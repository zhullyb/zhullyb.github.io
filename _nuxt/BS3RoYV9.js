const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Dt11aR0K.js","./BlLAPiP8.js","./entry.Cb3Jctur.css","./BC7mfSrw.js"])))=>i.map(i=>d[i]);
import{_ as D}from"./D0j9umye.js";import{_ as q}from"./CZA9huQ6.js";import{d as j,C as m,D as P,o as f,Q as O,E as c,y as N,G as u,I as E,_ as H,J as V,q as T,O as S,a as k,w as C,c as I,af as z,ag as F,ah as U,ai as Y,R as G,b as J,f as K,i as Q,M,N as W,P as X,K as R,L as Z,H as tt,F as et}from"./BlLAPiP8.js";import{a as nt,_ as st,u as B}from"./C7HeVghe.js";import{q as at,b as ot}from"./CWsaYOKK.js";const rt={key:0,class:"post-navigation"},it=["href"],lt={class:"nav-content"},ct={class:"nav-title"},ut=["href"],ft={class:"nav-content"},dt={class:"nav-title"},vt=j({__name:"PostNavigation",props:{prevPost:{},nextPost:{}},setup(t){return(o,e)=>t.prevPost||t.nextPost?(f(),m("nav",rt,[t.prevPost?(f(),m("a",{key:0,class:"nav-button prev",href:t.prevPost.path+"/",onClick:e[0]||(e[0]=O(i=>("navigateTo"in o?o.navigateTo:c(N))(t.prevPost.path+"/"),["prevent"]))},[e[3]||(e[3]=u("div",{class:"nav-arrow"},"←",-1)),u("div",lt,[e[2]||(e[2]=u("span",{class:"nav-label"},"上一篇",-1)),u("span",ct,E(t.prevPost.title),1)])],8,it)):P("",!0),t.nextPost?(f(),m("a",{key:1,class:"nav-button next",href:t.nextPost.path+"/",onClick:e[1]||(e[1]=O(i=>("navigateTo"in o?o.navigateTo:c(N))(t.nextPost.path+"/"),["prevent"]))},[u("div",ft,[e[4]||(e[4]=u("span",{class:"nav-label"},"下一篇",-1)),u("span",dt,E(t.nextPost.title),1)]),e[5]||(e[5]=u("div",{class:"nav-arrow"},"→",-1))],8,ut)):P("",!0)])):P("",!0)}}),pt=Object.assign(H(vt,[["__scopeId","data-v-f7d5c848"]]),{__name:"PostNavigation"}),_t={key:1},mt=j({__name:"Waline",setup(t){const o=z(()=>G(()=>import("./Dt11aR0K.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(d=>d.Waline)),e=V(),i=T(()=>({...S.waline,path:e.path.endsWith("/")?e.path:e.path+"/"})),{targetRef:s,isVisible:p}=nt({rootMargin:"200px",threshold:0});return(d,a)=>{const n=Y;return f(),m("div",{id:"waline",ref_key:"walineRef",ref:s},[k(n,null,{default:C(()=>[c(p)?(f(),I(c(o),F(U({key:0},c(i))),null,16)):(f(),m("div",_t,"Waline Loading..."))]),_:1})],512)}}}),ht=Object.assign(mt,{__name:"Waline"});function A(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(A).join(""):t.map(A).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(A).join(""):"":""}function gt(t){if(!t)return[];const o=[],e=t.value||t;function i(s){if(s)if(Array.isArray(s))if(s.length>=2&&typeof s[0]=="string"&&typeof s[1]=="object"){const p=s[0],d=s[1],a=s.slice(2),n=p.match(/^h([1-6])$/);if(n?.[1]&&d.id){const r=parseInt(n[1]),l=a.map(A).join("").trim();l&&o.push({id:d.id,text:l,level:r})}a.forEach(i)}else s.forEach(i);else typeof s=="object"&&(s.children&&Array.isArray(s.children)&&s.children.forEach(i),s.value&&Array.isArray(s.value)&&s.value.forEach(i))}return i(e),o}const yt={key:0,class:"toc"},xt={class:"toc-list"},bt=["href","onClick"],wt=j({__name:"TableOfContents",props:{body:{}},setup(t){const o=t,e=T(()=>gt(o.body)),i=J(""),s=a=>{if(!i.value)return!1;const n=e.value.findIndex(v=>v.id===i.value),r=e.value.findIndex(v=>v.id===a.id);if(n===-1||r===-1)return!1;const l=a;if(l.id===i.value||l.level<=2)return!1;const $=v=>{const h=[],g=e.value[v];if(!g)return h;let y=g.level,w=v-1;for(;w>=0;){const _=e.value[w];if(!_||_.level<y&&(h.push(_.id),y=_.level,_.level<=1))break;w--}return h},L=v=>{const h=e.value[v];if(!h)return null;let g=v-1;for(;g>=0;){const y=e.value[g];if(!y)break;if(y.level<h.level)return y.id;g--}return null},x=$(n);if(x.includes(l.id))return!1;const b=L(r);return!(!b||b===i.value||x.includes(b))},p=a=>{const n=document.getElementById(a);n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),window.history.pushState(null,"",`#${a}`))},d=()=>{const a=e.value.map(l=>({id:l.id,element:document.getElementById(l.id)})).filter(l=>l.element!==null);if(a.length===0)return;const n=window.scrollY;let r=a[0];for(const l of a)if(l.element.getBoundingClientRect().top+n<=n+100)r=l;else break;r&&(i.value=r.id)};return K(()=>{d();let a=!1;const n=()=>{a||(window.requestAnimationFrame(()=>{d(),a=!1}),a=!0)};window.addEventListener("scroll",n,{passive:!0}),Q(()=>{window.removeEventListener("scroll",n)})}),(a,n)=>c(e).length>0?(f(),m("nav",yt,[n[0]||(n[0]=u("div",{class:"toc-title"},"目录",-1)),u("ul",xt,[(f(!0),m(M,null,W(c(e),r=>(f(),m("li",{key:r.id,class:X(["toc-item",`toc-level-${r.level}`,{active:c(i)===r.id,collapsed:s(r)}])},[u("a",{href:`#${r.id}`,onClick:O(l=>p(r.id),["prevent"])},E(r.text),9,bt)],2))),128))])])):P("",!0)}}),Pt=Object.assign(H(wt,[["__scopeId","data-v-ae70bcd1"]]),{__name:"TableOfContents"}),$t={class:"tags"},kt=j({__name:"[slug]",async setup(t){let o,e;const i=V(),{year:s,month:p,day:d,slug:a}=i.params,{data:n}=([o,e]=R(()=>B(`post-${s}-${p}-${d}-${a}`,()=>at("posts").path(`/${s}/${p}/${d}/${a}`).first())),o=await o,e(),o);if(!n.value)throw Z({statusCode:404,statusMessage:"Post not found",fatal:!0});const r=([o,e]=R(()=>B(`surround-${s}-${p}-${d}-${a}`,()=>ot("posts",n.value.path,{before:1,after:1,fields:["title","path","date"]}).order("date","DESC"))),o=await o,e(),o).data,l=T(()=>r.value?.[0]||null),$=T(()=>r.value?.[1]||null);return tt({meta:[{name:"description",content:n.value?.description||""},{name:"keywords",content:n.value?.tags?.join(",")||""}],link:[{rel:"stylesheet",href:"https://static.031130.xyz/res/github-markdown.css"}]}),(L,x)=>{const b=D,v=q,h=pt,g=ht,y=Pt,w=st;return f(),I(w,{title:c(n)?.title},{AfterMain:C(()=>[u("aside",null,[k(y,{body:c(n)?.body},null,8,["body"])])]),default:C(()=>[c(n)?(f(),I(b,{key:0,value:c(n),tag:"article",class:"markdown-body"},null,8,["value"])):P("",!0),x[0]||(x[0]=u("hr",{class:"article-end-hr"},null,-1)),u("div",$t,[(f(!0),m(M,null,W(c(n)?.tags,_=>(f(),I(v,{key:_,to:`/tags/${encodeURIComponent(_)}`,prefetchOn:"interaction"},{default:C(()=>[et("#"+E(_),1)]),_:2},1032,["to"]))),128))]),k(h,{prevPost:c(l),nextPost:c($)},null,8,["prevPost","nextPost"]),k(g)]),_:1},8,["title"])}}}),jt=H(kt,[["__scopeId","data-v-5261e858"]]);export{jt as default};
