const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CbTrtqan.js","./WUoQoJsz.js","./entry.0KQ4aIgo.css","./BC7mfSrw.js"])))=>i.map(i=>d[i]);
import{_ as q}from"./DZWqbQlz.js";import{_ as F}from"./DA9VwbUs.js";import{a as U,d as Y,_ as G,u as H,q as J,e as K}from"./DWzm9oBL.js";import{e as j,L as z,b as x,F as N,o as _,c as b,w as P,d as u,J as w,G as c,_ as T,K as B,x as E,Q,a as A,ag as X,ah as Z,ai as tt,aj as et,S as nt,f as st,h as at,k as ot,O as V,P as W,R as rt,T as lt,W as it,M as R,N as ct,I as ut,H as _t}from"./WUoQoJsz.js";import{_ as dt}from"./CsLU05z7.js";const ft={key:0,class:"post-navigation"},pt={class:"nav-content"},vt={class:"nav-label"},mt={class:"nav-title"},ht={class:"nav-content"},gt={class:"nav-label"},yt={class:"nav-title"},xt=j({__name:"PostNavigation",props:{prevPost:{},nextPost:{}},setup(t){const{t:l}=z();return(o,r)=>{const e=U;return t.prevPost||t.nextPost?(_(),x("nav",ft,[t.prevPost?(_(),b(e,{key:0,class:"nav-button prev",to:t.prevPost.path},{default:P(()=>[r[0]||(r[0]=u("div",{class:"nav-arrow"},"←",-1)),u("div",pt,[u("span",vt,w(c(l)("postNavigation.prev")),1),u("span",mt,w(t.prevPost.title),1)])]),_:1},8,["to"])):N("",!0),t.nextPost?(_(),b(e,{key:1,class:"nav-button next",to:t.nextPost.path},{default:P(()=>[u("div",ht,[u("span",gt,w(c(l)("postNavigation.next")),1),u("span",yt,w(t.nextPost.title),1)]),r[1]||(r[1]=u("div",{class:"nav-arrow"},"→",-1))]),_:1},8,["to"])):N("",!0)])):N("",!0)}}}),wt=Object.assign(T(xt,[["__scopeId","data-v-3c6a4bdf"]]),{__name:"PostNavigation"}),bt={key:1},Pt=j({__name:"Waline",setup(t){const l=X(()=>nt(()=>import("./CbTrtqan.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(n=>n.Waline)),o=B(),{locale:r}=z(),e=E(()=>({...Q.waline,lang:r.value==="zh"?"zh-CN":"en",path:(o.path.endsWith("/")?o.path:o.path+"/").replace("/en/","/")})),{targetRef:g,isVisible:f}=Y({rootMargin:"200px",threshold:0});return(n,s)=>{const a=et;return _(),x("div",{id:"waline",ref_key:"walineRef",ref:g},[A(a,null,{default:P(()=>[c(f)?(_(),b(c(l),Z(tt({key:0},c(e))),null,16)):(_(),x("div",bt,"Waline Loading..."))]),_:1})],512)}}}),$t=Object.assign(Pt,{__name:"Waline"});function L(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(L).join(""):t.map(L).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(L).join(""):"":""}function kt(t){if(!t)return[];const l=[],o=t.value||t;function r(e){if(e)if(Array.isArray(e))if(e.length>=2&&typeof e[0]=="string"&&typeof e[1]=="object"){const g=e[0],f=e[1],n=e.slice(2),s=g.match(/^h([1-6])$/);if(s?.[1]&&f.id){const a=parseInt(s[1]),i=n.map(L).join("").trim();i&&l.push({id:f.id,text:i,level:a})}n.forEach(r)}else e.forEach(r);else typeof e=="object"&&(e.children&&Array.isArray(e.children)&&e.children.forEach(r),e.value&&Array.isArray(e.value)&&e.value.forEach(r))}return r(o),l}const Ct={key:0,class:"toc"},It={class:"toc-list"},At=["href","onClick"],Nt=j({__name:"TableOfContents",props:{body:{}},setup(t){const l=t,o=E(()=>kt(l.body)),r=st(""),e=n=>{if(!r.value)return!1;const s=o.value.findIndex(p=>p.id===r.value),a=o.value.findIndex(p=>p.id===n.id);if(s===-1||a===-1)return!1;const i=n;if(i.id===r.value||i.level<=2)return!1;const d=p=>{const v=[],m=o.value[p];if(!m)return v;let h=m.level,I=p-1;for(;I>=0;){const y=o.value[I];if(!y||y.level<h&&(v.push(y.id),h=y.level,y.level<=1))break;I--}return v},$=p=>{const v=o.value[p];if(!v)return null;let m=p-1;for(;m>=0;){const h=o.value[m];if(!h)break;if(h.level<v.level)return h.id;m--}return null},k=d(s);if(k.includes(i.id))return!1;const C=$(a);return!(!C||C===r.value||k.includes(C))},g=n=>{const s=document.getElementById(n);s&&(s.scrollIntoView({behavior:"smooth",block:"start"}),window.history.pushState(null,"",`#${n}`))},f=()=>{const n=o.value.map(i=>({id:i.id,element:document.getElementById(i.id)})).filter(i=>i.element!==null);if(n.length===0)return;const s=window.scrollY;let a=n[0];for(const i of n)if(i.element.getBoundingClientRect().top+s<=s+100)a=i;else break;a&&(r.value=a.id)};return at(()=>{f();let n=!1;const s=()=>{n||(window.requestAnimationFrame(()=>{f(),n=!1}),n=!0)};window.addEventListener("scroll",s,{passive:!0}),ot(()=>{window.removeEventListener("scroll",s)})}),(n,s)=>c(o).length>0?(_(),x("nav",Ct,[s[0]||(s[0]=u("div",{class:"toc-title"},"目录",-1)),u("ul",It,[(_(!0),x(V,null,W(c(o),a=>(_(),x("li",{key:a.id,class:rt(["toc-item",`toc-level-${a.level}`,{active:c(r)===a.id,collapsed:e(a)}])},[u("a",{href:`#${a.id}`,onClick:lt(i=>g(a.id),["prevent"])},w(a.text),9,At)],2))),128))])])):N("",!0)}}),Et=Object.assign(T(Nt,[["__scopeId","data-v-ae70bcd1"]]),{__name:"TableOfContents"}),Lt={class:"tags"},jt=j({__name:"index",async setup(t){let l,o;const r=B(),{locale:e}=z(),g=it(),{year:f,month:n,day:s,slug:a}=r.params,i=E(()=>`/${f}/${n}/${s}/${a}`),{data:d}=([l,o]=R(()=>H(`post-${f}-${n}-${s}-${a}-${e.value}`,()=>J("posts").path(i.value).where("lang","=",e.value==="zh"?"zh-CN":"en").first())),l=await l,o(),l);if(!d.value)throw ct({statusCode:404,statusMessage:"Post not found",fatal:!0});const $=([l,o]=R(()=>H(`surround-${f}-${n}-${s}-${a}-${e.value}`,()=>K("posts",d.value.path,{before:1,after:1,fields:["title","path","date","lang"]}).where("lang","=",e.value==="zh"?"zh-CN":"en").order("date","DESC"))),l=await l,o(),l).data,k=E(()=>$.value?.[0]||null),C=E(()=>$.value?.[1]||null);return ut({meta:[{name:"description",content:d.value?.description||""},{name:"keywords",content:d.value?.tags?.join(",")||""}],link:[{rel:"stylesheet",href:"https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"}]}),(p,v)=>{const m=q,h=dt,I=F,y=wt,M=$t,S=Et,D=G;return _(),b(D,{title:c(d)?.title},{AfterMain:P(()=>[u("aside",null,[A(S,{body:c(d)?.body},null,8,["body"])])]),default:P(()=>[c(d)?(_(),b(m,{key:0,value:c(d),tag:"article",class:"markdown-body"},null,8,["value"])):N("",!0),v[0]||(v[0]=u("hr",{class:"article-end-hr"},null,-1)),u("div",Lt,[A(h),(_(!0),x(V,null,W(c(d)?.tags,O=>(_(),b(I,{key:O,to:`${c(g)("/tags")}/${encodeURIComponent(O)}`,prefetchOn:"interaction"},{default:P(()=>[_t("#"+w(O),1)]),_:2},1032,["to"]))),128))]),A(y,{prevPost:c(k),nextPost:c(C)},null,8,["prevPost","nextPost"]),A(M)]),_:1},8,["title"])}}}),Bt=T(jt,[["__scopeId","data-v-11c89a0f"]]);export{Bt as default};
