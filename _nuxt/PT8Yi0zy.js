import{_ as T}from"./CtmZfTcB.js";import{_ as j}from"./T75rCvxz.js";import{d as E,J as b,K as d,q as B,L as H,H as I,C as i,o as n,a as x,M as y,N as v,G as l,I as u,c as M,w as S,F as q,E as f,_ as z}from"./t3YLDFC_.js";import{u as C}from"./BkbPqaJR.js";import{q as A}from"./JyMgyJju.js";function p(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(p).join(""):t.map(p).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(p).join(""):"":""}function D(t,e=300){if(!t)return"";const s=p(t.value||t).replace(/\s+/g," ").trim();return s.length<=e?s:s.slice(0,e)+"..."}const F={class:"title"},V={class:"description"},$={class:"post-meta"},L={class:"date"},g=10,O=E({__name:"HomeArticleContainer",async setup(t){let e,r;const s=b(),o=s.params.page&&parseInt(s.params.page)||1,c=([e,r]=d(()=>C(`index-page-${o}`,()=>A("posts").where("lang","=","zh-CN").order("date","DESC").skip((o-1)*g).limit(g).select("title","date","path","tags","body").all())),e=await e,r(),e).data,k=B(()=>c.value?c.value.map(_=>({..._,excerpt:D(_.body,300)})):[]),w=([e,r]=d(()=>C("posts-total",()=>A("posts").where("lang","=","zh-CN").count())),e=await e,r(),e).data,N=Math.max(1,Math.ceil((w.value??0)/g));if(c.value&&c.value.length===0&&o>1)throw H({statusCode:404,statusMessage:"Page not found",fatal:!0});return I({title:"竹林里有冰的博客",titleTemplate:"%s"}),(_,R)=>{const h=T,P=j;return n(),i("div",null,[(n(!0),i(y,null,v(f(k),a=>(n(),i("div",{key:a.path,class:"post-item"},[x(h,{to:a.path,class:"post-link","aria-label":a.title},null,8,["to","aria-label"]),l("h2",F,u(a.title),1),l("span",V,u(a.excerpt),1),l("div",$,[l("span",L,u(a.date?.split(" ")[0]),1),(n(!0),i(y,null,v(a.tags,m=>(n(),M(h,{class:"tags",key:m,to:`/tags/${encodeURIComponent(m)}`,prefetchOn:"interaction"},{default:S(()=>[q(u("#"+m),1)]),_:2},1032,["to"]))),128))])]))),128)),x(P,{currentPage:f(o),totalPages:f(N)},null,8,["currentPage","totalPages"])])}}}),W=Object.assign(z(O,[["__scopeId","data-v-c7eda537"]]),{__name:"HomeArticleContainer"});export{W as _};
