const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CYij9jS2.js","./DMBZNLBx.js","./entry.Cb3Jctur.css","./BC7mfSrw.js"])))=>i.map(i=>d[i]);
import{_ as U}from"./-BJgz6E8.js";import{_ as Y}from"./C0e4w4BS.js";import{d as j,C as h,D as P,o as d,R as H,E as c,y as V,G as u,I as T,_ as R,J as M,q as x,P as G,a as C,w as I,c as A,af as J,ag as K,ah as Q,ai as X,S as Z,b as tt,f as et,i as nt,N as W,O as D,Q as st,K as at,L as O,M as ot,H as rt,F as lt}from"./DMBZNLBx.js";import{b as it,_ as ct,u as z,q as B,d as ut}from"./D42L5MEN.js";const ft={key:0,class:"post-navigation"},dt=["href"],vt={class:"nav-content"},pt={class:"nav-title"},_t=["href"],mt={class:"nav-content"},ht={class:"nav-title"},gt=j({__name:"PostNavigation",props:{prevPost:{},nextPost:{}},setup(e){return(s,t)=>e.prevPost||e.nextPost?(d(),h("nav",ft,[e.prevPost?(d(),h("a",{key:0,class:"nav-button prev",href:e.prevPost.path+"/",onClick:t[0]||(t[0]=H(i=>("navigateTo"in s?s.navigateTo:c(V))(e.prevPost.path+"/"),["prevent"]))},[t[3]||(t[3]=u("div",{class:"nav-arrow"},"←",-1)),u("div",vt,[t[2]||(t[2]=u("span",{class:"nav-label"},"上一篇",-1)),u("span",pt,T(e.prevPost.title),1)])],8,dt)):P("",!0),e.nextPost?(d(),h("a",{key:1,class:"nav-button next",href:e.nextPost.path+"/",onClick:t[1]||(t[1]=H(i=>("navigateTo"in s?s.navigateTo:c(V))(e.nextPost.path+"/"),["prevent"]))},[u("div",mt,[t[4]||(t[4]=u("span",{class:"nav-label"},"下一篇",-1)),u("span",ht,T(e.nextPost.title),1)]),t[5]||(t[5]=u("div",{class:"nav-arrow"},"→",-1))],8,_t)):P("",!0)])):P("",!0)}}),yt=Object.assign(R(gt,[["__scopeId","data-v-f7d5c848"]]),{__name:"PostNavigation"}),$t={key:1},xt=j({__name:"Waline",setup(e){const s=J(()=>Z(()=>import("./CYij9jS2.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(f=>f.Waline)),t=M(),i=x(()=>({...G.waline,path:t.path.endsWith("/")?t.path:t.path+"/"})),{targetRef:n,isVisible:p}=it({rootMargin:"200px",threshold:0});return(f,r)=>{const o=X;return d(),h("div",{id:"waline",ref_key:"walineRef",ref:n},[C(o,null,{default:I(()=>[c(p)?(d(),A(c(s),K(Q({key:0},c(i))),null,16)):(d(),h("div",$t,"Waline Loading..."))]),_:1})],512)}}}),wt=Object.assign(xt,{__name:"Waline"});function E(e){return e?typeof e=="string"?e:Array.isArray(e)?e.length>=2&&typeof e[0]=="string"&&typeof e[1]=="object"?e.slice(2).map(E).join(""):e.map(E).join(""):e.value&&typeof e.value=="string"?e.value:e.children&&Array.isArray(e.children)?e.children.map(E).join(""):"":""}function bt(e){if(!e)return[];const s=[],t=e.value||e;function i(n){if(n)if(Array.isArray(n))if(n.length>=2&&typeof n[0]=="string"&&typeof n[1]=="object"){const p=n[0],f=n[1],r=n.slice(2),o=p.match(/^h([1-6])$/);if(o?.[1]&&f.id){const l=parseInt(o[1]),a=r.map(E).join("").trim();a&&s.push({id:f.id,text:a,level:l})}r.forEach(i)}else n.forEach(i);else typeof n=="object"&&(n.children&&Array.isArray(n.children)&&n.children.forEach(i),n.value&&Array.isArray(n.value)&&n.value.forEach(i))}return i(t),s}const Pt={key:0,class:"toc"},kt={class:"toc-list"},Ct=["href","onClick"],It=j({__name:"TableOfContents",props:{body:{}},setup(e){const s=e,t=x(()=>bt(s.body)),i=tt(""),n=r=>{if(!i.value)return!1;const o=t.value.findIndex(v=>v.id===i.value),l=t.value.findIndex(v=>v.id===r.id);if(o===-1||l===-1)return!1;const a=r;if(a.id===i.value||a.level<=2)return!1;const k=v=>{const _=[],m=t.value[v];if(!m)return _;let g=m.level,b=v-1;for(;b>=0;){const y=t.value[b];if(!y||y.level<g&&(_.push(y.id),g=y.level,y.level<=1))break;b--}return _},L=v=>{const _=t.value[v];if(!_)return null;let m=v-1;for(;m>=0;){const g=t.value[m];if(!g)break;if(g.level<_.level)return g.id;m--}return null},$=k(o);if($.includes(a.id))return!1;const w=L(l);return!(!w||w===i.value||$.includes(w))},p=r=>{const o=document.getElementById(r);o&&(o.scrollIntoView({behavior:"smooth",block:"start"}),window.history.pushState(null,"",`#${r}`))},f=()=>{const r=t.value.map(a=>({id:a.id,element:document.getElementById(a.id)})).filter(a=>a.element!==null);if(r.length===0)return;const o=window.scrollY;let l=r[0];for(const a of r)if(a.element.getBoundingClientRect().top+o<=o+100)l=a;else break;l&&(i.value=l.id)};return et(()=>{f();let r=!1;const o=()=>{r||(window.requestAnimationFrame(()=>{f(),r=!1}),r=!0)};window.addEventListener("scroll",o,{passive:!0}),nt(()=>{window.removeEventListener("scroll",o)})}),(r,o)=>c(t).length>0?(d(),h("nav",Pt,[o[0]||(o[0]=u("div",{class:"toc-title"},"目录",-1)),u("ul",kt,[(d(!0),h(W,null,D(c(t),l=>(d(),h("li",{key:l.id,class:st(["toc-item",`toc-level-${l.level}`,{active:c(i)===l.id,collapsed:n(l)}])},[u("a",{href:`#${l.id}`,onClick:H(a=>p(l.id),["prevent"])},T(l.text),9,Ct)],2))),128))])])):P("",!0)}}),At=Object.assign(R(It,[["__scopeId","data-v-ae70bcd1"]]),{__name:"TableOfContents"}),Et={class:"tags"},Tt=j({__name:"index",async setup(e){let s,t;const i=M(),{locale:n}=at(),{year:p,month:f,day:r,slug:o}=i.params,l=x(()=>`/${p}/${f}/${r}/${o}`),{data:a}=([s,t]=O(()=>z(`post-${p}-${f}-${r}-${o}-${n.value}`,()=>B("posts").path(l.value).where("lang","=",n.value==="zh"?"zh-CN":"en").first())),s=await s,t(),s),k=x(()=>n.value==="zh"?"en":"zh"),{data:L}=([s,t]=O(()=>z(`has-other-${p}-${f}-${r}-${o}-${n.value}`,()=>B("posts").path(l.value).where("lang","=",k.value==="zh"?"zh-CN":"en").count().then(_=>_>0))),s=await s,t(),s);if(!a.value)throw ot({statusCode:404,statusMessage:"Post not found",fatal:!0});const $=([s,t]=O(()=>z(`surround-${p}-${f}-${r}-${o}-${n.value}`,()=>ut("posts",a.value.path,{before:1,after:1,fields:["title","path","date"]}).order("date","DESC"))),s=await s,t(),s).data,w=x(()=>$.value?.[0]||null),v=x(()=>$.value?.[1]||null);return rt({meta:[{name:"description",content:a.value?.description||""},{name:"keywords",content:a.value?.tags?.join(",")||""}],link:[{rel:"stylesheet",href:"https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"}]}),(_,m)=>{const g=U,b=Y,y=yt,S=wt,q=At,F=ct;return d(),A(F,{title:c(a)?.title},{AfterMain:I(()=>[u("aside",null,[C(q,{body:c(a)?.body},null,8,["body"])])]),default:I(()=>[c(a)?(d(),A(g,{key:0,value:c(a),tag:"article",class:"markdown-body"},null,8,["value"])):P("",!0),m[0]||(m[0]=u("hr",{class:"article-end-hr"},null,-1)),u("div",Et,[(d(!0),h(W,null,D(c(a)?.tags,N=>(d(),A(b,{key:N,to:`/tags/${encodeURIComponent(N)}`,prefetchOn:"interaction"},{default:I(()=>[lt("#"+T(N),1)]),_:2},1032,["to"]))),128))]),C(y,{prevPost:c(w),nextPost:c(v)},null,8,["prevPost","nextPost"]),C(S)]),_:1},8,["title"])}}}),zt=R(Tt,[["__scopeId","data-v-058cb8d4"]]);export{zt as default};
