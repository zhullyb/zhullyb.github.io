const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B53YlFIc.js","./BeZ9uWtg.js","./entry.Cb3Jctur.css"])))=>i.map(i=>d[i]);
import{_ as M}from"./Cyw_0KGc.js";import{f as A,c as y,j as b,o as p,p as T,k as u,s as N,a as c,t as j,_ as O,g as D,l as k,m as S,e as B,w as H,b as $,v as V,x as W,y as R,z as F,A as z,B as Y,C as U,F as G,r as J,q as K,h as L,i as Q,u as X}from"./BeZ9uWtg.js";import{_ as Z,u as q}from"./bIOjXvdM.js";import{q as tt,a as et}from"./CaRVx73X.js";import{t as nt}from"./Dw9FZWsg.js";import"./zUSoyYz1.js";const st={key:0,class:"post-navigation"},at=["href"],ot={class:"nav-content"},rt={class:"nav-title"},lt=["href"],it={class:"nav-content"},ct={class:"nav-title"},ut=A({__name:"PostNavigation",props:{prevPost:{},nextPost:{}},setup(t){return(a,e)=>t.prevPost||t.nextPost?(p(),y("nav",st,[t.prevPost?(p(),y("a",{key:0,class:"nav-button prev",href:t.prevPost.path+"/",onClick:e[0]||(e[0]=T(l=>("navigateTo"in a?a.navigateTo:u(N))(t.prevPost.path+"/"),["prevent"]))},[e[3]||(e[3]=c("div",{class:"nav-arrow"},"←",-1)),c("div",ot,[e[2]||(e[2]=c("span",{class:"nav-label"},"上一篇",-1)),c("span",rt,j(t.prevPost.title),1)])],8,at)):b("",!0),t.nextPost?(p(),y("a",{key:1,class:"nav-button next",href:t.nextPost.path+"/",onClick:e[1]||(e[1]=T(l=>("navigateTo"in a?a.navigateTo:u(N))(t.nextPost.path+"/"),["prevent"]))},[c("div",it,[e[4]||(e[4]=c("span",{class:"nav-label"},"下一篇",-1)),c("span",ct,j(t.nextPost.title),1)]),e[5]||(e[5]=c("div",{class:"nav-arrow"},"→",-1))],8,lt)):b("",!0)])):b("",!0)}}),ft=Object.assign(O(ut,[["__scopeId","data-v-27f76087"]]),{__name:"PostNavigation"}),vt=A({__name:"Waline",setup(t){const a=V(()=>R(()=>import("./B53YlFIc.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(s=>s.Waline)),e=D(),l=k(()=>({...S.waline,path:e.path}));return(s,d)=>{const f=F;return p(),B(f,null,{default:H(()=>[$(u(a),W({id:"waline"},u(l)),null,16)]),_:1})}}}),pt=Object.assign(vt,{__name:"Waline"});function C(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(C).join(""):t.map(C).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(C).join(""):"":""}function dt(t){if(!t)return[];const a=[],e=t.value||t;function l(s){if(s)if(Array.isArray(s))if(s.length>=2&&typeof s[0]=="string"&&typeof s[1]=="object"){const d=s[0],f=s[1],o=s.slice(2),n=d.match(/^h([1-6])$/);if(n?.[1]&&f.id){const r=parseInt(n[1]),i=o.map(C).join("").trim();i&&a.push({id:f.id,text:i,level:r})}o.forEach(l)}else s.forEach(l);else typeof s=="object"&&(s.children&&Array.isArray(s.children)&&s.children.forEach(l),s.value&&Array.isArray(s.value)&&s.value.forEach(l))}return l(e),a}const mt={key:0,class:"toc"},_t={class:"toc-list"},ht=["href","onClick"],gt=A({__name:"TableOfContents",props:{body:{}},setup(t){const a=t,e=k(()=>dt(a.body)),l=z(""),s=o=>{if(!l.value)return!1;const n=e.value.findIndex(v=>v.id===l.value),r=e.value.findIndex(v=>v.id===o.id);if(n===-1||r===-1)return!1;const i=o;if(i.id===l.value||i.level<=2)return!1;const w=v=>{const m=[],_=e.value[v];if(!_)return m;let h=_.level,E=v-1;for(;E>=0;){const P=e.value[E];if(!P||P.level<h&&(m.push(P.id),h=P.level,P.level<=1))break;E--}return m},I=v=>{const m=e.value[v];if(!m)return null;let _=v-1;for(;_>=0;){const h=e.value[_];if(!h)break;if(h.level<m.level)return h.id;_--}return null},g=w(n);if(g.includes(i.id))return!1;const x=I(r);return!(!x||x===l.value||g.includes(x))},d=o=>{const n=document.getElementById(o);n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),window.history.pushState(null,"",`#${o}`))},f=()=>{const o=e.value.map(i=>({id:i.id,element:document.getElementById(i.id)})).filter(i=>i.element!==null);if(o.length===0)return;const n=window.scrollY;let r=o[0];for(const i of o)if(i.element.getBoundingClientRect().top+n<=n+100)r=i;else break;r&&(l.value=r.id)};return Y(()=>{f();let o=!1;const n=()=>{o||(window.requestAnimationFrame(()=>{f(),o=!1}),o=!0)};window.addEventListener("scroll",n,{passive:!0}),U(()=>{window.removeEventListener("scroll",n)})}),(o,n)=>u(e).length>0?(p(),y("nav",mt,[n[0]||(n[0]=c("div",{class:"toc-title"},"目录",-1)),c("ul",_t,[(p(!0),y(G,null,J(u(e),r=>(p(),y("li",{key:r.id,class:K(["toc-item",`toc-level-${r.level}`,{active:u(l)===r.id,collapsed:s(r)}])},[c("a",{href:`#${r.id}`,onClick:T(i=>d(r.id),["prevent"])},j(r.text),9,ht)],2))),128))])])):b("",!0)}}),yt=Object.assign(O(gt,[["__scopeId","data-v-61bd12f2"]]),{__name:"TableOfContents"}),xt=A({__name:"[slug]",async setup(t){let a,e;const l=D(),{year:s,month:d,day:f,slug:o}=l.params,{data:n}=([a,e]=L(()=>q(`post-${s}-${d}-${f}-${o}`,()=>tt("posts").path(`/${s}/${d}/${f}/${o}`).first())),a=await a,e(),a);if(!n.value)throw Q({statusCode:404,statusMessage:"Post not found",fatal:!0});const r=([a,e]=L(()=>q(`surround-${s}-${d}-${f}-${o}`,()=>et("posts",n.value.path,{before:1,after:1,fields:["title","path","date"]}).order("date","DESC"))),a=await a,e(),a).data,i=k(()=>r.value?.[0]||null),w=k(()=>r.value?.[1]||null);return X({meta:[{name:"description",content:n.value?.description||""},{name:"keywords",content:nt(n.value?.tags)?.join(",")||""}]}),(I,g)=>{const x=M,v=ft,m=pt,_=yt,h=Z;return p(),B(h,{title:u(n)?.title},{AfterMain:H(()=>[c("aside",null,[$(_,{body:u(n)?.body},null,8,["body"])])]),default:H(()=>[u(n)?(p(),B(x,{key:0,value:u(n),tag:"article",class:"markdown-body"},null,8,["value"])):b("",!0),$(v,{prevPost:u(i),nextPost:u(w)},null,8,["prevPost","nextPost"]),g[0]||(g[0]=c("hr",null,null,-1)),$(m)]),_:1},8,["title"])}}}),At=O(xt,[["__scopeId","data-v-483530c4"]]);export{At as default};
