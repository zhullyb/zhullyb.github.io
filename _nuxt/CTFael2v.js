import{_ as Q}from"./Dxe9-dl9.js";import{l as B,S as se,U as me,I as W,V as ve,W as pe,X as ye,A as L,Y as ae,Z as ge,$ as oe,i as be,k as p,E as De,a0 as we,a1 as K,a2 as Ce,a3 as Se,a4 as Ee,a5 as $e,a6 as Me,H as xe,f as A,c as b,o as y,a as d,F as q,r as Y,e as ee,w as G,d as te,t as P,_ as j,j as F,n as Te,B as J,C as re,b as R,p as Oe,a7 as Ie,a8 as ie,a9 as Pe,aa as ke,ab as Le,g as ce,q as Be,u as Re,P as Z}from"./DCGosE3R.js";const Ne={trailing:!0};function Ve(e,t=25,s={}){if(s={...Ne,...s},!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let r,a,u=[],o,n;const x=(m,T)=>(o=Fe(e,m,T),o.finally(()=>{if(o=null,s.trailing&&n&&!a){const w=x(m,n);return n=null,w}}),o),E=function(...m){return s.trailing&&(n=m),o||new Promise(T=>{const w=!a&&s.leading;clearTimeout(a),a=setTimeout(()=>{a=null;const f=s.leading?r:x(this,m);n=null;for(const v of u)v(f);u=[]},t),w?(r=x(this,m),T(r)):u.push(T)})},l=m=>{m&&(clearTimeout(m),a=null)};return E.isPending=()=>!!a,E.cancel=()=>{l(a),u=[],n=null},E.flush=()=>{if(l(a),!n||o)return;const m=n;return n=null,x(this,m)},E}async function Fe(e,t,s){return await e.apply(t,s)}function le(...e){const t=typeof e[e.length-1]=="string"?e.pop():void 0;ue(e[0],e[1])&&e.unshift(t);let[s,r,a={}]=e,u=!1;const o=B(()=>pe(s));if(typeof o.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof r!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=se();a.server??=!0,a.default??=He,a.getCachedData??=fe,a.lazy??=!1,a.immediate??=!0,a.deep??=me.deep,a.dedupe??="cancel",a._functionName,n._asyncData[o.value];function x(){const f={cause:"initial",dedupe:a.dedupe};return n._asyncData[o.value]?._init||(f.cachedData=a.getCachedData(o.value,n,{cause:"initial"}),n._asyncData[o.value]=ne(n,o.value,r,a,f.cachedData)),()=>n._asyncData[o.value].execute(f)}const E=x(),l=n._asyncData[o.value];l._deps++;const m=a.server!==!1&&n.payload.serverRendered;{let f=function(h){const S=n._asyncData[h];S?._deps&&(S._deps--,S._deps===0&&S?._off())};const v=De();if(v&&m&&a.immediate&&!v.sp&&(v.sp=[]),v&&!v._nuxtOnBeforeMountCbs){v._nuxtOnBeforeMountCbs=[];const h=v._nuxtOnBeforeMountCbs;we(()=>{h.forEach(S=>{S()}),h.splice(0,h.length)}),K(()=>h.splice(0,h.length))}const C=v&&(v._nuxtClientOnly||Ce(Se,!1));m&&n.isHydrating&&(l.error.value||l.data.value!==void 0)?l.status.value=l.error.value?"error":"success":v&&(!C&&n.payload.serverRendered&&n.isHydrating||a.lazy)&&a.immediate?v._nuxtOnBeforeMountCbs.push(E):a.immediate&&l.status.value!=="success"&&E();const $=ye(),O=W(o,(h,S)=>{if((h||S)&&h!==S){u=!0;const z=n._asyncData[S]?.data.value!==void 0,i=n._asyncDataPromises[S]!==void 0,_={cause:"initial",dedupe:a.dedupe};if(!n._asyncData[h]?._init){let M;S&&z?M=n._asyncData[S].data.value:(M=a.getCachedData(h,n,{cause:"initial"}),_.cachedData=M),n._asyncData[h]=ne(n,h,r,a,M)}n._asyncData[h]._deps++,S&&f(S),(a.immediate||z||i)&&n._asyncData[h].execute(_),Ee(()=>{u=!1})}},{flush:"sync"}),k=a.watch?W(a.watch,()=>{u||l._execute({cause:"watch",dedupe:a.dedupe})}):()=>{};$&&ve(()=>{O(),k(),f(o.value)})}const T={data:U(()=>n._asyncData[o.value]?.data),pending:U(()=>n._asyncData[o.value]?.pending),status:U(()=>n._asyncData[o.value]?.status),error:U(()=>n._asyncData[o.value]?.error),refresh:(...f)=>n._asyncData[o.value]?._init?n._asyncData[o.value].execute(...f):x()(),execute:(...f)=>T.refresh(...f),clear:()=>{const f=n._asyncData[o.value];if(f?._abortController)try{f._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{f._abortController=void 0}de(n,o.value)}},w=Promise.resolve(n._asyncDataPromises[o.value]).then(()=>T);return Object.assign(w,T),w}function U(e){return B({get(){return e()?.value},set(t){const s=e();s&&(s.value=t)}})}function Ae(...e){const t=typeof e[e.length-1]=="string"?e.pop():void 0;ue(e[0],e[1])&&e.unshift(t);const[s,r,a={}]=e;return le(s,r,{...a,lazy:!0},null)}function ue(e,t){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof t=="function")}function de(e,t){t in e.payload.data&&(e.payload.data[t]=void 0),t in e.payload._errors&&(e.payload._errors[t]=void 0),e._asyncData[t]&&(e._asyncData[t].data.value=p(e._asyncData[t]._default()),e._asyncData[t].error.value=void 0,e._asyncData[t].status.value="idle"),t in e._asyncDataPromises&&(e._asyncDataPromises[t]=void 0)}function je(e,t){const s={};for(const r of t)s[r]=e[r];return s}function ne(e,t,s,r,a){e.payload._errors[t]??=void 0;const u=r.getCachedData!==fe,o=s,n=r.deep?L:ae,x=a!==void 0,E=e.hook("app:data:refresh",async m=>{(!m||m.includes(t))&&await l.execute({cause:"refresh:hook"})}),l={data:n(x?a:r.default()),pending:B(()=>l.status.value==="pending"),error:ge(e.payload._errors,t),status:ae("idle"),execute:(...m)=>{const[T,w=void 0]=m,f=T&&w===void 0&&typeof T=="object"?T:{};if(e._asyncDataPromises[t]&&(f.dedupe??r.dedupe)==="defer")return e._asyncDataPromises[t];{const C="cachedData"in f?f.cachedData:r.getCachedData(t,e,{cause:f.cause??"refresh:manual"});if(C!==void 0)return e.payload.data[t]=l.data.value=C,l.error.value=void 0,l.status.value="success",Promise.resolve(C)}l._abortController&&l._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),l._abortController=new AbortController,l.status.value="pending";const v=new Promise((C,$)=>{try{const O=f.timeout??r.timeout,k=qe([l._abortController?.signal,f?.signal],O);if(k.aborted){const h=k.reason;$(h instanceof Error?h:new DOMException(String(h??"Aborted"),"AbortError"));return}return k.addEventListener("abort",()=>{const h=k.reason;$(h instanceof Error?h:new DOMException(String(h??"Aborted"),"AbortError"))},{once:!0}),Promise.resolve(o(e,{signal:k})).then(C,$)}catch(O){$(O)}}).then(async C=>{let $=C;r.transform&&($=await r.transform(C)),r.pick&&($=je($,r.pick)),e.payload.data[t]=$,l.data.value=$,l.error.value=void 0,l.status.value="success"}).catch(C=>{if(!(e._asyncDataPromises[t]&&e._asyncDataPromises[t]!==v)&&!l._abortController?.signal.aborted){if(typeof DOMException<"u"&&C instanceof DOMException&&C.name==="AbortError"){l.status.value="idle";return}l.error.value=be(C),l.data.value=p(r.default()),l.status.value="error"}}).finally(()=>{delete e._asyncDataPromises[t]});return e._asyncDataPromises[t]=v,e._asyncDataPromises[t]},_execute:Ve((...m)=>l.execute(...m),0,{leading:!0}),_default:r.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{E(),e._asyncData[t]?._init&&(e._asyncData[t]._init=!1),u||oe(()=>{e._asyncData[t]?._init||(de(e,t),l.execute=()=>Promise.resolve())})}};return l}const He=()=>{},fe=(e,t,s)=>{if(t.isHydrating)return t.payload.data[e];if(s.cause!=="refresh:manual"&&s.cause!=="refresh:hook")return t.static.data[e]};function qe(e,t){const s=e.filter(u=>!!u);if(typeof t=="number"&&t>=0){const u=AbortSignal.timeout?.(t);u&&s.push(u)}if(AbortSignal.any)return AbortSignal.any(s);const r=new AbortController;for(const u of s)if(u.aborted){const o=u.reason??new DOMException("Aborted","AbortError");try{r.abort(o)}catch{r.abort()}return r.signal}const a=()=>{const o=s.find(n=>n.aborted)?.reason??new DOMException("Aborted","AbortError");try{r.abort(o)}catch{r.abort()}};for(const u of s)u.addEventListener?.("abort",a,{once:!0});return r.signal}function ze(){return globalThis.$fetch}const Ue={nuxt:{}},We=$e(Me,Ue);function _e(){const e=se();return e._appConfig||=xe(We),e._appConfig}const Ye={class:"pc-nav"},Ge={class:"container"},Je=A({__name:"HeaderNav",props:{navItems:{}},emits:["toggle"],setup(e,{emit:t}){const s=t,r=a=>{s("toggle",a)};return(a,u)=>{const o=Q;return y(),b("nav",null,[d("div",Ye,[(y(!0),b(q,null,Y(e.navItems,n=>(y(),ee(o,{key:n.link,to:n.link},{default:G(()=>[te(P(n.text),1)]),_:2},1032,["to"]))),128))]),d("div",{class:"mobile-nav",onClick:r},[d("div",Ge,[(y(),b(q,null,Y(3,n=>d("div",{class:"mobile-nav-item",key:n})),64))])])])}}}),Xe=Object.assign(j(Je,[["__scopeId","data-v-f0d77200"]]),{__name:"HeaderNav"}),Ze={class:"mask"},Qe={class:"title-container"},Ke={class:"title"},et={key:0},tt=A({__name:"Banner",props:{bannerImg:{},title:{},slogan:{}},setup(e){const t=e,s=B(()=>({background:`url(${t.bannerImg}) center center / cover no-repeat`}));return(r,a)=>(y(),b("div",{class:"banner",style:Te(p(s))},[d("div",Ze,[d("div",Qe,[d("div",Ke,[d("h1",null,P(e.title),1),e.slogan?(y(),b("p",et,P(e.slogan),1)):F("",!0)])])])],4))}}),at=Object.assign(j(tt,[["__scopeId","data-v-3b68dcd7"]]),{__name:"Banner"}),nt={class:"search-overlay__panel"},st={class:"search-overlay__header"},ot={key:0,class:"search-overlay__state"},rt={key:1,class:"search-overlay__body"},it={key:0,class:"search-overlay__state"},ct={key:1,class:"search-overlay__state"},lt={key:2,class:"search-overlay__count"},ut={key:3,class:"search-overlay__list"},dt={class:"search-overlay__item-title"},ft={class:"search-overlay__item-meta"},_t={key:0},ht={class:"search-overlay__item-snippet"},mt=50,vt=A({__name:"SearchOverlay",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,r=t,a=L(""),u=L(null),o=ze(),n=L(!1),x=async()=>{const i=await o("/search/sections.json");if(Array.isArray(i))return i;if(typeof i=="string")try{return JSON.parse(i)}catch(_){console.warn("[search] Failed to parse sections payload",_)}return[]},{data:E,pending:l,refresh:m}=Ae("posts-search-sections",x,{server:!1,immediate:!1,default:()=>[]}),T=B(()=>E.value??[]),w=B(()=>{const i=a.value.trim().toLowerCase();if(!i)return[];const _=Array.from(new Set(i.split(/\s+/).filter(Boolean)));if(!_.length)return[];const M=T.value.map(c=>{const g=(c.content??"").replace(/\s+/g," ").trim();if(!g)return null;const N=C(c),H=$(c),X=`${N} ${H} ${g}`.toLowerCase();if(!_.every(I=>X.includes(I)))return null;let V=0;return _.forEach(I=>{N.toLowerCase().includes(I)?V+=4:H.toLowerCase().includes(I)?V+=3:V+=1}),{id:c.id,baseId:O(c.id),documentTitle:N,sectionTitle:H,snippet:S(g,_),score:V}}).filter(c=>!!c).sort((c,g)=>g.score-c.score);if(!M.length)return[];const D=new Map;return M.forEach(c=>{const g=D.get(c.baseId);if(!g){D.set(c.baseId,{id:c.id,baseId:c.baseId,documentTitle:c.documentTitle,sectionTitles:c.sectionTitle?[c.sectionTitle]:[],snippets:[c.snippet],score:c.score,matchCount:1,bestScore:c.score});return}g.matchCount+=1,g.score+=c.score,g.snippets.push(c.snippet),c.sectionTitle&&!g.sectionTitles.includes(c.sectionTitle)&&g.sectionTitles.length<3&&g.sectionTitles.push(c.sectionTitle),c.score>g.bestScore&&(g.bestScore=c.score,g.id=c.id)}),Array.from(D.values()).map(c=>({id:c.id,documentTitle:c.documentTitle,sectionLabel:h(c.sectionTitles,c.matchCount),snippet:k(c.snippets),score:c.score,matchCount:c.matchCount})).sort((c,g)=>g.score-c.score).slice(0,mt)}),f=i=>{s.modelValue&&i.key==="Escape"&&(i.preventDefault(),v())};W(()=>s.modelValue,i=>{i?(n.value||(n.value=!0,m()),document.body.style.setProperty("overflow","hidden"),oe(()=>{a.value="",u.value?.focus()})):document.body.style.removeProperty("overflow")}),J(()=>{window.addEventListener("keydown",f)}),re(()=>{window.removeEventListener("keydown",f),document.body.style.removeProperty("overflow")});function v(){r("update:modelValue",!1)}function C(i){return i.titles?.[0]??i.title??"未命名文章"}function $(i){return i.titles?.length?i.titles.slice(1).filter(Boolean).at(-1)??i.title??"":i.title??""}function O(i){const _=i.indexOf("#");return _===-1?i:i.slice(0,_)}function k(i){const _=[];if(i.forEach(D=>{const c=D.trim();c&&(_.includes(c)||_.push(c))}),!_.length)return"";const M=_.slice(0,2).join(" … ");return M.length>240?`${M.slice(0,240)}…`:M}function h(i,_){return _?_===1?i[0]??"":i.length?`涉及段落：${i.join("、")}${_>i.length?"…":""}`:"":""}function S(i,_){if(!i)return"";const M=i.toLowerCase(),D=_.map(I=>M.indexOf(I)).filter(I=>I>=0).sort((I,he)=>I-he)[0];if(D===void 0)return z(i);const c=60,g=Math.max(0,D-c),N=Math.min(i.length,D+c),H=i.slice(g,N),X=g>0?"…":"",V=N<i.length?"…":"";return`${X}${H}${V}`}function z(i){return i.length>140?`${i.slice(0,140)}…`:i}return(i,_)=>{const M=Q;return y(),ee(Le,{to:"body"},[R(ke,{name:"search-overlay"},{default:G(()=>[e.modelValue?(y(),b("div",{key:0,class:"search-overlay",role:"dialog","aria-modal":"true",onMousedown:Oe(v,["self"])},[d("div",nt,[d("div",st,[Ie(d("input",{ref_key:"inputRef",ref:u,type:"search","onUpdate:modelValue":_[0]||(_[0]=D=>ie(a)?a.value=D:null),class:"search-overlay__input",placeholder:"搜索文章，支持多个关键词"},null,512),[[Pe,p(a)]]),d("button",{class:"search-overlay__close",type:"button",onClick:v,"aria-label":"关闭搜索"}," × ")]),p(l)?(y(),b("div",ot,"正在准备索引…")):(y(),b("div",rt,[p(a).trim()?p(w).length?(y(),b("div",lt," 共找到 "+P(p(w).length)+" 条结果 ",1)):(y(),b("p",ct," 没有找到匹配内容，换个关键词试试？ ")):(y(),b("p",it," 输入关键词开始搜索。 ")),p(w).length?(y(),b("ul",ut,[(y(!0),b(q,null,Y(p(w),D=>(y(),b("li",{key:D.id,class:"search-overlay__item"},[R(M,{to:D.id,class:"search-overlay__link",onClick:v},{default:G(()=>[d("h3",dt,P(D.documentTitle),1),d("p",ft,[te(" 共 "+P(D.matchCount)+" 处匹配 ",1),D.sectionLabel?(y(),b("span",_t," · "+P(D.sectionLabel),1)):F("",!0)]),d("p",ht,P(D.snippet),1)]),_:2},1032,["to"])]))),128))])):F("",!0)]))])],32)):F("",!0)]),_:1})])}}}),pt=Object.assign(j(vt,[["__scopeId","data-v-62b29045"]]),{__name:"SearchOverlay"});function yt(){const e=L(!1);let t=!1;const s=()=>{t||(window.requestAnimationFrame(()=>{e.value=window.scrollY>0,t=!1}),t=!0)};return J(()=>{s(),window.addEventListener("scroll",s)}),K(()=>{window.removeEventListener("scroll",s)}),{isScrolled:e}}function gt(){const e=L(!1),t=r=>{r.stopPropagation(),e.value=!e.value},s=()=>{e.value=!1};return J(()=>{document.addEventListener("click",s)}),K(()=>{document.removeEventListener("click",s)}),{showMobileMenu:e,toggleMobileMenu:t,closeMobileMenu:s}}const bt={class:"header-container"},Dt={class:"header"},wt={href:"/",class:"header-title"},Ct={class:"header-right"},St={key:0,class:"mobile-menu-dropdown"},Et=A({__name:"Header",props:{bannerImg:{},title:{default:""}},setup(e){const t=_e(),s=ce(),r=B(()=>s.path==="/"||s.path.startsWith("/page/")?t.slogan:null),a=e,u=B(()=>a.title||t.title),{isScrolled:o}=yt(),{showMobileMenu:n,toggleMobileMenu:x,closeMobileMenu:E}=gt(),l=L(!1),m=()=>{E(),l.value=!0};return W(()=>s.fullPath,()=>{l.value=!1}),(T,w)=>{const f=Xe,v=Q,C=at,$=pt;return y(),b(q,null,[d("header",{class:Be({scrolled:p(o),"show-mobile-menu":p(n)})},[d("div",bt,[d("div",Dt,[d("a",wt,P(p(t).title),1),d("div",Ct,[R(f,{"nav-items":p(t).nav.items,onToggle:p(x)},null,8,["nav-items","onToggle"]),d("button",{type:"button",class:"search-trigger",onClick:m,"aria-label":"搜索文章"},[...w[1]||(w[1]=[d("span",{"aria-hidden":"true"},"🔍",-1),d("span",{class:"search-trigger__label"},"搜索",-1)])])])])]),p(n)?(y(),b("div",St,[(y(!0),b(q,null,Y(p(t).nav.items,O=>(y(),ee(v,{key:O.link,to:O.link,onClick:p(E)},{default:G(()=>[te(P(O.text),1)]),_:2},1032,["to","onClick"]))),128))])):F("",!0)],2),R(C,{"banner-img":e.bannerImg,title:p(u),slogan:p(r)},null,8,["banner-img","title","slogan"]),R($,{modelValue:p(l),"onUpdate:modelValue":w[0]||(w[0]=O=>ie(l)?l.value=O:null)},null,8,["modelValue"])],64)}}}),$t=Object.assign(j(Et,[["__scopeId","data-v-995e7b74"]]),{__name:"Header"}),Mt={class:"footer-content"},xt={key:0,frameborder:"0",src:"https://support.nodeget.com/page/promotion?id=61",style:{"border-radius":"8px",height:"246px",transform:"scale(0.8)","transform-origin":"top center"}},Tt=A({__name:"Footer",props:{bannerImg:{}},setup(e){const s={background:`url(${e.bannerImg}) center bottom / cover no-repeat`,minHeight:"120px",color:"white"},r=L(null),a=L(!1);return J(()=>{if(!r.value)return;const u=new IntersectionObserver(o=>{o.forEach(n=>{n.isIntersecting&&!a.value&&(a.value=!0,u.disconnect())})},{rootMargin:"100px",threshold:.1});u.observe(r.value),re(()=>{u.disconnect()})}),(u,o)=>(y(),b("footer",{ref_key:"footerRef",ref:r,style:s},[o[1]||(o[1]=d("div",{class:"footer-mask"},null,-1)),d("div",Mt,[o[0]||(o[0]=d("div",null,"©2020 - 2025 By zhullyb",-1)),p(a)?(y(),b("iframe",xt)):F("",!0)])],512))}}),Ot=Object.assign(j(Tt,[["__scopeId","data-v-cfb67d99"]]),{__name:"Footer"}),It={class:"content-wrapper"},Pt={class:"before-main side"},kt={class:"after-main side"},Lt=A({__name:"DefaultLayout",props:{title:{default:""}},setup(e){const t=ce(),s=e,r=_e(),{data:a}=le("randomIndex"+t.path,async()=>Math.floor(Math.random()*r.imgs.length),"$RRY2fi8_v6"),u=B(()=>r.imgs[a.value??0]);return Re({title:s.title||r.title,link:[{rel:"preload",as:"image",href:u.value,fetchpriority:"high"}]}),(o,n)=>{const x=$t,E=Ot;return y(),b("div",null,[R(x,{"banner-img":p(u),title:e.title},null,8,["banner-img","title"]),d("div",It,[d("div",Pt,[Z(o.$slots,"BeforeMain",{},void 0,!0)]),d("main",null,[Z(o.$slots,"default",{},void 0,!0)]),d("div",kt,[Z(o.$slots,"AfterMain",{},void 0,!0)])]),R(E,{"banner-img":p(u)},null,8,["banner-img"])])}}}),Nt=Object.assign(j(Lt,[["__scopeId","data-v-03b6b78b"]]),{__name:"DefaultLayout"});export{Nt as _,le as u};
