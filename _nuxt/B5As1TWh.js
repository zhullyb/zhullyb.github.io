const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BauRiIOH.js","./CmZUfZZX.js","./entry.Cb3Jctur.css","./BC7mfSrw.js"])))=>i.map(i=>d[i]);
import{_ as Y}from"./COHHTgzf.js";import{_ as G}from"./IVamwgeO.js";import{d as j,C as h,D as P,o as d,R as V,E as c,y as R,G as u,I as L,_ as H,J as M,q as w,P as J,a as I,w as A,c as E,af as K,ag as Q,ah as X,ai as Z,S as ee,b as te,f as ne,i as se,N as W,O as D,Q as ae,K as oe,V as re,L as O,M as le,H as ie,F as ce}from"./CmZUfZZX.js";import{d as ue,_ as fe,u as z,q as B,e as de}from"./9JId8OjJ.js";const ve={key:0,class:"post-navigation"},pe=["href"],_e={class:"nav-content"},me={class:"nav-title"},he=["href"],ge={class:"nav-content"},ye={class:"nav-title"},$e=j({__name:"PostNavigation",props:{prevPost:{},nextPost:{}},setup(t){return(s,e)=>t.prevPost||t.nextPost?(d(),h("nav",ve,[t.prevPost?(d(),h("a",{key:0,class:"nav-button prev",href:t.prevPost.path+"/",onClick:e[0]||(e[0]=V(l=>("navigateTo"in s?s.navigateTo:c(R))(t.prevPost.path+"/"),["prevent"]))},[e[3]||(e[3]=u("div",{class:"nav-arrow"},"←",-1)),u("div",_e,[e[2]||(e[2]=u("span",{class:"nav-label"},"上一篇",-1)),u("span",me,L(t.prevPost.title),1)])],8,pe)):P("",!0),t.nextPost?(d(),h("a",{key:1,class:"nav-button next",href:t.nextPost.path+"/",onClick:e[1]||(e[1]=V(l=>("navigateTo"in s?s.navigateTo:c(R))(t.nextPost.path+"/"),["prevent"]))},[u("div",ge,[e[4]||(e[4]=u("span",{class:"nav-label"},"下一篇",-1)),u("span",ye,L(t.nextPost.title),1)]),e[5]||(e[5]=u("div",{class:"nav-arrow"},"→",-1))],8,he)):P("",!0)])):P("",!0)}}),xe=Object.assign(H($e,[["__scopeId","data-v-f7d5c848"]]),{__name:"PostNavigation"}),we={key:1},be=j({__name:"Waline",setup(t){const s=K(()=>ee(()=>import("./BauRiIOH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(f=>f.Waline)),e=M(),l=w(()=>({...J.waline,path:e.path.endsWith("/")?e.path:e.path+"/"})),{targetRef:n,isVisible:y}=ue({rootMargin:"200px",threshold:0});return(f,o)=>{const a=Z;return d(),h("div",{id:"waline",ref_key:"walineRef",ref:n},[I(a,null,{default:A(()=>[c(y)?(d(),E(c(s),Q(X({key:0},c(l))),null,16)):(d(),h("div",we,"Waline Loading..."))]),_:1})],512)}}}),Pe=Object.assign(be,{__name:"Waline"});function T(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(T).join(""):t.map(T).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(T).join(""):"":""}function ke(t){if(!t)return[];const s=[],e=t.value||t;function l(n){if(n)if(Array.isArray(n))if(n.length>=2&&typeof n[0]=="string"&&typeof n[1]=="object"){const y=n[0],f=n[1],o=n.slice(2),a=y.match(/^h([1-6])$/);if(a?.[1]&&f.id){const r=parseInt(a[1]),i=o.map(T).join("").trim();i&&s.push({id:f.id,text:i,level:r})}o.forEach(l)}else n.forEach(l);else typeof n=="object"&&(n.children&&Array.isArray(n.children)&&n.children.forEach(l),n.value&&Array.isArray(n.value)&&n.value.forEach(l))}return l(e),s}const Ce={key:0,class:"toc"},Ie={class:"toc-list"},Ae=["href","onClick"],Ee=j({__name:"TableOfContents",props:{body:{}},setup(t){const s=t,e=w(()=>ke(s.body)),l=te(""),n=o=>{if(!l.value)return!1;const a=e.value.findIndex(p=>p.id===l.value),r=e.value.findIndex(p=>p.id===o.id);if(a===-1||r===-1)return!1;const i=o;if(i.id===l.value||i.level<=2)return!1;const v=p=>{const g=[],_=e.value[p];if(!_)return g;let m=_.level,b=p-1;for(;b>=0;){const $=e.value[b];if(!$||$.level<m&&(g.push($.id),m=$.level,$.level<=1))break;b--}return g},k=p=>{const g=e.value[p];if(!g)return null;let _=p-1;for(;_>=0;){const m=e.value[_];if(!m)break;if(m.level<g.level)return m.id;_--}return null},C=v(a);if(C.includes(i.id))return!1;const x=k(r);return!(!x||x===l.value||C.includes(x))},y=o=>{const a=document.getElementById(o);a&&(a.scrollIntoView({behavior:"smooth",block:"start"}),window.history.pushState(null,"",`#${o}`))},f=()=>{const o=e.value.map(i=>({id:i.id,element:document.getElementById(i.id)})).filter(i=>i.element!==null);if(o.length===0)return;const a=window.scrollY;let r=o[0];for(const i of o)if(i.element.getBoundingClientRect().top+a<=a+100)r=i;else break;r&&(l.value=r.id)};return ne(()=>{f();let o=!1;const a=()=>{o||(window.requestAnimationFrame(()=>{f(),o=!1}),o=!0)};window.addEventListener("scroll",a,{passive:!0}),se(()=>{window.removeEventListener("scroll",a)})}),(o,a)=>c(e).length>0?(d(),h("nav",Ce,[a[0]||(a[0]=u("div",{class:"toc-title"},"目录",-1)),u("ul",Ie,[(d(!0),h(W,null,D(c(e),r=>(d(),h("li",{key:r.id,class:ae(["toc-item",`toc-level-${r.level}`,{active:c(l)===r.id,collapsed:n(r)}])},[u("a",{href:`#${r.id}`,onClick:V(i=>y(r.id),["prevent"])},L(r.text),9,Ae)],2))),128))])])):P("",!0)}}),Te=Object.assign(H(Ee,[["__scopeId","data-v-ae70bcd1"]]),{__name:"TableOfContents"}),Le={class:"tags"},je=j({__name:"index",async setup(t){let s,e;const l=M(),{locale:n}=oe(),y=re(),{year:f,month:o,day:a,slug:r}=l.params,i=w(()=>`/${f}/${o}/${a}/${r}`),{data:v}=([s,e]=O(()=>z(`post-${f}-${o}-${a}-${r}-${n.value}`,()=>B("posts").path(i.value).where("lang","=",n.value==="zh"?"zh-CN":"en").first())),s=await s,e(),s),k=w(()=>n.value==="zh"?"en":"zh"),{data:C}=([s,e]=O(()=>z(`has-other-${f}-${o}-${a}-${r}-${n.value}`,()=>B("posts").path(i.value).where("lang","=",k.value==="zh"?"zh-CN":"en").count().then(_=>_>0))),s=await s,e(),s);if(!v.value)throw le({statusCode:404,statusMessage:"Post not found",fatal:!0});const x=([s,e]=O(()=>z(`surround-${f}-${o}-${a}-${r}-${n.value}`,()=>de("posts",v.value.path,{before:1,after:1,fields:["title","path","date"]}).order("date","DESC"))),s=await s,e(),s).data,p=w(()=>x.value?.[0]||null),g=w(()=>x.value?.[1]||null);return ie({meta:[{name:"description",content:v.value?.description||""},{name:"keywords",content:v.value?.tags?.join(",")||""}],link:[{rel:"stylesheet",href:"https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"}]}),(_,m)=>{const b=Y,$=G,S=xe,q=Pe,F=Te,U=fe;return d(),E(U,{title:c(v)?.title},{AfterMain:A(()=>[u("aside",null,[I(F,{body:c(v)?.body},null,8,["body"])])]),default:A(()=>[c(v)?(d(),E(b,{key:0,value:c(v),tag:"article",class:"markdown-body"},null,8,["value"])):P("",!0),m[0]||(m[0]=u("hr",{class:"article-end-hr"},null,-1)),u("div",Le,[(d(!0),h(W,null,D(c(v)?.tags,N=>(d(),E($,{key:N,to:`${c(y)("/tags")}/${encodeURIComponent(N)}`,prefetchOn:"interaction"},{default:A(()=>[ce("#"+L(N),1)]),_:2},1032,["to"]))),128))]),I(S,{prevPost:c(p),nextPost:c(g)},null,8,["prevPost","nextPost"]),I(q)]),_:1},8,["title"])}}}),He=H(je,[["__scopeId","data-v-26f8506b"]]);export{He as default};
