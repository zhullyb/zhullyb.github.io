import{_ as B}from"./C0e4w4BS.js";import{_ as H}from"./DzUUEppu.js";import{d as M,J as S,K as b,q as C,L as A,M as q,H as z,C as l,o as n,a as g,N as w,O as k,G as P,w as d,F as h,I as i,c as D,E as x,_ as F}from"./DMBZNLBx.js";import{u as T,q as N}from"./D42L5MEN.js";function u(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(u).join(""):t.map(u).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(u).join(""):"":""}function L(t,e=300){if(!t)return"";const s=u(t.value||t).replace(/\s+/g," ").trim();return s.length<=e?s:s.slice(0,e)+"..."}const O={class:"post-meta"},V={class:"date"},v=10,R=M({__name:"HomeArticleContainer",async setup(t){let e,r;const s=S(),{locale:p}=b(),o=s.params.page&&parseInt(s.params.page)||1,y=C(()=>p.value==="zh"?"zh-CN":"en"),c=([e,r]=A(()=>T(`index-page-${o}-${p.value}`,()=>N("posts").where("lang","=",y.value).order("date","DESC").skip((o-1)*v).limit(v).select("title","date","path","tags","body").all())),e=await e,r(),e).data,j=C(()=>c.value?c.value.map(_=>({..._,excerpt:L(_.body,300)})):[]),E=([e,r]=A(()=>T(`posts-total-${p.value}`,()=>N("posts").where("lang","=",y.value).count())),e=await e,r(),e).data,I=Math.max(1,Math.ceil((E.value??0)/v));if(c.value&&c.value.length===0&&o>1)throw q({statusCode:404,statusMessage:"Page not found",fatal:!0});return z({title:"竹林里有冰的博客",titleTemplate:"%s"}),(_,G)=>{const m=B,$=H;return n(),l("div",null,[(n(!0),l(w,null,k(x(j),(a,J)=>(n(),l("div",{key:a.path,class:"post-item"},[g(m,{class:"title",to:a.path},{default:d(()=>[h(i(a.title),1)]),_:2},1032,["to"]),g(m,{class:"description",to:a.path},{default:d(()=>[h(i(a.excerpt),1)]),_:2},1032,["to"]),P("div",O,[P("span",V,i(a.date?.split(" ")[0]),1),(n(!0),l(w,null,k(a.tags,f=>(n(),D(m,{class:"tags",key:f,to:`/tags/${encodeURIComponent(f)}`,prefetchOn:"interaction"},{default:d(()=>[h(i("#"+f),1)]),_:2},1032,["to"]))),128))])]))),128)),g($,{currentPage:x(o),totalPages:x(I)},null,8,["currentPage","totalPages"])])}}}),X=Object.assign(F(R,[["__scopeId","data-v-a5886be2"]]),{__name:"HomeArticleContainer"});export{X as _};
