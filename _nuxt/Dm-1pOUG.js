import{_ as E}from"./BBO5uOiM.js";import{_ as B}from"./q0BRKcDC.js";import{d as H,J as I,K as y,q as M,L as S,H as q,C as i,o as n,a as f,M as v,N as C,G as A,w as g,F as d,I as l,c as z,E as h,_ as D}from"./DbskkZdU.js";import{u as w}from"./BF8af9ZJ.js";import{q as k}from"./Cq7l85EN.js";function u(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(u).join(""):t.map(u).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(u).join(""):"":""}function F(t,e=300){if(!t)return"";const r=u(t.value||t).replace(/\s+/g," ").trim();return r.length<=e?r:r.slice(0,e)+"..."}const V={class:"post-meta"},$={class:"date"},x=10,b=H({__name:"HomeArticleContainer",async setup(t){let e,s;const r=I(),o=r.params.page&&parseInt(r.params.page)||1,c=([e,s]=y(()=>w(`index-page-${o}`,()=>k("posts").where("lang","=","zh-CN").order("date","DESC").skip((o-1)*x).limit(x).select("title","date","path","tags","body").all())),e=await e,s(),e).data,N=M(()=>c.value?c.value.map(p=>({...p,excerpt:F(p.body,300)})):[]),P=([e,s]=y(()=>w("posts-total",()=>k("posts").where("lang","=","zh-CN").count())),e=await e,s(),e).data,T=Math.max(1,Math.ceil((P.value??0)/x));if(c.value&&c.value.length===0&&o>1)throw S({statusCode:404,statusMessage:"Page not found",fatal:!0});return q({title:"竹林里有冰的博客",titleTemplate:"%s"}),(p,L)=>{const _=E,j=B;return n(),i("div",null,[(n(!0),i(v,null,C(h(N),(a,O)=>(n(),i("div",{key:a.path,class:"post-item"},[f(_,{class:"title",to:a.path},{default:g(()=>[d(l(a.title),1)]),_:2},1032,["to"]),f(_,{class:"description",to:a.path},{default:g(()=>[d(l(a.excerpt),1)]),_:2},1032,["to"]),A("div",V,[A("span",$,l(a.date?.split(" ")[0]),1),(n(!0),i(v,null,C(a.tags,m=>(n(),z(_,{class:"tags",key:m,to:`/tags/${encodeURIComponent(m)}`,prefetchOn:"interaction"},{default:g(()=>[d(l("#"+m),1)]),_:2},1032,["to"]))),128))])]))),128)),f(j,{currentPage:h(o),totalPages:h(T)},null,8,["currentPage","totalPages"])])}}}),Q=Object.assign(D(b,[["__scopeId","data-v-94efa551"]]),{__name:"HomeArticleContainer"});export{Q as _};
