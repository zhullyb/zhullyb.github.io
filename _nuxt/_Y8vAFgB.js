import{_ as w}from"./Coz-PfSq.js";import{_ as j}from"./CGeWRNiO.js";import{t as E}from"./Dw9FZWsg.js";import{d as b,J as B,K as h,q as H,L as I,H as M,C as l,o,a as x,M as y,N as v,G as u,I as p,E as _,c as S,w as q,F as D,_ as F}from"./BiImNZuI.js";import{u as C}from"./BJXfnGRi.js";import{q as T}from"./CKjaJXXJ.js";function m(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(m).join(""):t.map(m).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(m).join(""):"":""}function V(t,e=300){if(!t)return"";const s=m(t.value||t).replace(/\s+/g," ").trim();return s.length<=e?s:s.slice(0,e)+"..."}const $={class:"title"},L={class:"description"},O={class:"post-meta"},R={class:"date"},g=10,z=b({__name:"HomeArticleContainer",async setup(t){let e,r;const s=B(),i=s.params.page&&parseInt(s.params.page)||1,c=([e,r]=h(()=>C(`index-page-${i}`,()=>T("posts").order("date","DESC").skip((i-1)*g).limit(g).select("title","date","path","tags","body").all())),e=await e,r(),e).data,A=H(()=>c.value?c.value.map(n=>({...n,excerpt:V(n.body,300)})):[]),k=([e,r]=h(()=>C("posts-total",()=>T("posts").count())),e=await e,r(),e).data,N=Math.max(1,Math.ceil((k.value??0)/g));if(c.value&&c.value.length===0&&i>1)throw I({statusCode:404,statusMessage:"Page not found",fatal:!0});return M({title:"竹林里有冰的博客",titleTemplate:"%s"}),(n,G)=>{const d=w,P=j;return o(),l("div",null,[(o(!0),l(y,null,v(_(A),a=>(o(),l("div",{key:a.path,class:"post-item"},[x(d,{to:a.path,class:"post-link","aria-label":a.title},null,8,["to","aria-label"]),u("h2",$,p(a.title),1),u("span",L,p(a.excerpt),1),u("div",O,[u("span",R,p(a.date?.split(" ")[0]),1),(o(!0),l(y,null,v(("toNormalTags"in n?n.toNormalTags:_(E))(a.tags),f=>(o(),S(d,{class:"tags",key:f,to:`/tags/${encodeURIComponent(f)}`,prefetchOn:"interaction"},{default:q(()=>[D(p("#"+f),1)]),_:2},1032,["to"]))),128))])]))),128)),x(P,{currentPage:_(i),totalPages:_(N)},null,8,["currentPage","totalPages"])])}}}),Y=Object.assign(F(z,[["__scopeId","data-v-ed5660f8"]]),{__name:"HomeArticleContainer"});export{Y as _};
