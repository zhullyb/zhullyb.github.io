import{_ as Q}from"./BVK46BlO.js";import{l as B,S as se,U as me,I as W,V as ve,W as pe,X as ge,p as L,Y as ae,Z as ye,$ as oe,i as be,k as p,E as De,a0 as we,a1 as K,a2 as Ce,a3 as Me,a4 as Se,a5 as Ee,a6 as $e,H as xe,f as j,c as b,o as g,a as d,F as z,r as Y,e as ee,w as G,d as te,t as P,_ as A,j as F,n as Te,B as J,C as re,b as R,s as Oe,a7 as Ie,a8 as ie,a9 as Pe,aa as ke,ab as Le,g as ce,q as Be,u as Re,P as Z}from"./H-0zYzXa.js";const Ve={trailing:!0};function Ne(e,t=25,s={}){if(s={...Ve,...s},!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let o,a,u=[],r,n;const x=(m,T)=>(r=Fe(e,m,T),r.finally(()=>{if(r=null,s.trailing&&n&&!a){const w=x(m,n);return n=null,w}}),r),S=function(...m){return s.trailing&&(n=m),r||new Promise(T=>{const w=!a&&s.leading;clearTimeout(a),a=setTimeout(()=>{a=null;const f=s.leading?o:x(this,m);n=null;for(const v of u)v(f);u=[]},t),w?(o=x(this,m),T(o)):u.push(T)})},l=m=>{m&&(clearTimeout(m),a=null)};return S.isPending=()=>!!a,S.cancel=()=>{l(a),u=[],n=null},S.flush=()=>{if(l(a),!n||r)return;const m=n;return n=null,x(this,m)},S}async function Fe(e,t,s){return await e.apply(t,s)}function le(...e){const t=typeof e[e.length-1]=="string"?e.pop():void 0;ue(e[0],e[1])&&e.unshift(t);let[s,o,a={}]=e,u=!1;const r=B(()=>pe(s));if(typeof r.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=se();a.server??=!0,a.default??=He,a.getCachedData??=fe,a.lazy??=!1,a.immediate??=!0,a.deep??=me.deep,a.dedupe??="cancel",a._functionName,n._asyncData[r.value];function x(){const f={cause:"initial",dedupe:a.dedupe};return n._asyncData[r.value]?._init||(f.cachedData=a.getCachedData(r.value,n,{cause:"initial"}),n._asyncData[r.value]=ne(n,r.value,o,a,f.cachedData)),()=>n._asyncData[r.value].execute(f)}const S=x(),l=n._asyncData[r.value];l._deps++;const m=a.server!==!1&&n.payload.serverRendered;{let f=function(h){const M=n._asyncData[h];M?._deps&&(M._deps--,M._deps===0&&M?._off())};const v=De();if(v&&m&&a.immediate&&!v.sp&&(v.sp=[]),v&&!v._nuxtOnBeforeMountCbs){v._nuxtOnBeforeMountCbs=[];const h=v._nuxtOnBeforeMountCbs;we(()=>{h.forEach(M=>{M()}),h.splice(0,h.length)}),K(()=>h.splice(0,h.length))}const C=v&&(v._nuxtClientOnly||Ce(Me,!1));m&&n.isHydrating&&(l.error.value||l.data.value!==void 0)?l.status.value=l.error.value?"error":"success":v&&(!C&&n.payload.serverRendered&&n.isHydrating||a.lazy)&&a.immediate?v._nuxtOnBeforeMountCbs.push(S):a.immediate&&l.status.value!=="success"&&S();const E=ge(),O=W(r,(h,M)=>{if((h||M)&&h!==M){u=!0;const q=n._asyncData[M]?.data.value!==void 0,i=n._asyncDataPromises[M]!==void 0,_={cause:"initial",dedupe:a.dedupe};if(!n._asyncData[h]?._init){let $;M&&q?$=n._asyncData[M].data.value:($=a.getCachedData(h,n,{cause:"initial"}),_.cachedData=$),n._asyncData[h]=ne(n,h,o,a,$)}n._asyncData[h]._deps++,M&&f(M),(a.immediate||q||i)&&n._asyncData[h].execute(_),Se(()=>{u=!1})}},{flush:"sync"}),k=a.watch?W(a.watch,()=>{u||l._execute({cause:"watch",dedupe:a.dedupe})}):()=>{};E&&ve(()=>{O(),k(),f(r.value)})}const T={data:U(()=>n._asyncData[r.value]?.data),pending:U(()=>n._asyncData[r.value]?.pending),status:U(()=>n._asyncData[r.value]?.status),error:U(()=>n._asyncData[r.value]?.error),refresh:(...f)=>n._asyncData[r.value]?._init?n._asyncData[r.value].execute(...f):x()(),execute:(...f)=>T.refresh(...f),clear:()=>{const f=n._asyncData[r.value];if(f?._abortController)try{f._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{f._abortController=void 0}de(n,r.value)}},w=Promise.resolve(n._asyncDataPromises[r.value]).then(()=>T);return Object.assign(w,T),w}function U(e){return B({get(){return e()?.value},set(t){const s=e();s&&(s.value=t)}})}function je(...e){const t=typeof e[e.length-1]=="string"?e.pop():void 0;ue(e[0],e[1])&&e.unshift(t);const[s,o,a={}]=e;return le(s,o,{...a,lazy:!0},null)}function ue(e,t){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof t=="function")}function de(e,t){t in e.payload.data&&(e.payload.data[t]=void 0),t in e.payload._errors&&(e.payload._errors[t]=void 0),e._asyncData[t]&&(e._asyncData[t].data.value=p(e._asyncData[t]._default()),e._asyncData[t].error.value=void 0,e._asyncData[t].status.value="idle"),t in e._asyncDataPromises&&(e._asyncDataPromises[t]=void 0)}function Ae(e,t){const s={};for(const o of t)s[o]=e[o];return s}function ne(e,t,s,o,a){e.payload._errors[t]??=void 0;const u=o.getCachedData!==fe,r=s,n=o.deep?L:ae,x=a!==void 0,S=e.hook("app:data:refresh",async m=>{(!m||m.includes(t))&&await l.execute({cause:"refresh:hook"})}),l={data:n(x?a:o.default()),pending:B(()=>l.status.value==="pending"),error:ye(e.payload._errors,t),status:ae("idle"),execute:(...m)=>{const[T,w=void 0]=m,f=T&&w===void 0&&typeof T=="object"?T:{};if(e._asyncDataPromises[t]&&(f.dedupe??o.dedupe)==="defer")return e._asyncDataPromises[t];{const C="cachedData"in f?f.cachedData:o.getCachedData(t,e,{cause:f.cause??"refresh:manual"});if(C!==void 0)return e.payload.data[t]=l.data.value=C,l.error.value=void 0,l.status.value="success",Promise.resolve(C)}l._abortController&&l._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),l._abortController=new AbortController,l.status.value="pending";const v=new Promise((C,E)=>{try{const O=f.timeout??o.timeout,k=ze([l._abortController?.signal,f?.signal],O);if(k.aborted){const h=k.reason;E(h instanceof Error?h:new DOMException(String(h??"Aborted"),"AbortError"));return}return k.addEventListener("abort",()=>{const h=k.reason;E(h instanceof Error?h:new DOMException(String(h??"Aborted"),"AbortError"))},{once:!0}),Promise.resolve(r(e,{signal:k})).then(C,E)}catch(O){E(O)}}).then(async C=>{let E=C;o.transform&&(E=await o.transform(C)),o.pick&&(E=Ae(E,o.pick)),e.payload.data[t]=E,l.data.value=E,l.error.value=void 0,l.status.value="success"}).catch(C=>{if(!(e._asyncDataPromises[t]&&e._asyncDataPromises[t]!==v)&&!l._abortController?.signal.aborted){if(typeof DOMException<"u"&&C instanceof DOMException&&C.name==="AbortError"){l.status.value="idle";return}l.error.value=be(C),l.data.value=p(o.default()),l.status.value="error"}}).finally(()=>{delete e._asyncDataPromises[t]});return e._asyncDataPromises[t]=v,e._asyncDataPromises[t]},_execute:Ne((...m)=>l.execute(...m),0,{leading:!0}),_default:o.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{S(),e._asyncData[t]?._init&&(e._asyncData[t]._init=!1),u||oe(()=>{e._asyncData[t]?._init||(de(e,t),l.execute=()=>Promise.resolve())})}};return l}const He=()=>{},fe=(e,t,s)=>{if(t.isHydrating)return t.payload.data[e];if(s.cause!=="refresh:manual"&&s.cause!=="refresh:hook")return t.static.data[e]};function ze(e,t){const s=e.filter(u=>!!u);if(typeof t=="number"&&t>=0){const u=AbortSignal.timeout?.(t);u&&s.push(u)}if(AbortSignal.any)return AbortSignal.any(s);const o=new AbortController;for(const u of s)if(u.aborted){const r=u.reason??new DOMException("Aborted","AbortError");try{o.abort(r)}catch{o.abort()}return o.signal}const a=()=>{const r=s.find(n=>n.aborted)?.reason??new DOMException("Aborted","AbortError");try{o.abort(r)}catch{o.abort()}};for(const u of s)u.addEventListener?.("abort",a,{once:!0});return o.signal}function qe(){return globalThis.$fetch}const Ue={nuxt:{}},We=Ee($e,Ue);function _e(){const e=se();return e._appConfig||=xe(We),e._appConfig}const Ye={class:"pc-nav"},Ge={class:"container"},Je=j({__name:"HeaderNav",props:{navItems:{}},emits:["toggle"],setup(e,{emit:t}){const s=t,o=a=>{s("toggle",a)};return(a,u)=>{const r=Q;return g(),b("nav",null,[d("div",Ye,[(g(!0),b(z,null,Y(e.navItems,n=>(g(),ee(r,{key:n.link,to:n.link},{default:G(()=>[te(P(n.text),1)]),_:2},1032,["to"]))),128))]),d("div",{class:"mobile-nav",onClick:o},[d("div",Ge,[(g(),b(z,null,Y(3,n=>d("div",{class:"mobile-nav-item",key:n})),64))])])])}}}),Xe=Object.assign(A(Je,[["__scopeId","data-v-f0d77200"]]),{__name:"HeaderNav"}),Ze={class:"mask"},Qe={class:"title-container"},Ke={class:"title"},et={key:0},tt=j({__name:"Banner",props:{bannerImg:{},title:{},slogan:{}},setup(e){const t=e,s=B(()=>({background:`url(${t.bannerImg}) center center / cover no-repeat`}));return(o,a)=>(g(),b("div",{class:"banner",style:Te(p(s))},[d("div",Ze,[d("div",Qe,[d("div",Ke,[d("h1",null,P(e.title),1),e.slogan?(g(),b("p",et,P(e.slogan),1)):F("",!0)])])])],4))}}),at=Object.assign(A(tt,[["__scopeId","data-v-3b68dcd7"]]),{__name:"Banner"}),nt={class:"search-overlay__panel"},st={class:"search-overlay__header"},ot={key:0,class:"search-overlay__state"},rt={key:1,class:"search-overlay__body"},it={key:0,class:"search-overlay__state"},ct={key:1,class:"search-overlay__state"},lt={key:2,class:"search-overlay__count"},ut={key:3,class:"search-overlay__list"},dt={class:"search-overlay__item-title"},ft={class:"search-overlay__item-meta"},_t={key:0},ht={class:"search-overlay__item-snippet"},mt=50,vt=j({__name:"SearchOverlay",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,o=t,a=L(""),u=L(null),r=qe(),n=L(!1),x=async()=>{const i=await r("/search/sections.json");if(Array.isArray(i))return i;if(typeof i=="string")try{return JSON.parse(i)}catch(_){console.warn("[search] Failed to parse sections payload",_)}return[]},{data:S,pending:l,refresh:m}=je("posts-search-sections",x,{server:!1,immediate:!1,default:()=>[]}),T=B(()=>S.value??[]),w=B(()=>{const i=a.value.trim().toLowerCase();if(!i)return[];const _=Array.from(new Set(i.split(/\s+/).filter(Boolean)));if(!_.length)return[];const $=T.value.map(c=>{const y=(c.content??"").replace(/\s+/g," ").trim();if(!y)return null;const V=C(c),H=E(c),X=`${V} ${H} ${y}`.toLowerCase();if(!_.every(I=>X.includes(I)))return null;let N=0;return _.forEach(I=>{V.toLowerCase().includes(I)?N+=4:H.toLowerCase().includes(I)?N+=3:N+=1}),{id:c.id,baseId:O(c.id),documentTitle:V,sectionTitle:H,snippet:M(y,_),score:N}}).filter(c=>!!c).sort((c,y)=>y.score-c.score);if(!$.length)return[];const D=new Map;return $.forEach(c=>{const y=D.get(c.baseId);if(!y){D.set(c.baseId,{id:c.id,baseId:c.baseId,documentTitle:c.documentTitle,sectionTitles:c.sectionTitle?[c.sectionTitle]:[],snippets:[c.snippet],score:c.score,matchCount:1,bestScore:c.score});return}y.matchCount+=1,y.score+=c.score,y.snippets.push(c.snippet),c.sectionTitle&&!y.sectionTitles.includes(c.sectionTitle)&&y.sectionTitles.length<3&&y.sectionTitles.push(c.sectionTitle),c.score>y.bestScore&&(y.bestScore=c.score,y.id=c.id)}),Array.from(D.values()).map(c=>({id:c.id,documentTitle:c.documentTitle,sectionLabel:h(c.sectionTitles,c.matchCount),snippet:k(c.snippets),score:c.score,matchCount:c.matchCount})).sort((c,y)=>y.score-c.score).slice(0,mt)}),f=i=>{s.modelValue&&i.key==="Escape"&&(i.preventDefault(),v())};W(()=>s.modelValue,i=>{i?(n.value||(n.value=!0,m()),document.body.style.setProperty("overflow","hidden"),oe(()=>{a.value="",u.value?.focus()})):document.body.style.removeProperty("overflow")}),J(()=>{window.addEventListener("keydown",f)}),re(()=>{window.removeEventListener("keydown",f),document.body.style.removeProperty("overflow")});function v(){o("update:modelValue",!1)}function C(i){return i.titles?.[0]??i.title??"未命名文章"}function E(i){return i.titles?.length?i.titles.slice(1).filter(Boolean).at(-1)??i.title??"":i.title??""}function O(i){const _=i.indexOf("#");return _===-1?i:i.slice(0,_)}function k(i){const _=[];if(i.forEach(D=>{const c=D.trim();c&&(_.includes(c)||_.push(c))}),!_.length)return"";const $=_.slice(0,2).join(" … ");return $.length>240?`${$.slice(0,240)}…`:$}function h(i,_){return _?_===1?i[0]??"":i.length?`涉及段落：${i.join("、")}${_>i.length?"…":""}`:"":""}function M(i,_){if(!i)return"";const $=i.toLowerCase(),D=_.map(I=>$.indexOf(I)).filter(I=>I>=0).sort((I,he)=>I-he)[0];if(D===void 0)return q(i);const c=60,y=Math.max(0,D-c),V=Math.min(i.length,D+c),H=i.slice(y,V),X=y>0?"…":"",N=V<i.length?"…":"";return`${X}${H}${N}`}function q(i){return i.length>140?`${i.slice(0,140)}…`:i}return(i,_)=>{const $=Q;return g(),ee(Le,{to:"body"},[R(ke,{name:"search-overlay"},{default:G(()=>[e.modelValue?(g(),b("div",{key:0,class:"search-overlay",role:"dialog","aria-modal":"true",onMousedown:Oe(v,["self"])},[d("div",nt,[d("div",st,[Ie(d("input",{ref_key:"inputRef",ref:u,type:"search","onUpdate:modelValue":_[0]||(_[0]=D=>ie(a)?a.value=D:null),class:"search-overlay__input",placeholder:"搜索文章，支持多个关键词"},null,512),[[Pe,p(a)]]),d("button",{class:"search-overlay__close",type:"button",onClick:v,"aria-label":"关闭搜索"}," × ")]),p(l)?(g(),b("div",ot,"正在准备索引…")):(g(),b("div",rt,[p(a).trim()?p(w).length?(g(),b("div",lt," 共找到 "+P(p(w).length)+" 条结果 ",1)):(g(),b("p",ct," 没有找到匹配内容，换个关键词试试？ ")):(g(),b("p",it," 输入关键词开始搜索。 ")),p(w).length?(g(),b("ul",ut,[(g(!0),b(z,null,Y(p(w),D=>(g(),b("li",{key:D.id,class:"search-overlay__item"},[R($,{to:D.id,class:"search-overlay__link",onClick:v},{default:G(()=>[d("h3",dt,P(D.documentTitle),1),d("p",ft,[te(" 共 "+P(D.matchCount)+" 处匹配 ",1),D.sectionLabel?(g(),b("span",_t," · "+P(D.sectionLabel),1)):F("",!0)]),d("p",ht,P(D.snippet),1)]),_:2},1032,["to"])]))),128))])):F("",!0)]))])],32)):F("",!0)]),_:1})])}}}),pt=Object.assign(A(vt,[["__scopeId","data-v-62b29045"]]),{__name:"SearchOverlay"});function gt(){const e=L(!1);let t=!1;const s=()=>{t||(window.requestAnimationFrame(()=>{e.value=window.scrollY>0,t=!1}),t=!0)};return J(()=>{s(),window.addEventListener("scroll",s)}),K(()=>{window.removeEventListener("scroll",s)}),{isScrolled:e}}function yt(){const e=L(!1),t=o=>{o.stopPropagation(),e.value=!e.value},s=()=>{e.value=!1};return J(()=>{document.addEventListener("click",s)}),K(()=>{document.removeEventListener("click",s)}),{showMobileMenu:e,toggleMobileMenu:t,closeMobileMenu:s}}const bt={class:"header-container"},Dt={class:"header"},wt={href:"/",class:"header-title"},Ct={class:"header-right"},Mt={key:0,class:"mobile-menu-dropdown"},St=j({__name:"Header",props:{bannerImg:{},title:{default:""}},setup(e){const t=_e(),s=ce(),o=B(()=>s.path==="/"||s.path.startsWith("/page/")?t.slogan:null),a=e,u=B(()=>a.title||t.title),{isScrolled:r}=gt(),{showMobileMenu:n,toggleMobileMenu:x,closeMobileMenu:S}=yt(),l=L(!1),m=()=>{S(),l.value=!0};return W(()=>s.fullPath,()=>{l.value=!1}),(T,w)=>{const f=Xe,v=Q,C=at,E=pt;return g(),b(z,null,[d("header",{class:Be({scrolled:p(r),"show-mobile-menu":p(n)})},[d("div",bt,[d("div",Dt,[d("a",wt,P(p(t).title),1),d("div",Ct,[R(f,{"nav-items":p(t).nav.items,onToggle:p(x)},null,8,["nav-items","onToggle"]),d("button",{type:"button",class:"search-trigger",onClick:m,"aria-label":"搜索文章"},[...w[1]||(w[1]=[d("span",{"aria-hidden":"true"},"🔍",-1),d("span",{class:"search-trigger__label"},"搜索",-1)])])])])]),p(n)?(g(),b("div",Mt,[(g(!0),b(z,null,Y(p(t).nav.items,O=>(g(),ee(v,{key:O.link,to:O.link,onClick:p(S)},{default:G(()=>[te(P(O.text),1)]),_:2},1032,["to","onClick"]))),128))])):F("",!0)],2),R(C,{"banner-img":e.bannerImg,title:p(u),slogan:p(o)},null,8,["banner-img","title","slogan"]),R(E,{modelValue:p(l),"onUpdate:modelValue":w[0]||(w[0]=O=>ie(l)?l.value=O:null)},null,8,["modelValue"])],64)}}}),Et=Object.assign(A(St,[["__scopeId","data-v-995e7b74"]]),{__name:"Header"}),$t=e=>{const t=L(null),s=L(!1);return J(()=>{if(!t.value)return;const o=new IntersectionObserver(a=>{a.forEach(u=>{u.isIntersecting&&!s.value&&(s.value=!0,o.disconnect())})},{rootMargin:e?.rootMargin,threshold:e?.threshold});o.observe(t.value),re(()=>{o.disconnect()})}),{targetRef:t,isVisible:s}},xt={class:"footer-content"},Tt={key:0,frameborder:"0",src:"https://support.nodeget.com/page/promotion?id=61",style:{"border-radius":"8px",height:"246px",transform:"scale(0.8)","transform-origin":"top center"}},Ot=j({__name:"Footer",props:{bannerImg:{}},setup(e){const s={background:`url(${e.bannerImg}) center bottom / cover no-repeat`,minHeight:"120px",color:"white"},{targetRef:o,isVisible:a}=$t({rootMargin:"100px",threshold:.1});return(u,r)=>(g(),b("footer",{ref_key:"footerRef",ref:o,style:s},[r[1]||(r[1]=d("div",{class:"footer-mask"},null,-1)),d("div",xt,[r[0]||(r[0]=d("div",null,"©2020 - 2025 By zhullyb",-1)),p(a)?(g(),b("iframe",Tt)):F("",!0)])],512))}}),It=Object.assign(A(Ot,[["__scopeId","data-v-75e9447f"]]),{__name:"Footer"}),Pt={class:"content-wrapper"},kt={class:"before-main side"},Lt={class:"after-main side"},Bt=j({__name:"DefaultLayout",props:{title:{default:""}},setup(e){const t=ce(),s=e,o=_e(),{data:a}=le("randomIndex"+t.path,async()=>Math.floor(Math.random()*o.imgs.length),"$RRY2fi8_v6"),u=B(()=>o.imgs[a.value??0]);return Re({title:s.title||o.title,link:[{rel:"preload",as:"image",href:u.value,fetchpriority:"high"}]}),(r,n)=>{const x=Et,S=It;return g(),b("div",null,[R(x,{"banner-img":p(u),title:e.title},null,8,["banner-img","title"]),d("div",Pt,[d("div",kt,[Z(r.$slots,"BeforeMain",{},void 0,!0)]),d("main",null,[Z(r.$slots,"default",{},void 0,!0)]),d("div",Lt,[Z(r.$slots,"AfterMain",{},void 0,!0)])]),R(S,{"banner-img":p(u)},null,8,["banner-img"])])}}}),Nt=Object.assign(A(Bt,[["__scopeId","data-v-03b6b78b"]]),{__name:"DefaultLayout"});export{Nt as _,le as u};
