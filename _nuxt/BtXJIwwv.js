import{u as A,q as P,a as M}from"./dO_NVEVu.js";import{_ as S}from"./CKfdtC_V.js";import{_ as V}from"./B24ffKhg.js";import{d as b,J as q,K as z,V as D,q as k,L as w,M as F,H as O,C as l,o as r,a as d,N,O as T,G as $,w as h,F as i,I as u,c as R,E as p,_ as G}from"./B88BixJ4.js";function _(t){return t?typeof t=="string"?t:Array.isArray(t)?t.length>=2&&typeof t[0]=="string"&&typeof t[1]=="object"?t.slice(2).map(_).join(""):t.map(_).join(""):t.value&&typeof t.value=="string"?t.value:t.children&&Array.isArray(t.children)?t.children.map(_).join(""):"":""}function J(t,e=300){if(!t)return"";const s=_(t.value||t).replace(/\s+/g," ").trim();return s.length<=e?s:s.slice(0,e)+"..."}const K={class:"post-meta"},U={class:"date"},x=10,Q=b({__name:"HomeArticleContainer",async setup(t){let e,n;const s=q(),{locale:m}=z(),L=D(),o=s.params.page&&parseInt(s.params.page)||1,v=k(()=>m.value==="zh"?"zh-CN":"en"),c=([e,n]=w(()=>A(`index-page-${o}-${m.value}`,()=>P("posts").where("lang","=",v.value).order("date","DESC").skip((o-1)*x).limit(x).select("title","date","path","tags","body").all())),e=await e,n(),e).data,j=k(()=>c.value?c.value.map(f=>({...f,excerpt:J(f.body,300)})):[]),E=([e,n]=w(()=>A(`posts-total-${m.value}`,()=>P("posts").where("lang","=",v.value).count())),e=await e,n(),e).data,I=Math.max(1,Math.ceil((E.value??0)/x));if(c.value&&c.value.length===0&&o>1)throw F({statusCode:404,statusMessage:"Page not found",fatal:!0});return O({title:"竹林里有冰的博客",titleTemplate:"%s"}),(f,y)=>{const C=M,B=S,H=V;return r(),l("div",null,[(r(!0),l(N,null,T(p(j),(a,W)=>(r(),l("div",{key:a.path,class:"post-item"},[d(C,{class:"title",to:a.path},{default:h(()=>[i(u(a.title),1)]),_:2},1032,["to"]),d(C,{class:"description",to:a.path},{default:h(()=>[i(u(a.excerpt),1)]),_:2},1032,["to"]),$("div",K,[$("span",U,u(a.date?.split(" ")[0]),1),(r(!0),l(N,null,T(a.tags,g=>(r(),R(B,{class:"tags",key:g,to:`${p(L)("/tags")}/${encodeURIComponent(g)}`,prefetchOn:"interaction"},{default:h(()=>[i(u("#"+g),1)]),_:2},1032,["to"]))),128)),y[0]||(y[0]=i(" > ",-1))])]))),128)),d(H,{currentPage:p(o),totalPages:p(I)},null,8,["currentPage","totalPages"])])}}}),et=Object.assign(G(Q,[["__scopeId","data-v-fae606b2"]]),{__name:"HomeArticleContainer"});export{et as _};
