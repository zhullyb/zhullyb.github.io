[{"data":1,"prerenderedAt":433},["ShallowReactive",2],{"post-2021-05-30-share-xiaomi-bluetooth-mouse-on-both-windows-and-linux":3,"surround-2021-05-30-share-xiaomi-bluetooth-mouse-on-both-windows-and-linux":421,"randomIndex/2021/05/30/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux/":432},{"id":4,"title":5,"body":6,"date":407,"description":69,"extension":408,"meta":409,"navigation":410,"path":411,"rawbody":412,"seo":413,"stem":414,"sticky":415,"tags":416,"__hash__":420},"posts/posts/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux.md","在Windows与Linux双系统下共享蓝牙鼠标",{"type":7,"value":8,"toc":405},"minimark",[9,30,33,47,53,60,63,79,85,88,94,99,102,240,246,249,257,306,309,394,401],[10,11,12,24,27],"blockquote",{},[13,14,15,16,23],"p",{},"我自己使用的鼠标是一只",[17,18,22],"a",{"href":19,"rel":20},"https://www.mi.com/mouse",[21],"nofollow","小米的无线蓝牙双模鼠标","。但是由于我的USB接口不是很充裕，我平时还是蓝牙鼠标用的比较多。",[13,25,26],{},"但是，每当我在Windows和Archlinux上切换时，我不得不重新配对我的蓝牙鼠标。原因我在翻译Archwiki上关于蓝牙鼠标相关叙述时已经解释得非常清楚了，我摘在下面：",[13,28,29],{},"“首先，计算机保存蓝牙设备的 MAC 地址和配对密钥；然后，蓝牙设备保存计算机的 MAC 地址和配对密钥。这两步通常不会有问题，不过设备蓝牙端口的 MAC 地址在 Linux 和 Windows 上都是相同的 (这在硬件层面上就设定好了)。然而，当在 Windows 或 Linux  中重新配对设备时，它会生成一个新密钥，覆盖了蓝牙设备之前保存的密钥，即与 Windows 配对产生的密钥会覆盖原先与 Linux  配对的密钥，反之亦然。“",[13,31,32],{},"先在Linux上连接蓝牙鼠标，再重启到Windows重新配对蓝牙蓝牙鼠标。",[13,34,35,36,41,42,46],{},"到",[17,37,40],{"href":38,"rel":39},"https://docs.microsoft.com/en-us/sysinternals/downloads/psexec",[21],"微软官网","下载",[43,44,45],"code",{},"PsExec.zip","，解压后，记住你所解压的路径。",[13,48,49,50],{},"在Windows中，使用管理员权限打开",[43,51,52],{},"cmd.exe",[13,54,55],{},[56,57],"img",{"alt":58,"src":59},"在Windows下使用管理员权限打开cmd","https://static.031130.xyz/uploads/2024/08/12/62f3cb081565a.webp",[13,61,62],{},"cd到PsExec解压目录，使用如下命令将我们所需要的蓝牙密钥信息保存到C盘根目录下。",[64,65,70],"pre",{"className":66,"code":67,"language":68,"meta":69,"style":69},"language-cmd shiki shiki-themes github-light github-dark","psexec.exe -s -i regedit /e C:\\BTKeys.reg HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\BTHPORT\\Parameters\\Keys\n","cmd","",[43,71,72],{"__ignoreMap":69},[73,74,77],"span",{"class":75,"line":76},"line",1,[73,78,67],{},[13,80,81],{},[56,82],{"alt":83,"src":84},"使用psexec获取蓝牙信息","https://static.031130.xyz/uploads/2024/08/12/62f3cb0aae88f.webp",[13,86,87],{},"根目录的BTkeys.reg可以直接用记事本打开，内容大概是下面这个样子",[13,89,90],{},[56,91],{"alt":92,"src":93},"BTkeys.reg","https://static.031130.xyz/uploads/2024/08/12/62f3cb0d9e04f.webp",[10,95,96],{},[13,97,98],{},"为了方便后面的解说，我用各种颜色标注了起来。",[13,100,101],{},"在Linux下获取su权限以后，我们需要将Linux下随机分配给鼠标的蓝牙地址改成在Windows上获取的那个地址。上图中「红部分」划出来的就是Windows下获取的地址。",[64,103,107],{"className":104,"code":105,"language":106,"meta":69,"style":69},"language-bash shiki shiki-themes github-light github-dark","[zhullyb@Archlinux ~]$ su\nPassword: \n[root@Archlinux zhullyb]# cd /var/lib/bluetooth/E0\\:94\\:67\\:74\\:0D\\:5F/\n[root@Archlinux E0:94:67:74:0D:5F]# ls\nC6:2A:1B:33:2E:71  cache  settings\n[root@Archlinux E0:94:67:74:0D:5F]# mv C6\\:2A\\:1B\\:33\\:2E\\:71/ C4\\:F6\\:B3\\:2C\\:BD\\:7E\n","bash",[43,108,109,122,132,165,171,184],{"__ignoreMap":69},[73,110,111,115,119],{"class":75,"line":76},[73,112,114],{"class":113},"sVt8B","[zhullyb@Archlinux ",[73,116,118],{"class":117},"szBVR","~",[73,120,121],{"class":113},"]$ su\n",[73,123,125,129],{"class":75,"line":124},2,[73,126,128],{"class":127},"sScJk","Password:",[73,130,131],{"class":113}," \n",[73,133,135,138,142,145,147,150,152,155,157,160,162],{"class":75,"line":134},3,[73,136,137],{"class":113},"[root@Archlinux zhullyb]# cd /var/lib/bluetooth/E0",[73,139,141],{"class":140},"sj4cs","\\:",[73,143,144],{"class":113},"94",[73,146,141],{"class":140},[73,148,149],{"class":113},"67",[73,151,141],{"class":140},[73,153,154],{"class":113},"74",[73,156,141],{"class":140},[73,158,159],{"class":113},"0D",[73,161,141],{"class":140},[73,163,164],{"class":113},"5F/\n",[73,166,168],{"class":75,"line":167},4,[73,169,170],{"class":113},"[root@Archlinux E0:94:67:74:0D:5F]# ls\n",[73,172,174,177,181],{"class":75,"line":173},5,[73,175,176],{"class":127},"C6:2A:1B:33:2E:71",[73,178,180],{"class":179},"sZZnC","  cache",[73,182,183],{"class":179},"  settings\n",[73,185,187,190,192,195,197,200,202,205,207,210,212,215,217,220,222,225,227,230,232,235,237],{"class":75,"line":186},6,[73,188,189],{"class":113},"[root@Archlinux E0:94:67:74:0D:5F]# mv C6",[73,191,141],{"class":140},[73,193,194],{"class":113},"2A",[73,196,141],{"class":140},[73,198,199],{"class":113},"1B",[73,201,141],{"class":140},[73,203,204],{"class":113},"33",[73,206,141],{"class":140},[73,208,209],{"class":113},"2E",[73,211,141],{"class":140},[73,213,214],{"class":113},"71/ C4",[73,216,141],{"class":140},[73,218,219],{"class":113},"F6",[73,221,141],{"class":140},[73,223,224],{"class":113},"B3",[73,226,141],{"class":140},[73,228,229],{"class":113},"2C",[73,231,141],{"class":140},[73,233,234],{"class":113},"BD",[73,236,141],{"class":140},[73,238,239],{"class":113},"7E\n",[13,241,242,243],{},"再编辑",[43,244,245],{},"/var/lib/bluetooth/\u003C本机蓝牙地址>/\u003C鼠标蓝牙地址>/info",[13,247,248],{},"原文件如下：",[64,250,255],{"className":251,"code":253,"language":254},[252],"language-text","[General]\nName=MiMouse\nAppearance=0x03c2\nAddressType=static\nSupportedTechnologies=LE;\nTrusted=true\nBlocked=false\nWakeAllowed=true\nServices=00001530-1212-efde-1523-785feabcd123;00001800-0000-1000-8000-00805f9b34fb;00001801-0000-1000-8000-00805f9b34fb;0000180a-0000-1000-8000-00805f9b34fb;0000180f-0000-1000-8000-00805f9b34fb;00001812-0000-1000-8000-00805f9b34fb;\n\n[IdentityResolvingKey]\nKey=067764BF59A7531E978AFDC6BB5EC8E1\n\n[LongTermKey]\nKey=E3C49B4F3256018192942EB0CDDEE6A3\nAuthenticated=0\nEncSize=16\nEDiv=28209\nRand=15970850852728832717\n\n[DeviceID]\nSource=2\nVendor=10007\nProduct=64\nVersion=40\n\n[ConnectionParameters]\nMinInterval=6\nMaxInterval=9\nLatency=100\nTimeout=600\n","text",[43,256,253],{"__ignoreMap":69},[258,259,260,276,296],"ul",{},[261,262,263,264,267,268,271,272,275],"li",{},"「黄色部分」",[43,265,266],{},"LTK"," 对应 ",[43,269,270],{},"LongTermKey"," 下的 ",[43,273,274],{},"Key","，把小写转换成大写并删去逗号即可。",[261,277,278,279,267,282,285,286,289,290,289,293],{},"「绿色部分」",[43,280,281],{},"ERand",[43,283,284],{},"Rand","。这里比较特殊的是，我们必须先将 Windows 中的值倒转过来再转换为 10 进制。即",[43,287,288],{},"c2,83,7f,8f,7c,76,b4,02","->",[43,291,292],{},"02,b4,76,7c,8f,7f,83,c2",[43,294,295],{},"194910961239294914",[261,297,298,299,267,302,305],{},"「蓝色部分」",[43,300,301],{},"EDIV",[43,303,304],{},"EDiv","。把 16 进制转换成 10 进制即可，这里就不用倒转了。",[13,307,308],{},"具体的转换方法我不再赘述，我把我的转换过程放在下面，我相信各位读者能够看懂。",[64,310,312],{"className":104,"code":311,"language":106,"meta":69,"style":69},"[zhullyb@Archlinux ~]$ echo 'e3,c0,b2,8e,64,2b,12,16,d8,c2,d7,d4,59,55,92,cd' | tr a-z A-Z | sed 's/[[:punct:]]//g'\nE3C0B28E642B1216D8C2D7D4595592CD\n[zhullyb@Archlinux ~]$ echo $((16#02B4767C8F7F83C2))    #这里我是手动倒叙的\n194910961239294914\n[zhullyb@Archlinux ~]$ echo $((16#000055a3))\n21923\n",[43,313,314,346,351,370,375,389],{"__ignoreMap":69},[73,315,316,318,320,323,326,329,332,335,338,340,343],{"class":75,"line":76},[73,317,114],{"class":113},[73,319,118],{"class":117},[73,321,322],{"class":113},"]$ echo ",[73,324,325],{"class":179},"'e3,c0,b2,8e,64,2b,12,16,d8,c2,d7,d4,59,55,92,cd'",[73,327,328],{"class":117}," |",[73,330,331],{"class":127}," tr",[73,333,334],{"class":179}," a-z",[73,336,337],{"class":179}," A-Z",[73,339,328],{"class":117},[73,341,342],{"class":127}," sed",[73,344,345],{"class":179}," 's/[[:punct:]]//g'\n",[73,347,348],{"class":75,"line":124},[73,349,350],{"class":127},"E3C0B28E642B1216D8C2D7D4595592CD\n",[73,352,353,355,357,360,363,366],{"class":75,"line":134},[73,354,114],{"class":113},[73,356,118],{"class":117},[73,358,359],{"class":113},"]$ echo $((",[73,361,362],{"class":127},"16#02B4767C8F7F83C2",[73,364,365],{"class":113},"))    ",[73,367,369],{"class":368},"sJ8bj","#这里我是手动倒叙的\n",[73,371,372],{"class":75,"line":167},[73,373,374],{"class":127},"194910961239294914\n",[73,376,377,379,381,383,386],{"class":75,"line":173},[73,378,114],{"class":113},[73,380,118],{"class":117},[73,382,359],{"class":113},[73,384,385],{"class":127},"16#000055a3",[73,387,388],{"class":113},"))\n",[73,390,391],{"class":75,"line":186},[73,392,393],{"class":127},"21923\n",[13,395,396,397,400],{},"做完这些操作以后，",[43,398,399],{},"sudo systemctl start bluetooth","即可",[402,403,404],"style",{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}",{"title":69,"searchDepth":124,"depth":124,"links":406},[],"2021-05-30","md",{},true,"/2021/05/30/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux","---\ntitle: 在Windows与Linux双系统下共享蓝牙鼠标\ndate: 2021-05-30\ntags: \n      - Linux\n      - Archlinux\n      - Windows\n---\n\n> 我自己使用的鼠标是一只[小米的无线蓝牙双模鼠标](https://www.mi.com/mouse)。但是由于我的USB接口不是很充裕，我平时还是蓝牙鼠标用的比较多。\n>\n> 但是，每当我在Windows和Archlinux上切换时，我不得不重新配对我的蓝牙鼠标。原因我在翻译Archwiki上关于蓝牙鼠标相关叙述时已经解释得非常清楚了，我摘在下面：\n>\n> “首先，计算机保存蓝牙设备的 MAC 地址和配对密钥；然后，蓝牙设备保存计算机的 MAC 地址和配对密钥。这两步通常不会有问题，不过设备蓝牙端口的 MAC 地址在 Linux 和 Windows 上都是相同的 (这在硬件层面上就设定好了)。然而，当在 Windows 或 Linux  中重新配对设备时，它会生成一个新密钥，覆盖了蓝牙设备之前保存的密钥，即与 Windows 配对产生的密钥会覆盖原先与 Linux  配对的密钥，反之亦然。“\n\n先在Linux上连接蓝牙鼠标，再重启到Windows重新配对蓝牙蓝牙鼠标。\n\n到[微软官网](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec)下载`PsExec.zip`，解压后，记住你所解压的路径。\n\n在Windows中，使用管理员权限打开`cmd.exe`\n\n![在Windows下使用管理员权限打开cmd](https://static.031130.xyz/uploads/2024/08/12/62f3cb081565a.webp)\n\ncd到PsExec解压目录，使用如下命令将我们所需要的蓝牙密钥信息保存到C盘根目录下。\n\n```cmd\npsexec.exe -s -i regedit /e C:\\BTKeys.reg HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\BTHPORT\\Parameters\\Keys\n```\n\n![使用psexec获取蓝牙信息](https://static.031130.xyz/uploads/2024/08/12/62f3cb0aae88f.webp)\n\n根目录的BTkeys.reg可以直接用记事本打开，内容大概是下面这个样子\n\n![BTkeys.reg](https://static.031130.xyz/uploads/2024/08/12/62f3cb0d9e04f.webp)\n\n> 为了方便后面的解说，我用各种颜色标注了起来。\n\n在Linux下获取su权限以后，我们需要将Linux下随机分配给鼠标的蓝牙地址改成在Windows上获取的那个地址。上图中「红部分」划出来的就是Windows下获取的地址。\n\n```bash\n[zhullyb@Archlinux ~]$ su\nPassword: \n[root@Archlinux zhullyb]# cd /var/lib/bluetooth/E0\\:94\\:67\\:74\\:0D\\:5F/\n[root@Archlinux E0:94:67:74:0D:5F]# ls\nC6:2A:1B:33:2E:71  cache  settings\n[root@Archlinux E0:94:67:74:0D:5F]# mv C6\\:2A\\:1B\\:33\\:2E\\:71/ C4\\:F6\\:B3\\:2C\\:BD\\:7E\n```\n\n再编辑`/var/lib/bluetooth/\u003C本机蓝牙地址>/\u003C鼠标蓝牙地址>/info`\n\n原文件如下：\n\n```\n[General]\nName=MiMouse\nAppearance=0x03c2\nAddressType=static\nSupportedTechnologies=LE;\nTrusted=true\nBlocked=false\nWakeAllowed=true\nServices=00001530-1212-efde-1523-785feabcd123;00001800-0000-1000-8000-00805f9b34fb;00001801-0000-1000-8000-00805f9b34fb;0000180a-0000-1000-8000-00805f9b34fb;0000180f-0000-1000-8000-00805f9b34fb;00001812-0000-1000-8000-00805f9b34fb;\n\n[IdentityResolvingKey]\nKey=067764BF59A7531E978AFDC6BB5EC8E1\n\n[LongTermKey]\nKey=E3C49B4F3256018192942EB0CDDEE6A3\nAuthenticated=0\nEncSize=16\nEDiv=28209\nRand=15970850852728832717\n\n[DeviceID]\nSource=2\nVendor=10007\nProduct=64\nVersion=40\n\n[ConnectionParameters]\nMinInterval=6\nMaxInterval=9\nLatency=100\nTimeout=600\n```\n\n- 「黄色部分」`LTK` 对应 `LongTermKey` 下的 `Key`，把小写转换成大写并删去逗号即可。\n- 「绿色部分」`ERand` 对应 `Rand`。这里比较特殊的是，我们必须先将 Windows 中的值倒转过来再转换为 10 进制。即`c2,83,7f,8f,7c,76,b4,02`->`02,b4,76,7c,8f,7f,83,c2`->`194910961239294914`\n- 「蓝色部分」`EDIV` 对应 `EDiv`。把 16 进制转换成 10 进制即可，这里就不用倒转了。\n\n具体的转换方法我不再赘述，我把我的转换过程放在下面，我相信各位读者能够看懂。\n\n```bash\n[zhullyb@Archlinux ~]$ echo 'e3,c0,b2,8e,64,2b,12,16,d8,c2,d7,d4,59,55,92,cd' | tr a-z A-Z | sed 's/[[:punct:]]//g'\nE3C0B28E642B1216D8C2D7D4595592CD\n[zhullyb@Archlinux ~]$ echo $((16#02B4767C8F7F83C2))\t#这里我是手动倒叙的\n194910961239294914\n[zhullyb@Archlinux ~]$ echo $((16#000055a3))\n21923\n```\n\n做完这些操作以后，`sudo systemctl start bluetooth`即可\n",{"title":5,"description":69},"posts/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux",false,[417,418,419],"Linux","Archlinux","Windows","p2NiRvyqezHc2az3l3mkW3EMWlSSzabYLgAXMpaq46Q",[422,427],{"title":423,"path":424,"stem":425,"date":426,"children":-1},"下载一份openharmony的源码","/2021/06/06/download-openharmony-source-code","posts/download-openharmony-source-code","2021-06-06 16:47:34",{"title":428,"path":429,"stem":430,"date":431,"children":-1},"选择最新的Archlinux镜像源","/2021/05/29/choose-the-last-archlinux-mirror-site-in-china","posts/choose-the-last-archlinux-mirror-site-in-china","2021-05-29",28,1761735721640]