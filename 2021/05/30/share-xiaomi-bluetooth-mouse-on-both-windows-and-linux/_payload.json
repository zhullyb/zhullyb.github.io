[{"data":1,"prerenderedAt":416},["ShallowReactive",2],{"post-2021-05-30-share-xiaomi-bluetooth-mouse-on-both-windows-and-linux-zh":3,"surround-2021-05-30-share-xiaomi-bluetooth-mouse-on-both-windows-and-linux-zh":403,"randomIndex/2021/05/30/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux/":414,"language-switch-/2021/05/30/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux/-en":415},{"id":4,"title":5,"body":6,"date":388,"description":69,"extension":389,"lang":390,"meta":391,"navigation":392,"path":393,"rawbody":394,"seo":395,"stem":396,"sticky":397,"tags":398,"__hash__":402},"posts/posts/zh/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux.md","在Windows与Linux双系统下共享蓝牙鼠标",{"type":7,"value":8,"toc":386},"minimark",[9,30,33,47,53,60,63,79,85,88,94,99,102,233,239,242,250,299,302,375,382],[10,11,12,24,27],"blockquote",{},[13,14,15,16,23],"p",{},"我自己使用的鼠标是一只",[17,18,22],"a",{"href":19,"rel":20},"https://www.mi.com/mouse",[21],"nofollow","小米的无线蓝牙双模鼠标","。但是由于我的USB接口不是很充裕，我平时还是蓝牙鼠标用的比较多。",[13,25,26],{},"但是，每当我在Windows和Archlinux上切换时，我不得不重新配对我的蓝牙鼠标。原因我在翻译Archwiki上关于蓝牙鼠标相关叙述时已经解释得非常清楚了，我摘在下面：",[13,28,29],{},"“首先，计算机保存蓝牙设备的 MAC 地址和配对密钥；然后，蓝牙设备保存计算机的 MAC 地址和配对密钥。这两步通常不会有问题，不过设备蓝牙端口的 MAC 地址在 Linux 和 Windows 上都是相同的 (这在硬件层面上就设定好了)。然而，当在 Windows 或 Linux  中重新配对设备时，它会生成一个新密钥，覆盖了蓝牙设备之前保存的密钥，即与 Windows 配对产生的密钥会覆盖原先与 Linux  配对的密钥，反之亦然。“",[13,31,32],{},"先在Linux上连接蓝牙鼠标，再重启到Windows重新配对蓝牙蓝牙鼠标。",[13,34,35,36,41,42,46],{},"到",[17,37,40],{"href":38,"rel":39},"https://docs.microsoft.com/en-us/sysinternals/downloads/psexec",[21],"微软官网","下载",[43,44,45],"code",{},"PsExec.zip","，解压后，记住你所解压的路径。",[13,48,49,50],{},"在Windows中，使用管理员权限打开",[43,51,52],{},"cmd.exe",[13,54,55],{},[56,57],"img",{"alt":58,"src":59},"在Windows下使用管理员权限打开cmd","https://static.031130.xyz/uploads/2024/08/12/62f3cb081565a.webp",[13,61,62],{},"cd到PsExec解压目录，使用如下命令将我们所需要的蓝牙密钥信息保存到C盘根目录下。",[64,65,70],"pre",{"className":66,"code":67,"language":68,"meta":69,"style":69},"language-cmd shiki shiki-themes one-light one-dark-pro","psexec.exe -s -i regedit /e C:\\BTKeys.reg HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\BTHPORT\\Parameters\\Keys\n","cmd","",[43,71,72],{"__ignoreMap":69},[73,74,77],"span",{"class":75,"line":76},"line",1,[73,78,67],{},[13,80,81],{},[56,82],{"alt":83,"src":84},"使用psexec获取蓝牙信息","https://static.031130.xyz/uploads/2024/08/12/62f3cb0aae88f.webp",[13,86,87],{},"根目录的BTkeys.reg可以直接用记事本打开，内容大概是下面这个样子",[13,89,90],{},[56,91],{"alt":92,"src":93},"BTkeys.reg","https://static.031130.xyz/uploads/2024/08/12/62f3cb0d9e04f.webp",[10,95,96],{},[13,97,98],{},"为了方便后面的解说，我用各种颜色标注了起来。",[13,100,101],{},"在Linux下获取su权限以后，我们需要将Linux下随机分配给鼠标的蓝牙地址改成在Windows上获取的那个地址。上图中「红部分」划出来的就是Windows下获取的地址。",[64,103,107],{"className":104,"code":105,"language":106,"meta":69,"style":69},"language-bash shiki shiki-themes one-light one-dark-pro","[zhullyb@Archlinux ~]$ su\nPassword: \n[root@Archlinux zhullyb]# cd /var/lib/bluetooth/E0\\:94\\:67\\:74\\:0D\\:5F/\n[root@Archlinux E0:94:67:74:0D:5F]# ls\nC6:2A:1B:33:2E:71  cache  settings\n[root@Archlinux E0:94:67:74:0D:5F]# mv C6\\:2A\\:1B\\:33\\:2E\\:71/ C4\\:F6\\:B3\\:2C\\:BD\\:7E\n","bash",[43,108,109,115,125,158,164,177],{"__ignoreMap":69},[73,110,111],{"class":75,"line":76},[73,112,114],{"class":113},"s5ixo","[zhullyb@Archlinux ~]$ su\n",[73,116,118,122],{"class":75,"line":117},2,[73,119,121],{"class":120},"sAdtL","Password:",[73,123,124],{"class":113}," \n",[73,126,128,131,135,138,140,143,145,148,150,153,155],{"class":75,"line":127},3,[73,129,130],{"class":113},"[root@Archlinux zhullyb]# cd /var/lib/bluetooth/E0",[73,132,134],{"class":133},"s_Sar","\\:",[73,136,137],{"class":113},"94",[73,139,134],{"class":133},[73,141,142],{"class":113},"67",[73,144,134],{"class":133},[73,146,147],{"class":113},"74",[73,149,134],{"class":133},[73,151,152],{"class":113},"0D",[73,154,134],{"class":133},[73,156,157],{"class":113},"5F/\n",[73,159,161],{"class":75,"line":160},4,[73,162,163],{"class":113},"[root@Archlinux E0:94:67:74:0D:5F]# ls\n",[73,165,167,170,174],{"class":75,"line":166},5,[73,168,169],{"class":120},"C6:2A:1B:33:2E:71",[73,171,173],{"class":172},"sDhpE","  cache",[73,175,176],{"class":172},"  settings\n",[73,178,180,183,185,188,190,193,195,198,200,203,205,208,210,213,215,218,220,223,225,228,230],{"class":75,"line":179},6,[73,181,182],{"class":113},"[root@Archlinux E0:94:67:74:0D:5F]# mv C6",[73,184,134],{"class":133},[73,186,187],{"class":113},"2A",[73,189,134],{"class":133},[73,191,192],{"class":113},"1B",[73,194,134],{"class":133},[73,196,197],{"class":113},"33",[73,199,134],{"class":133},[73,201,202],{"class":113},"2E",[73,204,134],{"class":133},[73,206,207],{"class":113},"71/ C4",[73,209,134],{"class":133},[73,211,212],{"class":113},"F6",[73,214,134],{"class":133},[73,216,217],{"class":113},"B3",[73,219,134],{"class":133},[73,221,222],{"class":113},"2C",[73,224,134],{"class":133},[73,226,227],{"class":113},"BD",[73,229,134],{"class":133},[73,231,232],{"class":113},"7E\n",[13,234,235,236],{},"再编辑",[43,237,238],{},"/var/lib/bluetooth/\u003C本机蓝牙地址>/\u003C鼠标蓝牙地址>/info",[13,240,241],{},"原文件如下：",[64,243,248],{"className":244,"code":246,"language":247},[245],"language-text","[General]\nName=MiMouse\nAppearance=0x03c2\nAddressType=static\nSupportedTechnologies=LE;\nTrusted=true\nBlocked=false\nWakeAllowed=true\nServices=00001530-1212-efde-1523-785feabcd123;00001800-0000-1000-8000-00805f9b34fb;00001801-0000-1000-8000-00805f9b34fb;0000180a-0000-1000-8000-00805f9b34fb;0000180f-0000-1000-8000-00805f9b34fb;00001812-0000-1000-8000-00805f9b34fb;\n\n[IdentityResolvingKey]\nKey=067764BF59A7531E978AFDC6BB5EC8E1\n\n[LongTermKey]\nKey=E3C49B4F3256018192942EB0CDDEE6A3\nAuthenticated=0\nEncSize=16\nEDiv=28209\nRand=15970850852728832717\n\n[DeviceID]\nSource=2\nVendor=10007\nProduct=64\nVersion=40\n\n[ConnectionParameters]\nMinInterval=6\nMaxInterval=9\nLatency=100\nTimeout=600\n","text",[43,249,246],{"__ignoreMap":69},[251,252,253,269,289],"ul",{},[254,255,256,257,260,261,264,265,268],"li",{},"「黄色部分」",[43,258,259],{},"LTK"," 对应 ",[43,262,263],{},"LongTermKey"," 下的 ",[43,266,267],{},"Key","，把小写转换成大写并删去逗号即可。",[254,270,271,272,260,275,278,279,282,283,282,286],{},"「绿色部分」",[43,273,274],{},"ERand",[43,276,277],{},"Rand","。这里比较特殊的是，我们必须先将 Windows 中的值倒转过来再转换为 10 进制。即",[43,280,281],{},"c2,83,7f,8f,7c,76,b4,02","->",[43,284,285],{},"02,b4,76,7c,8f,7f,83,c2",[43,287,288],{},"194910961239294914",[254,290,291,292,260,295,298],{},"「蓝色部分」",[43,293,294],{},"EDIV",[43,296,297],{},"EDiv","。把 16 进制转换成 10 进制即可，这里就不用倒转了。",[13,300,301],{},"具体的转换方法我不再赘述，我把我的转换过程放在下面，我相信各位读者能够看懂。",[64,303,305],{"className":104,"code":304,"language":106,"meta":69,"style":69},"[zhullyb@Archlinux ~]$ echo 'e3,c0,b2,8e,64,2b,12,16,d8,c2,d7,d4,59,55,92,cd' | tr a-z A-Z | sed 's/[[:punct:]]//g'\nE3C0B28E642B1216D8C2D7D4595592CD\n[zhullyb@Archlinux ~]$ echo $((16#02B4767C8F7F83C2))    #这里我是手动倒叙的\n194910961239294914\n[zhullyb@Archlinux ~]$ echo $((16#000055a3))\n21923\n",[43,306,307,335,340,355,360,370],{"__ignoreMap":69},[73,308,309,312,315,318,321,324,327,329,332],{"class":75,"line":76},[73,310,311],{"class":113},"[zhullyb@Archlinux ~]$ echo ",[73,313,314],{"class":172},"'e3,c0,b2,8e,64,2b,12,16,d8,c2,d7,d4,59,55,92,cd'",[73,316,317],{"class":113}," | ",[73,319,320],{"class":120},"tr",[73,322,323],{"class":172}," a-z",[73,325,326],{"class":172}," A-Z",[73,328,317],{"class":113},[73,330,331],{"class":120},"sed",[73,333,334],{"class":172}," 's/[[:punct:]]//g'\n",[73,336,337],{"class":75,"line":117},[73,338,339],{"class":120},"E3C0B28E642B1216D8C2D7D4595592CD\n",[73,341,342,345,348,351],{"class":75,"line":127},[73,343,344],{"class":113},"[zhullyb@Archlinux ~]$ echo $((",[73,346,347],{"class":120},"16#02B4767C8F7F83C2",[73,349,350],{"class":113},"))    ",[73,352,354],{"class":353},"sW2Sy","#这里我是手动倒叙的\n",[73,356,357],{"class":75,"line":160},[73,358,359],{"class":120},"194910961239294914\n",[73,361,362,364,367],{"class":75,"line":166},[73,363,344],{"class":113},[73,365,366],{"class":120},"16#000055a3",[73,368,369],{"class":113},"))\n",[73,371,372],{"class":75,"line":179},[73,373,374],{"class":120},"21923\n",[13,376,377,378,381],{},"做完这些操作以后，",[43,379,380],{},"sudo systemctl start bluetooth","即可",[383,384,385],"style",{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}",{"title":69,"searchDepth":117,"depth":117,"links":387},[],"2021-05-30","md","zh-CN",{},true,"/2021/05/30/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux","---\ntitle: 在Windows与Linux双系统下共享蓝牙鼠标\ndate: 2021-05-30\ntags: \n      - Linux\n      - Archlinux\n      - Windows\n---\n\n> 我自己使用的鼠标是一只[小米的无线蓝牙双模鼠标](https://www.mi.com/mouse)。但是由于我的USB接口不是很充裕，我平时还是蓝牙鼠标用的比较多。\n>\n> 但是，每当我在Windows和Archlinux上切换时，我不得不重新配对我的蓝牙鼠标。原因我在翻译Archwiki上关于蓝牙鼠标相关叙述时已经解释得非常清楚了，我摘在下面：\n>\n> “首先，计算机保存蓝牙设备的 MAC 地址和配对密钥；然后，蓝牙设备保存计算机的 MAC 地址和配对密钥。这两步通常不会有问题，不过设备蓝牙端口的 MAC 地址在 Linux 和 Windows 上都是相同的 (这在硬件层面上就设定好了)。然而，当在 Windows 或 Linux  中重新配对设备时，它会生成一个新密钥，覆盖了蓝牙设备之前保存的密钥，即与 Windows 配对产生的密钥会覆盖原先与 Linux  配对的密钥，反之亦然。“\n\n先在Linux上连接蓝牙鼠标，再重启到Windows重新配对蓝牙蓝牙鼠标。\n\n到[微软官网](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec)下载`PsExec.zip`，解压后，记住你所解压的路径。\n\n在Windows中，使用管理员权限打开`cmd.exe`\n\n![在Windows下使用管理员权限打开cmd](https://static.031130.xyz/uploads/2024/08/12/62f3cb081565a.webp)\n\ncd到PsExec解压目录，使用如下命令将我们所需要的蓝牙密钥信息保存到C盘根目录下。\n\n```cmd\npsexec.exe -s -i regedit /e C:\\BTKeys.reg HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\BTHPORT\\Parameters\\Keys\n```\n\n![使用psexec获取蓝牙信息](https://static.031130.xyz/uploads/2024/08/12/62f3cb0aae88f.webp)\n\n根目录的BTkeys.reg可以直接用记事本打开，内容大概是下面这个样子\n\n![BTkeys.reg](https://static.031130.xyz/uploads/2024/08/12/62f3cb0d9e04f.webp)\n\n> 为了方便后面的解说，我用各种颜色标注了起来。\n\n在Linux下获取su权限以后，我们需要将Linux下随机分配给鼠标的蓝牙地址改成在Windows上获取的那个地址。上图中「红部分」划出来的就是Windows下获取的地址。\n\n```bash\n[zhullyb@Archlinux ~]$ su\nPassword: \n[root@Archlinux zhullyb]# cd /var/lib/bluetooth/E0\\:94\\:67\\:74\\:0D\\:5F/\n[root@Archlinux E0:94:67:74:0D:5F]# ls\nC6:2A:1B:33:2E:71  cache  settings\n[root@Archlinux E0:94:67:74:0D:5F]# mv C6\\:2A\\:1B\\:33\\:2E\\:71/ C4\\:F6\\:B3\\:2C\\:BD\\:7E\n```\n\n再编辑`/var/lib/bluetooth/\u003C本机蓝牙地址>/\u003C鼠标蓝牙地址>/info`\n\n原文件如下：\n\n```\n[General]\nName=MiMouse\nAppearance=0x03c2\nAddressType=static\nSupportedTechnologies=LE;\nTrusted=true\nBlocked=false\nWakeAllowed=true\nServices=00001530-1212-efde-1523-785feabcd123;00001800-0000-1000-8000-00805f9b34fb;00001801-0000-1000-8000-00805f9b34fb;0000180a-0000-1000-8000-00805f9b34fb;0000180f-0000-1000-8000-00805f9b34fb;00001812-0000-1000-8000-00805f9b34fb;\n\n[IdentityResolvingKey]\nKey=067764BF59A7531E978AFDC6BB5EC8E1\n\n[LongTermKey]\nKey=E3C49B4F3256018192942EB0CDDEE6A3\nAuthenticated=0\nEncSize=16\nEDiv=28209\nRand=15970850852728832717\n\n[DeviceID]\nSource=2\nVendor=10007\nProduct=64\nVersion=40\n\n[ConnectionParameters]\nMinInterval=6\nMaxInterval=9\nLatency=100\nTimeout=600\n```\n\n- 「黄色部分」`LTK` 对应 `LongTermKey` 下的 `Key`，把小写转换成大写并删去逗号即可。\n- 「绿色部分」`ERand` 对应 `Rand`。这里比较特殊的是，我们必须先将 Windows 中的值倒转过来再转换为 10 进制。即`c2,83,7f,8f,7c,76,b4,02`->`02,b4,76,7c,8f,7f,83,c2`->`194910961239294914`\n- 「蓝色部分」`EDIV` 对应 `EDiv`。把 16 进制转换成 10 进制即可，这里就不用倒转了。\n\n具体的转换方法我不再赘述，我把我的转换过程放在下面，我相信各位读者能够看懂。\n\n```bash\n[zhullyb@Archlinux ~]$ echo 'e3,c0,b2,8e,64,2b,12,16,d8,c2,d7,d4,59,55,92,cd' | tr a-z A-Z | sed 's/[[:punct:]]//g'\nE3C0B28E642B1216D8C2D7D4595592CD\n[zhullyb@Archlinux ~]$ echo $((16#02B4767C8F7F83C2))\t#这里我是手动倒叙的\n194910961239294914\n[zhullyb@Archlinux ~]$ echo $((16#000055a3))\n21923\n```\n\n做完这些操作以后，`sudo systemctl start bluetooth`即可\n",{"title":5,"description":69},"posts/zh/share-xiaomi-bluetooth-mouse-on-both-windows-and-linux",false,[399,400,401],"Linux","Archlinux","Windows","vq_4SAP38L8llBLC5yRaqvsCMihIJGjHYwQsvOd76kI",[404,409],{"title":405,"path":406,"stem":407,"date":408,"lang":390,"children":-1},"下载一份openharmony的源码","/2021/06/06/download-openharmony-source-code","posts/zh/download-openharmony-source-code","2021-06-06 16:47:34",{"title":410,"path":411,"stem":412,"date":413,"lang":390,"children":-1},"选择最新的Archlinux镜像源","/2021/05/29/choose-the-last-archlinux-mirror-site-in-china","posts/zh/choose-the-last-archlinux-mirror-site-in-china","2021-05-29",9,null,1763903431244]