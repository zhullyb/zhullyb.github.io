[{"data":1,"prerenderedAt":154},["ShallowReactive",2],{"post-2021-04-27-hide-simsun-from-deepin-wine-tim":3,"surround-2021-04-27-hide-simsun-from-deepin-wine-tim":142,"randomIndex/2021/04/27/hide-simsun-from-deepin-wine-tim/":153},{"id":4,"title":5,"body":6,"date":128,"description":36,"extension":129,"meta":130,"navigation":131,"path":132,"rawbody":133,"seo":134,"stem":135,"sticky":136,"tags":137,"__hash__":141},"posts/posts/hide-simsun-from-deepin-wine-tim.md","禁止deepin-wine-tim使用simsun字体渲染",{"type":7,"value":8,"toc":125},"minimark",[9,25,28,31,38,41,44,55,62,71,74,88,94,100,103,108,111,116,119],[10,11,12],"blockquote",{},[13,14,15,16,20,21,24],"p",{},"本文中，我通过bwrap命令对运行Tim的wine程序屏蔽了simsun字体以获得了一个更为舒适的字体渲染效果。我所使用的Tim为",[17,18,19],"code",{},"deepin-wine-tim","，至于",[17,22,23],{},"deepin-wine-qq","通过相同的方式应该也能达到相同的效果，spark商店的Tim我自己测试下来似乎是没法达到这样的效果，而使用其他方法安装simsun字体的网友们则需要注意灵活变通，不要照抄我给出的字体路径。",[13,26,27],{},"在Archlinux下，我们通常会使用deepin-wine5来运行QQ/Tim.",[13,29,30],{},"但是当我们在系统中倒入simsun字体时，无论使用什么奇迹淫巧似乎都无法阻止deepin-wine5找到simsun并优先使用它。于是，字体渲染就会变成如图这样奇奇怪怪的画风:",[13,32,33],{},[34,35],"img",{"alt":36,"src":37},"","https://static.031130.xyz/uploads/2024/08/12/62f3c887040ff.webp",[13,39,40],{},"但是我并不喜欢这样的渲染效果，使用simsun渲染出来的字体总感觉有一种上世纪的风格，况且，在我的1080p小屏下显示并不清晰。",[13,42,43],{},"于是，在尝试了更改注册表、在wine容器的系统路径下直接塞入字体文件等等方式无果后，我选择了逃避——直接让wine程序读取不到simsun。",[13,45,46,47,50,51,54],{},"我的simsun是通过",[17,48,49],{},"ttf-ms-win10-zh_cn","这个包安装上去的，被安装在",[17,52,53],{},"/usr/share/fonts/TTF/","路径下。",[13,56,57,58,61],{},"使用",[17,59,60],{},"pacman -Qo /usr/share/fonts/TTF/","命令查找这个路径下所安装的字体包，我这里的输出如下:",[63,64,69],"pre",{"className":65,"code":67,"language":68},[66],"language-text","[zhullyb@Archlinux ~]$ pacman -Qo /usr/share/fonts/TTF/\n/usr/share/fonts/TTF/ is owned by ttf-cascadia-code 2102.25-1\n/usr/share/fonts/TTF/ is owned by ttf-fira-code 5.2-1\n/usr/share/fonts/TTF/ is owned by ttf-hack 3.003-3\n/usr/share/fonts/TTF/ is owned by ttf-monaco 6.1-6\n/usr/share/fonts/TTF/ is owned by ttf-ms-win10-zh_cn 2019ltsc-1\n/usr/share/fonts/TTF/ is owned by ttf-opensans 1.101-2\n","text",[17,70,67],{"__ignoreMap":36},[13,72,73],{},"可以看到，并没有什么对wine程序运行特别重要的字体包，于是我计划通过bwrap命令对运行Tim的wine程序直接屏蔽这个路径。",[13,75,76,77,80,81,84,85],{},"首先安装提供",[17,78,79],{},"bwrap","命令的",[17,82,83],{},"bubblewrap","程序: ",[17,86,87],{},"sudo pacman -S bubblewrap --needed",[13,89,90,91],{},"通过查找deepin-wine-tim的desktop文件发现Tim的启动命令是",[17,92,93],{},"/opt/apps/com.qq.office.deepin/files/run.sh",[13,95,96,97],{},"在终端中输入命令进行测试",[17,98,99],{},"bwrap --dev-bind / / --tmpfs /usr/share/fonts/TTF/ /opt/apps/com.qq.office.deepin/files/run.sh",[13,101,102],{},"出现如下界面，看来方法是可行的。",[13,104,105],{},[34,106],{"alt":36,"src":107},"https://static.031130.xyz/uploads/2024/08/12/62f3c88b119f8.webp",[13,109,110],{},"于是，我们进一步更改deepin-wine-tim的desktop文件，以方便我们不需要每次都在Terminal中执行这么一大长串命令。需要更改的地方如下图红色方框圈出部分",[13,112,113],{},[34,114],{"alt":36,"src":115},"https://static.031130.xyz/uploads/2024/08/12/62f3c88f41790.webp",[13,117,118],{},"我这里附一下图中的命令方便诸位复制粘贴。",[63,120,123],{"className":121,"code":122,"language":68},[66],"[zhullyb@Archlinux ~]$ cat /usr/share/applications/com.qq.office.deepin.desktop \n#!/usr/bin/env xdg-open\n\n[Desktop Entry]\nEncoding=UTF-8\nType=Application\nX-Created-By=Deepin WINE Team\nCategories=chat;Network;\nIcon=com.qq.office.deepin\nExec=bwrap --dev-bind / / --tmpfs /usr/share/fonts/TTF/ /opt/apps/com.qq.office.deepin/files/run.sh\nName=TIM\nName[zh_CN]=TIM\nComment=Tencent TIM Client on Deepin Wine\nStartupWMClass=tim.exe\nMimeType=\n",[17,124,122],{"__ignoreMap":36},{"title":36,"searchDepth":126,"depth":126,"links":127},2,[],"2021-04-27","md",{},true,"/2021/04/27/hide-simsun-from-deepin-wine-tim","---\ntitle: 禁止deepin-wine-tim使用simsun字体渲染\ndate: 2021-04-27\ntags:\n- Archlinux\n- Linux\n- Bwrap\n---\n\n> 本文中，我通过bwrap命令对运行Tim的wine程序屏蔽了simsun字体以获得了一个更为舒适的字体渲染效果。我所使用的Tim为`deepin-wine-tim`，至于`deepin-wine-qq`通过相同的方式应该也能达到相同的效果，spark商店的Tim我自己测试下来似乎是没法达到这样的效果，而使用其他方法安装simsun字体的网友们则需要注意灵活变通，不要照抄我给出的字体路径。\n\n在Archlinux下，我们通常会使用deepin-wine5来运行QQ/Tim.\n\n但是当我们在系统中倒入simsun字体时，无论使用什么奇迹淫巧似乎都无法阻止deepin-wine5找到simsun并优先使用它。于是，字体渲染就会变成如图这样奇奇怪怪的画风: \n\n![](https://static.031130.xyz/uploads/2024/08/12/62f3c887040ff.webp)\n\n但是我并不喜欢这样的渲染效果，使用simsun渲染出来的字体总感觉有一种上世纪的风格，况且，在我的1080p小屏下显示并不清晰。\n\n于是，在尝试了更改注册表、在wine容器的系统路径下直接塞入字体文件等等方式无果后，我选择了逃避——直接让wine程序读取不到simsun。\n\n我的simsun是通过`ttf-ms-win10-zh_cn`这个包安装上去的，被安装在`/usr/share/fonts/TTF/`路径下。\n\n使用`pacman -Qo /usr/share/fonts/TTF/`命令查找这个路径下所安装的字体包，我这里的输出如下:\n\n```\n[zhullyb@Archlinux ~]$ pacman -Qo /usr/share/fonts/TTF/\n/usr/share/fonts/TTF/ is owned by ttf-cascadia-code 2102.25-1\n/usr/share/fonts/TTF/ is owned by ttf-fira-code 5.2-1\n/usr/share/fonts/TTF/ is owned by ttf-hack 3.003-3\n/usr/share/fonts/TTF/ is owned by ttf-monaco 6.1-6\n/usr/share/fonts/TTF/ is owned by ttf-ms-win10-zh_cn 2019ltsc-1\n/usr/share/fonts/TTF/ is owned by ttf-opensans 1.101-2\n```\n\n可以看到，并没有什么对wine程序运行特别重要的字体包，于是我计划通过bwrap命令对运行Tim的wine程序直接屏蔽这个路径。\n\n首先安装提供`bwrap`命令的`bubblewrap`程序: `sudo pacman -S bubblewrap --needed`\n\n通过查找deepin-wine-tim的desktop文件发现Tim的启动命令是`/opt/apps/com.qq.office.deepin/files/run.sh`\n\n在终端中输入命令进行测试`bwrap --dev-bind / / --tmpfs /usr/share/fonts/TTF/ /opt/apps/com.qq.office.deepin/files/run.sh`\n\n出现如下界面，看来方法是可行的。\n\n![](https://static.031130.xyz/uploads/2024/08/12/62f3c88b119f8.webp)\n\n于是，我们进一步更改deepin-wine-tim的desktop文件，以方便我们不需要每次都在Terminal中执行这么一大长串命令。需要更改的地方如下图红色方框圈出部分\n\n![](https://static.031130.xyz/uploads/2024/08/12/62f3c88f41790.webp)\n\n我这里附一下图中的命令方便诸位复制粘贴。\n\n```\n[zhullyb@Archlinux ~]$ cat /usr/share/applications/com.qq.office.deepin.desktop \n#!/usr/bin/env xdg-open\n\n[Desktop Entry]\nEncoding=UTF-8\nType=Application\nX-Created-By=Deepin WINE Team\nCategories=chat;Network;\nIcon=com.qq.office.deepin\nExec=bwrap --dev-bind / / --tmpfs /usr/share/fonts/TTF/ /opt/apps/com.qq.office.deepin/files/run.sh\nName=TIM\nName[zh_CN]=TIM\nComment=Tencent TIM Client on Deepin Wine\nStartupWMClass=tim.exe\nMimeType=\n```\n\n",{"title":5,"description":36},"posts/hide-simsun-from-deepin-wine-tim",false,[138,139,140],"Archlinux","Linux","Bwrap","6JS4sMJxbN30NsBueGcI0vFNi1_uroqeHZ5yE2gDiWM",[143,148],{"title":144,"path":145,"stem":146,"date":147,"children":-1},"使用vercel创建一个随机图片api","/2021/05/21/create-a-random-picture-api-with-vercel","posts/create-a-random-picture-api-with-vercel","2021-05-21",{"title":149,"path":150,"stem":151,"date":152,"children":-1},"在系统使用暗色主题时禁用Firefox的夜间模式","/2021/04/23/disable-firefox-nightmode-when-your-system-is-using-that","posts/disable-firefox-nightmode-when-your-system-is-using-that","2021-04-23",10,1762797156248]