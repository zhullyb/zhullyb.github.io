[{"data":1,"prerenderedAt":147},["ShallowReactive",2],{"post-2021-04-27-hide-simsun-from-deepin-wine-tim-zh":3,"surround-2021-04-27-hide-simsun-from-deepin-wine-tim-zh":133,"randomIndex/2021/04/27/hide-simsun-from-deepin-wine-tim/":145,"language-switch-/2021/04/27/hide-simsun-from-deepin-wine-tim/-en":146},{"title":4,"date":5,"path":6,"tags":7,"body":11,"description":41},"禁止deepin-wine-tim使用simsun字体渲染","2021-04-27","/2021/04/27/hide-simsun-from-deepin-wine-tim",[8,9,10],"Archlinux","Linux","Bwrap",{"type":12,"value":13,"toc":130},"minimark",[14,30,33,36,43,46,49,60,67,76,79,93,99,105,108,113,116,121,124],[15,16,17],"blockquote",{},[18,19,20,21,25,26,29],"p",{},"本文中，我通过bwrap命令对运行Tim的wine程序屏蔽了simsun字体以获得了一个更为舒适的字体渲染效果。我所使用的Tim为",[22,23,24],"code",{},"deepin-wine-tim","，至于",[22,27,28],{},"deepin-wine-qq","通过相同的方式应该也能达到相同的效果，spark商店的Tim我自己测试下来似乎是没法达到这样的效果，而使用其他方法安装simsun字体的网友们则需要注意灵活变通，不要照抄我给出的字体路径。",[18,31,32],{},"在Archlinux下，我们通常会使用deepin-wine5来运行QQ/Tim.",[18,34,35],{},"但是当我们在系统中倒入simsun字体时，无论使用什么奇迹淫巧似乎都无法阻止deepin-wine5找到simsun并优先使用它。于是，字体渲染就会变成如图这样奇奇怪怪的画风:",[18,37,38],{},[39,40],"img",{"alt":41,"src":42},"","https://static.031130.xyz/uploads/2024/08/12/62f3c887040ff.webp",[18,44,45],{},"但是我并不喜欢这样的渲染效果，使用simsun渲染出来的字体总感觉有一种上世纪的风格，况且，在我的1080p小屏下显示并不清晰。",[18,47,48],{},"于是，在尝试了更改注册表、在wine容器的系统路径下直接塞入字体文件等等方式无果后，我选择了逃避——直接让wine程序读取不到simsun。",[18,50,51,52,55,56,59],{},"我的simsun是通过",[22,53,54],{},"ttf-ms-win10-zh_cn","这个包安装上去的，被安装在",[22,57,58],{},"/usr/share/fonts/TTF/","路径下。",[18,61,62,63,66],{},"使用",[22,64,65],{},"pacman -Qo /usr/share/fonts/TTF/","命令查找这个路径下所安装的字体包，我这里的输出如下:",[68,69,74],"pre",{"className":70,"code":72,"language":73},[71],"language-text","[zhullyb@Archlinux ~]$ pacman -Qo /usr/share/fonts/TTF/\n/usr/share/fonts/TTF/ is owned by ttf-cascadia-code 2102.25-1\n/usr/share/fonts/TTF/ is owned by ttf-fira-code 5.2-1\n/usr/share/fonts/TTF/ is owned by ttf-hack 3.003-3\n/usr/share/fonts/TTF/ is owned by ttf-monaco 6.1-6\n/usr/share/fonts/TTF/ is owned by ttf-ms-win10-zh_cn 2019ltsc-1\n/usr/share/fonts/TTF/ is owned by ttf-opensans 1.101-2\n","text",[22,75,72],{"__ignoreMap":41},[18,77,78],{},"可以看到，并没有什么对wine程序运行特别重要的字体包，于是我计划通过bwrap命令对运行Tim的wine程序直接屏蔽这个路径。",[18,80,81,82,85,86,89,90],{},"首先安装提供",[22,83,84],{},"bwrap","命令的",[22,87,88],{},"bubblewrap","程序: ",[22,91,92],{},"sudo pacman -S bubblewrap --needed",[18,94,95,96],{},"通过查找deepin-wine-tim的desktop文件发现Tim的启动命令是",[22,97,98],{},"/opt/apps/com.qq.office.deepin/files/run.sh",[18,100,101,102],{},"在终端中输入命令进行测试",[22,103,104],{},"bwrap --dev-bind / / --tmpfs /usr/share/fonts/TTF/ /opt/apps/com.qq.office.deepin/files/run.sh",[18,106,107],{},"出现如下界面，看来方法是可行的。",[18,109,110],{},[39,111],{"alt":41,"src":112},"https://static.031130.xyz/uploads/2024/08/12/62f3c88b119f8.webp",[18,114,115],{},"于是，我们进一步更改deepin-wine-tim的desktop文件，以方便我们不需要每次都在Terminal中执行这么一大长串命令。需要更改的地方如下图红色方框圈出部分",[18,117,118],{},[39,119],{"alt":41,"src":120},"https://static.031130.xyz/uploads/2024/08/12/62f3c88f41790.webp",[18,122,123],{},"我这里附一下图中的命令方便诸位复制粘贴。",[68,125,128],{"className":126,"code":127,"language":73},[71],"[zhullyb@Archlinux ~]$ cat /usr/share/applications/com.qq.office.deepin.desktop \n#!/usr/bin/env xdg-open\n\n[Desktop Entry]\nEncoding=UTF-8\nType=Application\nX-Created-By=Deepin WINE Team\nCategories=chat;Network;\nIcon=com.qq.office.deepin\nExec=bwrap --dev-bind / / --tmpfs /usr/share/fonts/TTF/ /opt/apps/com.qq.office.deepin/files/run.sh\nName=TIM\nName[zh_CN]=TIM\nComment=Tencent TIM Client on Deepin Wine\nStartupWMClass=tim.exe\nMimeType=\n",[22,129,127],{"__ignoreMap":41},{"title":41,"searchDepth":131,"depth":131,"links":132},2,[],[134,140],{"title":135,"path":136,"stem":137,"date":138,"lang":139,"children":-1},"使用vercel创建一个随机图片api","/2021/05/21/create-a-random-picture-api-with-vercel","posts/zh/create-a-random-picture-api-with-vercel","2021-05-21","zh-CN",{"title":141,"path":142,"stem":143,"date":144,"lang":139,"children":-1},"在系统使用暗色主题时禁用Firefox的夜间模式","/2021/04/23/disable-firefox-nightmode-when-your-system-is-using-that","posts/zh/disable-firefox-nightmode-when-your-system-is-using-that","2021-04-23",0,null,1766437542690]