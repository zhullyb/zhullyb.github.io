[{"data":1,"prerenderedAt":2017},["ShallowReactive",2],{"randomIndex/archives/page/9/":3,"index-page-9":4,"posts-nums-total":2016},15,[5,90,284,627,877,983,1302,1549,1652,1736],{"title":6,"date":7,"path":8,"tags":9,"body":13},"使用 Github Action 跑 rpmbuild","2022-03-06 16:02:54","/2022/03/06/run-rpmbuild-with-github-action",[10,11,12],"Fedora","RPM Package","Github Action",{"type":14,"value":15,"toc":87},"minimark",[16,20,23,40,43,62,69,78],[17,18,19],"p",{},"一直打算用 Github Action 跑 rpmbuild 构建 rpm 包，然后传到 Action 的 Artifacts 里面，用户就可以在登陆 Github 帐号的情况下进行下载。只要不发 Release，应该就不算「再分发」的行为，也就自然规避了再分发闭源软件的法律风险。",[17,21,22],{},"然而，现有的那些 Action 几乎全都是针对 CentOS 老古董定制的，，有些甚至连 buildrequires 都不帮你安装，而且大部分情况下都不支持 Source 直接填写一个链接，需要你直接提供 Source 文件。我自己又不可能在 Github 的仓库里用 lfs 强行存一个 200MB+ 的二进制文件，显然是不符合我要求的。还有几个项目使用 mock 去构建的，但使用 mock 构建需要提前用 rpmbuild 生成 srpm，在我们的个人电脑上可以理解为用一个干净的 chroot 打包防止自己的环境受污染，但在一个全新的、用完一次就要扔掉的 docker 里面还要防止环境被污染似乎有些画蛇添足的嫌疑。",[17,24,25,26,33,34,39],{},"最终，我选择了 ",[27,28,32],"a",{"href":29,"rel":30},"https://github.com/marketplace/actions/rpm-build",[31],"nofollow","naveenrajm7/rpmbuild"," 这个项目。（虽然我并不理解为什么他要用 nodejs 去调用系统命令去执行 rpmbuild 等一系列步骤，我也没学过这类语言。不过项目的 ",[27,35,38],{"href":36,"rel":37},"https://github.com/naveenrajm7/rpmbuild/blob/master/src/main.ts",[31],"main.ts"," 我还是能仿写的。）",[17,41,42],{},"在经过三四个小时的摸爬滚打下，我还是成功地将这个项目按照我的想法改完了。",[44,45,46,50,53,56,59],"ul",{},[47,48,49],"li",{},"采用 Fedora 35 作为 host 进行 rpmbuild",[47,51,52],{},"自动安装 buildrequires",[47,54,55],{},"自动下载 source",[47,57,58],{},"允许仓库内自带本地 source",[47,60,61],{},"移除针对 srpm 的构建",[17,63,64],{},[65,66],"img",{"alt":67,"src":68},"","https://static.031130.xyz/uploads/2024/08/12/bb263c91c7bf4.webp",[17,70,71,72,77],{},"改完后的 action 在 ",[27,73,76],{"href":74,"rel":75},"https://github.com/zhullyb/rpmbuild-github-action",[31],"zhullyb/rpmbuild-github-action","，欢迎使用。",[17,79,80,81,86],{},"最终是在 ",[27,82,85],{"href":83,"rel":84},"https://github.com/zhullyb/dingtalk-for-fedora",[31],"zhullyb/dingtalk-for-fedora"," 项目成功实装了，有兴趣的访客们可以去尝试着一起来白嫖 Github Action 呀！ >_\u003C",{"title":67,"searchDepth":88,"depth":88,"links":89},2,[],{"title":91,"date":92,"path":93,"tags":94,"body":95},"如何打出一个「-git」的rpm包","2022-02-07 10:23:29","/2022/02/07/how-to-package-a-git-rpm-package",[10,11],{"type":14,"value":96,"toc":276},[97,105,110,117,137,141,148,152,167,171,188,192,216,225,231,252,256,262],[17,98,99,100,104],{},"本文中，笔者通过 github api 获取最新的 commit_id ，以一种曲线救国的方式成功为 rpm 打下了一个 ",[101,102,103],"code",{},"-git"," 包。",[106,107,109],"h2",{"id":108},"on-archlinux","On Archlinux",[17,111,112,113,116],{},"用过 AUR 的 Arch 用户应该知道，makepkg 支持 \"-git\" 包。当我们执行 makepkg 时，PKGBUILD 中的 ",[101,114,115],{},"pkgver"," 函数会自动被运行，并将输出的结果作为本次打包的版本号。这是一个非常棒的设计，我们不需要去手动更新 PKGBUILD，就可以直接从 git 服务区拉取最新的 master 分支编译打包，对于跟进开发进度而言非常方便。",[17,118,119,120,122,123,126,127,130,131,133,134,136],{},"一般来说，一个 ",[101,121,103],{}," 包的版本号会分成 2~4 个部分，最为核心的是 ",[101,124,125],{},"count"," 和 ",[101,128,129],{},"commit_id","：",[101,132,125],{},"用于记录这是第几次提交，通过提交的次数作为版本号的靠前部分可以帮助包管理器比较版本号的新旧，比如第21次提交的代码一定比第18次的更加新，而21也正好比18大，包管理器也就凭借着这个数字来保证其可以在用户在更新的时候为用户选择一个更新版本的包；而 ",[101,135,129],{},"则可以帮助人类更快定位这个包是在哪一次代码提交以后编译的，以帮助 开发者/用户 定位问题。",[106,138,140],{"id":139},"on-fedora","On Fedora",[17,142,143,144,147],{},"然而，这个思路在 rpm 上似乎无法实现。rpmbuild 执行的时候会事先根据版本号在 BUILDROOT 路径下创造一个 ",[101,145,146],{},"%{name}-%{version}-%{release}-%{arch}","的目录，如此一来，就必须先确定版本号，无法像 PKGBUILD 那样使用一个 pkgver 的函数去自动更新版本号。此外，rpm 似乎专注于软件包的 Reproducibility，也就是希望拿到了指导 rpmbuild 打包的 specfile 以后打出一个相同包的能力，因此，使用同一份 specfile 在不同时间打出一个不同包的这种行为似乎并不符合 Fedora/Redhat 的哲学，所以我们怕是等不到 rpm 支持这个功能的那一天了。",[106,149,151],{"id":150},"turn-of-events","Turn of events",[17,153,154,155,160,161,166],{},"当然，这也并非不可能完成的任务，在 ",[27,156,159],{"href":157,"rel":158},"https://yanqiyu.info/",[31],"西木野羰基"," 的指引下，我在 Fedora Docs 找到了",[27,162,165],{"href":163,"rel":164},"https://docs.fedoraproject.org/en-US/packaging-guidelines/SourceURL/#_branch_example",[31],"对于某个 Branch 的打包样版","。其实也就是直接从 github 下载 master 分支的 master.tar.gz 压缩包来获取最新的源码，这样就确保了每一次 rpmbuild 的时候都能获取最新的源码。接下来需要处理的就是版本号的问题。",[106,168,170],{"id":169},"sad-story","Sad Story",[17,172,173,174,177,178,181,182,184,185,187],{},"很可惜，master.tar.gz 压缩包中并不包括 ",[101,175,176],{},".git"," 文件，我们无法通过 ",[101,179,180],{},"git rev-list --count HEAD"," 来获取 ",[101,183,125],{}," 计数，此外，最新的 ",[101,186,129],{}," 我们也不得而知。即使我们知道这些参数，也无法在 rpmbuild 执行之前自动把这些参数填进 specfile 中。",[106,189,191],{"id":190},"improvement","Improvement",[17,193,194,195,200,201,204,205,209,210,215],{},"好在天无绝人之路，在 Liu Sen 的 ",[27,196,199],{"href":197,"rel":198},"https://forum.suse.org.cn/t/topic/13626",[31],"RPM 中宏的简单介绍"," 一文中发现宏其实也可以类似 bash 中的 ",[101,202,203],{},"$()"," 一样定义成系统运行某些命令后的结果，通过仿写 copr 上 ",[206,207,208],"em",{},"atim/fractal"," 的 ",[27,211,214],{"href":212,"rel":213},"https://download.copr.fedorainfracloud.org/results/atim/fractal/fedora-35-x86_64/03000082-fractal-master/fractal-master.spec",[31],"specfile"," 定义了下面两个宏。",[217,218,223],"pre",{"className":219,"code":221,"language":222},[220],"language-text","%global timenow %(echo $(date +%Y%m%d.%H%M))\n%global commit_short_id %(api_result=$(curl -s https://api.github.com/repos/\u003Cusername>/\u003Creponame>/branches/master | head -n 4 | tail -n 1); echo ${api_result:12:7})\n","text",[101,224,221],{"__ignoreMap":67},[17,226,227,228],{},"版本号就可以直接写成 ",[101,229,230],{},"%{timenow}.%{commit_id_short}",[44,232,233,242],{},[47,234,235,238,239,241],{},[101,236,237],{},"%{timenow}"," 是直接通过运行系统的 date 命令获得一个精确到分钟的时间来当作 ",[101,240,125],{}," 给 dnf 判断版本号大小使用",[47,243,244,247,248,251],{},[101,245,246],{},"%{commit_id_short}"," 从 api.github.com 获取到该仓库最新的 commit 号，配合粗制滥造的 shell 命令做切片，提取前7 位，帮助用户和开发者快速定位源码版本使用。当然，也可以选择直接使用 ",[101,249,250],{},"jq"," 作为 json 的解释器，不过 copr 大概率没有预装，生成 srpm 的时候估计就会报错。",[106,253,255],{"id":254},"review","Review",[17,257,258,259,261],{},"至此，我们成功解决了在 rpm 上打 ",[101,260,103],{}," 包的问题，不过仍然有以下缺点",[44,263,264,267,270,273],{},[47,265,266],{},"仅支持 github 上的项目，对于其他的 git 托管服务商还需要去查阅他们的 api 文档",[47,268,269],{},"粗制滥造的 shell 命令可能不足以应对以后的 github api 变更",[47,271,272],{},"使用了精确到分钟的时间作为计数器，导致版本号过长",[47,274,275],{},"使用 copr 打包的时候，有概率出现 srpm 与 rpm 之间版本号出现分钟级的差异",{"title":67,"searchDepth":88,"depth":88,"links":277},[278,279,280,281,282,283],{"id":108,"depth":88,"text":109},{"id":139,"depth":88,"text":140},{"id":150,"depth":88,"text":151},{"id":169,"depth":88,"text":170},{"id":190,"depth":88,"text":191},{"id":254,"depth":88,"text":255},{"title":285,"date":286,"path":287,"tags":288,"body":289},"雪藏在开源镜像站点中的那些常用却不为人知的软件","2022-01-19 13:01:30","/2022/01/19/the-common-software-hidden-in-mirrors",null,{"type":14,"value":290,"toc":625},[291,294,301],[17,292,293],{},"前两天在下载 微PE 的时候眼睛突然一瞥，发现了山东大学的开源镜像站。突然间才发现在各个开源镜像站点中提供了许多那些我们误以为只能顶着断断续续的 Github  网络才能下载的软件。",[17,295,296,297],{},"下面这张列表主要来自山东大学的镜像站中的「常用软件」和南京大学的「github-release」。",[298,299,300],"del",{},"我严重怀疑南京大学就是把整个 tuna 给搬了一遍过来。",[302,303,304,334],"table",{},[305,306,307],"thead",{},[308,309,310,313,320,327],"tr",{},[311,312],"th",{},[311,314,315],{},[27,316,319],{"href":317,"rel":318},"https://mirrors.sdu.edu.cn",[31],"山东大学",[311,321,322],{},[27,323,326],{"href":324,"rel":325},"https://mirrors.nju.edu.cn",[31],"南京大学",[311,328,329],{},[27,330,333],{"href":331,"rel":332},"https://mirrors.tuna.tsinghua.edu.cn",[31],"清华大学",[335,336,337,357,372,395,410,425,444,459,482,497,512,531,553,572,591,610],"tbody",{},[308,338,339,343,345,351],{},[340,341,342],"td",{},"balena-io/etcher",[340,344],{},[340,346,347],{},[27,348,349],{"href":349,"rel":350},"https://mirrors.nju.edu.cn/github-release/balena-io/etcher/LatestRelease/",[31],[340,352,353],{},[27,354,355],{"href":355,"rel":356},"https://mirrors.tuna.tsinghua.edu.cn/github-release/balena-io/etcher/LatestRelease/",[31],[308,358,359,362,368,370],{},[340,360,361],{},"drawio-desktop",[340,363,364],{},[27,365,366],{"href":366,"rel":367},"https://mirrors.sdu.edu.cn/github-release/jgraph_drawio-desktop/",[31],[340,369],{},[340,371],{},[308,373,374,377,383,389],{},[340,375,376],{},"git-for-windows",[340,378,379],{},[27,380,381],{"href":381,"rel":382},"https://mirrors.sdu.edu.cn/github-release/git-for-windows_git/",[31],[340,384,385],{},[27,386,387],{"href":387,"rel":388},"https://mirrors.nju.edu.cn/github-release/git-for-windows/git/LatestRelease/",[31],[340,390,391],{},[27,392,393],{"href":393,"rel":394},"https://mirrors.tuna.tsinghua.edu.cn/github-release/git-for-windows/git/LatestRelease/",[31],[308,396,397,400,402,408],{},[340,398,399],{},"Krita",[340,401],{},[340,403,404],{},[27,405,406],{"href":406,"rel":407},"https://mirrors.nju.edu.cn/kde/stable/krita/",[31],[340,409],{},[308,411,412,415,417,419],{},[340,413,414],{},"libreoffice",[340,416],{},[340,418],{},[340,420,421],{},[27,422,423],{"href":423,"rel":424},"https://mirrors.tuna.tsinghua.edu.cn/libreoffice/libreoffice/",[31],[308,426,427,430,432,438],{},[340,428,429],{},"Magisk",[340,431],{},[340,433,434],{},[27,435,436],{"href":436,"rel":437},"https://mirrors.nju.edu.cn/github-release/topjohnwu/Magisk/LatestRelease/",[31],[340,439,440],{},[27,441,442],{"href":442,"rel":443},"https://mirrors.tuna.tsinghua.edu.cn/github-release/topjohnwu/Magisk/LatestRelease/",[31],[308,445,446,449,455,457],{},[340,447,448],{},"Motrix",[340,450,451],{},[27,452,453],{"href":453,"rel":454},"https://mirrors.sdu.edu.cn/github-release/agalwood_Motrix/",[31],[340,456],{},[340,458],{},[308,460,461,464,470,476],{},[340,462,463],{},"obs-studio",[340,465,466],{},[27,467,468],{"href":468,"rel":469},"https://mirrors.sdu.edu.cn/github-release/obsproject_obs-studio/https://mirrors.sdu.edu.cn/software/Windows/OBS%20Studio/",[31],[340,471,472],{},[27,473,474],{"href":474,"rel":475},"https://mirrors.nju.edu.cn/github-release/obsproject/obs-studio/LatestRelease/",[31],[340,477,478],{},[27,479,480],{"href":480,"rel":481},"https://mirrors.tuna.tsinghua.edu.cn/github-release/obsproject/obs-studio/LatestRelease/",[31],[308,483,484,487,493,495],{},[340,485,486],{},"office tool plus",[340,488,489],{},[27,490,491],{"href":491,"rel":492},"https://mirrors.sdu.edu.cn/github-release/YerongAI_Office-Tool/",[31],[340,494],{},[340,496],{},[308,498,499,502,508,510],{},[340,500,501],{},"picgo",[340,503,504],{},[27,505,506],{"href":506,"rel":507},"https://mirrors.sdu.edu.cn/github-release/pbatard_rufus/",[31],[340,509],{},[340,511],{},[308,513,514,517,523,529],{},[340,515,516],{},"rufus",[340,518,519],{},[27,520,521],{"href":521,"rel":522},"https://mirrors.sdu.edu.cn/software/Windows/Rufus/",[31],[340,524,525],{},[27,526,527],{"href":527,"rel":528},"https://mirrors.nju.edu.cn/github-release/pbatard/rufus/LatestRelease/",[31],[340,530],{},[308,532,533,539,545,551],{},[340,534,535],{},[27,536,537],{"href":537,"rel":538},"https://mirrors.sdu.edu.cn/software/Windows/WePE/ventoy",[31],[340,540,541],{},[27,542,543],{"href":543,"rel":544},"https://mirrors.sdu.edu.cn/github-release/ventoy_Ventoy/",[31],[340,546,547],{},[27,548,549],{"href":549,"rel":550},"https://mirrors.nju.edu.cn/github-release/ventoy/Ventoy/LatestRelease/",[31],[340,552],{},[308,554,555,558,560,566],{},[340,556,557],{},"virtualbox",[340,559],{},[340,561,562],{},[27,563,564],{"href":564,"rel":565},"https://mirrors.nju.edu.cn/virtualbox/",[31],[340,567,568],{},[27,569,570],{"href":570,"rel":571},"https://mirrors.tuna.tsinghua.edu.cn/virtualbox/",[31],[308,573,574,577,579,585],{},[340,575,576],{},"vlc",[340,578],{},[340,580,581],{},[27,582,583],{"href":583,"rel":584},"https://mirrors.nju.edu.cn/videolan-ftp/",[31],[340,586,587],{},[27,588,589],{"href":589,"rel":590},"https://mirrors.tuna.tsinghua.edu.cn/videolan-ftp/",[31],[308,592,593,596,598,604],{},[340,594,595],{},"winehq",[340,597],{},[340,599,600],{},[27,601,602],{"href":602,"rel":603},"https://mirrors.nju.edu.cn/winehq/",[31],[340,605,606],{},[27,607,608],{"href":608,"rel":609},"https://mirrors.bfsu.edu.cn/winehq/",[31],[308,611,612,615,621,623],{},[340,613,614],{},"wepe",[340,616,617],{},[27,618,619],{"href":619,"rel":620},"https://mirrors.sdu.edu.cn/software/Windows/WePE/",[31],[340,622],{},[340,624],{},{"title":67,"searchDepth":88,"depth":88,"links":626},[],{"title":628,"date":629,"path":630,"tags":631,"body":632},"在Fedora搭建jekyll环境——dnf module","2022-01-12 22:11:42","/2022/01/12/dnf-module-in-setting-up-the-jekyll",[10],{"type":14,"value":633,"toc":869},[634,637,654,657,661,674,677,681,684,710,713,732,735,754,758,819,829,835,838,844,851,865],[106,635,636],{"id":636},"起因",[17,638,639,640,645,646,649,650,653],{},"我之前的博客一直用的是",[27,641,644],{"href":642,"rel":643},"https://github.com/qiubaiying/qiubaiying.github.io",[31],"这个主题","，直接使用 Fedora 官方源里的 ",[101,647,648],{},"rubygem-jekyll"," 似乎无法正常安装 Gemfile 中的依赖。之前使用 Archlinux 的时候，我是直接从 AUR 安装了一个 ",[101,651,652],{},"ruby-2.6"," 来使用的，但最近转到 Fedora 以后似乎就没法用这样的方案来解决了。",[17,655,656],{},"好在天无绝人之路，Fedora 也提供了安装老版本的 ruby 的方案——使用 dnf 的 module 功能。",[106,658,660],{"id":659},"关于-dnf-module","关于 dnf module",[17,662,663,664,669,670,673],{},"关于 dnf 的 module 功能到底是用来做什么的，其实我并不清楚。虽说 Fedora 提供了",[27,665,668],{"href":666,"rel":667},"https://docs.fedoraproject.org/en-US/modularity/",[31],"文档","，但就凭我的读中文文档都吃力的水准，似乎没有办法通过英文文档来理解这个全新的概念，",[298,671,672],{},"所以我选择直接莽过去","。",[17,675,676],{},"就我目前的理解而言，dnf 的 module 似乎并不致力于帮助用户完成系统内某一程序的新老版本共存的难题，而仅仅是给用户提供了停留在老版本软件的权利。module 所负责的，是保证老版本的程序能在你的系统上正常运行起来，而不会因为其他组件的更新而导致老版本的程序无法正常使用。",[678,679,680],"h3",{"id":680},"基本的使用方法",[17,682,683],{},"通过下列命令可以查看目前所支持的 module",[217,685,689],{"className":686,"code":687,"language":688,"meta":67,"style":67},"language-bash shiki shiki-themes one-light one-dark-pro","sudo dnf module list\n","bash",[101,690,691],{"__ignoreMap":67},[692,693,696,700,704,707],"span",{"class":694,"line":695},"line",1,[692,697,699],{"class":698},"sAdtL","sudo",[692,701,703],{"class":702},"sDhpE"," dnf",[692,705,706],{"class":702}," module",[692,708,709],{"class":702}," list\n",[17,711,712],{},"通过下列命令可以选择 module 所要停留的版本( 以 ruby 2.7 为例 )",[217,714,716],{"className":686,"code":715,"language":688,"meta":67,"style":67},"sudo dnf module enable ruby:2.7\n",[101,717,718],{"__ignoreMap":67},[692,719,720,722,724,726,729],{"class":694,"line":695},[692,721,699],{"class":698},[692,723,703],{"class":702},[692,725,706],{"class":702},[692,727,728],{"class":702}," enable",[692,730,731],{"class":702}," ruby:2.7\n",[17,733,734],{},"通过下列命令可以取消锁定 module 程序所要停留的版本( 以 ruby 为例 )",[217,736,738],{"className":686,"code":737,"language":688,"meta":67,"style":67},"sudo dnf module reset ruby\n",[101,739,740],{"__ignoreMap":67},[692,741,742,744,746,748,751],{"class":694,"line":695},[692,743,699],{"class":698},[692,745,703],{"class":702},[692,747,706],{"class":702},[692,749,750],{"class":702}," reset",[692,752,753],{"class":702}," ruby\n",[106,755,757],{"id":756},"开始配置该-jekyll-主题的运行环境","开始配置该 jekyll 主题的运行环境",[217,759,761],{"className":686,"code":760,"language":688,"meta":67,"style":67},"sudo dnf module install ruby:2.7\nsudo dnf install ruby-devel\n\ncd /path/to/the/jekyll-blog/\nbundle install --path vendor/bundle\n",[101,762,763,776,787,794,804],{"__ignoreMap":67},[692,764,765,767,769,771,774],{"class":694,"line":695},[692,766,699],{"class":698},[692,768,703],{"class":702},[692,770,706],{"class":702},[692,772,773],{"class":702}," install",[692,775,731],{"class":702},[692,777,778,780,782,784],{"class":694,"line":88},[692,779,699],{"class":698},[692,781,703],{"class":702},[692,783,773],{"class":702},[692,785,786],{"class":702}," ruby-devel\n",[692,788,790],{"class":694,"line":789},3,[692,791,793],{"emptyLinePlaceholder":792},true,"\n",[692,795,797,801],{"class":694,"line":796},4,[692,798,800],{"class":799},"s_Sar","cd",[692,802,803],{"class":702}," /path/to/the/jekyll-blog/\n",[692,805,807,810,812,816],{"class":694,"line":806},5,[692,808,809],{"class":698},"bundle",[692,811,773],{"class":702},[692,813,815],{"class":814},"sAGMh"," --path",[692,817,818],{"class":702}," vendor/bundle\n",[17,820,821,822,825,826],{},"完成后，我们即可在 jekyll-blog 目录下 使用 ",[101,823,824],{},"bundle exec jekyll"," 来正常运行 jekyll 了。试着跑一下 ",[101,827,828],{},"bundle exec jekyll server",[17,830,831],{},[65,832],{"alt":833,"src":834},"成功，彻彻底底！","https://static.031130.xyz/uploads/2024/08/12/62f3caeec8ef6.webp",[106,836,837],{"id":837},"参考材料",[17,839,840],{},[27,841,843],{"href":666,"rel":842},[31],"Fedora Docs",[17,845,846],{},[27,847,850],{"href":848,"rel":849},"https://github.com/openSUSE-zh/page-opensuse-zh/blob/main/CONTRIBUTING.md",[31],"openSUSE 中文社区主页贡献指南",[17,852,853,858,859,864],{},[27,854,857],{"href":855,"rel":856},"https://blog.kagesenshi.org/2021/05/ruby24-fedora34.html",[31],"Switching to use Ruby 2.7 (or older) in Fedora 34 using DNF Modules"," 「",[27,860,863],{"href":861,"rel":862},"https://web.archive.org/web/20220112143005/https://blog.kagesenshi.org/2021/05/ruby24-fedora34.html",[31],"WebArchive","」",[866,867,868],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}",{"title":67,"searchDepth":88,"depth":88,"links":870},[871,872,875,876],{"id":636,"depth":88,"text":636},{"id":659,"depth":88,"text":660,"children":873},[874],{"id":680,"depth":789,"text":680},{"id":756,"depth":88,"text":757},{"id":837,"depth":88,"text":837},{"title":878,"date":879,"path":880,"tags":881,"body":883},"pacman更新时遇到「GPGME 错误：无数据」","2022-01-01 23:42:09","/2022/01/01/pacman-gpgme-error-no-data",[882],"Archlinux",{"type":14,"value":884,"toc":978},[885,888,891,897,900,906,909,915,918,921,932,943,950,953,959,972],[106,886,887],{"id":887},"情景再现",[17,889,890],{},"当初是使用 pacman 更新时遇上了「GPGME 错误：无数据」的问题，我尝试复现了下，大概是下面这样的情况。",[217,892,895],{"className":893,"code":894,"language":222},[220],"[zhullyb@Archlinux ~]$ sudo pacman -Syu\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n:: 正在同步软件包数据库...\n core                                137.6 KiB   598 KiB/s 00:00 [------------------------------------] 100%\n extra                              1566.0 KiB  6.12 MiB/s 00:00 [------------------------------------] 100%\n community                             6.0 MiB  20.6 MiB/s 00:00 [------------------------------------] 100%\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：未能同步所有数据库（无效或已损坏的数据库 (PGP 签名)）\n",[101,896,894],{"__ignoreMap":67},[17,898,899],{},"英文版的提示应该是长成下面这个样子",[217,901,904],{"className":902,"code":903,"language":222},[220],"[zhullyb@Archlinux ~]$ sudo pacman -Syu\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: GPGME error: No data\n:: Synchronizing package databases...\n core                                137.6 KiB   574 KiB/s 00:00 [------------------------------------] 100%\n extra                              1566.0 KiB  5.66 MiB/s 00:00 [------------------------------------] 100%\n community                             6.0 MiB  18.1 MiB/s 00:00 [------------------------------------] 100%\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: failed to synchronize all databases (invalid or corrupted database (PGP signature))\n",[101,905,903],{"__ignoreMap":67},[106,907,908],{"id":908},"解决方案",[217,910,913],{"className":911,"code":912,"language":222},[220],"sudo rm /var/lib/pacman/sync/*.sig\n",[101,914,912],{"__ignoreMap":67},[17,916,917],{},"很简单，就这一条命令就够了。",[106,919,920],{"id":920},"问题原因",[17,922,923,924,927,928,931],{},"pacman在更新数据库文件时也会尝试下载",[101,925,926],{},"$repo.db.sig","，这里的",[101,929,930],{},"$repo","可以是 core、extra、community、archlinuxcn 等仓库名。",[17,933,934,935,939,940,673],{},"但是无论是官方源还是 archlinuxcn 源，",[936,937,938],"strong",{},"大多数源的数据库文件","都不会被签名，也就",[936,941,942],{},"不会存在 .db.sig 文件",[17,944,945,946,949],{},"pacman 尝试下载时这些数据库文件的签名文件时，镜像站就会返回 ",[936,947,948],{},"404 的 http 状态码","告诉pacman: “你个傻叉，神他妈没有这个文件！”",[17,951,952],{},"pacman 挨了一顿骂，也就善罢甘休，没有再动这个念头，所以我们每次更新也都相安无事。",[17,954,955,956,673],{},"而出现这种错误的情况大多是发生在 校园网、酒店免费 WIFI 这种",[936,957,958],{},"需要登陆以后才能上网的网络环境",[17,960,961,962,965,966,968,969,971],{},"因为 pacman 尝试下载 ",[101,963,964],{},".db.sig"," 文件时被登陆网页劫持了（这点你们应该深有感受，如果你在这种网络环境下没有登陆，你无论访问什么网页都会被重定向到登录界面，http 的状态码此时是200，不是404）。从没见过 ",[101,967,964],{},"的 pacman 此时两眼放光，由于没有挨骂，他就迅速地把登录界面当成是",[101,970,964],{},"下载下来了。",[17,973,974,975,977],{},"下载下来以后，pacman 激动地摆弄起 ",[101,976,964],{},"，甚至发现里面没有自己期待已久的 GPG签名数据并开始报错时仍然不愿意撒手，因此此时无论再怎么同步源码、再怎么 Syyu 也不会有效果，必须人工干预。",{"title":67,"searchDepth":88,"depth":88,"links":979},[980,981,982],{"id":887,"depth":88,"text":887},{"id":908,"depth":88,"text":908},{"id":920,"depth":88,"text":920},{"title":984,"date":985,"path":986,"tags":987,"body":989},"Cutefish的前世今生","2021-12-12 00:10:34","/2021/12/12/the-history-of-cutefish",[988],"OpenSource Project",{"type":14,"value":990,"toc":1290},[991,997,1000,1003,1006,1009,1013,1017,1020,1026,1037,1041,1044,1073,1076,1085,1089,1097,1106,1110,1128,1131,1140,1144,1149,1152,1201,1204,1218,1220],[992,993,994],"blockquote",{},[17,995,996],{},"CutefishOS是由我们国内的开发者主导（目前也主要是他们在开发）的桌面环境。不过似乎对于他的前世今生，似乎很多人都有误解。尤其是很多人认为他是一个Archlinux-based发行版；部分用户分不清他到底是基于Debian还是基于Ubuntu；还有人把它和 JingOS 弄混了。",[17,998,999],{},"先把这些问题的回答写在最前面:",[17,1001,1002],{},"CutefishOS 是一个基于Debian的发行版，他的前身 CyberOS 是一个基于 Archlinux 的发行版。但要注意: Cutefish （不加OS）可以单独指代 CutefishOS 所使用的桌面环境，为了避免混淆，本文中我将使用CutefishDE来指代他的桌面环境。",[17,1004,1005],{},"CutefishOS 和 JingOS 目前只是官网互加友链的关系，并不是相同的东西。Cutefish的开发方向是基于qt重写一套UI，而JingOS则更像是在开发一套KDE的主题。",[1007,1008],"hr",{},[106,1010,1012],{"id":1011},"cutefish的历史","Cutefish的历史",[678,1014,1016],{"id":1015},"cyberos的故事","CyberOS的故事",[17,1018,1019],{},"第一次体验到这个UI其实是在21年的3月，在Archlinux的QQ群里，群主向我们推荐了 CyberOS ，这是一个基于 Archlinux 的发行版。",[17,1021,1022],{},[65,1023],{"alt":1024,"src":1025},"QQ群公告","https://static.031130.xyz/uploads/2024/08/12/62f3cae911901.webp",[17,1027,1028,1029],{},"由于基于 Archlinux，我直接就添加了CyberOS的源作为第三方源安装上了CyberDE，",[298,1030,1031,1032,673],{},"那会儿还顺手水了篇博客，由于后来事情发展太快，这篇博客早就不适用了，就干脆删了，现在在我的Github还能找到那会儿的",[27,1033,1036],{"href":1034,"rel":1035},"https://github.com/zhullyb/blog/blob/20210430/_posts/2021-03-21-install-cyber-desktop-on-your-archlinux.md",[31],"存档",[678,1038,1040],{"id":1039},"更名cutefishos","更名CutefishOS",[17,1042,1043],{},"后来根据 CutefishOS 的QQ群的群主所说，是因为当时没注重海外平台的宣发，导致 CyberOS 的用户名在 Twitter 被抢注，因此决定改名 CutefishOS 。由于时间较为久远，QQ群的聊天记录已经几乎找不到了，我无法放出。",[17,1045,1046,1047,1057,1065],{},"关于CutefishOS的创始时间我已经记不清了，但是可以推测是在21年的4~5月份左右。",[1048,1049,1050],"sup",{},[27,1051,1056],{"href":1052,"ariaDescribedBy":1053,"dataFootnoteRef":67,"id":1055},"#user-content-fn-1",[1054],"footnote-label","user-content-fnref-1","1",[1048,1058,1059],{},[27,1060,1064],{"href":1061,"ariaDescribedBy":1062,"dataFootnoteRef":67,"id":1063},"#user-content-fn-2",[1054],"user-content-fnref-2","2",[1048,1066,1067],{},[27,1068,1072],{"href":1069,"ariaDescribedBy":1070,"dataFootnoteRef":67,"id":1071},"#user-content-fn-3",[1054],"user-content-fnref-3","3",[678,1074,1075],{"id":1075},"官网上线",[17,1077,1078,1079,1084],{},"21年5月12日，",[27,1080,1083],{"href":1081,"rel":1082},"https://cutefishos.com",[31],"cutefishos.com"," 上线，暂时不提供安装镜像。",[678,1086,1088],{"id":1087},"进军arch系","进军Arch系",[17,1090,1091,1092,673],{},"5月26日，CutefishDE进入 ",[27,1093,1096],{"href":1094,"rel":1095},"https://archlinux.org/groups/x86_64/cutefish/",[31],"Archlinux官方源",[17,1098,1099,1100,1105],{},"同日，Github 组织 manjaro-cutefish 放出了使用 CutefishDE 的 ",[27,1101,1104],{"href":1102,"rel":1103},"https://github.com/manjaro-cutefish/download/releases",[31],"manjaro安装镜像","。这个组织和官方的 github.com/cutefishos 没有共同维护者，因此可以基本断定是第三方打包的。",[678,1107,1109],{"id":1108},"ubuntu第三方打包版的跟进","Ubuntu第三方打包版的跟进",[17,1111,1112,1113,1121,1122,1127],{},"大约在7月中旬左右",[1048,1114,1115],{},[27,1116,1120],{"href":1117,"ariaDescribedBy":1118,"dataFootnoteRef":67,"id":1119},"#user-content-fn-4",[1054],"user-content-fnref-4","4","，Github出现了一位名为 cutefish-ubuntu 的用户，开始在 Ubutnu 上编译 CutefishDE ，并通过 ",[27,1123,1126],{"href":1124,"rel":1125},"https://cutefish-ubuntu.github.io/",[31],"GithubPages"," 发布安装镜像，依然是第三方打包的安装镜像。",[678,1129,1130],{"id":1130},"官方版本释出",[17,1132,1133,1134,1139],{},"21年国庆长假期间，cutefishos.com 释出由 Cutefish官方发布的",[27,1135,1138],{"href":1136,"rel":1137},"https://cutefishos.com/download",[31],"基于Debian的CutefishOS镜像","，搭载的DE是 0.5 版本的，英文版网页提供 Google Drive 和 Mega 的下载链接，中文版本网页非常贴心地添加了使用飞书下载的方式方便国内用户下载。",[678,1141,1143],{"id":1142},"rpm系的跟进","RPM系的跟进",[1145,1146,1148],"h4",{"id":1147},"copr","COPR",[17,1150,1151],{},"copr上分别有三名用户打包了CutefishDE/CyberDE，我以表格形式简单罗列一下",[302,1153,1154,1167],{},[305,1155,1156],{},[308,1157,1158,1161,1164],{},[311,1159,1160],{},"用户名",[311,1162,1163],{},"打包的DE",[311,1165,1166],{},"第一次打包日期",[335,1168,1169,1180,1191],{},[308,1170,1171,1174,1177],{},[340,1172,1173],{},"rmnscnce",[340,1175,1176],{},"cutefish",[340,1178,1179],{},"2021.8.19",[308,1181,1182,1185,1188],{},[340,1183,1184],{},"cappyishihara",[340,1186,1187],{},"cyber",[340,1189,1190],{},"2021.11.17",[308,1192,1193,1196,1198],{},[340,1194,1195],{},"jesonlay",[340,1197,1176],{},[340,1199,1200],{},"2021.12.06",[1145,1202,1203],{"id":1203},"论坛用户",[17,1205,1206,1207,1212,1213,673],{},"21年12月2日，一为名为",[27,1208,1211],{"href":1209,"rel":1210},"https://bbs.cutefishos.com/u/gesangtome",[31],"gesangtome","的网友在CutefishOS的论坛上",[27,1214,1217],{"href":1215,"rel":1216},"https://bbs.cutefishos.com/d/331-fedoracutefish",[31],"发布了自己编译的CutefishDE",[1007,1219],{},[1221,1222,1225,1230],"section",{"className":1223,"dataFootnotes":67},[1224],"footnotes",[106,1226,1229],{"className":1227,"id":1054},[1228],"sr-only","Footnotes",[1231,1232,1233,1247,1261,1275],"ol",{},[47,1234,1236,1237,1239,1240],{"id":1235},"user-content-fn-1","通过whois查询得知",[101,1238,1083],{}," 这个域名注册时间为21年3月31日 ",[27,1241,1246],{"href":1242,"ariaLabel":1243,"className":1244,"dataFootnoteBackref":67},"#user-content-fnref-1","Back to reference 1",[1245],"data-footnote-backref","↩",[47,1248,1250,1255,1256],{"id":1249},"user-content-fn-2",[27,1251,1254],{"href":1252,"rel":1253},"https://github.com/archlinux/svntogit-community/commit/b92bb9ae8fd35178cdfebb6f56b55f20722aa7dd",[31],"Cutefish进入Archlinux官方源","是在5月26日 ",[27,1257,1246],{"href":1258,"ariaLabel":1259,"className":1260,"dataFootnoteBackref":67},"#user-content-fnref-2","Back to reference 2",[1245],[47,1262,1264,1269,1270],{"id":1263},"user-content-fn-3",[27,1265,1268],{"href":1266,"rel":1267},"https://github.com/cyberos",[31],"CyberOS的Github仓库","最后一次内容变更是在21年的5月23日 ",[27,1271,1246],{"href":1272,"ariaLabel":1273,"className":1274,"dataFootnoteBackref":67},"#user-content-fnref-3","Back to reference 3",[1245],[47,1276,1278,1279,1284,1285],{"id":1277},"user-content-fn-4","这里参考的是 cutefish-ubuntu/cutefish-ubuntu.github.io 仓库的",[27,1280,1283],{"href":1281,"rel":1282},"https://github.com/cutefish-ubuntu/cutefish-ubuntu.github.io/commit/237a480992a74d8c75c1f4ec51511550ce97c64b",[31],"第一个commit","的时间 ",[27,1286,1246],{"href":1287,"ariaLabel":1288,"className":1289,"dataFootnoteBackref":67},"#user-content-fnref-4","Back to reference 4",[1245],{"title":67,"searchDepth":88,"depth":88,"links":1291},[1292,1301],{"id":1011,"depth":88,"text":1012,"children":1293},[1294,1295,1296,1297,1298,1299,1300],{"id":1015,"depth":789,"text":1016},{"id":1039,"depth":789,"text":1040},{"id":1075,"depth":789,"text":1075},{"id":1087,"depth":789,"text":1088},{"id":1108,"depth":789,"text":1109},{"id":1130,"depth":789,"text":1130},{"id":1142,"depth":789,"text":1143},{"id":1054,"depth":88,"text":1229},{"title":1303,"date":1304,"path":1305,"tags":1306,"body":1308},"wolai再打包遇到的问题--electron应用的dev判断机制","2021-12-03 22:53:25","/2021/12/03/dev-app-update-in-wolai",[882,1307],"electron",{"type":14,"value":1309,"toc":1546},[1310,1323,1329,1332,1344,1347,1355,1360,1367,1376,1404,1407,1410,1495,1498,1504,1507,1543],[17,1311,1312,1313,1318,1319,1322],{},"之前对于electron懵懵懂懂的时候就把 ",[27,1314,1317],{"href":1315,"rel":1316},"https://www.wolai.com/",[31],"wolai"," 给打包上了 AUR ，那会儿年少无知，也不懂得把内置的 electron 拆开来换成系统内置的以节省空间。前一阵子给CN源打完 Motrix 以后突然想起来自己在 AUR 上还有维护一个叫 wolai 的electron 应用，于是打算把软件内置的 electron 拆出来。尝试使用 ",[101,1320,1321],{},"electron /path/to/app.asar"," 命令启动的时候发现了以下的问题。",[17,1324,1325],{},[65,1326],{"alt":1327,"src":1328},"报错了","https://static.031130.xyz/uploads/2024/08/12/62f3caf822bec.webp",[17,1330,1331],{},"虽然这个报错无关紧要，直接右上角叉掉也不影响软件正常使用，但是就这样推上 AUR 似乎有些不太妥当。于是使用搜索引擎查找答案。",[17,1333,1334,1335,1338,1339],{},"发现是使用系统自带的 electron 启动时，app.asar 内置的一个叫 ",[101,1336,1337],{},"electron-updater"," 的模块在自动检测更新时会误认为我们此时处于开发模式，于是会尝试读取 app.asar 内部的 dev-app-update.yml 以查询更新。",[1048,1340,1341],{},[27,1342,1056],{"href":1052,"ariaDescribedBy":1343,"dataFootnoteRef":67,"id":1055},[1054],[17,1345,1346],{},"但问题在于这个 app.asar 并不是 wolai 开发者在开发时使用 development 模式打出来的包，应该是 production ，所以内置的那个文件名叫 app-update.yml ，少了个dev 前缀，就很尴尬。",[17,1348,1349,1350],{},"以下内容来自一篇简书的文章",[1048,1351,1352],{},[27,1353,1064],{"href":1061,"ariaDescribedBy":1354,"dataFootnoteRef":67,"id":1063},[1054],[992,1356,1357],{},[17,1358,1359],{},"所以调试的时候可以建一个default-app.yml文件放在D:\\hzhh123\\workspace\\vue-work\\electron-demo1\\node_modules\\electron\\dist\\resources\\default_app.asar 下，这里就涉及到asar解压缩，但是这样会很麻烦，打包后也需要这样替换，麻烦，所幸electron-updater中提供了这个文件的属性配置updateConfigPath，可以通过设置这个属性来解决这个问题",[17,1361,1362,1363,1366],{},"很遗憾，我们并不是该应用的开发者，并不能指定",[101,1364,1365],{},"electron-uploader","构建时的参数，所以只能考虑解压缩 app.asar 手动放入 dev-app-update.yml 的方案。",[17,1368,1369,1370,1375],{},"根据又一篇简书的文章",[1048,1371,1372],{},[27,1373,1072],{"href":1069,"ariaDescribedBy":1374,"dataFootnoteRef":67,"id":1071},[1054],"，我们了解到 npm 中有一个叫 asar 的程序可以帮助我们解压缩 app.asar。我这里直接将内容搬过来",[992,1377,1378,1381,1392,1395],{},[17,1379,1380],{},"解压",[217,1382,1386],{"className":1383,"code":1384,"language":1385,"meta":67,"style":67},"language-undefined shiki shiki-themes one-light one-dark-pro","asar extract 压缩文件  解压文件夹\n","undefined",[101,1387,1388],{"__ignoreMap":67},[692,1389,1390],{"class":694,"line":695},[692,1391,1384],{},[17,1393,1394],{},"压缩：如果压缩文件存在，则会被替换",[217,1396,1398],{"className":1383,"code":1397,"language":1385,"meta":67,"style":67},"asar pack 文件夹  压缩文件名\n",[101,1399,1400],{"__ignoreMap":67},[692,1401,1402],{"class":694,"line":695},[692,1403,1397],{},[17,1405,1406],{},"原文是让我们直接使用 npm 下载安装 asar 程序，然而这就会让打包过程变得很复杂，所幸 Archlinux 官方源中已经将这个程序打完了，我们可以直接将 asar 写入 makedepends。",[17,1408,1409],{},"大概就写成了这个样子。",[217,1411,1413],{"className":686,"code":1412,"language":688,"meta":67,"style":67},"asar extract ${srcdir}/squashfs-root/resources/app.asar ${srcdir}/new_app\nmv  ${srcdir}/squashfs-root/resources/app-update.yml ${srcdir}/new_app/dev-app-update.yml\nasar pack ${srcdir}/new_app ${srcdir}/squashfs-root/resources/app.asar\n",[101,1414,1415,1446,1470],{"__ignoreMap":67},[692,1416,1417,1420,1423,1427,1431,1434,1437,1439,1441,1443],{"class":694,"line":695},[692,1418,1419],{"class":698},"asar",[692,1421,1422],{"class":702}," extract",[692,1424,1426],{"class":1425},"sr1Ac"," ${",[692,1428,1430],{"class":1429},"sJa8x","srcdir",[692,1432,1433],{"class":1425},"}",[692,1435,1436],{"class":702},"/squashfs-root/resources/app.asar",[692,1438,1426],{"class":1425},[692,1440,1430],{"class":1429},[692,1442,1433],{"class":1425},[692,1444,1445],{"class":702},"/new_app\n",[692,1447,1448,1451,1454,1456,1458,1461,1463,1465,1467],{"class":694,"line":88},[692,1449,1450],{"class":698},"mv",[692,1452,1453],{"class":1425},"  ${",[692,1455,1430],{"class":1429},[692,1457,1433],{"class":1425},[692,1459,1460],{"class":702},"/squashfs-root/resources/app-update.yml",[692,1462,1426],{"class":1425},[692,1464,1430],{"class":1429},[692,1466,1433],{"class":1425},[692,1468,1469],{"class":702},"/new_app/dev-app-update.yml\n",[692,1471,1472,1474,1477,1479,1481,1483,1486,1488,1490,1492],{"class":694,"line":789},[692,1473,1419],{"class":698},[692,1475,1476],{"class":702}," pack",[692,1478,1426],{"class":1425},[692,1480,1430],{"class":1429},[692,1482,1433],{"class":1425},[692,1484,1485],{"class":702},"/new_app",[692,1487,1426],{"class":1425},[692,1489,1430],{"class":1429},[692,1491,1433],{"class":1425},[692,1493,1494],{"class":702},"/squashfs-root/resources/app.asar\n",[17,1496,1497],{},"程序正常启动，没有弹出之前的对话框了。",[17,1499,1500],{},[65,1501],{"alt":1502,"src":1503},"成功啦","https://static.031130.xyz/uploads/2024/08/12/62f3cafb6b04d.webp",[17,1505,1506],{},"参考:",[1221,1508,1510,1513],{"className":1509,"dataFootnotes":67},[1224],[106,1511,1229],{"className":1512,"id":1054},[1228],[1231,1514,1515,1525,1534],{},[47,1516,1517,1521,1522],{"id":1235},[27,1518,1519],{"href":1519,"rel":1520},"https://github.com/electron-userland/electron-builder/issues/1505",[31]," ",[27,1523,1246],{"href":1242,"ariaLabel":1243,"className":1524,"dataFootnoteBackref":67},[1245],[47,1526,1527,1521,1531],{"id":1249},[27,1528,1529],{"href":1529,"rel":1530},"https://www.jianshu.com/p/15bde714e198",[31],[27,1532,1246],{"href":1258,"ariaLabel":1259,"className":1533,"dataFootnoteBackref":67},[1245],[47,1535,1536,1521,1540],{"id":1263},[27,1537,1538],{"href":1538,"rel":1539},"https://www.jianshu.com/p/17d97e6bf174",[31],[27,1541,1246],{"href":1272,"ariaLabel":1273,"className":1542,"dataFootnoteBackref":67},[1245],[866,1544,1545],{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sr1Ac, html code.shiki .sr1Ac{--shiki-default:#E45649;--shiki-dark:#ABB2BF}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":67,"searchDepth":88,"depth":88,"links":1547},[1548],{"id":1054,"depth":88,"text":1229},{"title":1550,"date":1551,"path":1552,"tags":1553,"body":1555},"Typora与我","2021-11-26 23:05:05","/2021/11/26/typora-and-me",[1554],"Casual Talk",{"type":14,"value":1556,"toc":1649},[1557,1560,1563,1566,1568,1571,1580,1583,1589,1596,1598,1609,1612,1622,1625,1635],[17,1558,1559],{},"Typora 要收费了，$14.9 买断制，支持三设备激活。而且尚且不知道这里买断的是单个大版本更新还是多个大版本更新。",[17,1561,1562],{},"很多人说，不要紧，我们有VsCode、我们有Vnote、我们有MarkText。。。",[17,1564,1565],{},"但我还是不习惯。",[1007,1567],{},[17,1569,1570],{},"Typora真的就是个非常纯粹的Markdown编辑器，他有所见即所得的视觉效果，同时为我提供了沉浸式的写作体验。",[17,1572,1573,1574,1579],{},"当我在使用Typora写文章的时候，我就是个非常单纯的内容创作者，我不需要去考虑各种Markdown的语法格式，我只需要用文字写下我所想的，然后通过右键菜单把文字的样式调整到一个能够合理突出主次的程度，便完成了。若是用的时间长了，记住了打开菜单时旁边现实的快捷键，那速度便更快了。即使有插入图片/视频的需求，我也只需要将图片复制进 Typora 的编辑框，我在Typora预先设置好的自定义上传命令会自动调用我部署在本地的",[27,1575,1578],{"href":1576,"rel":1577},"https://github.com/xiebruce/PicUploader",[31],"PicUploader","完成上传，并将媒体文件以 Markdown/html 语法呈现在编辑框中。",[17,1581,1582],{},"这样一来，我的行文思路就是连贯、不受打断的。即使需要从系统中截取一些图片作说明用途，我也可以通过 Flameshot 截取图片并简单画几个箭头、标几个序号或者框几个按钮后复制到剪切板，并最终粘贴到Typora的编辑框中，整个过程就像是我在和别人QQ聊天时截个图发过去一般简单。",[17,1584,1585],{},[65,1586],{"alt":1587,"src":1588},"gif缩略图有点小，建议是点开来看","https://static.031130.xyz/uploads/2024/08/12/62f3b881e3c4c.gif",[17,1590,1591,1592,1595],{},"倘若我使用别的Markdown编辑器，我便需要将图片保存到本地、手动上传到图床、手动写markdown的",[101,1593,1594],{},"![]()","语法，如此一来，我的精力就被分散了，那我也就不会有为文章插入图片的兴趣，抑或是插入完某张图片以后深感心力憔悴，便把写了一半的文章束之高阁，欺骗自己将来有一天我会继续完成这篇文章。",[1007,1597],{},[17,1599,1600],{},[298,1601,1602,1603,1608],{},"总而言之，Typora对于我而言确实是非常有用的工具，而我将在接下来的半年到一年时间中过渡到其他的开源Markdown编辑器中。即使改变我的使用习惯将是一件非常痛苦的事情，但我不得不这么做。Typora内置的electron在Archlinux的滚动更新下不知道过多久会出现与系统不兼容的情况",[1048,1604,1605],{},[27,1606,1056],{"href":1052,"ariaDescribedBy":1607,"dataFootnoteRef":67,"id":1055},[1054],"，所以这意味着继续使用老版本的Typora并不是长久之策，我需要在此之前尽快切换到其他的Markdown编辑器。而我不是个商业公司的Markdown工程师，单纯为了个人兴趣而花大价钱去买这一款生产力工具却无法得到经济回馈似乎并不是一个明智的选择。",[17,1610,1611],{},"反转了，仔细阅读Typora官网的Q&A后发现了这么一条:",[992,1613,1614,1619],{},[17,1615,1616],{},[936,1617,1618],{},"Can I use Typora for free ?",[17,1620,1621],{},"You will have a 15 days free trial before the purchase. If you use  dev version or Linux version, you will have unlimited trial time if you  keep Typora updated. But we may show “trial button” or disable certain  features to encourage you to purchase our app, but basic and most  functions will be kept.",[17,1623,1624],{},"看起来 Dev 版和 Linux版本在最新版本可以无限试用下去，那我不考虑改变我的写作习惯了。",[992,1626,1627],{},[17,1628,1629,1630],{},"注: Dev 版藏得有点深，在",[27,1631,1634],{"href":1632,"rel":1633},"https://typora.io/releases/dev",[31],"这里",[1221,1636,1638,1641],{"className":1637,"dataFootnotes":67},[1224],[106,1639,1229],{"className":1640,"id":1054},[1228],[1231,1642,1643],{},[47,1644,1645,1646],{"id":1235},"baidunetdisk-bin内置的electron已经无法在如今的Archlinux上跑起来了，目前唯一的解决方案是拆包、并使用系统级的electron去启动百度网盘，也就是AUR的baidunetdisk-electron。但是typora运用了一些混淆/加密的手段，使得只有他内置的electron才可以正确启动程序。 ",[27,1647,1246],{"href":1242,"ariaLabel":1243,"className":1648,"dataFootnoteBackref":67},[1245],{"title":67,"searchDepth":88,"depth":88,"links":1650},[1651],{"id":1054,"depth":88,"text":1229},{"title":1653,"date":1654,"path":1655,"tags":1656,"body":1658},"我是来吹CloudflareMirrors的","2021-11-21 01:48:49","/2021/11/21/use-cloudflare-mirrors",[1657],"Cloudflare",{"type":14,"value":1659,"toc":1734},[1660,1669,1672,1679,1682,1687,1716,1723,1728,1731],[17,1661,1662,1663,1668],{},"Cloudflare也开始提供",[27,1664,1667],{"href":1665,"rel":1666},"https://cloudflaremirrors.com/",[31],"Linux开源镜像站","了。",[17,1670,1671],{},"虽然在中国大陆地区，Cloudflare速度日常抽风，不适合作为我们本机镜像源，但完全可以用于境外VPS。平常我们对国内的镜像站比较熟悉，也知道自己的网络环境使用哪个镜像站会稍微快一些，但一旦出了国，这些经验就没有用了。",[17,1673,1674,1675,1678],{},"作为一家老牌的CDN网站加速服务提供商，Cloudflare提供的网络服务在全球范围内都非常快（",[298,1676,1677],{},"嗯，对，全球范围不包含中国大陆","）",[17,1680,1681],{},"无论你的vps是在美国日本，还是香港新加坡，cloudflare都能提供非常稳定高速的服务，只需要记住cloudflare镜像站的域名，便可以抛弃挑选镜像站的烦恼。",[17,1683,1684],{},[65,1685],{"alt":67,"src":1686},"https://static.031130.xyz/uploads/2024/08/12/62f3c9a9448a4.webp",[17,1688,1689,1690,1693,1694,1698,1699,1704,1705,1698,1710,1715],{},"根据网页上所说，cloudflare会以「反代就近的镜像站」+「缓存」的形式来提供服务，",[298,1691,1692],{},"既然都要通过cloudflare网络，那中国大陆地区就可以彻底别想了","，能够给几乎所有地区提供不错的服务。目前说是只提供了「",[27,1695,882],{"href":1696,"rel":1697},"https://cloudflaremirrors.com/archlinux/",[31],"」和「",[27,1700,1703],{"href":1701,"rel":1702},"https://cloudflaremirrors.com/debian/",[31],"Debian","」的服务，但是根据我考证下来，其实「",[27,1706,1709],{"href":1707,"rel":1708},"https://cloudflaremirrors.com/ubuntu/",[31],"Ubuntu",[27,1711,1714],{"href":1712,"rel":1713},"https://cloudflaremirrors.com/centos/",[31],"CentOS","」也有，只不过没写在页面上罢了。那么废话不多说，我们上境外的vps测一下下载速度如何。",[17,1717,1718,1722],{},[27,1719,1721],{"href":1665,"rel":1720},[31],"cloudflaremirrors"," 在我这台位于美国达拉斯机房的1Gbps机器上可以跑到80MB/s+的速度，虽然没有跑满理论速率，但也算是相当喜人的成绩了。",[17,1724,1725],{},[65,1726],{"alt":67,"src":1727},"https://static.031130.xyz/uploads/2024/08/12/62f3ccc8d7c82.webp",[17,1729,1730],{},"小结:",[17,1732,1733],{},"CloudflareMirrors非常适合境外的vps使用，免去了用户自行给一个个镜像站测速的麻烦。",{"title":67,"searchDepth":88,"depth":88,"links":1735},[],{"title":1737,"date":1738,"path":1739,"tags":1740,"body":1743},"deepin-elf-verify究竟是何物？","2021-11-20","/2021/11/20/what-is-deepin-elf-verify",[1741,1742],"deepin","Linux",{"type":14,"value":1744,"toc":2007},[1745,1747,1761,1764,1784,1817,1820,1825,1832,1835,1841,1844,1852,1855,1861,1866,1884,1912,1915,1920,1927,1933,1939,1942,1946,1952,1955,1984,1988,1993,1999,2004],[106,1746,636],{"id":636},[17,1748,1749,1750,1753,1754,1757,1758,1760],{},"越来越多上架在 Deepin 应用商店中的 deb 包中开始依赖了一个叫做 ",[101,1751,1752],{},"deepin-elf-verify"," 的依赖，今天来讲讲这个",[298,1755,1756],{},"神奇","的 ",[101,1759,1752],{}," 到底为何物，为什么这么多程序都要依赖于他来工作。",[106,1762,1763],{"id":1763},"下载拆包",[17,1765,1766,1767,1772,1773,1778,1779,1781,1782,673],{},"打开 ",[27,1768,1771],{"href":1769,"rel":1770},"https://mirrors.bfsu.edu.cn/",[31],"Bfsu镜像站"," ，可以很轻松地找到 ",[27,1774,1777],{"href":1775,"rel":1776},"https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages",[31],"Packages"," —— 在 apt 源中记录了各个文件信息（包括他在仓库中的相对位置）的这么一个",[206,1780,1756],{},"的文件，就是体积有点大，达到了68MB的样子。我们可以通过以下命令检索今天的主角——",[101,1783,1752],{},[217,1785,1787],{"className":686,"code":1786,"language":688,"meta":67,"style":67},"curl -s https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages | grep deepin-elf-sign | grep pool\n",[101,1788,1789],{"__ignoreMap":67},[692,1790,1791,1794,1797,1800,1804,1807,1810,1812,1814],{"class":694,"line":695},[692,1792,1793],{"class":698},"curl",[692,1795,1796],{"class":814}," -s",[692,1798,1799],{"class":702}," https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages",[692,1801,1803],{"class":1802},"s5ixo"," | ",[692,1805,1806],{"class":698},"grep",[692,1808,1809],{"class":702}," deepin-elf-sign",[692,1811,1803],{"class":1802},[692,1813,1806],{"class":698},[692,1815,1816],{"class":702}," pool\n",[17,1818,1819],{},"得到了输出:",[992,1821,1822],{},[17,1823,1824],{},"Filename: pool/main/d/deepin-elf-verify/deepin-elf-verify_0.2.0.6-1_amd64.deb",[17,1826,1827,1828],{},"我们就可以把完整的下载链接拼出来: ",[27,1829,1830],{"href":1830,"rel":1831},"https://mirrors.bfsu.edu.cn/deepin/pool/main/d/deepin-elf-verify/deepin-elf-verify_0.2.0.6-1_amd64.deb",[31],[17,1833,1834],{},"下载解压，大概是这么一个目录结构:",[217,1836,1839],{"className":1837,"code":1838,"language":222},[220],"deepin-elf-verify_0.2.0.6-1_amd64\n├── control.tar.xz\n├── data.tar.xz\n└── debian-binary\n",[101,1840,1838],{"__ignoreMap":67},[17,1842,1843],{},"是个常规的deb包该有的结构了。",[44,1845,1846,1849],{},[47,1847,1848],{},"control.tar.xz 中存放了deb包的相关信息",[47,1850,1851],{},"data.tar.xz 是整个包最终会被安装到系统中的文件",[17,1853,1854],{},"终于到了激动人心的时刻了，打开 data.tar.xz ！",[17,1856,1857],{},[65,1858],{"alt":1859,"src":1860},"空的？","https://static.031130.xyz/uploads/2024/08/12/62f3ccc192986.webp",[17,1862,1863],{},[936,1864,1865],{},"搞错了，再来",[17,1867,1868,1869,1874,1875,1877,1878,1880,1881,1883],{},"打开UOS的",[27,1870,1873],{"href":1871,"rel":1872},"https://uos.deepin.cn/uos/",[31],"源链接","，使用",[101,1876,1793],{},"+",[101,1879,1806],{},"检索",[101,1882,1752],{},"在源中的相对位置",[217,1885,1887],{"className":686,"code":1886,"language":688,"meta":67,"style":67},"curl -sL https://uos.deepin.cn/uos/dists/eagle/main/binary-amd64/Packages | grep deepin-elf-verify | grep pool\n",[101,1888,1889],{"__ignoreMap":67},[692,1890,1891,1893,1896,1899,1901,1903,1906,1908,1910],{"class":694,"line":695},[692,1892,1793],{"class":698},[692,1894,1895],{"class":814}," -sL",[692,1897,1898],{"class":702}," https://uos.deepin.cn/uos/dists/eagle/main/binary-amd64/Packages",[692,1900,1803],{"class":1802},[692,1902,1806],{"class":698},[692,1904,1905],{"class":702}," deepin-elf-verify",[692,1907,1803],{"class":1802},[692,1909,1806],{"class":698},[692,1911,1816],{"class":702},[17,1913,1914],{},"获得输出:",[992,1916,1917],{},[17,1918,1919],{},"Filename: pool/main/d/deepin-elf-verify/deepin-elf-verify_0.0.14.5-1_amd64.deb\nFilename: pool/main/d/deepin-elf-verify/deepin-elf-verify-dbgsym_0.0.14.5-1_amd64.deb",[17,1921,1922,1923],{},"拼接为链接: ",[27,1924,1925],{"href":1925,"rel":1926},"https://uos.deepin.cn/uos/pool/main/d/deepin-elf-verify/deepin-elf-verify_0.0.14.5-1_amd64.deb",[31],[17,1928,1929,1930],{},"下载后打开 ",[101,1931,1932],{},"data.tar.xz",[17,1934,1935],{},[65,1936],{"alt":1937,"src":1938},"看来还是有东西的","https://static.031130.xyz/uploads/2024/08/12/62f3ccc53d544.webp",[106,1940,1941],{"id":1941},"说说结论吧",[678,1943,1945],{"id":1944},"对于uos","对于UOS",[17,1947,1948,1949,1951],{},"在UOS下，",[101,1950,1752],{},"用于检测用户运行的进程是否被deepin信任的证书签名过，虽然有些过于限制用户，对于一个将要广泛用于政府机关的发行版而言是可以理解的。",[678,1953,1954],{"id":1954},"对于deepin",[44,1956,1957,1962,1971],{},[47,1958,1959,1961],{},[101,1960,1752],{}," 在 deepin 上就是个空包。",[47,1963,1964,1965,1967,1968,1970],{},"当我们使用 deepin 安装一个含有 ",[101,1966,1752],{}," 的软件包时，apt 会自动从源内搜索并安装 ",[101,1969,1752],{},"，由于是个空包，他对于系统不会有任何负担。",[47,1972,1973,1974,1976,1977,1980,1981,1983],{},"大多数依赖",[101,1975,1752],{},"的程序都把依赖写成了",[101,1978,1979],{},"deepin-elf-verify (>= 0.0.16.7-1)","，而在deepin源中，",[101,1982,1752],{},"版本号是 0.2.0.6，因此在未来的很长一段时间里应该都是满足要求的，说明统信那边并没有「想要让deepin装不上UOS的包」的这种想法，可见在这一点上，统信还没有明显的偏心。",[678,1985,1987],{"id":1986},"在别的deb发行版下","在别的Deb发行版下",[17,1989,1990,1992],{},[101,1991,1752],{},"存在于、并且仅仅存在于 deepin 和 UOS 的源内。",[17,1994,1995,1996,1998],{},"而当我们使用别的 deb 发行版（如Debian、Ubuntu）时，apt 无法在他们自己的源内找到 ",[101,1997,1752],{}," ，apt就会报错并且停止安装。",[17,2000,2001],{},[936,2002,2003],{},"小结: 至于其最终目的，是为了__________________________",[866,2005,2006],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":67,"searchDepth":88,"depth":88,"links":2008},[2009,2010,2011],{"id":636,"depth":88,"text":636},{"id":1763,"depth":88,"text":1763},{"id":1941,"depth":88,"text":1941,"children":2012},[2013,2014,2015],{"id":1944,"depth":789,"text":1945},{"id":1954,"depth":789,"text":1954},{"id":1986,"depth":789,"text":1987},127,1761738552191]