[{"data":1,"prerenderedAt":2603},["ShallowReactive",2],{"randomIndex/archives/page/8/":3,"index-page-8":4,"posts-nums-total":2602},17,[5,149,251,715,870,1103,1314,1719,2083,2167],{"title":6,"date":7,"path":8,"tags":9,"body":12},"使用 VirtScreen 将 Pad 作为副屏","2022-10-04 00:19:20","/2022/10/04/use-virtscreen-to-turn-pad-into-another-screen",[10,11],"Linux","Hardware",{"type":13,"value":14,"toc":137},"minimark",[15,22,33,37,40,48,64,67,74,80,83,87,94,97,106,109,112,115,118,121,124,127,130],[16,17,18],"blockquote",{},[19,20,21],"p",{},"由于浙江工地大专的朝晖尚9宿舍实在是太小了，我没有办法放下一块便携显示屏，所以只能把家中闲置的 Huawei Pad M6 作为自己的副屏。",[19,23,24,25,32],{},"经过一轮搜索下来，我找到了 ",[26,27,31],"a",{"href":28,"rel":29},"https://github.com/kbumsik/VirtScreen",[30],"nofollow","VirtScreen"," 作为工具。",[34,35,36],"h2",{"id":36},"安装",[19,38,39],{},"在 Archlinux 上，大概有三种以上的方式进行安装:",[19,41,42,43],{},"一、使用 AUR 上的 ",[26,44,47],{"href":45,"rel":46},"https://aur.archlinux.org/package/virtscreen/",[30],"virtscreen",[19,49,50,51,55,56,59,60,63],{},"遇到的唯一一个麻烦是作为依赖之一的 ",[52,53,54],"code",{},"python-quamash"," 在 python3.10 上无法直接安装。通过 AUR 的评论区得知，需要将 ",[52,57,58],{},"collections.Mapping"," 改为 ",[52,61,62],{},"collections.abc.Mapping"," 方可通过安装。",[19,65,66],{},"二、使用 dderjoel 的 fork 进行安装",[19,68,69,70],{},"见 ",[26,71,72],{"href":72,"rel":73},"https://github.com/dderjoel/VirtScreen/blob/master/package/archlinux/PKGBUILD",[30],[19,75,76,77],{},"三、直接通过 appimage 安装，不过需要自己手动安装 ",[52,78,79],{},"x11vnc",[34,81,82],{"id":82},"配置",[84,85,86],"h3",{"id":86},"系统层",[19,88,89,90,93],{},"打开软件以后，我们需要先在 ",[52,91,92],{},"Display->Virtual Display->Advaced"," 选择 VIRTUAL1 作为显示屏。",[19,95,96],{},"如果没有这个选项，可能需要根据自己的显卡做出相应的调整。",[19,98,99,100,105],{},"可以参考 ",[26,101,104],{"href":102,"rel":103},"https://wiki.archlinux.org/title/Extreme_Multihead#Using_a_virtual_output",[30],"ArchWiki","。",[84,107,108],{"id":108},"软件层",[19,110,111],{},"在这里，我们需要根据我们作为副屏的设备的屏幕分辨率来计算我们需要在 VirtScreen 中设置的分辨率参数。",[19,113,114],{},"我的 Huawei Pad M6 是 2560*1600 的分辨率，但 VirtScreen 最高支持只有 1920*1080，所以我们需要选择 1280*800，并开启高分辨率选项。",[19,116,117],{},"VNC 那边只需要根据自己的需求设置一下密码即可。",[34,119,120],{"id":120},"使用",[19,122,123],{},"在 VirtScreen 的 Display 界面点击 \"Enable Virtual Screen\"，切换到 VNC 界面点击 \"Start VNC Server\"，可以勾选右侧的 \"Auto\"。",[19,125,126],{},"Pad 端只需要安装任意一个 VNC 客户端即可，我这里使用的是\"VNC Viewer\"。",[34,128,129],{"id":129},"图片",[19,131,132],{},[133,134],"img",{"alt":135,"src":136},"效果图","https://static.031130.xyz/uploads/2024/08/12/633b1bd1ba8f4.webp",{"title":138,"searchDepth":139,"depth":139,"links":140},"",2,[141,142,147,148],{"id":36,"depth":139,"text":36},{"id":82,"depth":139,"text":82,"children":143},[144,146],{"id":86,"depth":145,"text":86},3,{"id":108,"depth":145,"text":108},{"id":120,"depth":139,"text":120},{"id":129,"depth":139,"text":129},{"title":150,"date":151,"path":152,"tags":153,"body":156},"在 Archlinux 下使用 l2tp 协议连接校园网","2022-09-29 14:30:46","/2022/09/29/use-l2tp-protocol-to-connect-internet",[154,155],"Archlinux","Network",{"type":13,"value":157,"toc":249},[158,163,171,177,180,189,198,201,229,232,239,245],[16,159,160],{},[19,161,162],{},"由于高考爆炸，所以不得不进入浙江工地大专来度过自己接下来四年的人生（希望到时候可以借助学校的力量润出去）。",[19,164,165,166,170],{},"学校这边由于某些不可描述的原因，将校园卡与宽带捆绑销售，且每次登陆校园网时都需要使用定制的 l2tp 协议客户端进行上网，且该客户端将会禁用用户的无线网卡（",[167,168,169],"del",{},"这不明摆着想让我们宿舍每个人都花一次钱","）。",[19,172,173],{},[133,174],{"alt":175,"src":176},"学校定制的 l2tp 拨号客户端","https://static.031130.xyz/uploads/2024/08/12/63353e0e1978c.webp",[19,178,179],{},"更惨的是，学校仅提供了 Windows 与 MacOS 的客户端。",[19,181,182,183,188],{},"在 ",[26,184,187],{"href":185,"rel":186},"https://imbearchild.cyou/",[30],"BearChild"," 的提醒下，我意识到 Linux 下也可以有 l2tp 协议。",[19,190,191,192,197],{},"谷歌搜索了一番，我在简书上捞到了这篇文章",[26,193,196],{"href":194,"rel":195},"https://www.jianshu.com/p/85cd5bd3c7a2",[30],"《ubuntu 连校园网 via l2tp》","。不过这显然有些麻烦，我们的客户端不需要 pppoe 拨号，只需要插上网线后连接 l2tp 协议即可联网。",[19,199,200],{},"所幸，NetworkManager 非常贴心地为我们提供了 l2tp 的插件，在 Archlinux 下使用如下命令即可完成安装。",[202,203,207],"pre",{"className":204,"code":205,"language":206,"meta":138,"style":138},"language-bash shiki shiki-themes github-light github-dark","sudo pacman -S networkmanager-l2tp\n","bash",[52,208,209],{"__ignoreMap":138},[210,211,214,218,222,226],"span",{"class":212,"line":213},"line",1,[210,215,217],{"class":216},"sScJk","sudo",[210,219,221],{"class":220},"sZZnC"," pacman",[210,223,225],{"class":224},"sj4cs"," -S",[210,227,228],{"class":220}," networkmanager-l2tp\n",[19,230,231],{},"安装完成后，就可以在图形化界面下进行我们的设置操作。",[19,233,234,235,238],{},"由于定制的客户端已经把 l2tp 服务器 ip 写死且显示在界面上了，我们就不需要再去抓包截取服务器 ip，直接使用这边的 ",[52,236,237],{},"192.168.115.1"," 即可。",[19,240,241],{},[133,242],{"alt":243,"src":244},"KDE 下的 NetworkManager l2tp 设置界面","https://static.031130.xyz/uploads/2024/08/12/63354161dbe28.webp",[246,247,248],"style",{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":250},[],{"title":252,"date":253,"path":254,"tags":255,"body":256},"为 Element 添加自己喜欢的贴纸","2022-08-10 19:51:19","/2022/08/10/add-sticker-support-for-element",null,{"type":13,"value":257,"toc":707},[258,263,266,282,290,293,319,323,326,342,346,349,375,378,381,408,415,419,426,445,448,459,465,468,471,474,494,498,501,508,514,520,526,533,539,542,687,693,696,699,704],[16,259,260],{},[19,261,262],{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[34,264,265],{"id":265},"需要准备的",[267,268,269,273,276,279],"ul",{},[270,271,272],"li",{},"PC 端 element",[270,274,275],{},"python3.6+ 环境",[270,277,278],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[270,280,281],{},"可能需要能够突破大局域网限制的网络环境",[19,283,284,285],{},"需要用到的项目 ",[26,286,289],{"href":287,"rel":288},"https://github.com/maunium/stickerpicker",[30],"maunium/stickerpicker",[34,291,292],{"id":292},"克隆主项目",[202,294,296],{"className":204,"code":295,"language":206,"meta":138,"style":138},"git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n",[52,297,298],{"__ignoreMap":138},[210,299,300,303,306,309,313,316],{"class":212,"line":213},[210,301,302],{"class":216},"git",[210,304,305],{"class":220}," clone",[210,307,308],{"class":220}," https://github.com/maunium/stickerpicker.git",[210,310,312],{"class":311},"sVt8B"," && ",[210,314,315],{"class":224},"cd",[210,317,318],{"class":220}," stickerpicker\n",[34,320,322],{"id":321},"使用-pip-安装依赖","使用 pip 安装依赖",[19,324,325],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[202,327,329],{"className":204,"code":328,"language":206,"meta":138,"style":138},"pip install .\n",[52,330,331],{"__ignoreMap":138},[210,332,333,336,339],{"class":212,"line":213},[210,334,335],{"class":216},"pip",[210,337,338],{"class":220}," install",[210,340,341],{"class":220}," .\n",[34,343,345],{"id":344},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[19,347,348],{},"在项目根目录下创新一个新的目录。",[202,350,352],{"className":204,"code":351,"language":206,"meta":138,"style":138},"mkdir \u003Cpack directory>\n",[52,353,354],{"__ignoreMap":138},[210,355,356,359,363,366,369,372],{"class":212,"line":213},[210,357,358],{"class":216},"mkdir",[210,360,362],{"class":361},"szBVR"," \u003C",[210,364,365],{"class":220},"pack",[210,367,368],{"class":220}," director",[210,370,371],{"class":311},"y",[210,373,374],{"class":361},">\n",[19,376,377],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[19,379,380],{},"执行命令进行打包",[202,382,384],{"className":204,"code":383,"language":206,"meta":138,"style":138},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[52,385,386],{"__ignoreMap":138},[210,387,388,391,393,395,397,399,402,405],{"class":212,"line":213},[210,389,390],{"class":216},"sticker-pack",[210,392,362],{"class":361},[210,394,365],{"class":220},[210,396,368],{"class":220},[210,398,371],{"class":311},[210,400,401],{"class":361},">",[210,403,404],{"class":224}," --add-to-index",[210,406,407],{"class":220}," web/packs/\n",[19,409,410,411,414],{},"如果想要给目录贴纸包命名，则可以追加",[52,412,413],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[34,416,418],{"id":417},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[19,420,421,422,425],{},"项目内已经为我们准备了 ",[52,423,424],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[202,427,429],{"className":204,"code":428,"language":206,"meta":138,"style":138},"sticker-import \u003Cpack_url>\n",[52,430,431],{"__ignoreMap":138},[210,432,433,435,437,440,443],{"class":212,"line":213},[210,434,424],{"class":216},[210,436,362],{"class":361},[210,438,439],{"class":220},"pack_ur",[210,441,442],{"class":311},"l",[210,444,374],{"class":361},[19,446,447],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[19,449,450,451,454,455,458],{},"matrix 的 ",[52,452,453],{},"homeserver"," 和 ",[52,456,457],{},"access token"," 可以在 PC 端 element 的设置里找到",[19,460,461],{},[133,462],{"alt":463,"src":464},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[19,466,467],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[19,469,470],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[472,473],"hr",{},[19,475,476,477,480,481,484,485,490,491],{},"接着我们需要做的事情就是将 ",[52,478,479],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[52,482,483],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[26,486,489],{"href":487,"rel":488},"https://blog.zhaose.cyou/",[30],"@朝色"," 的 url 也可以直接拿来使用 ",[52,492,493],{},"https://sticker.zhaose.cyou/web/",[34,495,497],{"id":496},"添加到-element","添加到 element",[19,499,500],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[19,502,503,504,507],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[52,505,506],{},"/devtools"," 并发送",[19,509,510],{},[133,511],{"alt":512,"src":513},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[19,515,516,517],{},"将会出现如下页面，选择 ",[52,518,519],{},"Explore account data",[19,521,522],{},[133,523],{"alt":524,"src":525},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[19,527,528,529,532],{},"找到 ",[52,530,531],{},"m.widgets","，如果没有，就点击下图标出的按钮",[19,534,535],{},[133,536],{"alt":537,"src":538},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[19,540,541],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[202,543,547],{"className":544,"code":545,"language":546,"meta":138,"style":138},"language-json shiki shiki-themes github-light github-dark","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[52,548,549,554,562,569,584,597,610,619,625,638,651,664,675,681],{"__ignoreMap":138},[210,550,551],{"class":212,"line":213},[210,552,553],{"class":311},"{\n",[210,555,556,559],{"class":212,"line":139},[210,557,558],{"class":224},"    \"stickerpicker\"",[210,560,561],{"class":311},": {\n",[210,563,564,567],{"class":212,"line":145},[210,565,566],{"class":224},"        \"content\"",[210,568,561],{"class":311},[210,570,572,575,578,581],{"class":212,"line":571},4,[210,573,574],{"class":224},"            \"type\"",[210,576,577],{"class":311},": ",[210,579,580],{"class":220},"\"m.stickerpicker\"",[210,582,583],{"class":311},",\n",[210,585,587,590,592,595],{"class":212,"line":586},5,[210,588,589],{"class":224},"            \"url\"",[210,591,577],{"class":311},[210,593,594],{"class":220},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[210,596,583],{"class":311},[210,598,600,603,605,608],{"class":212,"line":599},6,[210,601,602],{"class":224},"            \"name\"",[210,604,577],{"class":311},[210,606,607],{"class":220},"\"Stickerpicker\"",[210,609,583],{"class":311},[210,611,613,616],{"class":212,"line":612},7,[210,614,615],{"class":224},"            \"data\"",[210,617,618],{"class":311},": {}\n",[210,620,622],{"class":212,"line":621},8,[210,623,624],{"class":311},"        },\n",[210,626,628,631,633,636],{"class":212,"line":627},9,[210,629,630],{"class":224},"        \"sender\"",[210,632,577],{"class":311},[210,634,635],{"class":220},"\"@you:matrix.server.name\"",[210,637,583],{"class":311},[210,639,641,644,646,649],{"class":212,"line":640},10,[210,642,643],{"class":224},"        \"state_key\"",[210,645,577],{"class":311},[210,647,648],{"class":220},"\"stickerpicker\"",[210,650,583],{"class":311},[210,652,654,657,659,662],{"class":212,"line":653},11,[210,655,656],{"class":224},"        \"type\"",[210,658,577],{"class":311},[210,660,661],{"class":220},"\"m.widget\"",[210,663,583],{"class":311},[210,665,667,670,672],{"class":212,"line":666},12,[210,668,669],{"class":224},"        \"id\"",[210,671,577],{"class":311},[210,673,674],{"class":220},"\"stickerpicker\"\n",[210,676,678],{"class":212,"line":677},13,[210,679,680],{"class":311},"    }\n",[210,682,684],{"class":212,"line":683},14,[210,685,686],{"class":311},"}\n",[19,688,689],{},[133,690],{"alt":691,"src":692},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[19,694,695],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[19,697,698],{},"补一张效果图",[19,700,701],{},[133,702],{"alt":135,"src":703},"https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[246,705,706],{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}",{"title":138,"searchDepth":139,"depth":139,"links":708},[709,710,711,712,713,714],{"id":265,"depth":139,"text":265},{"id":292,"depth":139,"text":292},{"id":321,"depth":139,"text":322},{"id":344,"depth":139,"text":345},{"id":417,"depth":139,"text":418},{"id":496,"depth":139,"text":497},{"title":716,"date":717,"path":718,"tags":719,"body":723},"nodejs16：是我配不上 openssl 3 咯？","2022-08-04 17:31:49","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16",[720,721,722],"Fedora","nodejs","OpenSSL",{"type":13,"value":724,"toc":868},[725,731,734,750,765,768,771,773,776,785,791,794,838,840,863],[19,726,727],{},[133,728],{"alt":729,"src":730},"长毛象的截图.png","https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp",[19,732,733],{},"今年上半年升级 Fedora 36 的时候遇到了这个问题。",[19,735,736,737,740,741,746,747,749],{},"那会儿很无奈，一直在等 nodejs16 合并提供 ",[52,738,739],{},"--openssl-legacy-provider"," 的",[26,742,745],{"href":743,"rel":744},"https://github.com/nodejs/node/pull/42972",[30],"那个 PR","。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 ",[52,748,739],{}," 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。",[19,751,752,753,758,759,764],{},"然而，nodejs 在他们的官网上发布的",[26,754,757],{"href":755,"rel":756},"https://nodejs.org/en/blog/announcements/nodejs16-eol/",[30],"一篇博客","刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有",[26,760,763],{"href":761,"rel":762},"https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/",[30],"寒晶雪提供的中文翻译","）",[19,766,767],{},"博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）",[19,769,770],{},"很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。",[472,772],{},[19,774,775],{},"不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）",[19,777,778,779,784],{},"前几天我给 ",[26,780,783],{"href":781,"rel":782},"https://github.com/atpoossfl/repo",[30],"atpoossfl 仓库","打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。",[19,786,787],{},[133,788],{"alt":789,"src":790},"此为 nvm 安装的 nodejs14 目录","https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp",[19,792,793],{},"所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。",[16,795,796],{},[19,797,798,799,802,803,806,807,810,811,814,815,820,821,824,825,828,829,832,833,454,835,837],{},"使用 Fedora 的用户需要注意，Fedora 官方源中的",[52,800,801],{},"yarnpkg","在打包时遇到了错误，他们将 ",[52,804,805],{},"/usr/lib/node_modules/yarn/bin/yarn.js"," 的 shebang 给改成了 ",[52,808,809],{},"#!/usr/bin/node","，应当改回 ",[52,812,813],{},"#!/usr/bin/env node","才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 ",[26,816,819],{"href":817,"rel":818},"https://dl.yarnpkg.com/rpm/yarn.repo",[30],"dl.yarnpkg.com"," 提供的 ",[52,822,823],{},"yarn"," 软件包。在写 specfile 的 ",[52,826,827],{},"BuildRequires"," 时，可以直接写成 ",[52,830,831],{},"/usr/bin/yarn"," 来避免频繁在 ",[52,834,823],{},[52,836,801],{}," 这两个包名间改动。",[472,839],{},[19,841,842,843,454,846,849,850,852,853,858,859,862],{},"更好的消息是，nodejs 已经在 ",[52,844,845],{},"v16.17.0-proposal",[52,847,848],{},"v16.x-staging"," 分支收下了这个为 nodejs16 提供 ",[52,851,739],{}," 的 ",[26,854,857],{"href":855,"rel":856},"https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f",[30],"commit","。相信在不久的将来，这个 commit 将会进入主线，并在 ",[52,860,861],{},"v16.17"," 版本的 nodejs16 上发挥它的作用。",[19,864,865],{},[133,866],{"alt":857,"src":867},"https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp",{"title":138,"searchDepth":139,"depth":139,"links":869},[],{"title":871,"date":872,"path":873,"tags":874,"body":876},"如何拯救失声的 hollywood","2022-07-25 11:25:44","/2022/07/25/restore-the-sound-of-hollywood",[875,10],"Fun",{"type":13,"value":877,"toc":1101},[878,881,890,893,898,901,904,912,923,943,954,963,966,981,1096,1099],[19,879,880],{},"我刚开始接触 Linux 下的 hollywood 时，我记得它运行时是有声音的，应该是 007 的主题音乐，如今再次装上 hollywood，却发现音乐没了。",[19,882,883,884,889],{},"在 Github 找到 hollywood，发现有一个 ",[26,885,888],{"href":886,"rel":887},"https://github.com/dustinkirkland/hollywood/issues/58",[30],"issue"," 也提到了这个问题。",[19,891,892],{},"原作者在该 issue 中回复道",[16,894,895],{},[19,896,897],{},"没错，它只是一段视频，音频受到版权保护。",[19,899,900],{},"所以不难看出，作者因为版权问题而去掉了音频，进而导致 hollywood 失声。但我们作为用户，是不是可以想办法获取到老版本中那段带有音频的 mp4 文件呢？",[19,902,903],{},"答案是肯定的。",[19,905,906,907,105],{},"得益于 git 的版本控制特色，在 hollywood 的 github 仓库中，我们可以找到原来的 ",[26,908,911],{"href":909,"rel":910},"https://github.com/dustinkirkland/hollywood/blob/67839229f878a08521885e9fc05dd2d3ba10ddd1/share/hollywood/mi.mp4",[30],"mp4 文件",[19,913,914,915,918,919,922],{},"下载这个 mp4 文件后，我们将其放入 ",[52,916,917],{},"/usr/share/hollywood/"," 路径下，重命名为 ",[52,920,921],{},"soundwave.mp4","，并确保其被正确设定为 0644 权限。",[202,924,926],{"className":204,"code":925,"language":206,"meta":138,"style":138},"sudo install -Dm644 ./mi.mp4 /usr/share/hollywood/soundwave.mp4\n",[52,927,928],{"__ignoreMap":138},[210,929,930,932,934,937,940],{"class":212,"line":213},[210,931,217],{"class":216},[210,933,338],{"class":220},[210,935,936],{"class":224}," -Dm644",[210,938,939],{"class":220}," ./mi.mp4",[210,941,942],{"class":220}," /usr/share/hollywood/soundwave.mp4\n",[19,944,945,946,949,950,953],{},"接下来试着跑一跑 ",[52,947,948],{},"hollywood","，发现依然没有声音。再次查阅源码，发现缺少了 ",[52,951,952],{},"mplayer"," 这个依赖。",[19,955,956,957,959,960,962],{},"使用包管理器安装 ",[52,958,952],{}," 后，运行 ",[52,961,948],{}," 就可以听到声音了。",[19,964,965],{},"然而，你觉不觉得这个音乐。。。听上去怪怪的。。。",[19,967,968,969,971,972,977,978],{},"没错，作者在去掉音频后，给 ",[52,970,921],{}," ",[26,973,976],{"href":974,"rel":975},"https://github.com/dustinkirkland/hollywood/commit/95f77d570d86cd8b8fe0e0939049609f81d1bae0#diff-3e2bf53af1a38136a109ac4fa1b11189e7b6fcd4385e1c68683093f73c6ac485",[30],"设定了加速播放","。而我们现在需要这段视频被原速播放。编辑 ",[52,979,980],{},"/usr/lib/hollywood/mplayer",[202,982,986],{"className":983,"code":984,"language":985,"meta":138,"style":138},"language-diff shiki shiki-themes github-light github-dark","#!/bin/bash\n#\n# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\ncommand -v mplayer >/dev/null 2>&1 || exit 1\ntrap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\nPKG=hollywood\ndir=\"$(dirname $0)/../../share/$PKG\"\n-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n","diff",[52,987,988,993,998,1003,1007,1012,1017,1022,1026,1031,1035,1040,1045,1050,1055,1061,1067,1072,1078,1084,1090],{"__ignoreMap":138},[210,989,990],{"class":212,"line":213},[210,991,992],{},"#!/bin/bash\n",[210,994,995],{"class":212,"line":139},[210,996,997],{},"#\n",[210,999,1000],{"class":212,"line":145},[210,1001,1002],{},"# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n",[210,1004,1005],{"class":212,"line":571},[210,1006,997],{},[210,1008,1009],{"class":212,"line":586},[210,1010,1011],{},"# Licensed under the Apache License, Version 2.0 (the \"License\");\n",[210,1013,1014],{"class":212,"line":599},[210,1015,1016],{},"# you may not use this file except in compliance with the License.\n",[210,1018,1019],{"class":212,"line":612},[210,1020,1021],{},"# You may obtain a copy of the License at\n",[210,1023,1024],{"class":212,"line":621},[210,1025,997],{},[210,1027,1028],{"class":212,"line":627},[210,1029,1030],{},"#    http://www.apache.org/licenses/LICENSE-2.0\n",[210,1032,1033],{"class":212,"line":640},[210,1034,997],{},[210,1036,1037],{"class":212,"line":653},[210,1038,1039],{},"# Unless required by applicable law or agreed to in writing, software\n",[210,1041,1042],{"class":212,"line":666},[210,1043,1044],{},"# distributed under the License is distributed on an \"AS IS\" BASIS,\n",[210,1046,1047],{"class":212,"line":677},[210,1048,1049],{},"# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",[210,1051,1052],{"class":212,"line":683},[210,1053,1054],{},"# See the License for the specific language governing permissions and\n",[210,1056,1058],{"class":212,"line":1057},15,[210,1059,1060],{},"# limitations under the License.\n",[210,1062,1064],{"class":212,"line":1063},16,[210,1065,1066],{},"command -v mplayer >/dev/null 2>&1 || exit 1\n",[210,1068,1069],{"class":212,"line":3},[210,1070,1071],{},"trap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\n",[210,1073,1075],{"class":212,"line":1074},18,[210,1076,1077],{},"PKG=hollywood\n",[210,1079,1081],{"class":212,"line":1080},19,[210,1082,1083],{},"dir=\"$(dirname $0)/../../share/$PKG\"\n",[210,1085,1087],{"class":212,"line":1086},20,[210,1088,1089],{},"-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n",[210,1091,1093],{"class":212,"line":1092},21,[210,1094,1095],{},"+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n",[19,1097,1098],{},"再次运行，确认修改已经成功。",[246,1100,248],{},{"title":138,"searchDepth":139,"depth":139,"links":1102},[],{"title":1104,"date":1105,"path":1106,"tags":1107,"body":1110},"处理 fcitx5 的文字候选框在 tg 客户端上闪烁的问题","2022-07-03 13:52:44","/2022/07/03/fcitx5-blinking-on-tg-under-wayland-kde",[10,1108,1109],"笔记","KDE",{"type":13,"value":1111,"toc":1304},[1112,1123,1126,1129,1135,1138,1141,1149,1152,1155,1158,1164,1171,1182,1185,1188,1191,1194,1209,1212,1216,1219,1240,1243,1251,1254,1258,1264,1267,1274,1281,1288,1301],[16,1113,1114],{},[19,1115,1116,1117,1122],{},"文章开头，先要感谢 fcitx5 的开发者 ",[26,1118,1121],{"href":1119,"rel":1120},"https://www.csslayer.info/wordpress/",[30],"老K"," 帮我 debug 这个问题",[34,1124,1125],{"id":1125},"鬼畜的文字候选框",[19,1127,1128],{},"在新装的 Fedora 36 KDE Wayland 下使用 fcitx5 时遇到了文字候选框前后移动晃眼的问题（如下图）",[19,1130,1131],{},[133,1132],{"alt":1133,"src":1134},"fcitx5 blinking","https://static.031130.xyz/uploads/2024/08/12/62c13162a6efc.gif",[34,1136,1137],{"id":1137},"解决方案",[19,1139,1140],{},"当我向老K提出这个问题上的时候，老K告诉我这是预期行为，一共有两个解决方案。",[267,1142,1143,1146],{},[270,1144,1145],{},"使用 qt 的 text input",[270,1147,1148],{},"关掉 kwin 的淡入淡出特效",[19,1150,1151],{},"但由于我并不熟悉 KWin 的特效，所以我选择了前者的方案。",[19,1153,1154],{},"首先，需要确保自己的 Plasma 版本在 5.24 或以上，fcitx5 的版本号在 5.0.14 以上。",[19,1156,1157],{},"然后我们需要让 KWin 去启动 fcitx5。KCM 为此提供了一个非常简单的方式，如下图",[19,1159,1160],{},[133,1161],{"alt":1162,"src":1163},"选择 fcitx5 就好啦","https://static.031130.xyz/uploads/2024/08/12/62c134907ada9.webp",[19,1165,1166,1167,1170],{},"随后需要确保环境变量没有设置 ",[52,1168,1169],{},"QT_IM_MODULE ","。一定要确保这个变量不存在，连空也不行，必须是 unset。",[19,1172,1173,1174,1177,1178,1181],{},"理论上来说，是不需要重启的，但我的环境变量是 ",[52,1175,1176],{},"fcitx5-autostart"," 这个 rpm 包在 ",[52,1179,1180],{},"/etc/profile.d/fcitx5.sh","里面设置的，我需要重启系统来使新的环境变量生效。",[19,1183,1184],{},"重启后，如果没有什么意外的话，就算成功了。",[34,1186,1187],{"id":1187},"绝对不会缺席的意外",[19,1189,1190],{},"很遗憾，我遇到了意外。",[19,1192,1193],{},"完成上述操作后，文字候选框依然有问题。",[19,1195,1196,1197,1200,1201,1204,1205,1208],{},"在老K的正确推测下，是因为我在 Fedora 下曾经使用过 ",[52,1198,1199],{},"im-settings","，该程序在 ",[52,1202,1203],{},"$HOME/.config/environment.d/"," 路径下重新帮我设置回了 ",[52,1206,1207],{},"QT_IM_MODULE"," 这个变量，从而使得 tg 启动时还在使用 IM MODULE，而不是预期的 qt text input。",[19,1210,1211],{},"删除这两个影响环境变量的文件后，在 tg 输入时，fcitx5 的文字候选框恢复了正常。",[34,1213,1215],{"id":1214},"debug-过程中用到的两个方式","debug 过程中用到的两个方式",[84,1217,1218],{"id":1218},"dbus-send",[202,1220,1222],{"className":204,"code":1221,"language":206,"meta":138,"style":138},"dbus-send --print-reply=literal --dest=org.fcitx.Fcitx5 /controller org.fcitx.Fcitx.Controller1.DebugInfo\n",[52,1223,1224],{"__ignoreMap":138},[210,1225,1226,1228,1231,1234,1237],{"class":212,"line":213},[210,1227,1218],{"class":216},[210,1229,1230],{"class":224}," --print-reply=literal",[210,1232,1233],{"class":224}," --dest=org.fcitx.Fcitx5",[210,1235,1236],{"class":220}," /controller",[210,1238,1239],{"class":220}," org.fcitx.Fcitx.Controller1.DebugInfo\n",[19,1241,1242],{},"运行如上命令后，我得到了如下的输出",[202,1244,1249],{"className":1245,"code":1247,"language":1248},[1246],"language-text","   Group [x11::1] has 0 InputContext(s)\nGroup [wayland:] has 5 InputContext(s)\n  IC [a50fe208d42e4611b240c0b66a2fa0b9] program:konsole frontend:dbus cap:e001800060 focus:1\n  IC [d7d4d5c05e9c445aab1af9c7dfb5fbd4] program:telegram-desktop frontend:dbus cap:e001800060 focus:0\n  IC [ac72ec3edf58481bbdf838352520efd5] program:krunner frontend:dbus cap:e001820060 focus:0\n  IC [d8b450176e204953837248f786204c29] program:plasmashell frontend:dbus cap:e001800060 focus:0\n  IC [df252979343d42ebbe9bd82ead6ff194] program: frontend:wayland cap:40 focus:0\nInput Context without group\n","text",[52,1250,1247],{"__ignoreMap":138},[19,1252,1253],{},"老K指出，出现了 telegram 的那一行表明 tg 还是在用 IM Module，所以是环境变量有问题",[84,1255,1257],{"id":1256},"proc-查看程序运行时的环境变量","/proc 查看程序运行时的环境变量",[19,1259,1260],{},[133,1261],{"alt":1262,"src":1263},"获取到的环境变量","https://static.031130.xyz/uploads/2024/08/12/62c138b030469.webp",[34,1265,1266],{"id":1266},"参考资料",[19,1268,1269],{},[26,1270,1273],{"href":1271,"rel":1272},"https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/",[30],"Use Plasma 5.24 to type in Alacritty (Or any other text-input-v3 client) with Fcitx 5 on Wayland",[19,1275,1276],{},[26,1277,1280],{"href":1278,"rel":1279},"https://fcitx-im.org/wiki/FAQ#Candidate_window_is_blinking_under_wayland_with_Fcitx_5",[30],"Candidate window is blinking under wayland with Fcitx 5",[19,1282,1283],{},[26,1284,1287],{"href":1285,"rel":1286},"https://www.cnblogs.com/hupeng1234/p/6735403.html",[30],"查看进程的环境变量",[19,1289,1290],{},[1291,1292,1293,1294,454,1297,1300],"em",{},"注: 上述参考资料均已在 ",[52,1295,1296],{},"web.archive.org",[52,1298,1299],{},"archive.ph"," 做过存档，如遇到原站点无法访问的情况，可自行前往这两个站点查看存档。",[246,1302,1303],{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":1305},[1306,1307,1308,1309,1313],{"id":1125,"depth":139,"text":1125},{"id":1137,"depth":139,"text":1137},{"id":1187,"depth":139,"text":1187},{"id":1214,"depth":139,"text":1215,"children":1310},[1311,1312],{"id":1218,"depth":145,"text":1218},{"id":1256,"depth":145,"text":1257},{"id":1266,"depth":139,"text":1266},{"title":1315,"date":1316,"path":1317,"tags":1318,"body":1320},"使用caddy反向代理维基百科中文站点","2022-05-30 08:59:21","/2022/05/30/use-caddy-to-proxy-wikipedia",[1319],"Caddy",{"type":13,"value":1321,"toc":1713},[1322,1325,1333,1336,1339,1369,1373,1651,1654,1660,1667,1674,1681,1683,1705,1710],[19,1323,1324],{},"反代的目的无非是两点",[267,1326,1327,1330],{},[270,1328,1329],{},"满足自己在无代理情况下访问无法访问的站点的需求",[270,1331,1332],{},"方便将站点分享给亲朋好友。",[19,1334,1335],{},"一直以来，我都想用 caddy 去反代一份维基百科来用，今天刚好就顺手解决了。",[34,1337,1338],{"id":1338},"注意事项",[267,1340,1341,1344,1347,1350],{},[270,1342,1343],{},"用于反代的机子需要有对目标站点的访问能力",[270,1345,1346],{},"最好准备一个新的域名作为白手套，防止被污染",[270,1348,1349],{},"建议增加密码保护，一来使得小鸡流量不被滥用，二来防止防火墙检测到站点内容",[270,1351,1352,1353,1356,1357,1360,1361,1365,1366,1368],{},"本文使用的 caddy 开启了 ",[52,1354,1355],{},"replace_response"," 插件，可以使用 ",[52,1358,1359],{},"xcaddy"," 编译或直接前往 ",[26,1362,1363],{"href":1363,"rel":1364},"https://caddyserver.com/download",[30]," 勾选相应插件后下载。安装时，建议先根据官方文档安装原版 caddy，再用启用了 ",[52,1367,1355],{}," 插件的 caddy 二进制文件覆盖掉原版 caddy，这样就不需要去手写 systemd 相关的文件了。",[34,1370,1372],{"id":1371},"caddyfile","Caddyfile",[202,1374,1378],{"className":1375,"code":1376,"language":1377,"meta":138,"style":138},"language-nginx shiki shiki-themes github-light github-dark","{\n        order replace after encode\n}\n\nhttps://zhwiki.example.com {\n\n        reverse_proxy * https://zh.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://m.zhwiki.example.com {\n\n        reverse_proxy * https://zh.m.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://up.zhwiki.example.com {\n        reverse_proxy * https://upload.wikimedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n        }\n}\n\n","nginx",[52,1379,1380,1384,1389,1393,1399,1404,1408,1413,1418,1423,1428,1433,1438,1443,1448,1453,1458,1462,1467,1472,1477,1482,1487,1492,1497,1503,1508,1514,1519,1524,1529,1534,1539,1544,1549,1554,1559,1564,1569,1574,1579,1584,1589,1594,1599,1605,1611,1616,1621,1626,1631,1636,1641,1646],{"__ignoreMap":138},[210,1381,1382],{"class":212,"line":213},[210,1383,553],{},[210,1385,1386],{"class":212,"line":139},[210,1387,1388],{},"        order replace after encode\n",[210,1390,1391],{"class":212,"line":145},[210,1392,686],{},[210,1394,1395],{"class":212,"line":571},[210,1396,1398],{"emptyLinePlaceholder":1397},true,"\n",[210,1400,1401],{"class":212,"line":586},[210,1402,1403],{},"https://zhwiki.example.com {\n",[210,1405,1406],{"class":212,"line":599},[210,1407,1398],{"emptyLinePlaceholder":1397},[210,1409,1410],{"class":212,"line":612},[210,1411,1412],{},"        reverse_proxy * https://zh.wikipedia.org {\n",[210,1414,1415],{"class":212,"line":621},[210,1416,1417],{},"                header_up Host {upstream_hostport}\n",[210,1419,1420],{"class":212,"line":627},[210,1421,1422],{},"                header_up X-Real-IP {http.request.remote.host}\n",[210,1424,1425],{"class":212,"line":640},[210,1426,1427],{},"                header_up X-Forwarded-For {http.request.remote.host}\n",[210,1429,1430],{"class":212,"line":653},[210,1431,1432],{},"                header_up X-Forwarded-Port {http.request.port}\n",[210,1434,1435],{"class":212,"line":666},[210,1436,1437],{},"                header_up X-Forwarded-Proto {http.request.scheme}\n",[210,1439,1440],{"class":212,"line":677},[210,1441,1442],{},"                header_up Accept-Encoding identity\n",[210,1444,1445],{"class":212,"line":683},[210,1446,1447],{},"                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n",[210,1449,1450],{"class":212,"line":1057},[210,1451,1452],{},"                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n",[210,1454,1455],{"class":212,"line":1063},[210,1456,1457],{},"        }\n",[210,1459,1460],{"class":212,"line":3},[210,1461,1398],{"emptyLinePlaceholder":1397},[210,1463,1464],{"class":212,"line":1074},[210,1465,1466],{},"        replace {\n",[210,1468,1469],{"class":212,"line":1080},[210,1470,1471],{},"                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n",[210,1473,1474],{"class":212,"line":1086},[210,1475,1476],{},"                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n",[210,1478,1479],{"class":212,"line":1092},[210,1480,1481],{},"                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n",[210,1483,1485],{"class":212,"line":1484},22,[210,1486,1457],{},[210,1488,1490],{"class":212,"line":1489},23,[210,1491,686],{},[210,1493,1495],{"class":212,"line":1494},24,[210,1496,1398],{"emptyLinePlaceholder":1397},[210,1498,1500],{"class":212,"line":1499},25,[210,1501,1502],{},"https://m.zhwiki.example.com {\n",[210,1504,1506],{"class":212,"line":1505},26,[210,1507,1398],{"emptyLinePlaceholder":1397},[210,1509,1511],{"class":212,"line":1510},27,[210,1512,1513],{},"        reverse_proxy * https://zh.m.wikipedia.org {\n",[210,1515,1517],{"class":212,"line":1516},28,[210,1518,1417],{},[210,1520,1522],{"class":212,"line":1521},29,[210,1523,1422],{},[210,1525,1527],{"class":212,"line":1526},30,[210,1528,1427],{},[210,1530,1532],{"class":212,"line":1531},31,[210,1533,1432],{},[210,1535,1537],{"class":212,"line":1536},32,[210,1538,1437],{},[210,1540,1542],{"class":212,"line":1541},33,[210,1543,1442],{},[210,1545,1547],{"class":212,"line":1546},34,[210,1548,1447],{},[210,1550,1552],{"class":212,"line":1551},35,[210,1553,1452],{},[210,1555,1557],{"class":212,"line":1556},36,[210,1558,1457],{},[210,1560,1562],{"class":212,"line":1561},37,[210,1563,1398],{"emptyLinePlaceholder":1397},[210,1565,1567],{"class":212,"line":1566},38,[210,1568,1466],{},[210,1570,1572],{"class":212,"line":1571},39,[210,1573,1471],{},[210,1575,1577],{"class":212,"line":1576},40,[210,1578,1476],{},[210,1580,1582],{"class":212,"line":1581},41,[210,1583,1481],{},[210,1585,1587],{"class":212,"line":1586},42,[210,1588,1457],{},[210,1590,1592],{"class":212,"line":1591},43,[210,1593,686],{},[210,1595,1597],{"class":212,"line":1596},44,[210,1598,1398],{"emptyLinePlaceholder":1397},[210,1600,1602],{"class":212,"line":1601},45,[210,1603,1604],{},"https://up.zhwiki.example.com {\n",[210,1606,1608],{"class":212,"line":1607},46,[210,1609,1610],{},"        reverse_proxy * https://upload.wikimedia.org {\n",[210,1612,1614],{"class":212,"line":1613},47,[210,1615,1417],{},[210,1617,1619],{"class":212,"line":1618},48,[210,1620,1422],{},[210,1622,1624],{"class":212,"line":1623},49,[210,1625,1427],{},[210,1627,1629],{"class":212,"line":1628},50,[210,1630,1432],{},[210,1632,1634],{"class":212,"line":1633},51,[210,1635,1437],{},[210,1637,1639],{"class":212,"line":1638},52,[210,1640,1442],{},[210,1642,1644],{"class":212,"line":1643},53,[210,1645,1457],{},[210,1647,1649],{"class":212,"line":1648},54,[210,1650,686],{},[34,1652,1653],{"id":1653},"简单解释",[19,1655,1656,1657,1659],{},"第一大段是启用 ",[52,1658,1355],{}," 插件的部分，直接照抄即可。",[19,1661,1662,1663,1666],{},"第二和第三大段的思路是一致的，分别反向代理了 PC 端和移动段的网页。两行 ",[52,1664,1665],{}," header_down"," 的写法是受到了知乎上那篇 Github 反代的启发，避免了源站发出 302 重定向时访客被带到源站去。replace 部分不用多说，就是将针对三个源站域名的请求改到反代站域名。",[19,1668,1669,1670,1673],{},"第四大段就是中规中举地反代了 ",[52,1671,1672],{},"upload.wikimedia.org"," 这个域名，上面存放的大多数是媒体文件，如果条件允许的话其实可以考虑使用多个服务器反代。",[19,1675,1676,1677,105],{},"密码保护在我这份 Caddyfile 中没有启用，如果有需要的话可以参考我的",[26,1678,1680],{"href":1679},"/2021/10/21/picuploader-on-archlinux-with-caddy/#%E8%AE%BE%E7%BD%AE%E8%AE%BF%E9%97%AE%E5%AF%86%E7%A0%81%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89","另一篇博客",[34,1682,1266],{"id":1266},[19,1684,1685,1690,1695,1700],{},[26,1686,1689],{"href":1687,"rel":1688},"https://caddyserver.com/docs/",[30],"Caddy 官方文档",[26,1691,1694],{"href":1692,"rel":1693},"https://zhuanlan.zhihu.com/p/476390779",[30],"The Road to Serfdom——如何为GitHub搭建反向代理",[26,1696,1699],{"href":1697,"rel":1698},"https://ichon.me/post/1026.html",[30],"使用 Caddy 配置 Wikipedia 反向代理",[26,1701,1704],{"href":1702,"rel":1703},"https://learningman.top/archives/365",[30],"使用 Caddy 反代 ghcr.io",[19,1706,1707],{},[1291,1708,1709],{},"所有参考资料除官方文档外均使用 web.archive.org 和 archive.ph 进行存档，如有无法访问的情况，请自行前往存档站获取历史存档。",[246,1711,1712],{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":1714},[1715,1716,1717,1718],{"id":1338,"depth":139,"text":1338},{"id":1371,"depth":139,"text":1372},{"id":1653,"depth":139,"text":1653},{"id":1266,"depth":139,"text":1266},{"title":1720,"date":1721,"path":1722,"tags":1723,"body":1724},"创建一个本地的 Fedora 镜像源","2022-05-11 04:18:26","/2022/05/11/setup-a-local-fedora-source",[720,1319],{"type":13,"value":1725,"toc":2074},[1726,1735,1738,1761,1764,1767,1774,1777,1780,1791,1798,1810,1816,1822,1825,1833,1850,1855,1861,1865,1868,1871,1880,1883,1889,1892,1911,1914,1920,1923,1929,1936,2001,2008,2062,2071],[16,1727,1728],{},[19,1729,1730,1731,1734],{},"Fedora 36 在多次跳票后，总算是在 5月10日正式发布了。截止北京时间 5月11日凌晨两点，上海交通大学开源镜像站的上游 ",[52,1732,1733],{},"rsync://download-ib01.fedoraproject.org/","  仍然没有同步 Fedora 36 的 Release 源。鉴于 Release 自 freeze 以后基本是不会有什么大变动的，也不需要及时同步更新，干脆就直接建立一个本地的镜像源。",[34,1736,1737],{"id":1737},"准备",[1739,1740,1741,1748,1758],"ol",{},[270,1742,1743,1744,1747],{},"一块足够大的硬盘",[1745,1746],"br",{},"根据我个人实测，单 Fedora 36 的 x86_64 架构 的 Release 源中的 binary rpm 就占用了 89.6 GB，具体准备多的的硬盘空间还得看你具体需要同步些什么。",[270,1749,1750,1751,1753,1754,1757],{},"符合要求的上游",[1745,1752],{},"这里所说的符合要求一共是两个方面，一是允许 rsync 同步，二是有你想要的文件。我通过 getfedora.org 的下载按钮的转发目标得知 ",[52,1755,1756],{},"mirror.karneval.cz"," 已经完成了 Fedora 36 Release 源的同步。",[270,1759,1760],{},"良好的网络条件",[19,1762,1763],{},"这里说的良好的网络条件，并不一定是说需要访问境外站点的能力，而是你和你的上游之间的网络访问畅通，不要动不动就i断开连接那种。如果你选择的是国内镜像站作为你的上游，那一般不会有什么问题。",[34,1765,1766],{"id":1766},"开始同步",[19,1768,1769,1770,1773],{},"现在的主流方案一般都是选择 ",[52,1771,1772],{},"rsync"," 直接开整。",[84,1775,1776],{"id":1776},"试探环节",[19,1778,1779],{},"很多镜像站的 rsync 文件路径和 http 文件路径路径是不同的。",[19,1781,1782,1783,1786,1787,1790],{},"比如说，我这里用的 mirror.karneval.cz 的 http 页面显示的 fedora 仓库路径在 ",[52,1784,1785],{},"/pub/fedora","，但 rsync 同步时需要使用 ",[52,1788,1789],{},"/fedora"," 路径。",[19,1792,1793,1794,1797],{},"为了确定这一点，我们可以先通过 ",[52,1795,1796],{},"rsync rsync://example.com"," 进行预览",[202,1799,1801],{"className":204,"code":1800,"language":206,"meta":138,"style":138},"rsync rsync://mirror.karneval.cz\n",[52,1802,1803],{"__ignoreMap":138},[210,1804,1805,1807],{"class":212,"line":213},[210,1806,1772],{"class":216},[210,1808,1809],{"class":220}," rsync://mirror.karneval.cz\n",[19,1811,1812],{},[133,1813],{"alt":1814,"src":1815},"image-20220511103736493","https://static.031130.xyz/uploads/2024/08/12/627b2177c4da2.webp",[19,1817,1818,1819],{},"通过一层一层预览目录的方式，找到需要同步的路径是 ",[52,1820,1821],{},"/fedora/linux/releases/36/Everything/x86_64/os/",[84,1823,1824],{"id":1824},"同步环节",[19,1826,1827,1828,454,1830,1832],{},"通过 ",[52,1829,358],{},[52,1831,315],{}," 创建并进入我们准备用于同步源码的文件夹，然后开始执行同步命令。",[202,1834,1836],{"className":204,"code":1835,"language":206,"meta":138,"style":138},"rsync -avP rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/ .\n",[52,1837,1838],{"__ignoreMap":138},[210,1839,1840,1842,1845,1848],{"class":212,"line":213},[210,1841,1772],{"class":216},[210,1843,1844],{"class":224}," -avP",[210,1846,1847],{"class":220}," rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/",[210,1849,341],{"class":220},[19,1851,1852],{},[1291,1853,1854],{},"Ps: 中途如果由于各种原因而中断了同步过程，可以再次使用上述命令继续同步，rsync 会保证文件完整性。",[19,1856,1857],{},[133,1858],{"alt":1859,"src":1860},"耗费两个半小时，同步成功","https://static.031130.xyz/uploads/2024/08/12/627b22fa44446.webp",[34,1862,1864],{"id":1863},"安装配置并启用-static-server-可选","安装、配置并启用 static server (可选)",[19,1866,1867],{},"如果只需要本机使用，那么直接跳过这一步即可；如果需要给局域网内的其他机器提供镜像源，那么需要启用 static server。",[19,1869,1870],{},"我这里选择的是 caddy，性能虽然比 nginx 略逊一筹，但胜在配置简单。",[19,1872,1873,1874,1879],{},"caddy 的安装可以直接参考",[26,1875,1878],{"href":1876,"rel":1877},"https://caddyserver.com/docs/install",[30],"官方文档","，这里不再赘述。",[19,1881,1882],{},"配置也不过那么几行的事情，我给个 example。端口号只要和别的程序没有冲突，就可以随意指定。443 端口需要 ssl 证书比较麻烦，局域网内直接用非标准端口即可。",[202,1884,1887],{"className":1885,"code":1886,"language":1248},[1246],":14567 {\n        root * /the/directory/you/use\n\n        file_server {\n                browse\n        }\n}\n",[52,1888,1886],{"__ignoreMap":138},[19,1890,1891],{},"配置完后直接以普通用户的权限启用即可，使用 systemd 启用需要解决 caddy 用户对目标无权限的问题。",[202,1893,1895],{"className":204,"code":1894,"language":206,"meta":138,"style":138},"caddy run --config /etc/caddy/Caddyfile\n",[52,1896,1897],{"__ignoreMap":138},[210,1898,1899,1902,1905,1908],{"class":212,"line":213},[210,1900,1901],{"class":216},"caddy",[210,1903,1904],{"class":220}," run",[210,1906,1907],{"class":224}," --config",[210,1909,1910],{"class":220}," /etc/caddy/Caddyfile\n",[19,1912,1913],{},"浏览器输入对应的 ip 和端口，应该就可以访问了。",[19,1915,1916],{},[133,1917],{"alt":1918,"src":1919},"image-20220511113417004","https://static.031130.xyz/uploads/2024/08/12/627b2ebd23331.webp",[34,1921,1922],{"id":1922},"修改源配置文件",[19,1924,1925,1926,238],{},"由于我们仅同步了 Release 源，就只需要修改 ",[52,1927,1928],{},"/etc/yum.repo.d/fedora.repo",[19,1930,1931,1932,1935],{},"如果镜像源在本机上，可以直接使用 ",[52,1933,1934],{},"file://"," 协议头:",[202,1937,1939],{"className":983,"code":1938,"language":985,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=file:///the/directory/you/use\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,1940,1941,1946,1951,1956,1961,1966,1971,1976,1981,1986,1991,1996],{"__ignoreMap":138},[210,1942,1943],{"class":212,"line":213},[210,1944,1945],{},"[fedora]\n",[210,1947,1948],{"class":212,"line":139},[210,1949,1950],{},"name=Fedora $releasever - $basearch\n",[210,1952,1953],{"class":212,"line":145},[210,1954,1955],{},"+ baseurl=file:///the/directory/you/use\n",[210,1957,1958],{"class":212,"line":571},[210,1959,1960],{},"- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\n",[210,1962,1963],{"class":212,"line":586},[210,1964,1965],{},"enabled=1\n",[210,1967,1968],{"class":212,"line":599},[210,1969,1970],{},"countme=1\n",[210,1972,1973],{"class":212,"line":612},[210,1974,1975],{},"metadata_expire=7d\n",[210,1977,1978],{"class":212,"line":621},[210,1979,1980],{},"repo_gpgcheck=0\n",[210,1982,1983],{"class":212,"line":627},[210,1984,1985],{},"type=rpm\n",[210,1987,1988],{"class":212,"line":640},[210,1989,1990],{},"gpgcheck=1\n",[210,1992,1993],{"class":212,"line":653},[210,1994,1995],{},"gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\n",[210,1997,1998],{"class":212,"line":666},[210,1999,2000],{},"skip_if_unavailable=False\n",[19,2002,2003,2004,2007],{},"如果镜像源在同局域网设备上，通过 ",[52,2005,2006],{},"http://"," 协议也能达到相同的效果:",[202,2009,2011],{"className":983,"code":2010,"language":985,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=http://192.168.1.233:14567\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,2012,2013,2017,2021,2026,2030,2034,2038,2042,2046,2050,2054,2058],{"__ignoreMap":138},[210,2014,2015],{"class":212,"line":213},[210,2016,1945],{},[210,2018,2019],{"class":212,"line":139},[210,2020,1950],{},[210,2022,2023],{"class":212,"line":145},[210,2024,2025],{},"+ baseurl=http://192.168.1.233:14567\n",[210,2027,2028],{"class":212,"line":571},[210,2029,1960],{},[210,2031,2032],{"class":212,"line":586},[210,2033,1965],{},[210,2035,2036],{"class":212,"line":599},[210,2037,1970],{},[210,2039,2040],{"class":212,"line":612},[210,2041,1975],{},[210,2043,2044],{"class":212,"line":621},[210,2045,1980],{},[210,2047,2048],{"class":212,"line":627},[210,2049,1985],{},[210,2051,2052],{"class":212,"line":640},[210,2053,1990],{},[210,2055,2056],{"class":212,"line":653},[210,2057,1995],{},[210,2059,2060],{"class":212,"line":666},[210,2061,2000],{},[19,2063,2064],{},[1291,2065,2066,2067,2070],{},"Ps: 提供镜像源的机子的局域网 ip 可以通过 ",[52,2068,2069],{},"ip -br a"," 命令获取",[246,2072,2073],{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}",{"title":138,"searchDepth":139,"depth":139,"links":2075},[2076,2077,2081,2082],{"id":1737,"depth":139,"text":1737},{"id":1766,"depth":139,"text":1766,"children":2078},[2079,2080],{"id":1776,"depth":145,"text":1776},{"id":1824,"depth":145,"text":1824},{"id":1863,"depth":139,"text":1864},{"id":1922,"depth":139,"text":1922},{"title":2084,"date":2085,"path":2086,"tags":2087,"body":2090},"好软推荐——FastOCR","2022-04-14 05:55:18","/2022/04/14/fastocr-experience",[2088,2089],"Experience","OpenSource Project",{"type":13,"value":2091,"toc":2165},[2092,2095,2109,2130,2136,2150,2156,2159],[19,2093,2094],{},"前两天在 PC 端有 OCR 的需求，需求如下",[267,2096,2097,2100,2103,2106],{},[270,2098,2099],{},"自带框选功能或者图片上传前的编辑功能",[270,2101,2102],{},"硬盘占用小，不要 electron (((已经受够了",[270,2104,2105],{},"支持系统托盘或者快捷键快速调出",[270,2107,2108],{},"免费",[19,2110,2111,2112,2117,2118,2123,2124,2129],{},"在",[26,2113,2116],{"href":2114,"rel":2115},"https://liolok.com/",[30],"李皓奇","的推荐下试用了 Arch 群",[26,2119,2122],{"href":2120,"rel":2121},"https://github.com/BruceZhang1993",[30],"兔兔","拿 python 和 qt 写的 ",[26,2125,2128],{"href":2126,"rel":2127},"https://github.com/BruceZhang1993/FastOCR",[30],"fastocr","，体验可以说是相当不错了。四个要求基本都能完美满足！",[19,2131,2132],{},[133,2133],{"alt":2134,"src":2135},"操作简单快捷","https://static.031130.xyz/uploads/2024/08/12/a4ddb3b05e19c.gif",[19,2137,2138,2139,2142,2143,2142,2146,2149],{},"支持 ",[1291,2140,2141],{},"百度","、",[1291,2144,2145],{},"有道",[1291,2147,2148],{},"旷视Face++"," 三家的接口，免费额度绝对够我试用的（大不了一家用完了换一家嘛",[19,2151,2152],{},[133,2153],{"alt":2154,"src":2155},"设置界面","https://static.031130.xyz/uploads/2024/08/12/488835757d5e3.webp",[19,2157,2158],{},"此外，空间占用小，算上依赖也不过 31MB 的硬盘空间占用，连半个 electron 都不到，运行起来反而更加流畅 \u003C^_^>",[19,2160,2161],{},[133,2162],{"alt":2163,"src":2164},"诶？哪里来的atpoossfl","https://static.031130.xyz/uploads/2024/08/12/a404346841d02.webp",{"title":138,"searchDepth":139,"depth":139,"links":2166},[],{"title":2168,"date":2169,"path":2170,"tags":2171,"body":2175},"抛弃PicGo，直接使用curl将图片上传到LskyPro","2022-03-31 19:19:14","/2022/03/31/upload-pic-to-lskypro-with-curl",[2172,2173,2174],"Shell Script","图床","Lsky Pro",{"type":13,"value":2176,"toc":2600},[2177,2184,2202,2214,2223,2228,2231,2234,2245,2248,2581,2586,2589,2592,2597],[19,2178,2179,2180,2183],{},"前一阵子为了图床折腾了好长一段时间。刚开始用的是 cloudinary，虽然每月有限制，但强在境内访问速度还不错，可惜后来 ",[52,2181,2182],{},"res.cloudinary.com"," 这个域名在某些地方被 DNS 污染了，而自定义域名是付费版的功能，就不得不放弃了。",[19,2185,2186,2187,2190,2191,2196,2197,105],{},"后来也尝试过 npm图床 的方案，可惜面对这种滥用公共资源的行为我无法接受~~（肯定不是因为受不了那繁琐的上传步骤，随便传张图都得 bump 下版本号的原因）~~，而且现在境内的能作为图床使用的 npm 镜像似乎也就只剩下 ",[52,2188,2189],{},"npm.elemecdn.com"," 这一个能够正常回源了，没准哪天就用不了了，所以就去投奔了",[26,2192,2195],{"href":2193,"rel":2194},"https://dusays.com/",[30],"杜老师","的",[26,2198,2201],{"href":2199,"rel":2200},"https://7bu.top/",[30],"去不图床",[19,2203,2204,2205,2209,2210,2213],{},"去不图床采用开源图床程序 ",[26,2206,2174],{"href":2207,"rel":2208},"https://www.lsky.pro/",[30]," 搭建，没有免费服务，且配置了鉴黄服务，看起来就是打算长久做下去的图床站点。境内使用腾讯云cdn，境外采用 cloudflare cdn，速度都挺让我满意的。",[167,2211,2212],{},"（杜老师看见请给我打钱，或者多送我点空间也行","（x",[19,2215,2216,2217,2222],{},"Typora 一直是我写博客的主用 Markdown 编辑器，之前我采用 Typora 调用 ",[26,2218,2221],{"href":2219,"rel":2220},"https://github.com/xiebruce/PicUploader",[30],"PicUploader(php)"," 自动上传图片的方案写博客，体验相当不错，如图:",[19,2224,2225],{},[133,2226],{"alt":138,"src":2227},"https://static.031130.xyz/uploads/2024/08/12/62f3b881e3c4c.gif",[19,2229,2230],{},"可惜 PicUploader 目前仍然没有支持 LskyPro 的上传，我采用的是现在烂大街的 Typora+PicGo+LskyPro插件 的方案去实现 Typora 的自动上传图片功能。",[19,2232,2233],{},"这个方案有明显的弊端：",[267,2235,2236,2239,2242],{},[270,2237,2238],{},"PicGo 运行依赖于 electron，极大地消耗了系统资源。",[270,2240,2241],{},"PicGo 面对多张图片( >=4张 )同时上传时容易报错。",[270,2243,2244],{},"PicGo 对于 Linux 的支持比较有限，作者可能不熟悉 Linux，直到半个月前我去交了一个 pr 才支持 wayland 下使用 wl-clipboard 将图片链接复制到粘贴版。",[19,2246,2247],{},"正好 LskyPro 有详细的文档，应该可以用 curl 手糊一段 Shell 脚本实现直接上传，资源占用小，唯一的弊端是上传完成后的图片不容易管理。脚本如下",[202,2249,2251],{"className":204,"code":2250,"language":206,"meta":138,"style":138},"#!/bin/bash\n\nAPI_URL=\"https://7bu.top/api/v1\"\n\nAUTH_TOKEN=\"\"\n\nmarkdown=false\nwhile [[ \"$#\" -gt 0 ]]; do\n    case $1 in\n        -m|--markdown) markdown=true; shift ;;\n        *) break ;;\n    esac\ndone\n\nfor images in \"$@\"; do\n    UPLOAD_RESPONSE=$(curl -s -X POST \"$API_URL/upload\" \\\n        -H 'Content-Type: multipart/form-data' \\\n        -H \"Authorization: Bearer $AUTH_TOKEN\" \\\n        -F \"file=@$images\")\n\n    if [ \"$markdown\" = true ]; then\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.markdown\n    else\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.url\n    fi\ndone\n",[52,2252,2253,2258,2262,2273,2277,2287,2291,2301,2329,2341,2373,2383,2388,2393,2397,2420,2453,2463,2477,2493,2497,2524,2548,2553,2572,2577],{"__ignoreMap":138},[210,2254,2255],{"class":212,"line":213},[210,2256,992],{"class":2257},"sJ8bj",[210,2259,2260],{"class":212,"line":139},[210,2261,1398],{"emptyLinePlaceholder":1397},[210,2263,2264,2267,2270],{"class":212,"line":145},[210,2265,2266],{"class":311},"API_URL",[210,2268,2269],{"class":361},"=",[210,2271,2272],{"class":220},"\"https://7bu.top/api/v1\"\n",[210,2274,2275],{"class":212,"line":571},[210,2276,1398],{"emptyLinePlaceholder":1397},[210,2278,2279,2282,2284],{"class":212,"line":586},[210,2280,2281],{"class":311},"AUTH_TOKEN",[210,2283,2269],{"class":361},[210,2285,2286],{"class":220},"\"\"\n",[210,2288,2289],{"class":212,"line":599},[210,2290,1398],{"emptyLinePlaceholder":1397},[210,2292,2293,2296,2298],{"class":212,"line":612},[210,2294,2295],{"class":311},"markdown",[210,2297,2269],{"class":361},[210,2299,2300],{"class":220},"false\n",[210,2302,2303,2306,2309,2312,2315,2317,2320,2323,2326],{"class":212,"line":621},[210,2304,2305],{"class":361},"while",[210,2307,2308],{"class":311}," [[ ",[210,2310,2311],{"class":220},"\"",[210,2313,2314],{"class":224},"$#",[210,2316,2311],{"class":220},[210,2318,2319],{"class":361}," -gt",[210,2321,2322],{"class":224}," 0",[210,2324,2325],{"class":311}," ]]; ",[210,2327,2328],{"class":361},"do\n",[210,2330,2331,2334,2338],{"class":212,"line":627},[210,2332,2333],{"class":361},"    case",[210,2335,2337],{"class":2336},"s4XuR"," $1",[210,2339,2340],{"class":361}," in\n",[210,2342,2343,2347,2350,2353,2356,2359,2361,2364,2367,2370],{"class":212,"line":640},[210,2344,2346],{"class":2345},"sA_wV","        -m",[210,2348,2349],{"class":361},"|",[210,2351,2352],{"class":2345},"--markdown",[210,2354,2355],{"class":361},")",[210,2357,2358],{"class":311}," markdown",[210,2360,2269],{"class":361},[210,2362,2363],{"class":220},"true",[210,2365,2366],{"class":311},"; ",[210,2368,2369],{"class":224},"shift",[210,2371,2372],{"class":311}," ;;\n",[210,2374,2375,2378,2381],{"class":212,"line":653},[210,2376,2377],{"class":361},"        *)",[210,2379,2380],{"class":361}," break",[210,2382,2372],{"class":311},[210,2384,2385],{"class":212,"line":666},[210,2386,2387],{"class":361},"    esac\n",[210,2389,2390],{"class":212,"line":677},[210,2391,2392],{"class":361},"done\n",[210,2394,2395],{"class":212,"line":683},[210,2396,1398],{"emptyLinePlaceholder":1397},[210,2398,2399,2402,2405,2408,2411,2414,2416,2418],{"class":212,"line":1057},[210,2400,2401],{"class":361},"for",[210,2403,2404],{"class":311}," images ",[210,2406,2407],{"class":361},"in",[210,2409,2410],{"class":220}," \"",[210,2412,2413],{"class":224},"$@",[210,2415,2311],{"class":220},[210,2417,2366],{"class":311},[210,2419,2328],{"class":361},[210,2421,2422,2425,2427,2430,2433,2436,2439,2442,2444,2447,2450],{"class":212,"line":1063},[210,2423,2424],{"class":311},"    UPLOAD_RESPONSE",[210,2426,2269],{"class":361},[210,2428,2429],{"class":311},"$(",[210,2431,2432],{"class":216},"curl",[210,2434,2435],{"class":224}," -s",[210,2437,2438],{"class":224}," -X",[210,2440,2441],{"class":220}," POST",[210,2443,2410],{"class":220},[210,2445,2446],{"class":311},"$API_URL",[210,2448,2449],{"class":220},"/upload\"",[210,2451,2452],{"class":224}," \\\n",[210,2454,2455,2458,2461],{"class":212,"line":3},[210,2456,2457],{"class":224},"        -H",[210,2459,2460],{"class":220}," 'Content-Type: multipart/form-data'",[210,2462,2452],{"class":224},[210,2464,2465,2467,2470,2473,2475],{"class":212,"line":1074},[210,2466,2457],{"class":224},[210,2468,2469],{"class":220}," \"Authorization: Bearer ",[210,2471,2472],{"class":311},"$AUTH_TOKEN",[210,2474,2311],{"class":220},[210,2476,2452],{"class":224},[210,2478,2479,2482,2485,2488,2490],{"class":212,"line":1080},[210,2480,2481],{"class":224},"        -F",[210,2483,2484],{"class":220}," \"file=@",[210,2486,2487],{"class":311},"$images",[210,2489,2311],{"class":220},[210,2491,2492],{"class":311},")\n",[210,2494,2495],{"class":212,"line":1086},[210,2496,1398],{"emptyLinePlaceholder":1397},[210,2498,2499,2502,2505,2507,2510,2512,2515,2518,2521],{"class":212,"line":1092},[210,2500,2501],{"class":361},"    if",[210,2503,2504],{"class":311}," [ ",[210,2506,2311],{"class":220},[210,2508,2509],{"class":311},"$markdown",[210,2511,2311],{"class":220},[210,2513,2514],{"class":361}," =",[210,2516,2517],{"class":224}," true",[210,2519,2520],{"class":311}," ]; ",[210,2522,2523],{"class":361},"then\n",[210,2525,2526,2529,2531,2534,2536,2539,2542,2545],{"class":212,"line":1484},[210,2527,2528],{"class":224},"        echo",[210,2530,2410],{"class":220},[210,2532,2533],{"class":311},"$UPLOAD_RESPONSE",[210,2535,2311],{"class":220},[210,2537,2538],{"class":361}," |",[210,2540,2541],{"class":216}," jq",[210,2543,2544],{"class":224}," -r",[210,2546,2547],{"class":220}," .data.links.markdown\n",[210,2549,2550],{"class":212,"line":1489},[210,2551,2552],{"class":361},"    else\n",[210,2554,2555,2557,2559,2561,2563,2565,2567,2569],{"class":212,"line":1494},[210,2556,2528],{"class":224},[210,2558,2410],{"class":220},[210,2560,2533],{"class":311},[210,2562,2311],{"class":220},[210,2564,2538],{"class":361},[210,2566,2541],{"class":216},[210,2568,2544],{"class":224},[210,2570,2571],{"class":220}," .data.links.url\n",[210,2573,2574],{"class":212,"line":1499},[210,2575,2576],{"class":361},"    fi\n",[210,2578,2579],{"class":212,"line":1505},[210,2580,2392],{"class":361},[16,2582,2583],{},[19,2584,2585],{},"2022/04/02更新: 第六行 $@ - \"$@\"，解决文件名中出现空格时导致的上传失败问题。",[19,2587,2588],{},"需要借助 jq 来读取返回的 json，各 Linux 发行版源内应该都有打包，自行安装即可。",[19,2590,2591],{},"授予x可执行权限后，Typora 内直接填写自定义命令输入脚本所在位置即可实现 Typora 自动上传图片了。",[16,2593,2594],{},[19,2595,2596],{},"2023/12/12更新: 支持 -m 或 --markdown 参数，使脚本输出 markdown 格式的链接。",[246,2598,2599],{},"html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .s4XuR, html code.shiki .s4XuR{--shiki-default:#E36209;--shiki-dark:#FFAB70}html pre.shiki code .sA_wV, html code.shiki .sA_wV{--shiki-default:#032F62;--shiki-dark:#DBEDFF}html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":2601},[],127,1761699630992]