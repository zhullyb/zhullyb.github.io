[{"data":1,"prerenderedAt":2600},["ShallowReactive",2],{"randomIndex/archives/page/8/":3,"index-page-8":4,"posts-nums-total":2599},0,[5,149,251,709,864,1098,1309,1714,2078,2162],{"title":6,"date":7,"path":8,"tags":9,"body":12},"使用 VirtScreen 将 Pad 作为副屏","2022-10-04 00:19:20","/2022/10/04/use-virtscreen-to-turn-pad-into-another-screen",[10,11],"Linux","Hardware",{"type":13,"value":14,"toc":137},"minimark",[15,22,33,37,40,48,64,67,74,80,83,87,94,97,106,109,112,115,118,121,124,127,130],[16,17,18],"blockquote",{},[19,20,21],"p",{},"由于浙江工地大专的朝晖尚9宿舍实在是太小了，我没有办法放下一块便携显示屏，所以只能把家中闲置的 Huawei Pad M6 作为自己的副屏。",[19,23,24,25,32],{},"经过一轮搜索下来，我找到了 ",[26,27,31],"a",{"href":28,"rel":29},"https://github.com/kbumsik/VirtScreen",[30],"nofollow","VirtScreen"," 作为工具。",[34,35,36],"h2",{"id":36},"安装",[19,38,39],{},"在 Archlinux 上，大概有三种以上的方式进行安装:",[19,41,42,43],{},"一、使用 AUR 上的 ",[26,44,47],{"href":45,"rel":46},"https://aur.archlinux.org/package/virtscreen/",[30],"virtscreen",[19,49,50,51,55,56,59,60,63],{},"遇到的唯一一个麻烦是作为依赖之一的 ",[52,53,54],"code",{},"python-quamash"," 在 python3.10 上无法直接安装。通过 AUR 的评论区得知，需要将 ",[52,57,58],{},"collections.Mapping"," 改为 ",[52,61,62],{},"collections.abc.Mapping"," 方可通过安装。",[19,65,66],{},"二、使用 dderjoel 的 fork 进行安装",[19,68,69,70],{},"见 ",[26,71,72],{"href":72,"rel":73},"https://github.com/dderjoel/VirtScreen/blob/master/package/archlinux/PKGBUILD",[30],[19,75,76,77],{},"三、直接通过 appimage 安装，不过需要自己手动安装 ",[52,78,79],{},"x11vnc",[34,81,82],{"id":82},"配置",[84,85,86],"h3",{"id":86},"系统层",[19,88,89,90,93],{},"打开软件以后，我们需要先在 ",[52,91,92],{},"Display->Virtual Display->Advaced"," 选择 VIRTUAL1 作为显示屏。",[19,95,96],{},"如果没有这个选项，可能需要根据自己的显卡做出相应的调整。",[19,98,99,100,105],{},"可以参考 ",[26,101,104],{"href":102,"rel":103},"https://wiki.archlinux.org/title/Extreme_Multihead#Using_a_virtual_output",[30],"ArchWiki","。",[84,107,108],{"id":108},"软件层",[19,110,111],{},"在这里，我们需要根据我们作为副屏的设备的屏幕分辨率来计算我们需要在 VirtScreen 中设置的分辨率参数。",[19,113,114],{},"我的 Huawei Pad M6 是 2560*1600 的分辨率，但 VirtScreen 最高支持只有 1920*1080，所以我们需要选择 1280*800，并开启高分辨率选项。",[19,116,117],{},"VNC 那边只需要根据自己的需求设置一下密码即可。",[34,119,120],{"id":120},"使用",[19,122,123],{},"在 VirtScreen 的 Display 界面点击 \"Enable Virtual Screen\"，切换到 VNC 界面点击 \"Start VNC Server\"，可以勾选右侧的 \"Auto\"。",[19,125,126],{},"Pad 端只需要安装任意一个 VNC 客户端即可，我这里使用的是\"VNC Viewer\"。",[34,128,129],{"id":129},"图片",[19,131,132],{},[133,134],"img",{"alt":135,"src":136},"效果图","https://static.031130.xyz/uploads/2024/08/12/633b1bd1ba8f4.webp",{"title":138,"searchDepth":139,"depth":139,"links":140},"",2,[141,142,147,148],{"id":36,"depth":139,"text":36},{"id":82,"depth":139,"text":82,"children":143},[144,146],{"id":86,"depth":145,"text":86},3,{"id":108,"depth":145,"text":108},{"id":120,"depth":139,"text":120},{"id":129,"depth":139,"text":129},{"title":150,"date":151,"path":152,"tags":153,"body":156},"在 Archlinux 下使用 l2tp 协议连接校园网","2022-09-29 14:30:46","/2022/09/29/use-l2tp-protocol-to-connect-internet",[154,155],"Archlinux","Network",{"type":13,"value":157,"toc":249},[158,163,171,177,180,189,198,201,229,232,239,245],[16,159,160],{},[19,161,162],{},"由于高考爆炸，所以不得不进入浙江工地大专来度过自己接下来四年的人生（希望到时候可以借助学校的力量润出去）。",[19,164,165,166,170],{},"学校这边由于某些不可描述的原因，将校园卡与宽带捆绑销售，且每次登陆校园网时都需要使用定制的 l2tp 协议客户端进行上网，且该客户端将会禁用用户的无线网卡（",[167,168,169],"del",{},"这不明摆着想让我们宿舍每个人都花一次钱","）。",[19,172,173],{},[133,174],{"alt":175,"src":176},"学校定制的 l2tp 拨号客户端","https://static.031130.xyz/uploads/2024/08/12/63353e0e1978c.webp",[19,178,179],{},"更惨的是，学校仅提供了 Windows 与 MacOS 的客户端。",[19,181,182,183,188],{},"在 ",[26,184,187],{"href":185,"rel":186},"https://imbearchild.cyou/",[30],"BearChild"," 的提醒下，我意识到 Linux 下也可以有 l2tp 协议。",[19,190,191,192,197],{},"谷歌搜索了一番，我在简书上捞到了这篇文章",[26,193,196],{"href":194,"rel":195},"https://www.jianshu.com/p/85cd5bd3c7a2",[30],"《ubuntu 连校园网 via l2tp》","。不过这显然有些麻烦，我们的客户端不需要 pppoe 拨号，只需要插上网线后连接 l2tp 协议即可联网。",[19,199,200],{},"所幸，NetworkManager 非常贴心地为我们提供了 l2tp 的插件，在 Archlinux 下使用如下命令即可完成安装。",[202,203,207],"pre",{"className":204,"code":205,"language":206,"meta":138,"style":138},"language-bash shiki shiki-themes one-light one-dark-pro","sudo pacman -S networkmanager-l2tp\n","bash",[52,208,209],{"__ignoreMap":138},[210,211,214,218,222,226],"span",{"class":212,"line":213},"line",1,[210,215,217],{"class":216},"sAdtL","sudo",[210,219,221],{"class":220},"sDhpE"," pacman",[210,223,225],{"class":224},"sAGMh"," -S",[210,227,228],{"class":220}," networkmanager-l2tp\n",[19,230,231],{},"安装完成后，就可以在图形化界面下进行我们的设置操作。",[19,233,234,235,238],{},"由于定制的客户端已经把 l2tp 服务器 ip 写死且显示在界面上了，我们就不需要再去抓包截取服务器 ip，直接使用这边的 ",[52,236,237],{},"192.168.115.1"," 即可。",[19,240,241],{},[133,242],{"alt":243,"src":244},"KDE 下的 NetworkManager l2tp 设置界面","https://static.031130.xyz/uploads/2024/08/12/63354161dbe28.webp",[246,247,248],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":250},[],{"title":252,"date":253,"path":254,"tags":255,"body":256},"为 Element 添加自己喜欢的贴纸","2022-08-10 19:51:19","/2022/08/10/add-sticker-support-for-element",null,{"type":13,"value":257,"toc":701},[258,263,266,282,290,293,320,324,327,343,347,350,372,375,378,403,410,414,421,438,441,452,458,461,464,467,487,491,494,501,507,513,519,526,532,535,681,687,690,693,698],[16,259,260],{},[19,261,262],{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[34,264,265],{"id":265},"需要准备的",[267,268,269,273,276,279],"ul",{},[270,271,272],"li",{},"PC 端 element",[270,274,275],{},"python3.6+ 环境",[270,277,278],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[270,280,281],{},"可能需要能够突破大局域网限制的网络环境",[19,283,284,285],{},"需要用到的项目 ",[26,286,289],{"href":287,"rel":288},"https://github.com/maunium/stickerpicker",[30],"maunium/stickerpicker",[34,291,292],{"id":292},"克隆主项目",[202,294,296],{"className":204,"code":295,"language":206,"meta":138,"style":138},"git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n",[52,297,298],{"__ignoreMap":138},[210,299,300,303,306,309,313,317],{"class":212,"line":213},[210,301,302],{"class":216},"git",[210,304,305],{"class":220}," clone",[210,307,308],{"class":220}," https://github.com/maunium/stickerpicker.git",[210,310,312],{"class":311},"s5ixo"," && ",[210,314,316],{"class":315},"s_Sar","cd",[210,318,319],{"class":220}," stickerpicker\n",[34,321,323],{"id":322},"使用-pip-安装依赖","使用 pip 安装依赖",[19,325,326],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[202,328,330],{"className":204,"code":329,"language":206,"meta":138,"style":138},"pip install .\n",[52,331,332],{"__ignoreMap":138},[210,333,334,337,340],{"class":212,"line":213},[210,335,336],{"class":216},"pip",[210,338,339],{"class":220}," install",[210,341,342],{"class":220}," .\n",[34,344,346],{"id":345},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[19,348,349],{},"在项目根目录下创新一个新的目录。",[202,351,353],{"className":204,"code":352,"language":206,"meta":138,"style":138},"mkdir \u003Cpack directory>\n",[52,354,355],{"__ignoreMap":138},[210,356,357,360,363,366,369],{"class":212,"line":213},[210,358,359],{"class":216},"mkdir",[210,361,362],{"class":311}," \u003C",[210,364,365],{"class":220},"pack",[210,367,368],{"class":220}," director",[210,370,371],{"class":311},"y>\n",[19,373,374],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[19,376,377],{},"执行命令进行打包",[202,379,381],{"className":204,"code":380,"language":206,"meta":138,"style":138},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[52,382,383],{"__ignoreMap":138},[210,384,385,388,390,392,394,397,400],{"class":212,"line":213},[210,386,387],{"class":216},"sticker-pack",[210,389,362],{"class":311},[210,391,365],{"class":220},[210,393,368],{"class":220},[210,395,396],{"class":311},"y> ",[210,398,399],{"class":224},"--add-to-index",[210,401,402],{"class":220}," web/packs/\n",[19,404,405,406,409],{},"如果想要给目录贴纸包命名，则可以追加",[52,407,408],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[34,411,413],{"id":412},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[19,415,416,417,420],{},"项目内已经为我们准备了 ",[52,418,419],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[202,422,424],{"className":204,"code":423,"language":206,"meta":138,"style":138},"sticker-import \u003Cpack_url>\n",[52,425,426],{"__ignoreMap":138},[210,427,428,430,432,435],{"class":212,"line":213},[210,429,419],{"class":216},[210,431,362],{"class":311},[210,433,434],{"class":220},"pack_ur",[210,436,437],{"class":311},"l>\n",[19,439,440],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[19,442,443,444,447,448,451],{},"matrix 的 ",[52,445,446],{},"homeserver"," 和 ",[52,449,450],{},"access token"," 可以在 PC 端 element 的设置里找到",[19,453,454],{},[133,455],{"alt":456,"src":457},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[19,459,460],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[19,462,463],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[465,466],"hr",{},[19,468,469,470,473,474,477,478,483,484],{},"接着我们需要做的事情就是将 ",[52,471,472],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[52,475,476],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[26,479,482],{"href":480,"rel":481},"https://blog.zhaose.cyou/",[30],"@朝色"," 的 url 也可以直接拿来使用 ",[52,485,486],{},"https://sticker.zhaose.cyou/web/",[34,488,490],{"id":489},"添加到-element","添加到 element",[19,492,493],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[19,495,496,497,500],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[52,498,499],{},"/devtools"," 并发送",[19,502,503],{},[133,504],{"alt":505,"src":506},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[19,508,509,510],{},"将会出现如下页面，选择 ",[52,511,512],{},"Explore account data",[19,514,515],{},[133,516],{"alt":517,"src":518},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[19,520,521,522,525],{},"找到 ",[52,523,524],{},"m.widgets","，如果没有，就点击下图标出的按钮",[19,527,528],{},[133,529],{"alt":530,"src":531},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[19,533,534],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[202,536,540],{"className":537,"code":538,"language":539,"meta":138,"style":138},"language-json shiki shiki-themes one-light one-dark-pro","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[52,541,542,547,556,563,578,591,604,613,619,632,645,658,669,675],{"__ignoreMap":138},[210,543,544],{"class":212,"line":213},[210,545,546],{"class":311},"{\n",[210,548,549,553],{"class":212,"line":139},[210,550,552],{"class":551},"sJa8x","    \"stickerpicker\"",[210,554,555],{"class":311},": {\n",[210,557,558,561],{"class":212,"line":145},[210,559,560],{"class":551},"        \"content\"",[210,562,555],{"class":311},[210,564,566,569,572,575],{"class":212,"line":565},4,[210,567,568],{"class":551},"            \"type\"",[210,570,571],{"class":311},": ",[210,573,574],{"class":220},"\"m.stickerpicker\"",[210,576,577],{"class":311},",\n",[210,579,581,584,586,589],{"class":212,"line":580},5,[210,582,583],{"class":551},"            \"url\"",[210,585,571],{"class":311},[210,587,588],{"class":220},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[210,590,577],{"class":311},[210,592,594,597,599,602],{"class":212,"line":593},6,[210,595,596],{"class":551},"            \"name\"",[210,598,571],{"class":311},[210,600,601],{"class":220},"\"Stickerpicker\"",[210,603,577],{"class":311},[210,605,607,610],{"class":212,"line":606},7,[210,608,609],{"class":551},"            \"data\"",[210,611,612],{"class":311},": {}\n",[210,614,616],{"class":212,"line":615},8,[210,617,618],{"class":311},"        },\n",[210,620,622,625,627,630],{"class":212,"line":621},9,[210,623,624],{"class":551},"        \"sender\"",[210,626,571],{"class":311},[210,628,629],{"class":220},"\"@you:matrix.server.name\"",[210,631,577],{"class":311},[210,633,635,638,640,643],{"class":212,"line":634},10,[210,636,637],{"class":551},"        \"state_key\"",[210,639,571],{"class":311},[210,641,642],{"class":220},"\"stickerpicker\"",[210,644,577],{"class":311},[210,646,648,651,653,656],{"class":212,"line":647},11,[210,649,650],{"class":551},"        \"type\"",[210,652,571],{"class":311},[210,654,655],{"class":220},"\"m.widget\"",[210,657,577],{"class":311},[210,659,661,664,666],{"class":212,"line":660},12,[210,662,663],{"class":551},"        \"id\"",[210,665,571],{"class":311},[210,667,668],{"class":220},"\"stickerpicker\"\n",[210,670,672],{"class":212,"line":671},13,[210,673,674],{"class":311},"    }\n",[210,676,678],{"class":212,"line":677},14,[210,679,680],{"class":311},"}\n",[19,682,683],{},[133,684],{"alt":685,"src":686},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[19,688,689],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[19,691,692],{},"补一张效果图",[19,694,695],{},[133,696],{"alt":135,"src":697},"https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[246,699,700],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":138,"searchDepth":139,"depth":139,"links":702},[703,704,705,706,707,708],{"id":265,"depth":139,"text":265},{"id":292,"depth":139,"text":292},{"id":322,"depth":139,"text":323},{"id":345,"depth":139,"text":346},{"id":412,"depth":139,"text":413},{"id":489,"depth":139,"text":490},{"title":710,"date":711,"path":712,"tags":713,"body":717},"nodejs16：是我配不上 openssl 3 咯？","2022-08-04 17:31:49","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16",[714,715,716],"Fedora","nodejs","OpenSSL",{"type":13,"value":718,"toc":862},[719,725,728,744,759,762,765,767,770,779,785,788,832,834,857],[19,720,721],{},[133,722],{"alt":723,"src":724},"长毛象的截图.png","https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp",[19,726,727],{},"今年上半年升级 Fedora 36 的时候遇到了这个问题。",[19,729,730,731,734,735,740,741,743],{},"那会儿很无奈，一直在等 nodejs16 合并提供 ",[52,732,733],{},"--openssl-legacy-provider"," 的",[26,736,739],{"href":737,"rel":738},"https://github.com/nodejs/node/pull/42972",[30],"那个 PR","。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 ",[52,742,733],{}," 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。",[19,745,746,747,752,753,758],{},"然而，nodejs 在他们的官网上发布的",[26,748,751],{"href":749,"rel":750},"https://nodejs.org/en/blog/announcements/nodejs16-eol/",[30],"一篇博客","刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有",[26,754,757],{"href":755,"rel":756},"https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/",[30],"寒晶雪提供的中文翻译","）",[19,760,761],{},"博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）",[19,763,764],{},"很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。",[465,766],{},[19,768,769],{},"不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）",[19,771,772,773,778],{},"前几天我给 ",[26,774,777],{"href":775,"rel":776},"https://github.com/atpoossfl/repo",[30],"atpoossfl 仓库","打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。",[19,780,781],{},[133,782],{"alt":783,"src":784},"此为 nvm 安装的 nodejs14 目录","https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp",[19,786,787],{},"所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。",[16,789,790],{},[19,791,792,793,796,797,800,801,804,805,808,809,814,815,818,819,822,823,826,827,447,829,831],{},"使用 Fedora 的用户需要注意，Fedora 官方源中的",[52,794,795],{},"yarnpkg","在打包时遇到了错误，他们将 ",[52,798,799],{},"/usr/lib/node_modules/yarn/bin/yarn.js"," 的 shebang 给改成了 ",[52,802,803],{},"#!/usr/bin/node","，应当改回 ",[52,806,807],{},"#!/usr/bin/env node","才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 ",[26,810,813],{"href":811,"rel":812},"https://dl.yarnpkg.com/rpm/yarn.repo",[30],"dl.yarnpkg.com"," 提供的 ",[52,816,817],{},"yarn"," 软件包。在写 specfile 的 ",[52,820,821],{},"BuildRequires"," 时，可以直接写成 ",[52,824,825],{},"/usr/bin/yarn"," 来避免频繁在 ",[52,828,817],{},[52,830,795],{}," 这两个包名间改动。",[465,833],{},[19,835,836,837,447,840,843,844,846,847,852,853,856],{},"更好的消息是，nodejs 已经在 ",[52,838,839],{},"v16.17.0-proposal",[52,841,842],{},"v16.x-staging"," 分支收下了这个为 nodejs16 提供 ",[52,845,733],{}," 的 ",[26,848,851],{"href":849,"rel":850},"https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f",[30],"commit","。相信在不久的将来，这个 commit 将会进入主线，并在 ",[52,854,855],{},"v16.17"," 版本的 nodejs16 上发挥它的作用。",[19,858,859],{},[133,860],{"alt":851,"src":861},"https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp",{"title":138,"searchDepth":139,"depth":139,"links":863},[],{"title":865,"date":866,"path":867,"tags":868,"body":870},"如何拯救失声的 hollywood","2022-07-25 11:25:44","/2022/07/25/restore-the-sound-of-hollywood",[869,10],"Fun",{"type":13,"value":871,"toc":1096},[872,875,884,887,892,895,898,906,917,937,948,957,960,975,1091,1094],[19,873,874],{},"我刚开始接触 Linux 下的 hollywood 时，我记得它运行时是有声音的，应该是 007 的主题音乐，如今再次装上 hollywood，却发现音乐没了。",[19,876,877,878,883],{},"在 Github 找到 hollywood，发现有一个 ",[26,879,882],{"href":880,"rel":881},"https://github.com/dustinkirkland/hollywood/issues/58",[30],"issue"," 也提到了这个问题。",[19,885,886],{},"原作者在该 issue 中回复道",[16,888,889],{},[19,890,891],{},"没错，它只是一段视频，音频受到版权保护。",[19,893,894],{},"所以不难看出，作者因为版权问题而去掉了音频，进而导致 hollywood 失声。但我们作为用户，是不是可以想办法获取到老版本中那段带有音频的 mp4 文件呢？",[19,896,897],{},"答案是肯定的。",[19,899,900,901,105],{},"得益于 git 的版本控制特色，在 hollywood 的 github 仓库中，我们可以找到原来的 ",[26,902,905],{"href":903,"rel":904},"https://github.com/dustinkirkland/hollywood/blob/67839229f878a08521885e9fc05dd2d3ba10ddd1/share/hollywood/mi.mp4",[30],"mp4 文件",[19,907,908,909,912,913,916],{},"下载这个 mp4 文件后，我们将其放入 ",[52,910,911],{},"/usr/share/hollywood/"," 路径下，重命名为 ",[52,914,915],{},"soundwave.mp4","，并确保其被正确设定为 0644 权限。",[202,918,920],{"className":204,"code":919,"language":206,"meta":138,"style":138},"sudo install -Dm644 ./mi.mp4 /usr/share/hollywood/soundwave.mp4\n",[52,921,922],{"__ignoreMap":138},[210,923,924,926,928,931,934],{"class":212,"line":213},[210,925,217],{"class":216},[210,927,339],{"class":220},[210,929,930],{"class":224}," -Dm644",[210,932,933],{"class":220}," ./mi.mp4",[210,935,936],{"class":220}," /usr/share/hollywood/soundwave.mp4\n",[19,938,939,940,943,944,947],{},"接下来试着跑一跑 ",[52,941,942],{},"hollywood","，发现依然没有声音。再次查阅源码，发现缺少了 ",[52,945,946],{},"mplayer"," 这个依赖。",[19,949,950,951,953,954,956],{},"使用包管理器安装 ",[52,952,946],{}," 后，运行 ",[52,955,942],{}," 就可以听到声音了。",[19,958,959],{},"然而，你觉不觉得这个音乐。。。听上去怪怪的。。。",[19,961,962,963,965,966,971,972],{},"没错，作者在去掉音频后，给 ",[52,964,915],{}," ",[26,967,970],{"href":968,"rel":969},"https://github.com/dustinkirkland/hollywood/commit/95f77d570d86cd8b8fe0e0939049609f81d1bae0#diff-3e2bf53af1a38136a109ac4fa1b11189e7b6fcd4385e1c68683093f73c6ac485",[30],"设定了加速播放","。而我们现在需要这段视频被原速播放。编辑 ",[52,973,974],{},"/usr/lib/hollywood/mplayer",[202,976,980],{"className":977,"code":978,"language":979,"meta":138,"style":138},"language-diff shiki shiki-themes one-light one-dark-pro","#!/bin/bash\n#\n# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\ncommand -v mplayer >/dev/null 2>&1 || exit 1\ntrap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\nPKG=hollywood\ndir=\"$(dirname $0)/../../share/$PKG\"\n-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n","diff",[52,981,982,987,992,997,1001,1006,1011,1016,1020,1025,1029,1034,1039,1044,1049,1055,1061,1067,1073,1079,1085],{"__ignoreMap":138},[210,983,984],{"class":212,"line":213},[210,985,986],{},"#!/bin/bash\n",[210,988,989],{"class":212,"line":139},[210,990,991],{},"#\n",[210,993,994],{"class":212,"line":145},[210,995,996],{},"# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n",[210,998,999],{"class":212,"line":565},[210,1000,991],{},[210,1002,1003],{"class":212,"line":580},[210,1004,1005],{},"# Licensed under the Apache License, Version 2.0 (the \"License\");\n",[210,1007,1008],{"class":212,"line":593},[210,1009,1010],{},"# you may not use this file except in compliance with the License.\n",[210,1012,1013],{"class":212,"line":606},[210,1014,1015],{},"# You may obtain a copy of the License at\n",[210,1017,1018],{"class":212,"line":615},[210,1019,991],{},[210,1021,1022],{"class":212,"line":621},[210,1023,1024],{},"#    http://www.apache.org/licenses/LICENSE-2.0\n",[210,1026,1027],{"class":212,"line":634},[210,1028,991],{},[210,1030,1031],{"class":212,"line":647},[210,1032,1033],{},"# Unless required by applicable law or agreed to in writing, software\n",[210,1035,1036],{"class":212,"line":660},[210,1037,1038],{},"# distributed under the License is distributed on an \"AS IS\" BASIS,\n",[210,1040,1041],{"class":212,"line":671},[210,1042,1043],{},"# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",[210,1045,1046],{"class":212,"line":677},[210,1047,1048],{},"# See the License for the specific language governing permissions and\n",[210,1050,1052],{"class":212,"line":1051},15,[210,1053,1054],{},"# limitations under the License.\n",[210,1056,1058],{"class":212,"line":1057},16,[210,1059,1060],{},"command -v mplayer >/dev/null 2>&1 || exit 1\n",[210,1062,1064],{"class":212,"line":1063},17,[210,1065,1066],{},"trap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\n",[210,1068,1070],{"class":212,"line":1069},18,[210,1071,1072],{},"PKG=hollywood\n",[210,1074,1076],{"class":212,"line":1075},19,[210,1077,1078],{},"dir=\"$(dirname $0)/../../share/$PKG\"\n",[210,1080,1082],{"class":212,"line":1081},20,[210,1083,1084],{},"-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n",[210,1086,1088],{"class":212,"line":1087},21,[210,1089,1090],{},"+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n",[19,1092,1093],{},"再次运行，确认修改已经成功。",[246,1095,248],{},{"title":138,"searchDepth":139,"depth":139,"links":1097},[],{"title":1099,"date":1100,"path":1101,"tags":1102,"body":1105},"处理 fcitx5 的文字候选框在 tg 客户端上闪烁的问题","2022-07-03 13:52:44","/2022/07/03/fcitx5-blinking-on-tg-under-wayland-kde",[10,1103,1104],"笔记","KDE",{"type":13,"value":1106,"toc":1299},[1107,1118,1121,1124,1130,1133,1136,1144,1147,1150,1153,1159,1166,1177,1180,1183,1186,1189,1204,1207,1211,1214,1235,1238,1246,1249,1253,1259,1262,1269,1276,1283,1296],[16,1108,1109],{},[19,1110,1111,1112,1117],{},"文章开头，先要感谢 fcitx5 的开发者 ",[26,1113,1116],{"href":1114,"rel":1115},"https://www.csslayer.info/wordpress/",[30],"老K"," 帮我 debug 这个问题",[34,1119,1120],{"id":1120},"鬼畜的文字候选框",[19,1122,1123],{},"在新装的 Fedora 36 KDE Wayland 下使用 fcitx5 时遇到了文字候选框前后移动晃眼的问题（如下图）",[19,1125,1126],{},[133,1127],{"alt":1128,"src":1129},"fcitx5 blinking","https://static.031130.xyz/uploads/2024/08/12/62c13162a6efc.gif",[34,1131,1132],{"id":1132},"解决方案",[19,1134,1135],{},"当我向老K提出这个问题上的时候，老K告诉我这是预期行为，一共有两个解决方案。",[267,1137,1138,1141],{},[270,1139,1140],{},"使用 qt 的 text input",[270,1142,1143],{},"关掉 kwin 的淡入淡出特效",[19,1145,1146],{},"但由于我并不熟悉 KWin 的特效，所以我选择了前者的方案。",[19,1148,1149],{},"首先，需要确保自己的 Plasma 版本在 5.24 或以上，fcitx5 的版本号在 5.0.14 以上。",[19,1151,1152],{},"然后我们需要让 KWin 去启动 fcitx5。KCM 为此提供了一个非常简单的方式，如下图",[19,1154,1155],{},[133,1156],{"alt":1157,"src":1158},"选择 fcitx5 就好啦","https://static.031130.xyz/uploads/2024/08/12/62c134907ada9.webp",[19,1160,1161,1162,1165],{},"随后需要确保环境变量没有设置 ",[52,1163,1164],{},"QT_IM_MODULE ","。一定要确保这个变量不存在，连空也不行，必须是 unset。",[19,1167,1168,1169,1172,1173,1176],{},"理论上来说，是不需要重启的，但我的环境变量是 ",[52,1170,1171],{},"fcitx5-autostart"," 这个 rpm 包在 ",[52,1174,1175],{},"/etc/profile.d/fcitx5.sh","里面设置的，我需要重启系统来使新的环境变量生效。",[19,1178,1179],{},"重启后，如果没有什么意外的话，就算成功了。",[34,1181,1182],{"id":1182},"绝对不会缺席的意外",[19,1184,1185],{},"很遗憾，我遇到了意外。",[19,1187,1188],{},"完成上述操作后，文字候选框依然有问题。",[19,1190,1191,1192,1195,1196,1199,1200,1203],{},"在老K的正确推测下，是因为我在 Fedora 下曾经使用过 ",[52,1193,1194],{},"im-settings","，该程序在 ",[52,1197,1198],{},"$HOME/.config/environment.d/"," 路径下重新帮我设置回了 ",[52,1201,1202],{},"QT_IM_MODULE"," 这个变量，从而使得 tg 启动时还在使用 IM MODULE，而不是预期的 qt text input。",[19,1205,1206],{},"删除这两个影响环境变量的文件后，在 tg 输入时，fcitx5 的文字候选框恢复了正常。",[34,1208,1210],{"id":1209},"debug-过程中用到的两个方式","debug 过程中用到的两个方式",[84,1212,1213],{"id":1213},"dbus-send",[202,1215,1217],{"className":204,"code":1216,"language":206,"meta":138,"style":138},"dbus-send --print-reply=literal --dest=org.fcitx.Fcitx5 /controller org.fcitx.Fcitx.Controller1.DebugInfo\n",[52,1218,1219],{"__ignoreMap":138},[210,1220,1221,1223,1226,1229,1232],{"class":212,"line":213},[210,1222,1213],{"class":216},[210,1224,1225],{"class":224}," --print-reply=literal",[210,1227,1228],{"class":224}," --dest=org.fcitx.Fcitx5",[210,1230,1231],{"class":220}," /controller",[210,1233,1234],{"class":220}," org.fcitx.Fcitx.Controller1.DebugInfo\n",[19,1236,1237],{},"运行如上命令后，我得到了如下的输出",[202,1239,1244],{"className":1240,"code":1242,"language":1243},[1241],"language-text","   Group [x11::1] has 0 InputContext(s)\nGroup [wayland:] has 5 InputContext(s)\n  IC [a50fe208d42e4611b240c0b66a2fa0b9] program:konsole frontend:dbus cap:e001800060 focus:1\n  IC [d7d4d5c05e9c445aab1af9c7dfb5fbd4] program:telegram-desktop frontend:dbus cap:e001800060 focus:0\n  IC [ac72ec3edf58481bbdf838352520efd5] program:krunner frontend:dbus cap:e001820060 focus:0\n  IC [d8b450176e204953837248f786204c29] program:plasmashell frontend:dbus cap:e001800060 focus:0\n  IC [df252979343d42ebbe9bd82ead6ff194] program: frontend:wayland cap:40 focus:0\nInput Context without group\n","text",[52,1245,1242],{"__ignoreMap":138},[19,1247,1248],{},"老K指出，出现了 telegram 的那一行表明 tg 还是在用 IM Module，所以是环境变量有问题",[84,1250,1252],{"id":1251},"proc-查看程序运行时的环境变量","/proc 查看程序运行时的环境变量",[19,1254,1255],{},[133,1256],{"alt":1257,"src":1258},"获取到的环境变量","https://static.031130.xyz/uploads/2024/08/12/62c138b030469.webp",[34,1260,1261],{"id":1261},"参考资料",[19,1263,1264],{},[26,1265,1268],{"href":1266,"rel":1267},"https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/",[30],"Use Plasma 5.24 to type in Alacritty (Or any other text-input-v3 client) with Fcitx 5 on Wayland",[19,1270,1271],{},[26,1272,1275],{"href":1273,"rel":1274},"https://fcitx-im.org/wiki/FAQ#Candidate_window_is_blinking_under_wayland_with_Fcitx_5",[30],"Candidate window is blinking under wayland with Fcitx 5",[19,1277,1278],{},[26,1279,1282],{"href":1280,"rel":1281},"https://www.cnblogs.com/hupeng1234/p/6735403.html",[30],"查看进程的环境变量",[19,1284,1285],{},[1286,1287,1288,1289,447,1292,1295],"em",{},"注: 上述参考资料均已在 ",[52,1290,1291],{},"web.archive.org",[52,1293,1294],{},"archive.ph"," 做过存档，如遇到原站点无法访问的情况，可自行前往这两个站点查看存档。",[246,1297,1298],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":1300},[1301,1302,1303,1304,1308],{"id":1120,"depth":139,"text":1120},{"id":1132,"depth":139,"text":1132},{"id":1182,"depth":139,"text":1182},{"id":1209,"depth":139,"text":1210,"children":1305},[1306,1307],{"id":1213,"depth":145,"text":1213},{"id":1251,"depth":145,"text":1252},{"id":1261,"depth":139,"text":1261},{"title":1310,"date":1311,"path":1312,"tags":1313,"body":1315},"使用caddy反向代理维基百科中文站点","2022-05-30 08:59:21","/2022/05/30/use-caddy-to-proxy-wikipedia",[1314],"Caddy",{"type":13,"value":1316,"toc":1708},[1317,1320,1328,1331,1334,1364,1368,1646,1649,1655,1662,1669,1676,1678,1700,1705],[19,1318,1319],{},"反代的目的无非是两点",[267,1321,1322,1325],{},[270,1323,1324],{},"满足自己在无代理情况下访问无法访问的站点的需求",[270,1326,1327],{},"方便将站点分享给亲朋好友。",[19,1329,1330],{},"一直以来，我都想用 caddy 去反代一份维基百科来用，今天刚好就顺手解决了。",[34,1332,1333],{"id":1333},"注意事项",[267,1335,1336,1339,1342,1345],{},[270,1337,1338],{},"用于反代的机子需要有对目标站点的访问能力",[270,1340,1341],{},"最好准备一个新的域名作为白手套，防止被污染",[270,1343,1344],{},"建议增加密码保护，一来使得小鸡流量不被滥用，二来防止防火墙检测到站点内容",[270,1346,1347,1348,1351,1352,1355,1356,1360,1361,1363],{},"本文使用的 caddy 开启了 ",[52,1349,1350],{},"replace_response"," 插件，可以使用 ",[52,1353,1354],{},"xcaddy"," 编译或直接前往 ",[26,1357,1358],{"href":1358,"rel":1359},"https://caddyserver.com/download",[30]," 勾选相应插件后下载。安装时，建议先根据官方文档安装原版 caddy，再用启用了 ",[52,1362,1350],{}," 插件的 caddy 二进制文件覆盖掉原版 caddy，这样就不需要去手写 systemd 相关的文件了。",[34,1365,1367],{"id":1366},"caddyfile","Caddyfile",[202,1369,1373],{"className":1370,"code":1371,"language":1372,"meta":138,"style":138},"language-nginx shiki shiki-themes one-light one-dark-pro","{\n        order replace after encode\n}\n\nhttps://zhwiki.example.com {\n\n        reverse_proxy * https://zh.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://m.zhwiki.example.com {\n\n        reverse_proxy * https://zh.m.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://up.zhwiki.example.com {\n        reverse_proxy * https://upload.wikimedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n        }\n}\n\n","nginx",[52,1374,1375,1379,1384,1388,1394,1399,1403,1408,1413,1418,1423,1428,1433,1438,1443,1448,1453,1457,1462,1467,1472,1477,1482,1487,1492,1498,1503,1509,1514,1519,1524,1529,1534,1539,1544,1549,1554,1559,1564,1569,1574,1579,1584,1589,1594,1600,1606,1611,1616,1621,1626,1631,1636,1641],{"__ignoreMap":138},[210,1376,1377],{"class":212,"line":213},[210,1378,546],{},[210,1380,1381],{"class":212,"line":139},[210,1382,1383],{},"        order replace after encode\n",[210,1385,1386],{"class":212,"line":145},[210,1387,680],{},[210,1389,1390],{"class":212,"line":565},[210,1391,1393],{"emptyLinePlaceholder":1392},true,"\n",[210,1395,1396],{"class":212,"line":580},[210,1397,1398],{},"https://zhwiki.example.com {\n",[210,1400,1401],{"class":212,"line":593},[210,1402,1393],{"emptyLinePlaceholder":1392},[210,1404,1405],{"class":212,"line":606},[210,1406,1407],{},"        reverse_proxy * https://zh.wikipedia.org {\n",[210,1409,1410],{"class":212,"line":615},[210,1411,1412],{},"                header_up Host {upstream_hostport}\n",[210,1414,1415],{"class":212,"line":621},[210,1416,1417],{},"                header_up X-Real-IP {http.request.remote.host}\n",[210,1419,1420],{"class":212,"line":634},[210,1421,1422],{},"                header_up X-Forwarded-For {http.request.remote.host}\n",[210,1424,1425],{"class":212,"line":647},[210,1426,1427],{},"                header_up X-Forwarded-Port {http.request.port}\n",[210,1429,1430],{"class":212,"line":660},[210,1431,1432],{},"                header_up X-Forwarded-Proto {http.request.scheme}\n",[210,1434,1435],{"class":212,"line":671},[210,1436,1437],{},"                header_up Accept-Encoding identity\n",[210,1439,1440],{"class":212,"line":677},[210,1441,1442],{},"                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n",[210,1444,1445],{"class":212,"line":1051},[210,1446,1447],{},"                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n",[210,1449,1450],{"class":212,"line":1057},[210,1451,1452],{},"        }\n",[210,1454,1455],{"class":212,"line":1063},[210,1456,1393],{"emptyLinePlaceholder":1392},[210,1458,1459],{"class":212,"line":1069},[210,1460,1461],{},"        replace {\n",[210,1463,1464],{"class":212,"line":1075},[210,1465,1466],{},"                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n",[210,1468,1469],{"class":212,"line":1081},[210,1470,1471],{},"                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n",[210,1473,1474],{"class":212,"line":1087},[210,1475,1476],{},"                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n",[210,1478,1480],{"class":212,"line":1479},22,[210,1481,1452],{},[210,1483,1485],{"class":212,"line":1484},23,[210,1486,680],{},[210,1488,1490],{"class":212,"line":1489},24,[210,1491,1393],{"emptyLinePlaceholder":1392},[210,1493,1495],{"class":212,"line":1494},25,[210,1496,1497],{},"https://m.zhwiki.example.com {\n",[210,1499,1501],{"class":212,"line":1500},26,[210,1502,1393],{"emptyLinePlaceholder":1392},[210,1504,1506],{"class":212,"line":1505},27,[210,1507,1508],{},"        reverse_proxy * https://zh.m.wikipedia.org {\n",[210,1510,1512],{"class":212,"line":1511},28,[210,1513,1412],{},[210,1515,1517],{"class":212,"line":1516},29,[210,1518,1417],{},[210,1520,1522],{"class":212,"line":1521},30,[210,1523,1422],{},[210,1525,1527],{"class":212,"line":1526},31,[210,1528,1427],{},[210,1530,1532],{"class":212,"line":1531},32,[210,1533,1432],{},[210,1535,1537],{"class":212,"line":1536},33,[210,1538,1437],{},[210,1540,1542],{"class":212,"line":1541},34,[210,1543,1442],{},[210,1545,1547],{"class":212,"line":1546},35,[210,1548,1447],{},[210,1550,1552],{"class":212,"line":1551},36,[210,1553,1452],{},[210,1555,1557],{"class":212,"line":1556},37,[210,1558,1393],{"emptyLinePlaceholder":1392},[210,1560,1562],{"class":212,"line":1561},38,[210,1563,1461],{},[210,1565,1567],{"class":212,"line":1566},39,[210,1568,1466],{},[210,1570,1572],{"class":212,"line":1571},40,[210,1573,1471],{},[210,1575,1577],{"class":212,"line":1576},41,[210,1578,1476],{},[210,1580,1582],{"class":212,"line":1581},42,[210,1583,1452],{},[210,1585,1587],{"class":212,"line":1586},43,[210,1588,680],{},[210,1590,1592],{"class":212,"line":1591},44,[210,1593,1393],{"emptyLinePlaceholder":1392},[210,1595,1597],{"class":212,"line":1596},45,[210,1598,1599],{},"https://up.zhwiki.example.com {\n",[210,1601,1603],{"class":212,"line":1602},46,[210,1604,1605],{},"        reverse_proxy * https://upload.wikimedia.org {\n",[210,1607,1609],{"class":212,"line":1608},47,[210,1610,1412],{},[210,1612,1614],{"class":212,"line":1613},48,[210,1615,1417],{},[210,1617,1619],{"class":212,"line":1618},49,[210,1620,1422],{},[210,1622,1624],{"class":212,"line":1623},50,[210,1625,1427],{},[210,1627,1629],{"class":212,"line":1628},51,[210,1630,1432],{},[210,1632,1634],{"class":212,"line":1633},52,[210,1635,1437],{},[210,1637,1639],{"class":212,"line":1638},53,[210,1640,1452],{},[210,1642,1644],{"class":212,"line":1643},54,[210,1645,680],{},[34,1647,1648],{"id":1648},"简单解释",[19,1650,1651,1652,1654],{},"第一大段是启用 ",[52,1653,1350],{}," 插件的部分，直接照抄即可。",[19,1656,1657,1658,1661],{},"第二和第三大段的思路是一致的，分别反向代理了 PC 端和移动段的网页。两行 ",[52,1659,1660],{}," header_down"," 的写法是受到了知乎上那篇 Github 反代的启发，避免了源站发出 302 重定向时访客被带到源站去。replace 部分不用多说，就是将针对三个源站域名的请求改到反代站域名。",[19,1663,1664,1665,1668],{},"第四大段就是中规中举地反代了 ",[52,1666,1667],{},"upload.wikimedia.org"," 这个域名，上面存放的大多数是媒体文件，如果条件允许的话其实可以考虑使用多个服务器反代。",[19,1670,1671,1672,105],{},"密码保护在我这份 Caddyfile 中没有启用，如果有需要的话可以参考我的",[26,1673,1675],{"href":1674},"/2021/10/21/picuploader-on-archlinux-with-caddy/#%E8%AE%BE%E7%BD%AE%E8%AE%BF%E9%97%AE%E5%AF%86%E7%A0%81%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89","另一篇博客",[34,1677,1261],{"id":1261},[19,1679,1680,1685,1690,1695],{},[26,1681,1684],{"href":1682,"rel":1683},"https://caddyserver.com/docs/",[30],"Caddy 官方文档",[26,1686,1689],{"href":1687,"rel":1688},"https://zhuanlan.zhihu.com/p/476390779",[30],"The Road to Serfdom——如何为GitHub搭建反向代理",[26,1691,1694],{"href":1692,"rel":1693},"https://ichon.me/post/1026.html",[30],"使用 Caddy 配置 Wikipedia 反向代理",[26,1696,1699],{"href":1697,"rel":1698},"https://learningman.top/archives/365",[30],"使用 Caddy 反代 ghcr.io",[19,1701,1702],{},[1286,1703,1704],{},"所有参考资料除官方文档外均使用 web.archive.org 和 archive.ph 进行存档，如有无法访问的情况，请自行前往存档站获取历史存档。",[246,1706,1707],{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":1709},[1710,1711,1712,1713],{"id":1333,"depth":139,"text":1333},{"id":1366,"depth":139,"text":1367},{"id":1648,"depth":139,"text":1648},{"id":1261,"depth":139,"text":1261},{"title":1715,"date":1716,"path":1717,"tags":1718,"body":1719},"创建一个本地的 Fedora 镜像源","2022-05-11 04:18:26","/2022/05/11/setup-a-local-fedora-source",[714,1314],{"type":13,"value":1720,"toc":2069},[1721,1730,1733,1756,1759,1762,1769,1772,1775,1786,1793,1805,1811,1817,1820,1828,1845,1850,1856,1860,1863,1866,1875,1878,1884,1887,1906,1909,1915,1918,1924,1931,1996,2003,2057,2066],[16,1722,1723],{},[19,1724,1725,1726,1729],{},"Fedora 36 在多次跳票后，总算是在 5月10日正式发布了。截止北京时间 5月11日凌晨两点，上海交通大学开源镜像站的上游 ",[52,1727,1728],{},"rsync://download-ib01.fedoraproject.org/","  仍然没有同步 Fedora 36 的 Release 源。鉴于 Release 自 freeze 以后基本是不会有什么大变动的，也不需要及时同步更新，干脆就直接建立一个本地的镜像源。",[34,1731,1732],{"id":1732},"准备",[1734,1735,1736,1743,1753],"ol",{},[270,1737,1738,1739,1742],{},"一块足够大的硬盘",[1740,1741],"br",{},"根据我个人实测，单 Fedora 36 的 x86_64 架构 的 Release 源中的 binary rpm 就占用了 89.6 GB，具体准备多的的硬盘空间还得看你具体需要同步些什么。",[270,1744,1745,1746,1748,1749,1752],{},"符合要求的上游",[1740,1747],{},"这里所说的符合要求一共是两个方面，一是允许 rsync 同步，二是有你想要的文件。我通过 getfedora.org 的下载按钮的转发目标得知 ",[52,1750,1751],{},"mirror.karneval.cz"," 已经完成了 Fedora 36 Release 源的同步。",[270,1754,1755],{},"良好的网络条件",[19,1757,1758],{},"这里说的良好的网络条件，并不一定是说需要访问境外站点的能力，而是你和你的上游之间的网络访问畅通，不要动不动就i断开连接那种。如果你选择的是国内镜像站作为你的上游，那一般不会有什么问题。",[34,1760,1761],{"id":1761},"开始同步",[19,1763,1764,1765,1768],{},"现在的主流方案一般都是选择 ",[52,1766,1767],{},"rsync"," 直接开整。",[84,1770,1771],{"id":1771},"试探环节",[19,1773,1774],{},"很多镜像站的 rsync 文件路径和 http 文件路径路径是不同的。",[19,1776,1777,1778,1781,1782,1785],{},"比如说，我这里用的 mirror.karneval.cz 的 http 页面显示的 fedora 仓库路径在 ",[52,1779,1780],{},"/pub/fedora","，但 rsync 同步时需要使用 ",[52,1783,1784],{},"/fedora"," 路径。",[19,1787,1788,1789,1792],{},"为了确定这一点，我们可以先通过 ",[52,1790,1791],{},"rsync rsync://example.com"," 进行预览",[202,1794,1796],{"className":204,"code":1795,"language":206,"meta":138,"style":138},"rsync rsync://mirror.karneval.cz\n",[52,1797,1798],{"__ignoreMap":138},[210,1799,1800,1802],{"class":212,"line":213},[210,1801,1767],{"class":216},[210,1803,1804],{"class":220}," rsync://mirror.karneval.cz\n",[19,1806,1807],{},[133,1808],{"alt":1809,"src":1810},"image-20220511103736493","https://static.031130.xyz/uploads/2024/08/12/627b2177c4da2.webp",[19,1812,1813,1814],{},"通过一层一层预览目录的方式，找到需要同步的路径是 ",[52,1815,1816],{},"/fedora/linux/releases/36/Everything/x86_64/os/",[84,1818,1819],{"id":1819},"同步环节",[19,1821,1822,1823,447,1825,1827],{},"通过 ",[52,1824,359],{},[52,1826,316],{}," 创建并进入我们准备用于同步源码的文件夹，然后开始执行同步命令。",[202,1829,1831],{"className":204,"code":1830,"language":206,"meta":138,"style":138},"rsync -avP rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/ .\n",[52,1832,1833],{"__ignoreMap":138},[210,1834,1835,1837,1840,1843],{"class":212,"line":213},[210,1836,1767],{"class":216},[210,1838,1839],{"class":224}," -avP",[210,1841,1842],{"class":220}," rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/",[210,1844,342],{"class":220},[19,1846,1847],{},[1286,1848,1849],{},"Ps: 中途如果由于各种原因而中断了同步过程，可以再次使用上述命令继续同步，rsync 会保证文件完整性。",[19,1851,1852],{},[133,1853],{"alt":1854,"src":1855},"耗费两个半小时，同步成功","https://static.031130.xyz/uploads/2024/08/12/627b22fa44446.webp",[34,1857,1859],{"id":1858},"安装配置并启用-static-server-可选","安装、配置并启用 static server (可选)",[19,1861,1862],{},"如果只需要本机使用，那么直接跳过这一步即可；如果需要给局域网内的其他机器提供镜像源，那么需要启用 static server。",[19,1864,1865],{},"我这里选择的是 caddy，性能虽然比 nginx 略逊一筹，但胜在配置简单。",[19,1867,1868,1869,1874],{},"caddy 的安装可以直接参考",[26,1870,1873],{"href":1871,"rel":1872},"https://caddyserver.com/docs/install",[30],"官方文档","，这里不再赘述。",[19,1876,1877],{},"配置也不过那么几行的事情，我给个 example。端口号只要和别的程序没有冲突，就可以随意指定。443 端口需要 ssl 证书比较麻烦，局域网内直接用非标准端口即可。",[202,1879,1882],{"className":1880,"code":1881,"language":1243},[1241],":14567 {\n        root * /the/directory/you/use\n\n        file_server {\n                browse\n        }\n}\n",[52,1883,1881],{"__ignoreMap":138},[19,1885,1886],{},"配置完后直接以普通用户的权限启用即可，使用 systemd 启用需要解决 caddy 用户对目标无权限的问题。",[202,1888,1890],{"className":204,"code":1889,"language":206,"meta":138,"style":138},"caddy run --config /etc/caddy/Caddyfile\n",[52,1891,1892],{"__ignoreMap":138},[210,1893,1894,1897,1900,1903],{"class":212,"line":213},[210,1895,1896],{"class":216},"caddy",[210,1898,1899],{"class":220}," run",[210,1901,1902],{"class":224}," --config",[210,1904,1905],{"class":220}," /etc/caddy/Caddyfile\n",[19,1907,1908],{},"浏览器输入对应的 ip 和端口，应该就可以访问了。",[19,1910,1911],{},[133,1912],{"alt":1913,"src":1914},"image-20220511113417004","https://static.031130.xyz/uploads/2024/08/12/627b2ebd23331.webp",[34,1916,1917],{"id":1917},"修改源配置文件",[19,1919,1920,1921,238],{},"由于我们仅同步了 Release 源，就只需要修改 ",[52,1922,1923],{},"/etc/yum.repo.d/fedora.repo",[19,1925,1926,1927,1930],{},"如果镜像源在本机上，可以直接使用 ",[52,1928,1929],{},"file://"," 协议头:",[202,1932,1934],{"className":977,"code":1933,"language":979,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=file:///the/directory/you/use\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,1935,1936,1941,1946,1951,1956,1961,1966,1971,1976,1981,1986,1991],{"__ignoreMap":138},[210,1937,1938],{"class":212,"line":213},[210,1939,1940],{},"[fedora]\n",[210,1942,1943],{"class":212,"line":139},[210,1944,1945],{},"name=Fedora $releasever - $basearch\n",[210,1947,1948],{"class":212,"line":145},[210,1949,1950],{},"+ baseurl=file:///the/directory/you/use\n",[210,1952,1953],{"class":212,"line":565},[210,1954,1955],{},"- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\n",[210,1957,1958],{"class":212,"line":580},[210,1959,1960],{},"enabled=1\n",[210,1962,1963],{"class":212,"line":593},[210,1964,1965],{},"countme=1\n",[210,1967,1968],{"class":212,"line":606},[210,1969,1970],{},"metadata_expire=7d\n",[210,1972,1973],{"class":212,"line":615},[210,1974,1975],{},"repo_gpgcheck=0\n",[210,1977,1978],{"class":212,"line":621},[210,1979,1980],{},"type=rpm\n",[210,1982,1983],{"class":212,"line":634},[210,1984,1985],{},"gpgcheck=1\n",[210,1987,1988],{"class":212,"line":647},[210,1989,1990],{},"gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\n",[210,1992,1993],{"class":212,"line":660},[210,1994,1995],{},"skip_if_unavailable=False\n",[19,1997,1998,1999,2002],{},"如果镜像源在同局域网设备上，通过 ",[52,2000,2001],{},"http://"," 协议也能达到相同的效果:",[202,2004,2006],{"className":977,"code":2005,"language":979,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=http://192.168.1.233:14567\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,2007,2008,2012,2016,2021,2025,2029,2033,2037,2041,2045,2049,2053],{"__ignoreMap":138},[210,2009,2010],{"class":212,"line":213},[210,2011,1940],{},[210,2013,2014],{"class":212,"line":139},[210,2015,1945],{},[210,2017,2018],{"class":212,"line":145},[210,2019,2020],{},"+ baseurl=http://192.168.1.233:14567\n",[210,2022,2023],{"class":212,"line":565},[210,2024,1955],{},[210,2026,2027],{"class":212,"line":580},[210,2028,1960],{},[210,2030,2031],{"class":212,"line":593},[210,2032,1965],{},[210,2034,2035],{"class":212,"line":606},[210,2036,1970],{},[210,2038,2039],{"class":212,"line":615},[210,2040,1975],{},[210,2042,2043],{"class":212,"line":621},[210,2044,1980],{},[210,2046,2047],{"class":212,"line":634},[210,2048,1985],{},[210,2050,2051],{"class":212,"line":647},[210,2052,1990],{},[210,2054,2055],{"class":212,"line":660},[210,2056,1995],{},[19,2058,2059],{},[1286,2060,2061,2062,2065],{},"Ps: 提供镜像源的机子的局域网 ip 可以通过 ",[52,2063,2064],{},"ip -br a"," 命令获取",[246,2067,2068],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}",{"title":138,"searchDepth":139,"depth":139,"links":2070},[2071,2072,2076,2077],{"id":1732,"depth":139,"text":1732},{"id":1761,"depth":139,"text":1761,"children":2073},[2074,2075],{"id":1771,"depth":145,"text":1771},{"id":1819,"depth":145,"text":1819},{"id":1858,"depth":139,"text":1859},{"id":1917,"depth":139,"text":1917},{"title":2079,"date":2080,"path":2081,"tags":2082,"body":2085},"好软推荐——FastOCR","2022-04-14 05:55:18","/2022/04/14/fastocr-experience",[2083,2084],"Experience","OpenSource Project",{"type":13,"value":2086,"toc":2160},[2087,2090,2104,2125,2131,2145,2151,2154],[19,2088,2089],{},"前两天在 PC 端有 OCR 的需求，需求如下",[267,2091,2092,2095,2098,2101],{},[270,2093,2094],{},"自带框选功能或者图片上传前的编辑功能",[270,2096,2097],{},"硬盘占用小，不要 electron (((已经受够了",[270,2099,2100],{},"支持系统托盘或者快捷键快速调出",[270,2102,2103],{},"免费",[19,2105,2106,2107,2112,2113,2118,2119,2124],{},"在",[26,2108,2111],{"href":2109,"rel":2110},"https://liolok.com/",[30],"李皓奇","的推荐下试用了 Arch 群",[26,2114,2117],{"href":2115,"rel":2116},"https://github.com/BruceZhang1993",[30],"兔兔","拿 python 和 qt 写的 ",[26,2120,2123],{"href":2121,"rel":2122},"https://github.com/BruceZhang1993/FastOCR",[30],"fastocr","，体验可以说是相当不错了。四个要求基本都能完美满足！",[19,2126,2127],{},[133,2128],{"alt":2129,"src":2130},"操作简单快捷","https://static.031130.xyz/uploads/2024/08/12/a4ddb3b05e19c.gif",[19,2132,2133,2134,2137,2138,2137,2141,2144],{},"支持 ",[1286,2135,2136],{},"百度","、",[1286,2139,2140],{},"有道",[1286,2142,2143],{},"旷视Face++"," 三家的接口，免费额度绝对够我试用的（大不了一家用完了换一家嘛",[19,2146,2147],{},[133,2148],{"alt":2149,"src":2150},"设置界面","https://static.031130.xyz/uploads/2024/08/12/488835757d5e3.webp",[19,2152,2153],{},"此外，空间占用小，算上依赖也不过 31MB 的硬盘空间占用，连半个 electron 都不到，运行起来反而更加流畅 \u003C^_^>",[19,2155,2156],{},[133,2157],{"alt":2158,"src":2159},"诶？哪里来的atpoossfl","https://static.031130.xyz/uploads/2024/08/12/a404346841d02.webp",{"title":138,"searchDepth":139,"depth":139,"links":2161},[],{"title":2163,"date":2164,"path":2165,"tags":2166,"body":2170},"抛弃PicGo，直接使用curl将图片上传到LskyPro","2022-03-31 19:19:14","/2022/03/31/upload-pic-to-lskypro-with-curl",[2167,2168,2169],"Shell Script","图床","Lsky Pro",{"type":13,"value":2171,"toc":2597},[2172,2179,2197,2209,2218,2223,2226,2229,2240,2243,2578,2583,2586,2589,2594],[19,2173,2174,2175,2178],{},"前一阵子为了图床折腾了好长一段时间。刚开始用的是 cloudinary，虽然每月有限制，但强在境内访问速度还不错，可惜后来 ",[52,2176,2177],{},"res.cloudinary.com"," 这个域名在某些地方被 DNS 污染了，而自定义域名是付费版的功能，就不得不放弃了。",[19,2180,2181,2182,2185,2186,2191,2192,105],{},"后来也尝试过 npm图床 的方案，可惜面对这种滥用公共资源的行为我无法接受~~（肯定不是因为受不了那繁琐的上传步骤，随便传张图都得 bump 下版本号的原因）~~，而且现在境内的能作为图床使用的 npm 镜像似乎也就只剩下 ",[52,2183,2184],{},"npm.elemecdn.com"," 这一个能够正常回源了，没准哪天就用不了了，所以就去投奔了",[26,2187,2190],{"href":2188,"rel":2189},"https://dusays.com/",[30],"杜老师","的",[26,2193,2196],{"href":2194,"rel":2195},"https://7bu.top/",[30],"去不图床",[19,2198,2199,2200,2204,2205,2208],{},"去不图床采用开源图床程序 ",[26,2201,2169],{"href":2202,"rel":2203},"https://www.lsky.pro/",[30]," 搭建，没有免费服务，且配置了鉴黄服务，看起来就是打算长久做下去的图床站点。境内使用腾讯云cdn，境外采用 cloudflare cdn，速度都挺让我满意的。",[167,2206,2207],{},"（杜老师看见请给我打钱，或者多送我点空间也行","（x",[19,2210,2211,2212,2217],{},"Typora 一直是我写博客的主用 Markdown 编辑器，之前我采用 Typora 调用 ",[26,2213,2216],{"href":2214,"rel":2215},"https://github.com/xiebruce/PicUploader",[30],"PicUploader(php)"," 自动上传图片的方案写博客，体验相当不错，如图:",[19,2219,2220],{},[133,2221],{"alt":138,"src":2222},"https://static.031130.xyz/uploads/2024/08/12/62f3b881e3c4c.gif",[19,2224,2225],{},"可惜 PicUploader 目前仍然没有支持 LskyPro 的上传，我采用的是现在烂大街的 Typora+PicGo+LskyPro插件 的方案去实现 Typora 的自动上传图片功能。",[19,2227,2228],{},"这个方案有明显的弊端：",[267,2230,2231,2234,2237],{},[270,2232,2233],{},"PicGo 运行依赖于 electron，极大地消耗了系统资源。",[270,2235,2236],{},"PicGo 面对多张图片( >=4张 )同时上传时容易报错。",[270,2238,2239],{},"PicGo 对于 Linux 的支持比较有限，作者可能不熟悉 Linux，直到半个月前我去交了一个 pr 才支持 wayland 下使用 wl-clipboard 将图片链接复制到粘贴版。",[19,2241,2242],{},"正好 LskyPro 有详细的文档，应该可以用 curl 手糊一段 Shell 脚本实现直接上传，资源占用小，唯一的弊端是上传完成后的图片不容易管理。脚本如下",[202,2244,2246],{"className":204,"code":2245,"language":206,"meta":138,"style":138},"#!/bin/bash\n\nAPI_URL=\"https://7bu.top/api/v1\"\n\nAUTH_TOKEN=\"\"\n\nmarkdown=false\nwhile [[ \"$#\" -gt 0 ]]; do\n    case $1 in\n        -m|--markdown) markdown=true; shift ;;\n        *) break ;;\n    esac\ndone\n\nfor images in \"$@\"; do\n    UPLOAD_RESPONSE=$(curl -s -X POST \"$API_URL/upload\" \\\n        -H 'Content-Type: multipart/form-data' \\\n        -H \"Authorization: Bearer $AUTH_TOKEN\" \\\n        -F \"file=@$images\")\n\n    if [ \"$markdown\" = true ]; then\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.markdown\n    else\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.url\n    fi\ndone\n",[52,2247,2248,2253,2257,2269,2273,2283,2287,2297,2327,2339,2370,2380,2385,2390,2394,2417,2450,2460,2474,2490,2494,2521,2545,2550,2569,2574],{"__ignoreMap":138},[210,2249,2250],{"class":212,"line":213},[210,2251,986],{"class":2252},"sW2Sy",[210,2254,2255],{"class":212,"line":139},[210,2256,1393],{"emptyLinePlaceholder":1392},[210,2258,2259,2262,2266],{"class":212,"line":145},[210,2260,2261],{"class":551},"API_URL",[210,2263,2265],{"class":2264},"sknuh","=",[210,2267,2268],{"class":220},"\"https://7bu.top/api/v1\"\n",[210,2270,2271],{"class":212,"line":565},[210,2272,1393],{"emptyLinePlaceholder":1392},[210,2274,2275,2278,2280],{"class":212,"line":580},[210,2276,2277],{"class":551},"AUTH_TOKEN",[210,2279,2265],{"class":2264},[210,2281,2282],{"class":220},"\"\"\n",[210,2284,2285],{"class":212,"line":593},[210,2286,1393],{"emptyLinePlaceholder":1392},[210,2288,2289,2292,2294],{"class":212,"line":606},[210,2290,2291],{"class":551},"markdown",[210,2293,2265],{"class":2264},[210,2295,2296],{"class":220},"false\n",[210,2298,2299,2303,2306,2309,2313,2315,2318,2321,2324],{"class":212,"line":615},[210,2300,2302],{"class":2301},"sLKXg","while",[210,2304,2305],{"class":311}," [[ ",[210,2307,2308],{"class":220},"\"",[210,2310,2312],{"class":2311},"s2QsP","$#",[210,2314,2308],{"class":220},[210,2316,2317],{"class":2264}," -gt",[210,2319,2320],{"class":224}," 0",[210,2322,2323],{"class":311}," ]]; ",[210,2325,2326],{"class":2301},"do\n",[210,2328,2329,2332,2336],{"class":212,"line":621},[210,2330,2331],{"class":2301},"    case",[210,2333,2335],{"class":2334},"s8iYz"," $1",[210,2337,2338],{"class":2301}," in\n",[210,2340,2341,2345,2348,2351,2354,2356,2358,2361,2364,2367],{"class":212,"line":634},[210,2342,2344],{"class":2343},"sDaw7","        -m",[210,2346,2347],{"class":311},"|",[210,2349,2350],{"class":2343},"--markdown",[210,2352,2353],{"class":311},") ",[210,2355,2291],{"class":551},[210,2357,2265],{"class":2264},[210,2359,2360],{"class":220},"true",[210,2362,2363],{"class":311},"; ",[210,2365,2366],{"class":315},"shift",[210,2368,2369],{"class":311}," ;;\n",[210,2371,2372,2375,2378],{"class":212,"line":647},[210,2373,2374],{"class":311},"        *) ",[210,2376,2377],{"class":2301},"break",[210,2379,2369],{"class":311},[210,2381,2382],{"class":212,"line":660},[210,2383,2384],{"class":2301},"    esac\n",[210,2386,2387],{"class":212,"line":671},[210,2388,2389],{"class":2301},"done\n",[210,2391,2392],{"class":212,"line":677},[210,2393,1393],{"emptyLinePlaceholder":1392},[210,2395,2396,2399,2402,2405,2408,2411,2413,2415],{"class":212,"line":1051},[210,2397,2398],{"class":2301},"for",[210,2400,2401],{"class":551}," images",[210,2403,2404],{"class":2301}," in",[210,2406,2407],{"class":220}," \"",[210,2409,2410],{"class":2334},"$@",[210,2412,2308],{"class":220},[210,2414,2363],{"class":311},[210,2416,2326],{"class":2301},[210,2418,2419,2422,2424,2427,2430,2433,2436,2439,2441,2444,2447],{"class":212,"line":1057},[210,2420,2421],{"class":551},"    UPLOAD_RESPONSE",[210,2423,2265],{"class":2264},[210,2425,2426],{"class":311},"$(",[210,2428,2429],{"class":216},"curl",[210,2431,2432],{"class":224}," -s",[210,2434,2435],{"class":224}," -X",[210,2437,2438],{"class":220}," POST",[210,2440,2407],{"class":220},[210,2442,2443],{"class":551},"$API_URL",[210,2445,2446],{"class":220},"/upload\"",[210,2448,2449],{"class":315}," \\\n",[210,2451,2452,2455,2458],{"class":212,"line":1063},[210,2453,2454],{"class":224},"        -H",[210,2456,2457],{"class":220}," 'Content-Type: multipart/form-data'",[210,2459,2449],{"class":315},[210,2461,2462,2464,2467,2470,2472],{"class":212,"line":1069},[210,2463,2454],{"class":224},[210,2465,2466],{"class":220}," \"Authorization: Bearer ",[210,2468,2469],{"class":551},"$AUTH_TOKEN",[210,2471,2308],{"class":220},[210,2473,2449],{"class":315},[210,2475,2476,2479,2482,2485,2487],{"class":212,"line":1075},[210,2477,2478],{"class":224},"        -F",[210,2480,2481],{"class":220}," \"file=@",[210,2483,2484],{"class":551},"$images",[210,2486,2308],{"class":220},[210,2488,2489],{"class":311},")\n",[210,2491,2492],{"class":212,"line":1081},[210,2493,1393],{"emptyLinePlaceholder":1392},[210,2495,2496,2499,2502,2504,2507,2509,2512,2515,2518],{"class":212,"line":1087},[210,2497,2498],{"class":2301},"    if",[210,2500,2501],{"class":311}," [ ",[210,2503,2308],{"class":220},[210,2505,2506],{"class":551},"$markdown",[210,2508,2308],{"class":220},[210,2510,2511],{"class":2264}," =",[210,2513,2514],{"class":224}," true",[210,2516,2517],{"class":311}," ]; ",[210,2519,2520],{"class":2301},"then\n",[210,2522,2523,2526,2528,2531,2533,2536,2539,2542],{"class":212,"line":1479},[210,2524,2525],{"class":315},"        echo",[210,2527,2407],{"class":220},[210,2529,2530],{"class":551},"$UPLOAD_RESPONSE",[210,2532,2308],{"class":220},[210,2534,2535],{"class":311}," | ",[210,2537,2538],{"class":216},"jq",[210,2540,2541],{"class":224}," -r",[210,2543,2544],{"class":220}," .data.links.markdown\n",[210,2546,2547],{"class":212,"line":1484},[210,2548,2549],{"class":2301},"    else\n",[210,2551,2552,2554,2556,2558,2560,2562,2564,2566],{"class":212,"line":1489},[210,2553,2525],{"class":315},[210,2555,2407],{"class":220},[210,2557,2530],{"class":551},[210,2559,2308],{"class":220},[210,2561,2535],{"class":311},[210,2563,2538],{"class":216},[210,2565,2541],{"class":224},[210,2567,2568],{"class":220}," .data.links.url\n",[210,2570,2571],{"class":212,"line":1494},[210,2572,2573],{"class":2301},"    fi\n",[210,2575,2576],{"class":212,"line":1500},[210,2577,2389],{"class":2301},[16,2579,2580],{},[19,2581,2582],{},"2022/04/02更新: 第六行 $@ - \"$@\"，解决文件名中出现空格时导致的上传失败问题。",[19,2584,2585],{},"需要借助 jq 来读取返回的 json，各 Linux 发行版源内应该都有打包，自行安装即可。",[19,2587,2588],{},"授予x可执行权限后，Typora 内直接填写自定义命令输入脚本所在位置即可实现 Typora 自动上传图片了。",[16,2590,2591],{},[19,2592,2593],{},"2023/12/12更新: 支持 -m 或 --markdown 参数，使脚本输出 markdown 格式的链接。",[246,2595,2596],{},"html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .sknuh, html code.shiki .sknuh{--shiki-default:#383A42;--shiki-dark:#56B6C2}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .s2QsP, html code.shiki .s2QsP{--shiki-default:#E45649;--shiki-dark:#E5C07B}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .s8iYz, html code.shiki .s8iYz{--shiki-default:#383A42;--shiki-default-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic}html pre.shiki code .sDaw7, html code.shiki .sDaw7{--shiki-default:#0184BC;--shiki-dark:#E06C75}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":2598},[],127,1762207296167]