[{"data":1,"prerenderedAt":207},["ShallowReactive",2],{"post-2024-07-15-try-ssh-connection-in-fedora-copr-zh":3,"surround-2024-07-15-try-ssh-connection-in-fedora-copr-zh":194,"randomIndex/2024/07/15/try-ssh-connection-in-fedora-copr/":205,"language-switch-/2024/07/15/try-ssh-connection-in-fedora-copr/-en":206},{"id":4,"title":5,"body":6,"date":179,"description":12,"extension":180,"lang":181,"meta":182,"navigation":183,"path":184,"rawbody":185,"seo":186,"stem":187,"sticky":188,"tags":189,"__hash__":193},"posts/posts/zh/try-ssh-connection-in-fedora-copr.md","尝试体验 Fedora COPR 中的 allow SSH 功能",{"type":7,"value":8,"toc":172},"minimark",[9,13,20,23,37,40,44,47,52,55,60,63,68,71,77,80,86,89,95,98,104,107,110,140,143,163,166],[10,11,12],"p",{},"在今年的早些时候，我在 COPR 看到了一个新出现的名为「allow SSH」的按钮。",[10,14,15],{},[16,17],"img",{"alt":18,"src":19},"","https://static.031130.xyz/uploads/2024/08/12/6694949de2921.webp",[10,21,22],{},"我在 COPR 的 User Documentation 中找到了对应的描述。",[24,25,26],"blockquote",{},[10,27,28,29,36],{},"Sometimes it is useful to manually debug failed builds not locally but within the Copr infrastructure. That’s why it is possible to allow SSH access to a copr builder. More information in the ",[30,31,35],"a",{"href":32,"rel":33},"https://frostyx.cz/posts/ssh-access-to-copr-builders",[34],"nofollow","SSH access to Copr builders"," blog post.",[10,38,39],{},"COPR 的这项功能允许包维护者远程访问自己没有的 CPU 架构或 Linux 发行版的 Linux 环境，大大减少打包时的痛点。",[41,42,43],"h2",{"id":43},"开始使用",[10,45,46],{},"尝试点击按钮，获得如下界面，可以填写自己的 ssh 公钥，最多可以选择两台设备，如果选择的设备数量大于 2，则剩下的人物会维持在 pending 状态，直到被你 ssh 连接的构建机完成对应的构建任务。",[10,48,49],{},[16,50],{"alt":18,"src":51},"https://static.031130.xyz/uploads/2024/08/12/66949782e9177.webp",[10,53,54],{},"在该次构建的详情页面，等待 backend.log 按钮出现",[10,56,57],{},[16,58],{"alt":18,"src":59},"https://static.031130.xyz/uploads/2024/08/12/6694ca668003e.webp",[10,61,62],{},"在这个 url 对应的文件中，我们可以找到需要的 ssh 命令",[10,64,65],{},[16,66],{"alt":18,"src":67},"https://static.031130.xyz/uploads/2024/08/12/6694988c63899.webp",[10,69,70],{},"使用对应的 ssh 命令即可连上构建服务器",[10,72,73],{},[16,74],{"alt":75,"src":76},"连接成功","https://static.031130.xyz/uploads/2024/08/12/669499b25cd1b.webp",[10,78,79],{},"先跑个 neofetch 看看，双核 16G，看着还行。",[10,81,82],{},[16,83],{"alt":84,"src":85},"neofetch","https://static.031130.xyz/uploads/2024/08/12/669499b56e156.webp",[10,87,88],{},"随手跑了个 speedtest，竟然是千兆上下传对等的网速。",[10,90,91],{},[16,92],{"alt":93,"src":94},"speedtest 结果","https://static.031130.xyz/uploads/2024/08/12/6694bc062f6a3.webp",[10,96,97],{},"在这台机子上，我们可以使用 builder-live.log 中的命令手动触发一次构建（不过我这里跑了一半就报错了，疑似是系统不够完善）",[10,99,100],{},[16,101],{"alt":102,"src":103},"构建命令","https://static.031130.xyz/uploads/2024/08/12/6694b09a57e06.webp",[10,105,106],{},"不过很可惜，COPR 似乎并没有给我们中途去干预/调试构建过程的方案，仅仅是提供了一个可供自由操作的 Linux 环境。使用 copr-rpmbuild 命令可以进行对应的构建，但构建过程依然是在沙箱内进行，且没有给中途暂停/调试的机会。如果需要一步步手动的构建，还是建议使用 rpmbuild 命令进行。",[41,108,109],{"id":109},"杂项",[111,112,113,122,128,134],"ul",{},[114,115,116,117,121],"li",{},"使用 ",[118,119,120],"code",{},"copr-builder help"," 命令可以获取打包机的提示信息",[114,123,116,124,127],{},[118,125,126],{},"copr-builder show"," 命令查看剩余时间",[114,129,116,130,133],{},[118,131,132],{},"copr-builder prolong"," 可以延长打包机的有效时长",[114,135,116,136,139],{},[118,137,138],{},"copr-builder release"," 可以销毁当前的打包机环境",[41,141,142],{"id":142},"限制",[111,144,145,148,151,154,157,160],{},[114,146,147],{},"由于安全原因，构建结束后，只有 spec 文件和日志可以被存储到 copr 对应项目的服务器。打包机会使用一个独特的沙箱防止其构建产物被二次使用，哪怕是同一个用户都不行。",[114,149,150],{},"为了避免资源艾琳娜贵妃，同一用户在同一时刻最多只能使用两台具有 ssh 访问权限的打包机。",[114,152,153],{},"由于上面的两套规定，当 copr 构建失败时并不能自动启动 SSH 访问权限，需要用户手动在面板上 resubmit 当前任务并选择使用 SSH 访问权限。",[114,155,156],{},"打包机在默认情况下 1 小时后自动销毁，除非你手动申请延长时间，最长为 48 小时。",[114,158,159],{},"有些打包机只有 IPv6 的访问地址，你没得选。如果你无法连接 IPv6 网络，你可以取消当前的任务并重新发布并期待能给你下发一台具有 IPv4 访问地址的打包机（其实非常少），或者使用代理。",[114,161,162],{},"如果 SRPM 构建失败，则不能 resubmit 当前任务。这是 COPR 的实现逻辑问题，未来可能得到改善。",[41,164,165],{"id":165},"参考",[10,167,168],{},[30,169,171],{"href":32,"rel":170},[34],"「SSH access to Copr builders」",{"title":18,"searchDepth":173,"depth":173,"links":174},2,[175,176,177,178],{"id":43,"depth":173,"text":43},{"id":109,"depth":173,"text":109},{"id":142,"depth":173,"text":142},{"id":165,"depth":173,"text":165},"2024-07-15 11:14:12","md","zh-CN",{},true,"/2024/07/15/try-ssh-connection-in-fedora-copr","---\ntitle: 尝试体验 Fedora COPR 中的 allow SSH 功能\ndate: 2024-07-15 11:14:12\nsticky:\ntags:\n- Fedora\n- Experience\n- Linux\n---\n\n在今年的早些时候，我在 COPR 看到了一个新出现的名为「allow SSH」的按钮。\n\n![](https://static.031130.xyz/uploads/2024/08/12/6694949de2921.webp)\n\n我在 COPR 的 User Documentation 中找到了对应的描述。\n\n> Sometimes it is useful to manually debug failed builds not locally but within the Copr infrastructure. That’s why it is possible to allow SSH access to a copr builder. More information in the [SSH access to Copr builders](https://frostyx.cz/posts/ssh-access-to-copr-builders) blog post.\n\nCOPR 的这项功能允许包维护者远程访问自己没有的 CPU 架构或 Linux 发行版的 Linux 环境，大大减少打包时的痛点。\n\n## 开始使用\n\n尝试点击按钮，获得如下界面，可以填写自己的 ssh 公钥，最多可以选择两台设备，如果选择的设备数量大于 2，则剩下的人物会维持在 pending 状态，直到被你 ssh 连接的构建机完成对应的构建任务。\n\n![](https://static.031130.xyz/uploads/2024/08/12/66949782e9177.webp)\n\n在该次构建的详情页面，等待 backend.log 按钮出现\n\n![](https://static.031130.xyz/uploads/2024/08/12/6694ca668003e.webp)\n\n在这个 url 对应的文件中，我们可以找到需要的 ssh 命令\n\n![](https://static.031130.xyz/uploads/2024/08/12/6694988c63899.webp)\n\n使用对应的 ssh 命令即可连上构建服务器\n\n![连接成功](https://static.031130.xyz/uploads/2024/08/12/669499b25cd1b.webp)\n\n先跑个 neofetch 看看，双核 16G，看着还行。\n\n![neofetch](https://static.031130.xyz/uploads/2024/08/12/669499b56e156.webp)\n\n随手跑了个 speedtest，竟然是千兆上下传对等的网速。\n\n![speedtest 结果](https://static.031130.xyz/uploads/2024/08/12/6694bc062f6a3.webp)\n\n在这台机子上，我们可以使用 builder-live.log 中的命令手动触发一次构建（不过我这里跑了一半就报错了，疑似是系统不够完善）\n\n![构建命令](https://static.031130.xyz/uploads/2024/08/12/6694b09a57e06.webp)\n\n不过很可惜，COPR 似乎并没有给我们中途去干预/调试构建过程的方案，仅仅是提供了一个可供自由操作的 Linux 环境。使用 copr-rpmbuild 命令可以进行对应的构建，但构建过程依然是在沙箱内进行，且没有给中途暂停/调试的机会。如果需要一步步手动的构建，还是建议使用 rpmbuild 命令进行。\n\n## 杂项\n\n- 使用 `copr-builder help` 命令可以获取打包机的提示信息\n- 使用 `copr-builder show` 命令查看剩余时间\n- 使用 `copr-builder prolong` 可以延长打包机的有效时长\n- 使用 `copr-builder release` 可以销毁当前的打包机环境\n\n## 限制\n\n- 由于安全原因，构建结束后，只有 spec 文件和日志可以被存储到 copr 对应项目的服务器。打包机会使用一个独特的沙箱防止其构建产物被二次使用，哪怕是同一个用户都不行。\n- 为了避免资源艾琳娜贵妃，同一用户在同一时刻最多只能使用两台具有 ssh 访问权限的打包机。\n- 由于上面的两套规定，当 copr 构建失败时并不能自动启动 SSH 访问权限，需要用户手动在面板上 resubmit 当前任务并选择使用 SSH 访问权限。\n- 打包机在默认情况下 1 小时后自动销毁，除非你手动申请延长时间，最长为 48 小时。\n- 有些打包机只有 IPv6 的访问地址，你没得选。如果你无法连接 IPv6 网络，你可以取消当前的任务并重新发布并期待能给你下发一台具有 IPv4 访问地址的打包机（其实非常少），或者使用代理。\n- 如果 SRPM 构建失败，则不能 resubmit 当前任务。这是 COPR 的实现逻辑问题，未来可能得到改善。\n\n## 参考\n\n[「SSH access to Copr builders」](https://frostyx.cz/posts/ssh-access-to-copr-builders)\n",{"title":5,"description":12},"posts/zh/try-ssh-connection-in-fedora-copr",false,[190,191,192],"Fedora","Experience","Linux","UPctkyCh3SQetY1Ts4w5NaHBDcafgXJw1ycHtqoaXJw",[195,200],{"title":196,"path":197,"stem":198,"date":199,"lang":181,"children":-1},"我的博客被完整地反向代理，并自动翻译成了繁体中文","/2024/07/18/my-blog-is-completely-proxied-and-translated-into-traditional-chinese","posts/zh/my-blog-is-completely-proxied-and-translated-into-traditional-chinese","2024-07-18 11:22:37",{"title":201,"path":202,"stem":203,"date":204,"lang":181,"children":-1},"在 Arch Linux 下配置使用 HP Laser 103w 打印机无线打印","/2024/07/14/config-hp-laser-103w-printer-for-archlinux","posts/zh/config-hp-laser-103w-printer-for-archlinux","2024-07-14 18:30:33",6,null,1764012807510]