[{"data":1,"prerenderedAt":198},["ShallowReactive",2],{"post-2024-07-15-try-ssh-connection-in-fedora-copr-zh":3,"surround-2024-07-15-try-ssh-connection-in-fedora-copr-zh":184,"randomIndex/2024/07/15/try-ssh-connection-in-fedora-copr/":196,"language-switch-/2024/07/15/try-ssh-connection-in-fedora-copr/-en":197},{"title":4,"date":5,"path":6,"tags":7,"body":11,"description":17},"尝试体验 Fedora COPR 中的 allow SSH 功能","2024-07-15 11:14:12","/2024/07/15/try-ssh-connection-in-fedora-copr",[8,9,10],"Fedora","Experience","Linux",{"type":12,"value":13,"toc":177},"minimark",[14,18,25,28,42,45,49,52,57,60,65,68,73,76,82,85,91,94,100,103,109,112,115,145,148,168,171],[15,16,17],"p",{},"在今年的早些时候，我在 COPR 看到了一个新出现的名为「allow SSH」的按钮。",[15,19,20],{},[21,22],"img",{"alt":23,"src":24},"","https://static.031130.xyz/uploads/2024/08/12/6694949de2921.webp",[15,26,27],{},"我在 COPR 的 User Documentation 中找到了对应的描述。",[29,30,31],"blockquote",{},[15,32,33,34,41],{},"Sometimes it is useful to manually debug failed builds not locally but within the Copr infrastructure. That’s why it is possible to allow SSH access to a copr builder. More information in the ",[35,36,40],"a",{"href":37,"rel":38},"https://frostyx.cz/posts/ssh-access-to-copr-builders",[39],"nofollow","SSH access to Copr builders"," blog post.",[15,43,44],{},"COPR 的这项功能允许包维护者远程访问自己没有的 CPU 架构或 Linux 发行版的 Linux 环境，大大减少打包时的痛点。",[46,47,48],"h2",{"id":48},"开始使用",[15,50,51],{},"尝试点击按钮，获得如下界面，可以填写自己的 ssh 公钥，最多可以选择两台设备，如果选择的设备数量大于 2，则剩下的人物会维持在 pending 状态，直到被你 ssh 连接的构建机完成对应的构建任务。",[15,53,54],{},[21,55],{"alt":23,"src":56},"https://static.031130.xyz/uploads/2024/08/12/66949782e9177.webp",[15,58,59],{},"在该次构建的详情页面，等待 backend.log 按钮出现",[15,61,62],{},[21,63],{"alt":23,"src":64},"https://static.031130.xyz/uploads/2024/08/12/6694ca668003e.webp",[15,66,67],{},"在这个 url 对应的文件中，我们可以找到需要的 ssh 命令",[15,69,70],{},[21,71],{"alt":23,"src":72},"https://static.031130.xyz/uploads/2024/08/12/6694988c63899.webp",[15,74,75],{},"使用对应的 ssh 命令即可连上构建服务器",[15,77,78],{},[21,79],{"alt":80,"src":81},"连接成功","https://static.031130.xyz/uploads/2024/08/12/669499b25cd1b.webp",[15,83,84],{},"先跑个 neofetch 看看，双核 16G，看着还行。",[15,86,87],{},[21,88],{"alt":89,"src":90},"neofetch","https://static.031130.xyz/uploads/2024/08/12/669499b56e156.webp",[15,92,93],{},"随手跑了个 speedtest，竟然是千兆上下传对等的网速。",[15,95,96],{},[21,97],{"alt":98,"src":99},"speedtest 结果","https://static.031130.xyz/uploads/2024/08/12/6694bc062f6a3.webp",[15,101,102],{},"在这台机子上，我们可以使用 builder-live.log 中的命令手动触发一次构建（不过我这里跑了一半就报错了，疑似是系统不够完善）",[15,104,105],{},[21,106],{"alt":107,"src":108},"构建命令","https://static.031130.xyz/uploads/2024/08/12/6694b09a57e06.webp",[15,110,111],{},"不过很可惜，COPR 似乎并没有给我们中途去干预/调试构建过程的方案，仅仅是提供了一个可供自由操作的 Linux 环境。使用 copr-rpmbuild 命令可以进行对应的构建，但构建过程依然是在沙箱内进行，且没有给中途暂停/调试的机会。如果需要一步步手动的构建，还是建议使用 rpmbuild 命令进行。",[46,113,114],{"id":114},"杂项",[116,117,118,127,133,139],"ul",{},[119,120,121,122,126],"li",{},"使用 ",[123,124,125],"code",{},"copr-builder help"," 命令可以获取打包机的提示信息",[119,128,121,129,132],{},[123,130,131],{},"copr-builder show"," 命令查看剩余时间",[119,134,121,135,138],{},[123,136,137],{},"copr-builder prolong"," 可以延长打包机的有效时长",[119,140,121,141,144],{},[123,142,143],{},"copr-builder release"," 可以销毁当前的打包机环境",[46,146,147],{"id":147},"限制",[116,149,150,153,156,159,162,165],{},[119,151,152],{},"由于安全原因，构建结束后，只有 spec 文件和日志可以被存储到 copr 对应项目的服务器。打包机会使用一个独特的沙箱防止其构建产物被二次使用，哪怕是同一个用户都不行。",[119,154,155],{},"为了避免资源艾琳娜贵妃，同一用户在同一时刻最多只能使用两台具有 ssh 访问权限的打包机。",[119,157,158],{},"由于上面的两套规定，当 copr 构建失败时并不能自动启动 SSH 访问权限，需要用户手动在面板上 resubmit 当前任务并选择使用 SSH 访问权限。",[119,160,161],{},"打包机在默认情况下 1 小时后自动销毁，除非你手动申请延长时间，最长为 48 小时。",[119,163,164],{},"有些打包机只有 IPv6 的访问地址，你没得选。如果你无法连接 IPv6 网络，你可以取消当前的任务并重新发布并期待能给你下发一台具有 IPv4 访问地址的打包机（其实非常少），或者使用代理。",[119,166,167],{},"如果 SRPM 构建失败，则不能 resubmit 当前任务。这是 COPR 的实现逻辑问题，未来可能得到改善。",[46,169,170],{"id":170},"参考",[15,172,173],{},[35,174,176],{"href":37,"rel":175},[39],"「SSH access to Copr builders」",{"title":23,"searchDepth":178,"depth":178,"links":179},2,[180,181,182,183],{"id":48,"depth":178,"text":48},{"id":114,"depth":178,"text":114},{"id":147,"depth":178,"text":147},{"id":170,"depth":178,"text":170},[185,191],{"title":186,"path":187,"stem":188,"date":189,"lang":190,"children":-1},"我的博客被完整地反向代理，并自动翻译成了繁体中文","/2024/07/18/my-blog-is-completely-proxied-and-translated-into-traditional-chinese","posts/zh/my-blog-is-completely-proxied-and-translated-into-traditional-chinese","2024-07-18 11:22:37","zh-CN",{"title":192,"path":193,"stem":194,"date":195,"lang":190,"children":-1},"在 Arch Linux 下配置使用 HP Laser 103w 打印机无线打印","/2024/07/14/config-hp-laser-103w-printer-for-archlinux","posts/zh/config-hp-laser-103w-printer-for-archlinux","2024-07-14 18:30:33",3,null,1771553316232]