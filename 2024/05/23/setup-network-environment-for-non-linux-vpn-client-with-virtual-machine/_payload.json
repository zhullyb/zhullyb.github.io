[{"data":1,"prerenderedAt":145},["ShallowReactive",2],{"post-2024-05-23-setup-network-environment-for-non-linux-vpn-client-with-virtual-machine-zh":3,"surround-2024-05-23-setup-network-environment-for-non-linux-vpn-client-with-virtual-machine-zh":131,"randomIndex/2024/05/23/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine/":143,"language-switch-/2024/05/23/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine/-en":144},{"title":4,"date":5,"path":6,"tags":7,"body":12,"description":28},"使用 Windows 虚拟机运行虚拟专用网客户端为 Linux 提供内网环境","2024-05-23 01:07:44","/2024/05/23/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine",[8,9,10,11],"Linux","Windows","Virtual Machine","Network",{"type":13,"value":14,"toc":120},"minimark",[15,19,23,30,33,36,39,44,47,52,63,69,72,77,80,84,93,98,101,106,109,112,117],[16,17,18],"h2",{"id":18},"起因",[20,21,22],"p",{},"最近在某家公司实习，公司内部的 git 部署在内网环境上，需要通过虚拟专用网的客户端（天翼云的 AONE）才能够正常访问。很可惜，客户端只提供了 Windows 和 MacOS 的版本。",[20,24,25],{},[26,27],"img",{"alt":28,"src":29},"","https://static.031130.xyz/uploads/2024/08/12/664e29866c1ab.webp",[20,31,32],{},"工作的代码总是要提交的，我也不想改变我的开发环境，又不希望在 Windows 上使用 git-for-windows 这个近乎简陋的工具进行代码提交，更别说还有一些别的内网服务接下来可能也会用到。所以最好的办法就是在 Linux 下也配置好能够访问内网的环境。",[16,34,35],{"id":35},"理论",[20,37,38],{},"在 Windows 下使用 AONE 的网络拓扑是这样的",[20,40,41],{},[26,42],{"alt":28,"src":43},"https://static.031130.xyz/uploads/2024/08/12/664e2b93de6f9.webp",[20,45,46],{},"而我的方案则是使用 Windows 虚拟机开启 AONE，并在这台虚拟机上开一个 socks5 server 负责代理 Linux 宿主机需要打到内网服务的流量。网络拓扑如下",[20,48,49],{},[26,50],{"alt":28,"src":51},"https://static.031130.xyz/uploads/2024/08/12/664e2e1b0da09.webp",[20,53,54,55,62],{},"根据 bilibili 上",[56,57,61],"a",{"href":58,"rel":59},"https://www.bilibili.com/video/BV11M4y1J7zP/",[60],"nofollow","技术蛋老师的视频总结","，我们应该选择使用网卡桥接的网络配置，只有这个配置方式同时支持「宿主->虚拟机」和 「虚拟机->互联网」的网络。",[20,64,65],{},[26,66],{"alt":67,"src":68},"图片来源: bilibili 技术蛋老师","https://static.031130.xyz/uploads/2024/08/12/664e2fbb4a36b.webp",[16,70,71],{"id":71},"实操",[73,74,76],"h3",{"id":75},"在-windows-虚拟机中开启虚拟专用网客户端","在 Windows 虚拟机中开启虚拟专用网客户端",[20,78,79],{},"开启 AONE，不做赘述",[73,81,83],{"id":82},"开启-socks-server监听地址为-0000-或者设置为宿主机的-ip-地址","开启 socks server，监听地址为 0.0.0.0 （或者设置为宿主机的 IP 地址）",[20,85,86,87,92],{},"在「",[56,88,91],{"href":89,"rel":90},"https://imbearchild.cyou/",[60],"熊孩子(BearChild)","」的推荐下，我这里采用的是大名鼎鼎的二级射线（某 V 字开头的常见软件），直接从 GIthub Release 中下载 Windows X64 的压缩包，简单配置下即可，如果没有什么特殊需求的话可以只修改图中的两处配置。",[20,94,95],{},[26,96],{"alt":28,"src":97},"https://static.031130.xyz/uploads/2024/08/12/664e328cd83b3.webp",[20,99,100],{},"在终端中通过该软件的 run 命令即可开启服务",[20,102,103],{},[26,104],{"alt":28,"src":105},"https://static.031130.xyz/uploads/2024/08/12/664e32e6c350a.webp",[73,107,108],{"id":108},"在宿主机进行测试",[20,110,111],{},"我这里使用的是 mzz2017 编写的 gg 命令进行代理，代理服务器的 ip 地址使用虚拟机下 ipconfig 命令获得的 ip 地址，端口号则对应上面配置文件中的 port 参数。",[20,113,114],{},[26,115],{"alt":28,"src":116},"https://static.031130.xyz/uploads/2024/08/12/664e33c3e8320.webp",[20,118,119],{},"这里 curl 百度得到了正确的相应，说明通道是通的，gg 也可以用于代理浏览器。经实测能够正常访问公司内网服务，不便在博客中展示。",{"title":28,"searchDepth":121,"depth":121,"links":122},2,[123,124,125],{"id":18,"depth":121,"text":18},{"id":35,"depth":121,"text":35},{"id":71,"depth":121,"text":71,"children":126},[127,129,130],{"id":75,"depth":128,"text":76},3,{"id":82,"depth":128,"text":83},{"id":108,"depth":128,"text":108},[132,138],{"title":133,"path":134,"stem":135,"date":136,"lang":137,"children":-1},"使用动态公网 ip + ddns 实现 rustdesk 的 ip 直连","/2024/06/30/dynamic-public-ip-and-ddns-for-rustdesk","posts/zh/dynamic-public-ip-and-ddns-for-rustdesk","2024-06-30 18:15:00","zh-CN",{"title":139,"path":140,"stem":141,"date":142,"lang":137,"children":-1},"以 Archlinux 中 makepkg 的方式打开 rpmbuild","/2024/05/03/open-rpmbuild-in-the-way-of-archlinux-makepkg","posts/zh/open-rpmbuild-in-the-way-of-archlinux-makepkg","2024-05-03 22:48:39",4,null,1766532344897]