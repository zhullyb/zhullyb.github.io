[{"data":1,"prerenderedAt":152},["ShallowReactive",2],{"post-2024-05-23-setup-network-environment-for-non-linux-vpn-client-with-virtual-machine":3,"surround-2024-05-23-setup-network-environment-for-non-linux-vpn-client-with-virtual-machine":140,"randomIndex/2024/05/23/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine/":151},{"id":4,"title":5,"body":6,"date":125,"description":22,"extension":126,"meta":127,"navigation":128,"path":129,"rawbody":130,"seo":131,"stem":132,"sticky":133,"tags":134,"__hash__":139},"posts/posts/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine.md","使用 Windows 虚拟机运行虚拟专用网客户端为 Linux 提供内网环境",{"type":7,"value":8,"toc":114},"minimark",[9,13,17,24,27,30,33,38,41,46,57,63,66,71,74,78,87,92,95,100,103,106,111],[10,11,12],"h2",{"id":12},"起因",[14,15,16],"p",{},"最近在某家公司实习，公司内部的 git 部署在内网环境上，需要通过虚拟专用网的客户端（天翼云的 AONE）才能够正常访问。很可惜，客户端只提供了 Windows 和 MacOS 的版本。",[14,18,19],{},[20,21],"img",{"alt":22,"src":23},"","https://static.031130.xyz/uploads/2024/08/12/664e29866c1ab.webp",[14,25,26],{},"工作的代码总是要提交的，我也不想改变我的开发环境，又不希望在 Windows 上使用 git-for-windows 这个近乎简陋的工具进行代码提交，更别说还有一些别的内网服务接下来可能也会用到。所以最好的办法就是在 Linux 下也配置好能够访问内网的环境。",[10,28,29],{"id":29},"理论",[14,31,32],{},"在 Windows 下使用 AONE 的网络拓扑是这样的",[14,34,35],{},[20,36],{"alt":22,"src":37},"https://static.031130.xyz/uploads/2024/08/12/664e2b93de6f9.webp",[14,39,40],{},"而我的方案则是使用 Windows 虚拟机开启 AONE，并在这台虚拟机上开一个 socks5 server 负责代理 Linux 宿主机需要打到内网服务的流量。网络拓扑如下",[14,42,43],{},[20,44],{"alt":22,"src":45},"https://static.031130.xyz/uploads/2024/08/12/664e2e1b0da09.webp",[14,47,48,49,56],{},"根据 bilibili 上",[50,51,55],"a",{"href":52,"rel":53},"https://www.bilibili.com/video/BV11M4y1J7zP/",[54],"nofollow","技术蛋老师的视频总结","，我们应该选择使用网卡桥接的网络配置，只有这个配置方式同时支持「宿主->虚拟机」和 「虚拟机->互联网」的网络。",[14,58,59],{},[20,60],{"alt":61,"src":62},"图片来源: bilibili 技术蛋老师","https://static.031130.xyz/uploads/2024/08/12/664e2fbb4a36b.webp",[10,64,65],{"id":65},"实操",[67,68,70],"h3",{"id":69},"在-windows-虚拟机中开启虚拟专用网客户端","在 Windows 虚拟机中开启虚拟专用网客户端",[14,72,73],{},"开启 AONE，不做赘述",[67,75,77],{"id":76},"开启-socks-server监听地址为-0000-或者设置为宿主机的-ip-地址","开启 socks server，监听地址为 0.0.0.0 （或者设置为宿主机的 IP 地址）",[14,79,80,81,86],{},"在「",[50,82,85],{"href":83,"rel":84},"https://imbearchild.cyou/",[54],"熊孩子(BearChild)","」的推荐下，我这里采用的是大名鼎鼎的二级射线（某 V 字开头的常见软件），直接从 GIthub Release 中下载 Windows X64 的压缩包，简单配置下即可，如果没有什么特殊需求的话可以只修改图中的两处配置。",[14,88,89],{},[20,90],{"alt":22,"src":91},"https://static.031130.xyz/uploads/2024/08/12/664e328cd83b3.webp",[14,93,94],{},"在终端中通过该软件的 run 命令即可开启服务",[14,96,97],{},[20,98],{"alt":22,"src":99},"https://static.031130.xyz/uploads/2024/08/12/664e32e6c350a.webp",[67,101,102],{"id":102},"在宿主机进行测试",[14,104,105],{},"我这里使用的是 mzz2017 编写的 gg 命令进行代理，代理服务器的 ip 地址使用虚拟机下 ipconfig 命令获得的 ip 地址，端口号则对应上面配置文件中的 port 参数。",[14,107,108],{},[20,109],{"alt":22,"src":110},"https://static.031130.xyz/uploads/2024/08/12/664e33c3e8320.webp",[14,112,113],{},"这里 curl 百度得到了正确的相应，说明通道是通的，gg 也可以用于代理浏览器。经实测能够正常访问公司内网服务，不便在博客中展示。",{"title":22,"searchDepth":115,"depth":115,"links":116},2,[117,118,119],{"id":12,"depth":115,"text":12},{"id":29,"depth":115,"text":29},{"id":65,"depth":115,"text":65,"children":120},[121,123,124],{"id":69,"depth":122,"text":70},3,{"id":76,"depth":122,"text":77},{"id":102,"depth":122,"text":102},"2024-05-23 01:07:44","md",{},true,"/2024/05/23/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine","---\ntitle: 使用 Windows 虚拟机运行虚拟专用网客户端为 Linux 提供内网环境\ndate: 2024-05-23 01:07:44\nsticky:\ntags:\n- Linux\n- Windows\n- Virtual Machine\n- Network\n---\n\n## 起因\n\n最近在某家公司实习，公司内部的 git 部署在内网环境上，需要通过虚拟专用网的客户端（天翼云的 AONE）才能够正常访问。很可惜，客户端只提供了 Windows 和 MacOS 的版本。\n\n![](https://static.031130.xyz/uploads/2024/08/12/664e29866c1ab.webp)\n\n工作的代码总是要提交的，我也不想改变我的开发环境，又不希望在 Windows 上使用 git-for-windows 这个近乎简陋的工具进行代码提交，更别说还有一些别的内网服务接下来可能也会用到。所以最好的办法就是在 Linux 下也配置好能够访问内网的环境。\n\n## 理论\n\n在 Windows 下使用 AONE 的网络拓扑是这样的\n\n![](https://static.031130.xyz/uploads/2024/08/12/664e2b93de6f9.webp)\n\n而我的方案则是使用 Windows 虚拟机开启 AONE，并在这台虚拟机上开一个 socks5 server 负责代理 Linux 宿主机需要打到内网服务的流量。网络拓扑如下\n\n![](https://static.031130.xyz/uploads/2024/08/12/664e2e1b0da09.webp)\n\n根据 bilibili 上[技术蛋老师的视频总结](https://www.bilibili.com/video/BV11M4y1J7zP/)，我们应该选择使用网卡桥接的网络配置，只有这个配置方式同时支持「宿主->虚拟机」和 「虚拟机->互联网」的网络。\n\n![图片来源: bilibili 技术蛋老师](https://static.031130.xyz/uploads/2024/08/12/664e2fbb4a36b.webp)\n\n## 实操\n\n### 在 Windows 虚拟机中开启虚拟专用网客户端\n\n开启 AONE，不做赘述\n\n### 开启 socks server，监听地址为 0.0.0.0 （或者设置为宿主机的 IP 地址）\n\n在「[熊孩子(BearChild)](https://imbearchild.cyou/)」的推荐下，我这里采用的是大名鼎鼎的二级射线（某 V 字开头的常见软件），直接从 GIthub Release 中下载 Windows X64 的压缩包，简单配置下即可，如果没有什么特殊需求的话可以只修改图中的两处配置。\n\n![](https://static.031130.xyz/uploads/2024/08/12/664e328cd83b3.webp)\n\n在终端中通过该软件的 run 命令即可开启服务\n\n![](https://static.031130.xyz/uploads/2024/08/12/664e32e6c350a.webp)\n\n### 在宿主机进行测试\n\n我这里使用的是 mzz2017 编写的 gg 命令进行代理，代理服务器的 ip 地址使用虚拟机下 ipconfig 命令获得的 ip 地址，端口号则对应上面配置文件中的 port 参数。\n\n![](https://static.031130.xyz/uploads/2024/08/12/664e33c3e8320.webp)\n\n这里 curl 百度得到了正确的相应，说明通道是通的，gg 也可以用于代理浏览器。经实测能够正常访问公司内网服务，不便在博客中展示。\n",{"title":5,"description":22},"posts/setup-network-environment-for-non-linux-vpn-client-with-virtual-machine",false,[135,136,137,138],"Linux","Windows","Virtual Machine","Network","R3zt6xzJq7ZZOXCUfTpfenTRWK5UVGt507MeCufoLd0",[141,146],{"title":142,"path":143,"stem":144,"date":145,"children":-1},"使用动态公网 ip + ddns 实现 rustdesk 的 ip 直连","/2024/06/30/dynamic-public-ip-and-ddns-for-rustdesk","posts/dynamic-public-ip-and-ddns-for-rustdesk","2024-06-30 18:15:00",{"title":147,"path":148,"stem":149,"date":150,"children":-1},"以 Archlinux 中 makepkg 的方式打开 rpmbuild","/2024/05/03/open-rpmbuild-in-the-way-of-archlinux-makepkg","posts/open-rpmbuild-in-the-way-of-archlinux-makepkg","2024-05-03 22:48:39",12,1761735720282]