[{"data":1,"prerenderedAt":371},["ShallowReactive",2],{"post-2023-06-24-redmi-ac2100-router-with-padavan":3,"surround-2023-06-24-redmi-ac2100-router-with-padavan":359,"randomIndex/2023/06/24/redmi-ac2100-router-with-padavan/":370},{"id":4,"title":5,"body":6,"date":346,"description":119,"extension":347,"meta":348,"navigation":349,"path":350,"rawbody":351,"seo":352,"stem":353,"sticky":354,"tags":355,"__hash__":358},"posts/posts/redmi-ac2100-router-with-padavan.md","为红米 Redmi AC2100 路由器刷入 Padavan",{"type":7,"value":8,"toc":338},"minimark",[9,16,20,23,26,29,32,39,42,47,50,55,58,63,66,72,76,79,92,95,104,112,122,125,131,137,143,146,152,155,169,175,179,182,189,195,206,212,215,221,227,234,240,243,249,253,256,263,269,272,278,281,287,290,293,299,302,308,334],[10,11,12],"blockquote",{},[13,14,15],"p",{},"大一一年转眼就要过去了，最近要搬校区了，顺手就把之前刷过的「小米路由器4A千兆版」出手给了同学，自己反手入了一个 「Redmi AC 2100」，尽管是跟着教程走，但过程中依然是遇见了不少坑，因此就开一篇博客记录了一下。",[17,18,19],"h2",{"id":19},"重置路由器",[13,21,22],{},"这一步其实可有可无，只是我从闲鱼上入手这个路由器，买家并没有告知我密码，于是我只能手动 RESET 这个路由器来进入后台。",[17,24,25],{"id":25},"通过网络设置引导",[13,27,28],{},"原本就是连上路由器后简单地通过引导界面，但由于我没有一个正常的网络环境，所以这一步走的其实也是有点困难的，我还是稍微记一下。",[13,30,31],{},"首先浏览器地址栏输入 192.168.31.1 (小米家的路由器默认好像都是这个 ip 地址)，看到下图界面，加不加入用户改善计划其实都是无所谓的，反正马上就要刷掉这个系统了。",[13,33,34],{},[35,36],"img",{"alt":37,"src":38},"路由器设置引导界面","https://static.031130.xyz/uploads/2024/08/12/6495c9a227d2c.webp",[13,40,41],{},"此处选择「不插网线，继续配置」，因为我们没有标准的网络环境，还指望着这台路由器跑 l2tp 帮我们连校园网呢。",[13,43,44],{},[35,45],{"alt":37,"src":46},"https://static.031130.xyz/uploads/2024/08/12/6495ca724bf14.webp",[13,48,49],{},"这里需要选择「自动获取IP」（静态 IP）好像也行，但别的选项在我的网络环境下恐怕都是没法继续配置下去的。",[13,51,52],{},[35,53],{"alt":37,"src":54},"https://static.031130.xyz/uploads/2024/08/12/6495cae48566d.webp",[13,56,57],{},"随后随手输个 WIFI 名称和密码，主要是记住密码进路由器后台管理。",[13,59,60],{},[35,61],{"alt":37,"src":62},"https://static.031130.xyz/uploads/2024/08/12/6495cb8eba4b5.webp",[13,64,65],{},"设置完上述设置项以后，再次进入 192.168.31.1 ，就能看见路由器后台管理的登陆页面了。",[13,67,68],{},[35,69],{"alt":70,"src":71},"路由器后台管理首页","https://static.031130.xyz/uploads/2024/08/12/6495cc2ff1e02.webp",[17,73,75],{"id":74},"获取-ssh-权限","获取 ssh 权限",[13,77,78],{},"输入登陆密码，进入路由器后台管理页面，我们需要通过 bug 去获取打开官方系统的 ssh 功能",[10,80,81],{},[13,82,83,84,91],{},"这里提一嘴，当初我刷小米路由器4A千兆版的时候用的是",[85,86,90],"a",{"href":87,"rel":88},"https://github.com/acecilia/OpenWRTInvasion/",[89],"nofollow","这个仓库","来打开 ssh。",[13,93,94],{},"首先是确认路由器的版本，我从闲鱼上购得的路由器自带的版本是官方稳定版 2.0.23，一开始跟着别人的思路就降级到了 2.0.7，但后来遇见问题在网上查解决方案的时候看到有人说这个漏洞在 2.0.23 依然可用，但我也没有去试。",[13,96,97,98,103],{},"在电脑上下载 2.0.7 的",[85,99,102],{"href":100,"rel":101},"https://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_firmware_d6234_2.0.7.bin",[89],"升级包","，在路由器设置界面的常用设置->系统状态->手动升级 选择自己下载的升级包，确认等待重启即可。有些教程说可以选择保留数据，但我也懒得试，就直接清除了所有数据，又不得不再次过一遍上面的配置引导。",[13,105,106,107,111],{},"在地址栏，删除 ",[108,109,110],"code",{},"/web/home#router"," 部分，加入下面这串代码",[113,114,120],"pre",{"className":115,"code":117,"language":118,"meta":119},[116],"language-text","/api/misystem/set_config_iotdev?bssid=Xiaomi&user_id=longdike&ssid=-h%3B%20nvram%20set%20ssh_en%3D1%3B%20nvram%20commit%3B%20sed%20-i%20's%2Fchannel%3D.*%2Fchannel%3D%5C%22debug%5C%22%2Fg'%20%2Fetc%2Finit.d%2Fdropbear%3B%20%2Fetc%2Finit.d%2Fdropbear%20start%3B\n","text","",[108,121,117],{"__ignoreMap":119},[13,123,124],{},"再次删除后面的代码，加入下面这串代码",[113,126,129],{"className":127,"code":128,"language":118,"meta":119},[116],"/api/misystem/set_config_iotdev?bssid=Xiaomi&user_id=longdike&ssid=-h%3B%20echo%20-e%20'admin%5Cnadmin'%20%7C%20passwd%20root%3B\n",[108,130,128],{"__ignoreMap":119},[13,132,133],{},[35,134],{"alt":135,"src":136},"需要被去除的 url 部分","https://static.031130.xyz/uploads/2024/08/12/6495ce20b91d1.webp",[13,138,139],{},[35,140],{"alt":141,"src":142},"被截剩的 url 部分","https://static.031130.xyz/uploads/2024/08/12/6495ce1de2acd.webp",[13,144,145],{},"两次请求的正常反馈应该长成下面这个样子。",[13,147,148],{},[35,149],{"alt":150,"src":151},"正常反馈","https://static.031130.xyz/uploads/2024/08/12/6495ce8d86b03.webp",[13,153,154],{},"此时应该就可以使用 ssh 访问路由器的 root 账户了，密码已经被改为了 admin",[113,156,160],{"className":157,"code":158,"language":159,"meta":119,"style":119},"language-ba shiki shiki-themes one-light one-dark-pro","ssh -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedKeyTypes=+ssh-rsa root@192.168.31.1\n","ba",[108,161,162],{"__ignoreMap":119},[163,164,167],"span",{"class":165,"line":166},"line",1,[163,168,158],{},[13,170,171],{},[35,172],{"alt":173,"src":174},"登陆成功","https://static.031130.xyz/uploads/2024/08/12/6495cf0b224c4.webp",[17,176,178],{"id":177},"刷入-breed","刷入 breed",[13,180,181],{},"如果用我在安卓刷机的经验来讲 breed 是什么的话，我会把他类比成第三方 Recovery (TWRP)。这是一个能够帮助你去输入系统、备份系统的恢复模式。虽然我们可以直接刷入 padavan，但如果系统没有自带镜像刷写工具或者输入的系统打不开了，那可能就是一台路由器的报废，或许得靠编程器才能救回来。",[13,183,184,185],{},"首先，我们到 breed 下载站上下载 breed 的镜像: ",[85,186,187],{"href":187,"rel":188},"https://breed.hackpascal.net/",[89],[13,190,191],{},[35,192],{"alt":193,"src":194},"需要下载的 breed 镜像","https://static.031130.xyz/uploads/2024/08/12/6495cf9ca81de.webp",[13,196,197,198,201,202,205],{},"随后，在电脑上这个存放了 breed 镜像的路径上开一个 http server，我这里选择的是 ",[108,199,200],{},"darkhttpd","，Windows 或者 MacOS 用户可以选择使用 ",[108,203,204],{},"miniserve","，他们呢起的是一样的效果，甚至可以使用 python 直接开一个 local server。",[13,207,208],{},[35,209],{"alt":210,"src":211},"本地 http 服务","https://static.031130.xyz/uploads/2024/08/12/6495d0bd79f4c.webp",[13,213,214],{},"接下来，通过自己电脑在路由器局域网内的那个 ip 地址并添加端口号在浏览器上访问你开的 http server，直接右键复制 breed 镜像的下载链接。",[13,216,217],{},[35,218],{"alt":219,"src":220},"查看本机 ip","https://static.031130.xyz/uploads/2024/08/12/6495d0bd79f4d.webp",[13,222,223],{},[35,224],{"alt":225,"src":226},"复制下载链接","https://static.031130.xyz/uploads/2024/08/12/6495d10b09fe0.webp",[13,228,229,230,233],{},"将 ssh 连接到的路由器终端 cd 到 /tmp 路径下，使用 wget 命令去下载你刚刚复制到的 url，这样我们就简单地将 breed 镜像传输到了路由器的内存上。再使用 ",[108,231,232],{},"mtd -r write breed-mt7621-xiaomi-r3g.bin Bootloader"," 刷入 breed，刷入成功后 ssh 将会自动断开连接，但并不会直接进入 breed。",[13,235,236],{},[35,237],{"alt":238,"src":239},"Screenshot_20230623_203903.png","https://static.031130.xyz/uploads/2024/08/12/6495d17602f3a.webp",[13,241,242],{},"我们需要先断开路由器的电源，使用一根针（比如取卡针）怼在 RESET 按钮上面，再次接通路由器的电源并持续按压 RESET 按钮几秒钟，浏览器这时就会进入 breed 状态，浏览器访问 192.168.1.1 就可以看到他的控制面板。",[13,244,245],{},[35,246],{"alt":247,"src":248},"Breed Web 界面","https://static.031130.xyz/uploads/2024/08/12/6495d2129a764.webp",[17,250,252],{"id":251},"刷入-padavan","刷入 Padavan",[13,254,255],{},"在 Breed 中拥有很多的功能，不过我们用到的只是「固件更新」这一个功能，备份功能什么的可以自己尝试，这只是一个可选项。",[13,257,258,259],{},"首先去下载站下载适配 Redmi AC2100 的 Padavan 镜像: ",[85,260,261],{"href":261,"rel":262},"https://opt.cn2qq.com/padavan/",[89],[13,264,265],{},[35,266],{"alt":267,"src":268},"适配 Redmi AC2100 的 Padavan 镜像","https://static.031130.xyz/uploads/2024/08/12/6495d5cbbb5b9.webp",[13,270,271],{},"然后在 Breed 的 web 端控制台直接选择 Padavan 的系统镜像进行固件更新",[13,273,274],{},[35,275],{"alt":276,"src":277},"固件更新界面","https://static.031130.xyz/uploads/2024/08/12/6495d63261ad4.webp",[13,279,280],{},"确认后直接刷入",[13,282,283],{},[35,284],{"alt":285,"src":286},"固件刷入中","https://static.031130.xyz/uploads/2024/08/12/6495d64fd1e0e.webp",[13,288,289],{},"自动重启后，Padavan 就刷入完成了。",[13,291,292],{},"Padavan 的默认 WIFI 名是 PDCN 和 PDCN_5G，WIFI 密码是 1234567890",[13,294,295],{},[35,296],{"alt":297,"src":298},"Padavan 的默认 WIFI","https://static.031130.xyz/uploads/2024/08/12/6495d6c11aa01.webp",[13,300,301],{},"浏览器输入 192.168.123.1 就可以进入默认的后台管理页面，管理页面的用户名和密码都是 admin",[13,303,304],{},[35,305],{"alt":306,"src":307},"Padavan 设置界面","https://static.031130.xyz/uploads/2024/08/12/6496ac4f3170f.webp",[10,309,310,313,320,327],{},[13,311,312],{},"参考文章:",[13,314,315],{},[85,316,319],{"href":317,"rel":318},"https://www.bilibili.com/read/cv18237601/",[89],"《小米/红米AC2100刷OpenWrt/Padavan/第三方固件的详细教程（2022年8月23日更新）》",[13,321,322],{},[85,323,326],{"href":324,"rel":325},"https://zhuanlan.zhihu.com/p/260531160",[89],"《小米、红米 AC2100 一键开启 SSH，可自定义安装各种插件》",[13,328,329],{},[85,330,333],{"href":331,"rel":332},"https://blog.alanwei.com/blog/2022/01/24/ssh-no-matching-host-key-type-found/",[89],"《解决SSH no matching host key type found 问题》",[335,336,337],"style",{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":119,"searchDepth":339,"depth":339,"links":340},2,[341,342,343,344,345],{"id":19,"depth":339,"text":19},{"id":25,"depth":339,"text":25},{"id":74,"depth":339,"text":75},{"id":177,"depth":339,"text":178},{"id":251,"depth":339,"text":252},"2023-06-24 00:22:53","md",{},true,"/2023/06/24/redmi-ac2100-router-with-padavan","---\ntitle: 为红米 Redmi AC2100 路由器刷入 Padavan\ndate: 2023-06-24 00:22:53\nsticky:\ntags:\n- Router\n- Network\n---\n\n> 大一一年转眼就要过去了，最近要搬校区了，顺手就把之前刷过的「小米路由器4A千兆版」出手给了同学，自己反手入了一个 「Redmi AC 2100」，尽管是跟着教程走，但过程中依然是遇见了不少坑，因此就开一篇博客记录了一下。\n\n## 重置路由器\n\n这一步其实可有可无，只是我从闲鱼上入手这个路由器，买家并没有告知我密码，于是我只能手动 RESET 这个路由器来进入后台。\n\n## 通过网络设置引导\n\n原本就是连上路由器后简单地通过引导界面，但由于我没有一个正常的网络环境，所以这一步走的其实也是有点困难的，我还是稍微记一下。\n\n首先浏览器地址栏输入 192.168.31.1 (小米家的路由器默认好像都是这个 ip 地址)，看到下图界面，加不加入用户改善计划其实都是无所谓的，反正马上就要刷掉这个系统了。\n\n![路由器设置引导界面](https://static.031130.xyz/uploads/2024/08/12/6495c9a227d2c.webp)\n\n此处选择「不插网线，继续配置」，因为我们没有标准的网络环境，还指望着这台路由器跑 l2tp 帮我们连校园网呢。\n\n![路由器设置引导界面](https://static.031130.xyz/uploads/2024/08/12/6495ca724bf14.webp)\n\n这里需要选择「自动获取IP」（静态 IP）好像也行，但别的选项在我的网络环境下恐怕都是没法继续配置下去的。\n\n![路由器设置引导界面](https://static.031130.xyz/uploads/2024/08/12/6495cae48566d.webp)\n\n随后随手输个 WIFI 名称和密码，主要是记住密码进路由器后台管理。\n\n![路由器设置引导界面](https://static.031130.xyz/uploads/2024/08/12/6495cb8eba4b5.webp)\n\n设置完上述设置项以后，再次进入 192.168.31.1 ，就能看见路由器后台管理的登陆页面了。\n\n![路由器后台管理首页](https://static.031130.xyz/uploads/2024/08/12/6495cc2ff1e02.webp)\n\n## 获取 ssh 权限\n\n输入登陆密码，进入路由器后台管理页面，我们需要通过 bug 去获取打开官方系统的 ssh 功能\n\n> 这里提一嘴，当初我刷小米路由器4A千兆版的时候用的是[这个仓库](https://github.com/acecilia/OpenWRTInvasion/)来打开 ssh。\n\n首先是确认路由器的版本，我从闲鱼上购得的路由器自带的版本是官方稳定版 2.0.23，一开始跟着别人的思路就降级到了 2.0.7，但后来遇见问题在网上查解决方案的时候看到有人说这个漏洞在 2.0.23 依然可用，但我也没有去试。\n\n在电脑上下载 2.0.7 的[升级包](https://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_firmware_d6234_2.0.7.bin)，在路由器设置界面的常用设置->系统状态->手动升级 选择自己下载的升级包，确认等待重启即可。有些教程说可以选择保留数据，但我也懒得试，就直接清除了所有数据，又不得不再次过一遍上面的配置引导。\n\n在地址栏，删除 `/web/home#router` 部分，加入下面这串代码\n\n```text\n/api/misystem/set_config_iotdev?bssid=Xiaomi&user_id=longdike&ssid=-h%3B%20nvram%20set%20ssh_en%3D1%3B%20nvram%20commit%3B%20sed%20-i%20's%2Fchannel%3D.*%2Fchannel%3D%5C%22debug%5C%22%2Fg'%20%2Fetc%2Finit.d%2Fdropbear%3B%20%2Fetc%2Finit.d%2Fdropbear%20start%3B\n```\n\n再次删除后面的代码，加入下面这串代码\n\n```text\n/api/misystem/set_config_iotdev?bssid=Xiaomi&user_id=longdike&ssid=-h%3B%20echo%20-e%20'admin%5Cnadmin'%20%7C%20passwd%20root%3B\n```\n\n![需要被去除的 url 部分](https://static.031130.xyz/uploads/2024/08/12/6495ce20b91d1.webp)\n\n![被截剩的 url 部分](https://static.031130.xyz/uploads/2024/08/12/6495ce1de2acd.webp)\n\n两次请求的正常反馈应该长成下面这个样子。\n\n![正常反馈](https://static.031130.xyz/uploads/2024/08/12/6495ce8d86b03.webp)\n\n此时应该就可以使用 ssh 访问路由器的 root 账户了，密码已经被改为了 admin\n\n```ba\nssh -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedKeyTypes=+ssh-rsa root@192.168.31.1\n```\n\n![登陆成功](https://static.031130.xyz/uploads/2024/08/12/6495cf0b224c4.webp)\n\n## 刷入 breed\n\n如果用我在安卓刷机的经验来讲 breed 是什么的话，我会把他类比成第三方 Recovery (TWRP)。这是一个能够帮助你去输入系统、备份系统的恢复模式。虽然我们可以直接刷入 padavan，但如果系统没有自带镜像刷写工具或者输入的系统打不开了，那可能就是一台路由器的报废，或许得靠编程器才能救回来。\n\n首先，我们到 breed 下载站上下载 breed 的镜像: https://breed.hackpascal.net/\n\n![需要下载的 breed 镜像](https://static.031130.xyz/uploads/2024/08/12/6495cf9ca81de.webp)\n\n随后，在电脑上这个存放了 breed 镜像的路径上开一个 http server，我这里选择的是 `darkhttpd`，Windows 或者 MacOS 用户可以选择使用 `miniserve`，他们呢起的是一样的效果，甚至可以使用 python 直接开一个 local server。\n\n![本地 http 服务](https://static.031130.xyz/uploads/2024/08/12/6495d0bd79f4c.webp)\n\n接下来，通过自己电脑在路由器局域网内的那个 ip 地址并添加端口号在浏览器上访问你开的 http server，直接右键复制 breed 镜像的下载链接。\n\n![查看本机 ip](https://static.031130.xyz/uploads/2024/08/12/6495d0bd79f4d.webp)\n\n![复制下载链接](https://static.031130.xyz/uploads/2024/08/12/6495d10b09fe0.webp)\n\n将 ssh 连接到的路由器终端 cd 到 /tmp 路径下，使用 wget 命令去下载你刚刚复制到的 url，这样我们就简单地将 breed 镜像传输到了路由器的内存上。再使用 `mtd -r write breed-mt7621-xiaomi-r3g.bin Bootloader` 刷入 breed，刷入成功后 ssh 将会自动断开连接，但并不会直接进入 breed。\n\n![Screenshot_20230623_203903.png](https://static.031130.xyz/uploads/2024/08/12/6495d17602f3a.webp)\n\n我们需要先断开路由器的电源，使用一根针（比如取卡针）怼在 RESET 按钮上面，再次接通路由器的电源并持续按压 RESET 按钮几秒钟，浏览器这时就会进入 breed 状态，浏览器访问 192.168.1.1 就可以看到他的控制面板。\n\n![Breed Web 界面](https://static.031130.xyz/uploads/2024/08/12/6495d2129a764.webp)\n\n## 刷入 Padavan\n\n在 Breed 中拥有很多的功能，不过我们用到的只是「固件更新」这一个功能，备份功能什么的可以自己尝试，这只是一个可选项。\n\n首先去下载站下载适配 Redmi AC2100 的 Padavan 镜像: https://opt.cn2qq.com/padavan/\n\n![适配 Redmi AC2100 的 Padavan 镜像](https://static.031130.xyz/uploads/2024/08/12/6495d5cbbb5b9.webp)\n\n然后在 Breed 的 web 端控制台直接选择 Padavan 的系统镜像进行固件更新\n\n![固件更新界面](https://static.031130.xyz/uploads/2024/08/12/6495d63261ad4.webp)\n\n确认后直接刷入\n\n![固件刷入中](https://static.031130.xyz/uploads/2024/08/12/6495d64fd1e0e.webp)\n\n自动重启后，Padavan 就刷入完成了。\n\nPadavan 的默认 WIFI 名是 PDCN 和 PDCN_5G，WIFI 密码是 1234567890\n\n![Padavan 的默认 WIFI](https://static.031130.xyz/uploads/2024/08/12/6495d6c11aa01.webp)\n\n浏览器输入 192.168.123.1 就可以进入默认的后台管理页面，管理页面的用户名和密码都是 admin\n\n![Padavan 设置界面](https://static.031130.xyz/uploads/2024/08/12/6496ac4f3170f.webp)\n\n> 参考文章: \n>\n> [《小米/红米AC2100刷OpenWrt/Padavan/第三方固件的详细教程（2022年8月23日更新）》](https://www.bilibili.com/read/cv18237601/)\n>\n> [《小米、红米 AC2100 一键开启 SSH，可自定义安装各种插件》](https://zhuanlan.zhihu.com/p/260531160)\n>\n> [《解决SSH no matching host key type found 问题》](https://blog.alanwei.com/blog/2022/01/24/ssh-no-matching-host-key-type-found/)\n",{"title":5,"description":119},"posts/redmi-ac2100-router-with-padavan",false,[356,357],"Router","Network","8s9UXfEthwSFPmStgS6rLiCpDr6g3BTi0erjjy2y3Hg",[360,365],{"title":361,"path":362,"stem":363,"date":364,"children":-1},"在浙工大宿舍使用路由器连接移动网络(校园网)","/2023/06/24/connect-china-mobile-with-router-in-zjut-dormitory","posts/connect-china-mobile-with-router-in-zjut-dormitory","2023-06-24 14:30:24",{"title":366,"path":367,"stem":368,"date":369,"children":-1},"Azure 教育订阅申请时遇到的麻烦","/2023/05/12/troubles-when-applying-azure-education","posts/troubles-when-applying-azure-education","2023-05-12 23:38:29",11,1762243371458]