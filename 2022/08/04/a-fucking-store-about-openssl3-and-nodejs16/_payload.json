[{"data":1,"prerenderedAt":190},["ShallowReactive",2],{"post-2022-08-04-a-fucking-store-about-openssl3-and-nodejs16":3,"surround-2022-08-04-a-fucking-store-about-openssl3-and-nodejs16":178,"randomIndex/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16/":189},{"id":4,"title":5,"body":6,"date":164,"description":161,"extension":165,"meta":166,"navigation":167,"path":168,"rawbody":169,"seo":170,"stem":171,"sticky":172,"tags":173,"__hash__":177},"posts/posts/a-fucking-store-about-openssl3-and-nodejs16.md","nodejs16：是我配不上 openssl 3 咯？",{"type":7,"value":8,"toc":160},"minimark",[9,17,20,39,54,57,60,63,66,75,81,84,130,132,155],[10,11,12],"p",{},[13,14],"img",{"alt":15,"src":16},"长毛象的截图.png","https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp",[10,18,19],{},"今年上半年升级 Fedora 36 的时候遇到了这个问题。",[10,21,22,23,27,28,35,36,38],{},"那会儿很无奈，一直在等 nodejs16 合并提供 ",[24,25,26],"code",{},"--openssl-legacy-provider"," 的",[29,30,34],"a",{"href":31,"rel":32},"https://github.com/nodejs/node/pull/42972",[33],"nofollow","那个 PR","。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 ",[24,37,26],{}," 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。",[10,40,41,42,47,48,53],{},"然而，nodejs 在他们的官网上发布的",[29,43,46],{"href":44,"rel":45},"https://nodejs.org/en/blog/announcements/nodejs16-eol/",[33],"一篇博客","刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有",[29,49,52],{"href":50,"rel":51},"https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/",[33],"寒晶雪提供的中文翻译","）",[10,55,56],{},"博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）",[10,58,59],{},"很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。",[61,62],"hr",{},[10,64,65],{},"不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）",[10,67,68,69,74],{},"前几天我给 ",[29,70,73],{"href":71,"rel":72},"https://github.com/atpoossfl/repo",[33],"atpoossfl 仓库","打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。",[10,76,77],{},[13,78],{"alt":79,"src":80},"此为 nvm 安装的 nodejs14 目录","https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp",[10,82,83],{},"所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。",[85,86,87],"blockquote",{},[10,88,89,90,93,94,97,98,101,102,105,106,111,112,115,116,119,120,123,124,126,127,129],{},"使用 Fedora 的用户需要注意，Fedora 官方源中的",[24,91,92],{},"yarnpkg","在打包时遇到了错误，他们将 ",[24,95,96],{},"/usr/lib/node_modules/yarn/bin/yarn.js"," 的 shebang 给改成了 ",[24,99,100],{},"#!/usr/bin/node","，应当改回 ",[24,103,104],{},"#!/usr/bin/env node","才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 ",[29,107,110],{"href":108,"rel":109},"https://dl.yarnpkg.com/rpm/yarn.repo",[33],"dl.yarnpkg.com"," 提供的 ",[24,113,114],{},"yarn"," 软件包。在写 specfile 的 ",[24,117,118],{},"BuildRequires"," 时，可以直接写成 ",[24,121,122],{},"/usr/bin/yarn"," 来避免频繁在 ",[24,125,114],{}," 和 ",[24,128,92],{}," 这两个包名间改动。",[61,131],{},[10,133,134,135,126,138,141,142,144,145,150,151,154],{},"更好的消息是，nodejs 已经在 ",[24,136,137],{},"v16.17.0-proposal",[24,139,140],{},"v16.x-staging"," 分支收下了这个为 nodejs16 提供 ",[24,143,26],{}," 的 ",[29,146,149],{"href":147,"rel":148},"https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f",[33],"commit","。相信在不久的将来，这个 commit 将会进入主线，并在 ",[24,152,153],{},"v16.17"," 版本的 nodejs16 上发挥它的作用。",[10,156,157],{},[13,158],{"alt":149,"src":159},"https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp",{"title":161,"searchDepth":162,"depth":162,"links":163},"",2,[],"2022-08-04 17:31:49","md",{},true,"/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16","---\ntitle: nodejs16：是我配不上 openssl 3 咯？\ndate: 2022-08-04 17:31:49\nsticky:\ntags:\n- Fedora\n- nodejs\n- OpenSSL\n---\n\n![长毛象的截图.png](https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp)\n\n今年上半年升级 Fedora 36 的时候遇到了这个问题。\n\n那会儿很无奈，一直在等 nodejs16 合并提供 `--openssl-legacy-provider` 的[那个 PR](https://github.com/nodejs/node/pull/42972)。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 `--openssl-legacy-provider` 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。\n\n然而，nodejs 在他们的官网上发布的[一篇博客](https://nodejs.org/en/blog/announcements/nodejs16-eol/)刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有[寒晶雪提供的中文翻译](https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/)）\n\n博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）\n\n很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。\n\n***\n\n不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）\n\n前几天我给 [atpoossfl 仓库](https://github.com/atpoossfl/repo)打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。\n\n![此为 nvm 安装的 nodejs14 目录](https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp)\n\n所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。\n\n> 使用 Fedora 的用户需要注意，Fedora 官方源中的`yarnpkg`在打包时遇到了错误，他们将 `/usr/lib/node_modules/yarn/bin/yarn.js` 的 shebang 给改成了 `#!/usr/bin/node`，应当改回 `#!/usr/bin/env node`才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 [dl.yarnpkg.com](https://dl.yarnpkg.com/rpm/yarn.repo) 提供的 `yarn` 软件包。在写 specfile 的 `BuildRequires` 时，可以直接写成 `/usr/bin/yarn` 来避免频繁在 `yarn` 和 `yarnpkg` 这两个包名间改动。\n\n***\n\n更好的消息是，nodejs 已经在 `v16.17.0-proposal` 和 `v16.x-staging` 分支收下了这个为 nodejs16 提供 `--openssl-legacy-provider` 的 [commit](https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f)。相信在不久的将来，这个 commit 将会进入主线，并在 `v16.17` 版本的 nodejs16 上发挥它的作用。\n\n![commit](https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp)\n\n\n\n",{"title":5,"description":161},"posts/a-fucking-store-about-openssl3-and-nodejs16",false,[174,175,176],"Fedora","nodejs","OpenSSL","zCs0H_Cp08U0Zp94KBi_qK4uptSxsc-eX2Uz7xT83Rg",[179,184],{"title":180,"path":181,"stem":182,"date":183,"children":-1},"为 Element 添加自己喜欢的贴纸","/2022/08/10/add-sticker-support-for-element","posts/add-sticker-support-for-element","2022-08-10 19:51:19",{"title":185,"path":186,"stem":187,"date":188,"children":-1},"如何拯救失声的 hollywood","/2022/07/25/restore-the-sound-of-hollywood","posts/restore-the-sound-of-hollywood","2022-07-25 11:25:44",14,1761769024963]