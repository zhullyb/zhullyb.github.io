[{"data":1,"prerenderedAt":183},["ShallowReactive",2],{"post-2022-08-04-a-fucking-store-about-openssl3-and-nodejs16-zh":3,"surround-2022-08-04-a-fucking-store-about-openssl3-and-nodejs16-zh":169,"randomIndex/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16/":181,"language-switch-/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16/-en":182},{"title":4,"date":5,"path":6,"tags":7,"body":11,"description":166},"nodejs16：是我配不上 openssl 3 咯？","2022-08-04 17:31:49","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16",[8,9,10],"Fedora","nodejs","OpenSSL",{"type":12,"value":13,"toc":165},"minimark",[14,22,25,44,59,62,65,68,71,80,86,89,135,137,160],[15,16,17],"p",{},[18,19],"img",{"alt":20,"src":21},"长毛象的截图.png","https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp",[15,23,24],{},"今年上半年升级 Fedora 36 的时候遇到了这个问题。",[15,26,27,28,32,33,40,41,43],{},"那会儿很无奈，一直在等 nodejs16 合并提供 ",[29,30,31],"code",{},"--openssl-legacy-provider"," 的",[34,35,39],"a",{"href":36,"rel":37},"https://github.com/nodejs/node/pull/42972",[38],"nofollow","那个 PR","。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 ",[29,42,31],{}," 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。",[15,45,46,47,52,53,58],{},"然而，nodejs 在他们的官网上发布的",[34,48,51],{"href":49,"rel":50},"https://nodejs.org/en/blog/announcements/nodejs16-eol/",[38],"一篇博客","刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有",[34,54,57],{"href":55,"rel":56},"https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/",[38],"寒晶雪提供的中文翻译","）",[15,60,61],{},"博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）",[15,63,64],{},"很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。",[66,67],"hr",{},[15,69,70],{},"不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）",[15,72,73,74,79],{},"前几天我给 ",[34,75,78],{"href":76,"rel":77},"https://github.com/atpoossfl/repo",[38],"atpoossfl 仓库","打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。",[15,81,82],{},[18,83],{"alt":84,"src":85},"此为 nvm 安装的 nodejs14 目录","https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp",[15,87,88],{},"所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。",[90,91,92],"blockquote",{},[15,93,94,95,98,99,102,103,106,107,110,111,116,117,120,121,124,125,128,129,131,132,134],{},"使用 Fedora 的用户需要注意，Fedora 官方源中的",[29,96,97],{},"yarnpkg","在打包时遇到了错误，他们将 ",[29,100,101],{},"/usr/lib/node_modules/yarn/bin/yarn.js"," 的 shebang 给改成了 ",[29,104,105],{},"#!/usr/bin/node","，应当改回 ",[29,108,109],{},"#!/usr/bin/env node","才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 ",[34,112,115],{"href":113,"rel":114},"https://dl.yarnpkg.com/rpm/yarn.repo",[38],"dl.yarnpkg.com"," 提供的 ",[29,118,119],{},"yarn"," 软件包。在写 specfile 的 ",[29,122,123],{},"BuildRequires"," 时，可以直接写成 ",[29,126,127],{},"/usr/bin/yarn"," 来避免频繁在 ",[29,130,119],{}," 和 ",[29,133,97],{}," 这两个包名间改动。",[66,136],{},[15,138,139,140,131,143,146,147,149,150,155,156,159],{},"更好的消息是，nodejs 已经在 ",[29,141,142],{},"v16.17.0-proposal",[29,144,145],{},"v16.x-staging"," 分支收下了这个为 nodejs16 提供 ",[29,148,31],{}," 的 ",[34,151,154],{"href":152,"rel":153},"https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f",[38],"commit","。相信在不久的将来，这个 commit 将会进入主线，并在 ",[29,157,158],{},"v16.17"," 版本的 nodejs16 上发挥它的作用。",[15,161,162],{},[18,163],{"alt":154,"src":164},"https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp",{"title":166,"searchDepth":167,"depth":167,"links":168},"",2,[],[170,176],{"title":171,"path":172,"stem":173,"date":174,"lang":175,"children":-1},"为 Element 添加自己喜欢的贴纸","/2022/08/10/add-sticker-support-for-element","posts/zh/add-sticker-support-for-element","2022-08-10 19:51:19","zh-CN",{"title":177,"path":178,"stem":179,"date":180,"lang":175,"children":-1},"如何拯救失声的 hollywood","/2022/07/25/restore-the-sound-of-hollywood","posts/zh/restore-the-sound-of-hollywood","2022-07-25 11:25:44",7,null,1766337209210]