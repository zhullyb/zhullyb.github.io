[{"data":1,"prerenderedAt":509},["ShallowReactive",2],{"post-2022-08-10-add-sticker-support-for-element":3,"surround-2022-08-10-add-sticker-support-for-element":498,"randomIndex/2022/08/10/add-sticker-support-for-element/":333},{"id":4,"title":5,"body":6,"date":487,"description":55,"extension":488,"meta":489,"navigation":490,"path":491,"rawbody":492,"seo":493,"stem":494,"sticky":495,"tags":496,"__hash__":497},"posts/posts/add-sticker-support-for-element.md","为 Element 添加自己喜欢的贴纸",{"type":7,"value":8,"toc":479},"minimark",[9,16,20,36,46,49,86,90,93,109,113,116,142,145,148,175,182,186,193,212,215,226,233,236,239,242,262,266,269,276,282,288,294,301,307,310,457,463,466,469,475],[10,11,12],"blockquote",{},[13,14,15],"p",{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[17,18,19],"h2",{"id":19},"需要准备的",[21,22,23,27,30,33],"ul",{},[24,25,26],"li",{},"PC 端 element",[24,28,29],{},"python3.6+ 环境",[24,31,32],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[24,34,35],{},"可能需要能够突破大局域网限制的网络环境",[13,37,38,39],{},"需要用到的项目 ",[40,41,45],"a",{"href":42,"rel":43},"https://github.com/maunium/stickerpicker",[44],"nofollow","maunium/stickerpicker",[17,47,48],{"id":48},"克隆主项目",[50,51,56],"pre",{"className":52,"code":53,"language":54,"meta":55,"style":55},"language-bash shiki shiki-themes github-light github-dark","git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n","bash","",[57,58,59],"code",{"__ignoreMap":55},[60,61,64,68,72,75,79,83],"span",{"class":62,"line":63},"line",1,[60,65,67],{"class":66},"sScJk","git",[60,69,71],{"class":70},"sZZnC"," clone",[60,73,74],{"class":70}," https://github.com/maunium/stickerpicker.git",[60,76,78],{"class":77},"sVt8B"," && ",[60,80,82],{"class":81},"sj4cs","cd",[60,84,85],{"class":70}," stickerpicker\n",[17,87,89],{"id":88},"使用-pip-安装依赖","使用 pip 安装依赖",[13,91,92],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[50,94,96],{"className":52,"code":95,"language":54,"meta":55,"style":55},"pip install .\n",[57,97,98],{"__ignoreMap":55},[60,99,100,103,106],{"class":62,"line":63},[60,101,102],{"class":66},"pip",[60,104,105],{"class":70}," install",[60,107,108],{"class":70}," .\n",[17,110,112],{"id":111},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[13,114,115],{},"在项目根目录下创新一个新的目录。",[50,117,119],{"className":52,"code":118,"language":54,"meta":55,"style":55},"mkdir \u003Cpack directory>\n",[57,120,121],{"__ignoreMap":55},[60,122,123,126,130,133,136,139],{"class":62,"line":63},[60,124,125],{"class":66},"mkdir",[60,127,129],{"class":128},"szBVR"," \u003C",[60,131,132],{"class":70},"pack",[60,134,135],{"class":70}," director",[60,137,138],{"class":77},"y",[60,140,141],{"class":128},">\n",[13,143,144],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[13,146,147],{},"执行命令进行打包",[50,149,151],{"className":52,"code":150,"language":54,"meta":55,"style":55},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[57,152,153],{"__ignoreMap":55},[60,154,155,158,160,162,164,166,169,172],{"class":62,"line":63},[60,156,157],{"class":66},"sticker-pack",[60,159,129],{"class":128},[60,161,132],{"class":70},[60,163,135],{"class":70},[60,165,138],{"class":77},[60,167,168],{"class":128},">",[60,170,171],{"class":81}," --add-to-index",[60,173,174],{"class":70}," web/packs/\n",[13,176,177,178,181],{},"如果想要给目录贴纸包命名，则可以追加",[57,179,180],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[17,183,185],{"id":184},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[13,187,188,189,192],{},"项目内已经为我们准备了 ",[57,190,191],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[50,194,196],{"className":52,"code":195,"language":54,"meta":55,"style":55},"sticker-import \u003Cpack_url>\n",[57,197,198],{"__ignoreMap":55},[60,199,200,202,204,207,210],{"class":62,"line":63},[60,201,191],{"class":66},[60,203,129],{"class":128},[60,205,206],{"class":70},"pack_ur",[60,208,209],{"class":77},"l",[60,211,141],{"class":128},[13,213,214],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[13,216,217,218,221,222,225],{},"matrix 的 ",[57,219,220],{},"homeserver"," 和 ",[57,223,224],{},"access token"," 可以在 PC 端 element 的设置里找到",[13,227,228],{},[229,230],"img",{"alt":231,"src":232},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[13,234,235],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[13,237,238],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[240,241],"hr",{},[13,243,244,245,248,249,252,253,258,259],{},"接着我们需要做的事情就是将 ",[57,246,247],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[57,250,251],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[40,254,257],{"href":255,"rel":256},"https://blog.zhaose.cyou/",[44],"@朝色"," 的 url 也可以直接拿来使用 ",[57,260,261],{},"https://sticker.zhaose.cyou/web/",[17,263,265],{"id":264},"添加到-element","添加到 element",[13,267,268],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[13,270,271,272,275],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[57,273,274],{},"/devtools"," 并发送",[13,277,278],{},[229,279],{"alt":280,"src":281},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[13,283,284,285],{},"将会出现如下页面，选择 ",[57,286,287],{},"Explore account data",[13,289,290],{},[229,291],{"alt":292,"src":293},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[13,295,296,297,300],{},"找到 ",[57,298,299],{},"m.widgets","，如果没有，就点击下图标出的按钮",[13,302,303],{},[229,304],{"alt":305,"src":306},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[13,308,309],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[50,311,315],{"className":312,"code":313,"language":314,"meta":55,"style":55},"language-json shiki shiki-themes github-light github-dark","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[57,316,317,322,331,339,354,367,380,389,395,408,421,434,445,451],{"__ignoreMap":55},[60,318,319],{"class":62,"line":63},[60,320,321],{"class":77},"{\n",[60,323,325,328],{"class":62,"line":324},2,[60,326,327],{"class":81},"    \"stickerpicker\"",[60,329,330],{"class":77},": {\n",[60,332,334,337],{"class":62,"line":333},3,[60,335,336],{"class":81},"        \"content\"",[60,338,330],{"class":77},[60,340,342,345,348,351],{"class":62,"line":341},4,[60,343,344],{"class":81},"            \"type\"",[60,346,347],{"class":77},": ",[60,349,350],{"class":70},"\"m.stickerpicker\"",[60,352,353],{"class":77},",\n",[60,355,357,360,362,365],{"class":62,"line":356},5,[60,358,359],{"class":81},"            \"url\"",[60,361,347],{"class":77},[60,363,364],{"class":70},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[60,366,353],{"class":77},[60,368,370,373,375,378],{"class":62,"line":369},6,[60,371,372],{"class":81},"            \"name\"",[60,374,347],{"class":77},[60,376,377],{"class":70},"\"Stickerpicker\"",[60,379,353],{"class":77},[60,381,383,386],{"class":62,"line":382},7,[60,384,385],{"class":81},"            \"data\"",[60,387,388],{"class":77},": {}\n",[60,390,392],{"class":62,"line":391},8,[60,393,394],{"class":77},"        },\n",[60,396,398,401,403,406],{"class":62,"line":397},9,[60,399,400],{"class":81},"        \"sender\"",[60,402,347],{"class":77},[60,404,405],{"class":70},"\"@you:matrix.server.name\"",[60,407,353],{"class":77},[60,409,411,414,416,419],{"class":62,"line":410},10,[60,412,413],{"class":81},"        \"state_key\"",[60,415,347],{"class":77},[60,417,418],{"class":70},"\"stickerpicker\"",[60,420,353],{"class":77},[60,422,424,427,429,432],{"class":62,"line":423},11,[60,425,426],{"class":81},"        \"type\"",[60,428,347],{"class":77},[60,430,431],{"class":70},"\"m.widget\"",[60,433,353],{"class":77},[60,435,437,440,442],{"class":62,"line":436},12,[60,438,439],{"class":81},"        \"id\"",[60,441,347],{"class":77},[60,443,444],{"class":70},"\"stickerpicker\"\n",[60,446,448],{"class":62,"line":447},13,[60,449,450],{"class":77},"    }\n",[60,452,454],{"class":62,"line":453},14,[60,455,456],{"class":77},"}\n",[13,458,459],{},[229,460],{"alt":461,"src":462},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[13,464,465],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[13,467,468],{},"补一张效果图",[13,470,471],{},[229,472],{"alt":473,"src":474},"效果图","https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[476,477,478],"style",{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}",{"title":55,"searchDepth":324,"depth":324,"links":480},[481,482,483,484,485,486],{"id":19,"depth":324,"text":19},{"id":48,"depth":324,"text":48},{"id":88,"depth":324,"text":89},{"id":111,"depth":324,"text":112},{"id":184,"depth":324,"text":185},{"id":264,"depth":324,"text":265},"2022-08-10 19:51:19","md",{},true,"/2022/08/10/add-sticker-support-for-element","---\ntitle: 为 Element 添加自己喜欢的贴纸\ndate: 2022-08-10 19:51:19\nsticky:\ntags:\n---\n\n\n\n> 在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。\n\n## 需要准备的\n\n- PC 端 element\n- python3.6+ 环境\n- 能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）\n- 可能需要能够突破大局域网限制的网络环境\n\n需要用到的项目 [maunium/stickerpicker](https://github.com/maunium/stickerpicker)\n\n## 克隆主项目\n\n```bash\ngit clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n```\n\n## 使用 pip 安装依赖\n\n其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。\n\n```bash\npip install .\n```\n\n## 选择一：将本地图片制成贴纸包\n\n在项目根目录下创新一个新的目录。\n\n```bash\nmkdir \u003Cpack directory>\n```\n\n将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。\n\n执行命令进行打包\n\n```bash\nsticker-pack \u003Cpack directory> --add-to-index web/packs/\n```\n\n如果想要给目录贴纸包命名，则可以追加`--title \u003Ccustom title>`，否则将直接设置为目录名\n\n## 选择二：从 tg 获取现成的贴纸包\n\n项目内已经为我们准备了 ```sticker-import``` 命令来帮助我们直接从 tg 获取表情包，那我们直接收下\n\n```bash\nsticker-import \u003Cpack_url>\n```\n\n第一次使用时，会要求我们登陆 matrix 和 tg 账号\n\nmatrix 的 `homeserver` 和 `access token` 可以在 PC 端 element 的设置里找到\n\n![element 在 pc 端上而设置界面](https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp)\n\ntg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。\n\n运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。\n\n***\n\n接着我们需要做的事情就是将 `web` 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 `https://matrix-sticker.zhullyb.top` 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，[@朝色](https://blog.zhaose.cyou/) 的 url 也可以直接拿来使用 `https://sticker.zhaose.cyou/web/`\n\n## 添加到 element\n\n这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。\n\n在 element 的 pc 端找到任意一个对话框，输入 `/devtools` 并发送\n\n![如图](https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp)\n\n将会出现如下页面，选择 `Explore account data`\n\n![1660220693791.png](https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp)\n\n找到 `m.widgets`，如果没有，就点击下图标出的按钮\n\n![1660220786171.png](https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp)\n\n在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求\n\n```json\n{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n```\n\n![发送请求](https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp)\n\n重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。\n\n补一张效果图\n\n![效果图](https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp)\n",{"title":5,"description":55},"posts/add-sticker-support-for-element",false,null,"NIZzvbciIfAk1BkxmJ4yYwPuCgmLoHkWwn534h6JTio",[499,504],{"title":500,"path":501,"stem":502,"date":503,"children":-1},"在 Archlinux 下使用 l2tp 协议连接校园网","/2022/09/29/use-l2tp-protocol-to-connect-internet","posts/use-l2tp-protocol-to-connect-internet","2022-09-29 14:30:46",{"title":505,"path":506,"stem":507,"date":508,"children":-1},"nodejs16：是我配不上 openssl 3 咯？","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16","posts/a-fucking-store-about-openssl3-and-nodejs16","2022-08-04 17:31:49",1761699630905]