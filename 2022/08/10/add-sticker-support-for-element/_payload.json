[{"data":1,"prerenderedAt":504},["ShallowReactive",2],{"post-2022-08-10-add-sticker-support-for-element":3,"surround-2022-08-10-add-sticker-support-for-element":492,"randomIndex/2022/08/10/add-sticker-support-for-element/":503},{"id":4,"title":5,"body":6,"date":481,"description":55,"extension":482,"meta":483,"navigation":484,"path":485,"rawbody":486,"seo":487,"stem":488,"sticky":489,"tags":490,"__hash__":491},"posts/posts/add-sticker-support-for-element.md","为 Element 添加自己喜欢的贴纸",{"type":7,"value":8,"toc":473},"minimark",[9,16,20,36,46,49,86,90,93,109,113,116,138,141,144,170,177,181,188,205,208,219,226,229,232,235,255,259,262,269,275,281,287,294,300,303,451,457,460,463,469],[10,11,12],"blockquote",{},[13,14,15],"p",{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[17,18,19],"h2",{"id":19},"需要准备的",[21,22,23,27,30,33],"ul",{},[24,25,26],"li",{},"PC 端 element",[24,28,29],{},"python3.6+ 环境",[24,31,32],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[24,34,35],{},"可能需要能够突破大局域网限制的网络环境",[13,37,38,39],{},"需要用到的项目 ",[40,41,45],"a",{"href":42,"rel":43},"https://github.com/maunium/stickerpicker",[44],"nofollow","maunium/stickerpicker",[17,47,48],{"id":48},"克隆主项目",[50,51,56],"pre",{"className":52,"code":53,"language":54,"meta":55,"style":55},"language-bash shiki shiki-themes one-light one-dark-pro","git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n","bash","",[57,58,59],"code",{"__ignoreMap":55},[60,61,64,68,72,75,79,83],"span",{"class":62,"line":63},"line",1,[60,65,67],{"class":66},"sAdtL","git",[60,69,71],{"class":70},"sDhpE"," clone",[60,73,74],{"class":70}," https://github.com/maunium/stickerpicker.git",[60,76,78],{"class":77},"s5ixo"," && ",[60,80,82],{"class":81},"s_Sar","cd",[60,84,85],{"class":70}," stickerpicker\n",[17,87,89],{"id":88},"使用-pip-安装依赖","使用 pip 安装依赖",[13,91,92],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[50,94,96],{"className":52,"code":95,"language":54,"meta":55,"style":55},"pip install .\n",[57,97,98],{"__ignoreMap":55},[60,99,100,103,106],{"class":62,"line":63},[60,101,102],{"class":66},"pip",[60,104,105],{"class":70}," install",[60,107,108],{"class":70}," .\n",[17,110,112],{"id":111},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[13,114,115],{},"在项目根目录下创新一个新的目录。",[50,117,119],{"className":52,"code":118,"language":54,"meta":55,"style":55},"mkdir \u003Cpack directory>\n",[57,120,121],{"__ignoreMap":55},[60,122,123,126,129,132,135],{"class":62,"line":63},[60,124,125],{"class":66},"mkdir",[60,127,128],{"class":77}," \u003C",[60,130,131],{"class":70},"pack",[60,133,134],{"class":70}," director",[60,136,137],{"class":77},"y>\n",[13,139,140],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[13,142,143],{},"执行命令进行打包",[50,145,147],{"className":52,"code":146,"language":54,"meta":55,"style":55},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[57,148,149],{"__ignoreMap":55},[60,150,151,154,156,158,160,163,167],{"class":62,"line":63},[60,152,153],{"class":66},"sticker-pack",[60,155,128],{"class":77},[60,157,131],{"class":70},[60,159,134],{"class":70},[60,161,162],{"class":77},"y> ",[60,164,166],{"class":165},"sAGMh","--add-to-index",[60,168,169],{"class":70}," web/packs/\n",[13,171,172,173,176],{},"如果想要给目录贴纸包命名，则可以追加",[57,174,175],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[17,178,180],{"id":179},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[13,182,183,184,187],{},"项目内已经为我们准备了 ",[57,185,186],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[50,189,191],{"className":52,"code":190,"language":54,"meta":55,"style":55},"sticker-import \u003Cpack_url>\n",[57,192,193],{"__ignoreMap":55},[60,194,195,197,199,202],{"class":62,"line":63},[60,196,186],{"class":66},[60,198,128],{"class":77},[60,200,201],{"class":70},"pack_ur",[60,203,204],{"class":77},"l>\n",[13,206,207],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[13,209,210,211,214,215,218],{},"matrix 的 ",[57,212,213],{},"homeserver"," 和 ",[57,216,217],{},"access token"," 可以在 PC 端 element 的设置里找到",[13,220,221],{},[222,223],"img",{"alt":224,"src":225},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[13,227,228],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[13,230,231],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[233,234],"hr",{},[13,236,237,238,241,242,245,246,251,252],{},"接着我们需要做的事情就是将 ",[57,239,240],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[57,243,244],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[40,247,250],{"href":248,"rel":249},"https://blog.zhaose.cyou/",[44],"@朝色"," 的 url 也可以直接拿来使用 ",[57,253,254],{},"https://sticker.zhaose.cyou/web/",[17,256,258],{"id":257},"添加到-element","添加到 element",[13,260,261],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[13,263,264,265,268],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[57,266,267],{},"/devtools"," 并发送",[13,270,271],{},[222,272],{"alt":273,"src":274},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[13,276,277,278],{},"将会出现如下页面，选择 ",[57,279,280],{},"Explore account data",[13,282,283],{},[222,284],{"alt":285,"src":286},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[13,288,289,290,293],{},"找到 ",[57,291,292],{},"m.widgets","，如果没有，就点击下图标出的按钮",[13,295,296],{},[222,297],{"alt":298,"src":299},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[13,301,302],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[50,304,308],{"className":305,"code":306,"language":307,"meta":55,"style":55},"language-json shiki shiki-themes one-light one-dark-pro","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[57,309,310,315,325,333,348,361,374,383,389,402,415,428,439,445],{"__ignoreMap":55},[60,311,312],{"class":62,"line":63},[60,313,314],{"class":77},"{\n",[60,316,318,322],{"class":62,"line":317},2,[60,319,321],{"class":320},"sJa8x","    \"stickerpicker\"",[60,323,324],{"class":77},": {\n",[60,326,328,331],{"class":62,"line":327},3,[60,329,330],{"class":320},"        \"content\"",[60,332,324],{"class":77},[60,334,336,339,342,345],{"class":62,"line":335},4,[60,337,338],{"class":320},"            \"type\"",[60,340,341],{"class":77},": ",[60,343,344],{"class":70},"\"m.stickerpicker\"",[60,346,347],{"class":77},",\n",[60,349,351,354,356,359],{"class":62,"line":350},5,[60,352,353],{"class":320},"            \"url\"",[60,355,341],{"class":77},[60,357,358],{"class":70},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[60,360,347],{"class":77},[60,362,364,367,369,372],{"class":62,"line":363},6,[60,365,366],{"class":320},"            \"name\"",[60,368,341],{"class":77},[60,370,371],{"class":70},"\"Stickerpicker\"",[60,373,347],{"class":77},[60,375,377,380],{"class":62,"line":376},7,[60,378,379],{"class":320},"            \"data\"",[60,381,382],{"class":77},": {}\n",[60,384,386],{"class":62,"line":385},8,[60,387,388],{"class":77},"        },\n",[60,390,392,395,397,400],{"class":62,"line":391},9,[60,393,394],{"class":320},"        \"sender\"",[60,396,341],{"class":77},[60,398,399],{"class":70},"\"@you:matrix.server.name\"",[60,401,347],{"class":77},[60,403,405,408,410,413],{"class":62,"line":404},10,[60,406,407],{"class":320},"        \"state_key\"",[60,409,341],{"class":77},[60,411,412],{"class":70},"\"stickerpicker\"",[60,414,347],{"class":77},[60,416,418,421,423,426],{"class":62,"line":417},11,[60,419,420],{"class":320},"        \"type\"",[60,422,341],{"class":77},[60,424,425],{"class":70},"\"m.widget\"",[60,427,347],{"class":77},[60,429,431,434,436],{"class":62,"line":430},12,[60,432,433],{"class":320},"        \"id\"",[60,435,341],{"class":77},[60,437,438],{"class":70},"\"stickerpicker\"\n",[60,440,442],{"class":62,"line":441},13,[60,443,444],{"class":77},"    }\n",[60,446,448],{"class":62,"line":447},14,[60,449,450],{"class":77},"}\n",[13,452,453],{},[222,454],{"alt":455,"src":456},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[13,458,459],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[13,461,462],{},"补一张效果图",[13,464,465],{},[222,466],{"alt":467,"src":468},"效果图","https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[470,471,472],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":55,"searchDepth":317,"depth":317,"links":474},[475,476,477,478,479,480],{"id":19,"depth":317,"text":19},{"id":48,"depth":317,"text":48},{"id":88,"depth":317,"text":89},{"id":111,"depth":317,"text":112},{"id":179,"depth":317,"text":180},{"id":257,"depth":317,"text":258},"2022-08-10 19:51:19","md",{},true,"/2022/08/10/add-sticker-support-for-element","---\ntitle: 为 Element 添加自己喜欢的贴纸\ndate: 2022-08-10 19:51:19\nsticky:\ntags:\n---\n\n\n\n> 在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。\n\n## 需要准备的\n\n- PC 端 element\n- python3.6+ 环境\n- 能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）\n- 可能需要能够突破大局域网限制的网络环境\n\n需要用到的项目 [maunium/stickerpicker](https://github.com/maunium/stickerpicker)\n\n## 克隆主项目\n\n```bash\ngit clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n```\n\n## 使用 pip 安装依赖\n\n其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。\n\n```bash\npip install .\n```\n\n## 选择一：将本地图片制成贴纸包\n\n在项目根目录下创新一个新的目录。\n\n```bash\nmkdir \u003Cpack directory>\n```\n\n将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。\n\n执行命令进行打包\n\n```bash\nsticker-pack \u003Cpack directory> --add-to-index web/packs/\n```\n\n如果想要给目录贴纸包命名，则可以追加`--title \u003Ccustom title>`，否则将直接设置为目录名\n\n## 选择二：从 tg 获取现成的贴纸包\n\n项目内已经为我们准备了 ```sticker-import``` 命令来帮助我们直接从 tg 获取表情包，那我们直接收下\n\n```bash\nsticker-import \u003Cpack_url>\n```\n\n第一次使用时，会要求我们登陆 matrix 和 tg 账号\n\nmatrix 的 `homeserver` 和 `access token` 可以在 PC 端 element 的设置里找到\n\n![element 在 pc 端上而设置界面](https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp)\n\ntg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。\n\n运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。\n\n***\n\n接着我们需要做的事情就是将 `web` 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 `https://matrix-sticker.zhullyb.top` 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，[@朝色](https://blog.zhaose.cyou/) 的 url 也可以直接拿来使用 `https://sticker.zhaose.cyou/web/`\n\n## 添加到 element\n\n这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。\n\n在 element 的 pc 端找到任意一个对话框，输入 `/devtools` 并发送\n\n![如图](https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp)\n\n将会出现如下页面，选择 `Explore account data`\n\n![1660220693791.png](https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp)\n\n找到 `m.widgets`，如果没有，就点击下图标出的按钮\n\n![1660220786171.png](https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp)\n\n在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求\n\n```json\n{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n```\n\n![发送请求](https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp)\n\n重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。\n\n补一张效果图\n\n![效果图](https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp)\n",{"title":5,"description":55},"posts/add-sticker-support-for-element",false,null,"R_w97eaTgy8RjXb2STXooN4z0Q9ccGK73YIcf2ZwWq4",[493,498],{"title":494,"path":495,"stem":496,"date":497,"children":-1},"在 Archlinux 下使用 l2tp 协议连接校园网","/2022/09/29/use-l2tp-protocol-to-connect-internet","posts/use-l2tp-protocol-to-connect-internet","2022-09-29 14:30:46",{"title":499,"path":500,"stem":501,"date":502,"children":-1},"nodejs16：是我配不上 openssl 3 咯？","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16","posts/a-fucking-store-about-openssl3-and-nodejs16","2022-08-04 17:31:49",15,1761738553412]