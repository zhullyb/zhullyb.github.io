[{"data":1,"prerenderedAt":495},["ShallowReactive",2],{"post-2022-08-10-add-sticker-support-for-element-zh":3,"surround-2022-08-10-add-sticker-support-for-element-zh":483,"randomIndex/2022/08/10/add-sticker-support-for-element/":65,"language-switch-/2022/08/10/add-sticker-support-for-element/-en":7},{"title":4,"date":5,"path":6,"tags":7,"body":8,"description":57},"为 Element 添加自己喜欢的贴纸","2022-08-10 19:51:19","/2022/08/10/add-sticker-support-for-element",null,{"type":9,"value":10,"toc":475},"minimark",[11,18,22,38,48,51,88,92,95,111,115,118,140,143,146,172,179,183,190,207,210,221,228,231,234,237,257,261,264,271,277,283,289,296,302,305,453,459,462,465,471],[12,13,14],"blockquote",{},[15,16,17],"p",{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[19,20,21],"h2",{"id":21},"需要准备的",[23,24,25,29,32,35],"ul",{},[26,27,28],"li",{},"PC 端 element",[26,30,31],{},"python3.6+ 环境",[26,33,34],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[26,36,37],{},"可能需要能够突破大局域网限制的网络环境",[15,39,40,41],{},"需要用到的项目 ",[42,43,47],"a",{"href":44,"rel":45},"https://github.com/maunium/stickerpicker",[46],"nofollow","maunium/stickerpicker",[19,49,50],{"id":50},"克隆主项目",[52,53,58],"pre",{"className":54,"code":55,"language":56,"meta":57,"style":57},"language-bash shiki shiki-themes one-light one-dark-pro","git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n","bash","",[59,60,61],"code",{"__ignoreMap":57},[62,63,66,70,74,77,81,85],"span",{"class":64,"line":65},"line",1,[62,67,69],{"class":68},"sAdtL","git",[62,71,73],{"class":72},"sDhpE"," clone",[62,75,76],{"class":72}," https://github.com/maunium/stickerpicker.git",[62,78,80],{"class":79},"s5ixo"," && ",[62,82,84],{"class":83},"s_Sar","cd",[62,86,87],{"class":72}," stickerpicker\n",[19,89,91],{"id":90},"使用-pip-安装依赖","使用 pip 安装依赖",[15,93,94],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[52,96,98],{"className":54,"code":97,"language":56,"meta":57,"style":57},"pip install .\n",[59,99,100],{"__ignoreMap":57},[62,101,102,105,108],{"class":64,"line":65},[62,103,104],{"class":68},"pip",[62,106,107],{"class":72}," install",[62,109,110],{"class":72}," .\n",[19,112,114],{"id":113},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[15,116,117],{},"在项目根目录下创新一个新的目录。",[52,119,121],{"className":54,"code":120,"language":56,"meta":57,"style":57},"mkdir \u003Cpack directory>\n",[59,122,123],{"__ignoreMap":57},[62,124,125,128,131,134,137],{"class":64,"line":65},[62,126,127],{"class":68},"mkdir",[62,129,130],{"class":79}," \u003C",[62,132,133],{"class":72},"pack",[62,135,136],{"class":72}," director",[62,138,139],{"class":79},"y>\n",[15,141,142],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[15,144,145],{},"执行命令进行打包",[52,147,149],{"className":54,"code":148,"language":56,"meta":57,"style":57},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[59,150,151],{"__ignoreMap":57},[62,152,153,156,158,160,162,165,169],{"class":64,"line":65},[62,154,155],{"class":68},"sticker-pack",[62,157,130],{"class":79},[62,159,133],{"class":72},[62,161,136],{"class":72},[62,163,164],{"class":79},"y> ",[62,166,168],{"class":167},"sAGMh","--add-to-index",[62,170,171],{"class":72}," web/packs/\n",[15,173,174,175,178],{},"如果想要给目录贴纸包命名，则可以追加",[59,176,177],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[19,180,182],{"id":181},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[15,184,185,186,189],{},"项目内已经为我们准备了 ",[59,187,188],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[52,191,193],{"className":54,"code":192,"language":56,"meta":57,"style":57},"sticker-import \u003Cpack_url>\n",[59,194,195],{"__ignoreMap":57},[62,196,197,199,201,204],{"class":64,"line":65},[62,198,188],{"class":68},[62,200,130],{"class":79},[62,202,203],{"class":72},"pack_ur",[62,205,206],{"class":79},"l>\n",[15,208,209],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[15,211,212,213,216,217,220],{},"matrix 的 ",[59,214,215],{},"homeserver"," 和 ",[59,218,219],{},"access token"," 可以在 PC 端 element 的设置里找到",[15,222,223],{},[224,225],"img",{"alt":226,"src":227},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[15,229,230],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[15,232,233],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[235,236],"hr",{},[15,238,239,240,243,244,247,248,253,254],{},"接着我们需要做的事情就是将 ",[59,241,242],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[59,245,246],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[42,249,252],{"href":250,"rel":251},"https://blog.zhaose.cyou/",[46],"@朝色"," 的 url 也可以直接拿来使用 ",[59,255,256],{},"https://sticker.zhaose.cyou/web/",[19,258,260],{"id":259},"添加到-element","添加到 element",[15,262,263],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[15,265,266,267,270],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[59,268,269],{},"/devtools"," 并发送",[15,272,273],{},[224,274],{"alt":275,"src":276},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[15,278,279,280],{},"将会出现如下页面，选择 ",[59,281,282],{},"Explore account data",[15,284,285],{},[224,286],{"alt":287,"src":288},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[15,290,291,292,295],{},"找到 ",[59,293,294],{},"m.widgets","，如果没有，就点击下图标出的按钮",[15,297,298],{},[224,299],{"alt":300,"src":301},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[15,303,304],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[52,306,310],{"className":307,"code":308,"language":309,"meta":57,"style":57},"language-json shiki shiki-themes one-light one-dark-pro","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[59,311,312,317,327,335,350,363,376,385,391,404,417,430,441,447],{"__ignoreMap":57},[62,313,314],{"class":64,"line":65},[62,315,316],{"class":79},"{\n",[62,318,320,324],{"class":64,"line":319},2,[62,321,323],{"class":322},"sJa8x","    \"stickerpicker\"",[62,325,326],{"class":79},": {\n",[62,328,330,333],{"class":64,"line":329},3,[62,331,332],{"class":322},"        \"content\"",[62,334,326],{"class":79},[62,336,338,341,344,347],{"class":64,"line":337},4,[62,339,340],{"class":322},"            \"type\"",[62,342,343],{"class":79},": ",[62,345,346],{"class":72},"\"m.stickerpicker\"",[62,348,349],{"class":79},",\n",[62,351,353,356,358,361],{"class":64,"line":352},5,[62,354,355],{"class":322},"            \"url\"",[62,357,343],{"class":79},[62,359,360],{"class":72},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[62,362,349],{"class":79},[62,364,366,369,371,374],{"class":64,"line":365},6,[62,367,368],{"class":322},"            \"name\"",[62,370,343],{"class":79},[62,372,373],{"class":72},"\"Stickerpicker\"",[62,375,349],{"class":79},[62,377,379,382],{"class":64,"line":378},7,[62,380,381],{"class":322},"            \"data\"",[62,383,384],{"class":79},": {}\n",[62,386,388],{"class":64,"line":387},8,[62,389,390],{"class":79},"        },\n",[62,392,394,397,399,402],{"class":64,"line":393},9,[62,395,396],{"class":322},"        \"sender\"",[62,398,343],{"class":79},[62,400,401],{"class":72},"\"@you:matrix.server.name\"",[62,403,349],{"class":79},[62,405,407,410,412,415],{"class":64,"line":406},10,[62,408,409],{"class":322},"        \"state_key\"",[62,411,343],{"class":79},[62,413,414],{"class":72},"\"stickerpicker\"",[62,416,349],{"class":79},[62,418,420,423,425,428],{"class":64,"line":419},11,[62,421,422],{"class":322},"        \"type\"",[62,424,343],{"class":79},[62,426,427],{"class":72},"\"m.widget\"",[62,429,349],{"class":79},[62,431,433,436,438],{"class":64,"line":432},12,[62,434,435],{"class":322},"        \"id\"",[62,437,343],{"class":79},[62,439,440],{"class":72},"\"stickerpicker\"\n",[62,442,444],{"class":64,"line":443},13,[62,445,446],{"class":79},"    }\n",[62,448,450],{"class":64,"line":449},14,[62,451,452],{"class":79},"}\n",[15,454,455],{},[224,456],{"alt":457,"src":458},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[15,460,461],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[15,463,464],{},"补一张效果图",[15,466,467],{},[224,468],{"alt":469,"src":470},"效果图","https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[472,473,474],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":57,"searchDepth":319,"depth":319,"links":476},[477,478,479,480,481,482],{"id":21,"depth":319,"text":21},{"id":50,"depth":319,"text":50},{"id":90,"depth":319,"text":91},{"id":113,"depth":319,"text":114},{"id":181,"depth":319,"text":182},{"id":259,"depth":319,"text":260},[484,490],{"title":485,"path":486,"stem":487,"date":488,"lang":489,"children":-1},"在 Archlinux 下使用 l2tp 协议连接校园网","/2022/09/29/use-l2tp-protocol-to-connect-internet","posts/zh/use-l2tp-protocol-to-connect-internet","2022-09-29 14:30:46","zh-CN",{"title":491,"path":492,"stem":493,"date":494,"lang":489,"children":-1},"nodejs16：是我配不上 openssl 3 咯？","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16","posts/zh/a-fucking-store-about-openssl3-and-nodejs16","2022-08-04 17:31:49",1771555483462]