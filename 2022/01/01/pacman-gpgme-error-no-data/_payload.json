[{"data":1,"prerenderedAt":141},["ShallowReactive",2],{"post-2022-01-01-pacman-gpgme-error-no-data":3,"has-en-2022-01-01-pacman-gpgme-error-no-data":125,"surround-2022-01-01-pacman-gpgme-error-no-data":129,"randomIndex/2022/01/01/pacman-gpgme-error-no-data/":140},{"id":4,"title":5,"body":6,"date":116,"description":27,"extension":117,"lang":118,"meta":119,"navigation":120,"path":121,"rawbody":122,"seo":123,"stem":124,"sticky":125,"tags":126,"__hash__":128},"posts/posts/pacman-gpgme-error-no-data.md","pacman更新时遇到「GPGME 错误：无数据」",{"type":7,"value":8,"toc":110},"minimark",[9,13,17,28,31,37,40,46,49,52,63,75,82,85,91,104],[10,11,12],"h2",{"id":12},"情景再现",[14,15,16],"p",{},"当初是使用 pacman 更新时遇上了「GPGME 错误：无数据」的问题，我尝试复现了下，大概是下面这样的情况。",[18,19,24],"pre",{"className":20,"code":22,"language":23},[21],"language-text","[zhullyb@Archlinux ~]$ sudo pacman -Syu\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n:: 正在同步软件包数据库...\n core                                137.6 KiB   598 KiB/s 00:00 [------------------------------------] 100%\n extra                              1566.0 KiB  6.12 MiB/s 00:00 [------------------------------------] 100%\n community                             6.0 MiB  20.6 MiB/s 00:00 [------------------------------------] 100%\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：未能同步所有数据库（无效或已损坏的数据库 (PGP 签名)）\n","text",[25,26,22],"code",{"__ignoreMap":27},"",[14,29,30],{},"英文版的提示应该是长成下面这个样子",[18,32,35],{"className":33,"code":34,"language":23},[21],"[zhullyb@Archlinux ~]$ sudo pacman -Syu\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: GPGME error: No data\n:: Synchronizing package databases...\n core                                137.6 KiB   574 KiB/s 00:00 [------------------------------------] 100%\n extra                              1566.0 KiB  5.66 MiB/s 00:00 [------------------------------------] 100%\n community                             6.0 MiB  18.1 MiB/s 00:00 [------------------------------------] 100%\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: failed to synchronize all databases (invalid or corrupted database (PGP signature))\n",[25,36,34],{"__ignoreMap":27},[10,38,39],{"id":39},"解决方案",[18,41,44],{"className":42,"code":43,"language":23},[21],"sudo rm /var/lib/pacman/sync/*.sig\n",[25,45,43],{"__ignoreMap":27},[14,47,48],{},"很简单，就这一条命令就够了。",[10,50,51],{"id":51},"问题原因",[14,53,54,55,58,59,62],{},"pacman在更新数据库文件时也会尝试下载",[25,56,57],{},"$repo.db.sig","，这里的",[25,60,61],{},"$repo","可以是 core、extra、community、archlinuxcn 等仓库名。",[14,64,65,66,70,71,74],{},"但是无论是官方源还是 archlinuxcn 源，",[67,68,69],"strong",{},"大多数源的数据库文件","都不会被签名，也就",[67,72,73],{},"不会存在 .db.sig 文件","。",[14,76,77,78,81],{},"pacman 尝试下载时这些数据库文件的签名文件时，镜像站就会返回 ",[67,79,80],{},"404 的 http 状态码","告诉pacman: “你个傻叉，神他妈没有这个文件！”",[14,83,84],{},"pacman 挨了一顿骂，也就善罢甘休，没有再动这个念头，所以我们每次更新也都相安无事。",[14,86,87,88,74],{},"而出现这种错误的情况大多是发生在 校园网、酒店免费 WIFI 这种",[67,89,90],{},"需要登陆以后才能上网的网络环境",[14,92,93,94,97,98,100,101,103],{},"因为 pacman 尝试下载 ",[25,95,96],{},".db.sig"," 文件时被登陆网页劫持了（这点你们应该深有感受，如果你在这种网络环境下没有登陆，你无论访问什么网页都会被重定向到登录界面，http 的状态码此时是200，不是404）。从没见过 ",[25,99,96],{},"的 pacman 此时两眼放光，由于没有挨骂，他就迅速地把登录界面当成是",[25,102,96],{},"下载下来了。",[14,105,106,107,109],{},"下载下来以后，pacman 激动地摆弄起 ",[25,108,96],{},"，甚至发现里面没有自己期待已久的 GPG签名数据并开始报错时仍然不愿意撒手，因此此时无论再怎么同步源码、再怎么 Syyu 也不会有效果，必须人工干预。",{"title":27,"searchDepth":111,"depth":111,"links":112},2,[113,114,115],{"id":12,"depth":111,"text":12},{"id":39,"depth":111,"text":39},{"id":51,"depth":111,"text":51},"2022-01-01 23:42:09","md","zh-CN",{},true,"/2022/01/01/pacman-gpgme-error-no-data","---\ntitle: pacman更新时遇到「GPGME 错误：无数据」\ndate: 2022-01-01 23:42:09\nsticky:\ntags:\n- Archlinux\n---\n\n## 情景再现\n\n当初是使用 pacman 更新时遇上了「GPGME 错误：无数据」的问题，我尝试复现了下，大概是下面这样的情况。\n\n```\n[zhullyb@Archlinux ~]$ sudo pacman -Syu\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n:: 正在同步软件包数据库...\n core                                137.6 KiB   598 KiB/s 00:00 [------------------------------------] 100%\n extra                              1566.0 KiB  6.12 MiB/s 00:00 [------------------------------------] 100%\n community                             6.0 MiB  20.6 MiB/s 00:00 [------------------------------------] 100%\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：GPGME 错误：无数据\n错误：未能同步所有数据库（无效或已损坏的数据库 (PGP 签名)）\n```\n\n英文版的提示应该是长成下面这个样子\n\n```\n[zhullyb@Archlinux ~]$ sudo pacman -Syu\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: GPGME error: No data\n:: Synchronizing package databases...\n core                                137.6 KiB   574 KiB/s 00:00 [------------------------------------] 100%\n extra                              1566.0 KiB  5.66 MiB/s 00:00 [------------------------------------] 100%\n community                             6.0 MiB  18.1 MiB/s 00:00 [------------------------------------] 100%\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: GPGME error: No data\nerror: failed to synchronize all databases (invalid or corrupted database (PGP signature))\n```\n\n## 解决方案\n\n```\nsudo rm /var/lib/pacman/sync/*.sig\n```\n\n很简单，就这一条命令就够了。\n\n## 问题原因\n\npacman在更新数据库文件时也会尝试下载`$repo.db.sig`，这里的`$repo`可以是 core、extra、community、archlinuxcn 等仓库名。\n\n但是无论是官方源还是 archlinuxcn 源，**大多数源的数据库文件**都不会被签名，也就**不会存在 .db.sig 文件**。\n\npacman 尝试下载时这些数据库文件的签名文件时，镜像站就会返回 **404 的 http 状态码**告诉pacman: “你个傻叉，神他妈没有这个文件！”\n\npacman 挨了一顿骂，也就善罢甘休，没有再动这个念头，所以我们每次更新也都相安无事。\n\n而出现这种错误的情况大多是发生在 校园网、酒店免费 WIFI 这种**需要登陆以后才能上网的网络环境**。\n\n因为 pacman 尝试下载 `.db.sig` 文件时被登陆网页劫持了（这点你们应该深有感受，如果你在这种网络环境下没有登陆，你无论访问什么网页都会被重定向到登录界面，http 的状态码此时是200，不是404）。从没见过 `.db.sig`的 pacman 此时两眼放光，由于没有挨骂，他就迅速地把登录界面当成是`.db.sig`下载下来了。\n\n下载下来以后，pacman 激动地摆弄起 `.db.sig`，甚至发现里面没有自己期待已久的 GPG签名数据并开始报错时仍然不愿意撒手，因此此时无论再怎么同步源码、再怎么 Syyu 也不会有效果，必须人工干预。\n",{"title":5,"description":27},"posts/pacman-gpgme-error-no-data",false,[127],"Archlinux","mckixI-WfM2LenYEHZHg4Nha4k-oBVGkEdfQtXafvT4",[130,135],{"title":131,"path":132,"stem":133,"date":134,"children":-1},"在Fedora搭建jekyll环境——dnf module","/2022/01/12/dnf-module-in-setting-up-the-jekyll","posts/dnf-module-in-setting-up-the-jekyll","2022-01-12 22:11:42",{"title":136,"path":137,"stem":138,"date":139,"children":-1},"Cutefish的前世今生","/2021/12/12/the-history-of-cutefish","posts/the-history-of-cutefish","2021-12-12 00:10:34",10,1762960745183]