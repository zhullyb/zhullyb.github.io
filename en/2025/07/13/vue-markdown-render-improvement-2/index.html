<!DOCTYPE html><html  lang="en-US"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Vue Markdown Rendering Optimization in Practice (Part 2): Farewell to DOM Manipulation, Embrace AST and Functional Rendering | 竹林里有冰的博客</title><link rel="preconnect" href="https://static.031130.xyz" crossorigin><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"><style>[data-v-11c89a0f] .markdown-body{font-size:inherit}[data-v-11c89a0f] .markdown-body h2,[data-v-11c89a0f] .markdown-body h3,[data-v-11c89a0f] .markdown-body h4,[data-v-11c89a0f] .markdown-body h5,[data-v-11c89a0f] .markdown-body h6{scroll-margin-top:78px}[data-v-11c89a0f] .markdown-body h2>a,[data-v-11c89a0f] .markdown-body h3>a,[data-v-11c89a0f] .markdown-body h4>a,[data-v-11c89a0f] .markdown-body h5>a,[data-v-11c89a0f] .markdown-body h6>a{color:unset}@media(prefers-color-scheme:dark){[data-v-11c89a0f] .markdown-body{--bgColor-default:#252d38;--bgColor-muted:#181c27}[data-v-11c89a0f] .markdown-body .shiki,[data-v-11c89a0f] .markdown-body .shiki span{color:var(--shiki-dark)!important}}aside[data-v-11c89a0f]{position:sticky;top:78px}[data-v-11c89a0f] #waline{margin-top:3rem}.article-end-hr[data-v-11c89a0f]{border:none;border-top:1px solid #e1e4e8;margin:1rem 0}@media(prefers-color-scheme:dark){.article-end-hr[data-v-11c89a0f]{border-color:#444c56}}.tags[data-v-11c89a0f]{margin:1rem 0}.tags[data-v-11c89a0f] *{vertical-align:middle}.tags svg[data-v-11c89a0f]{font-size:.9em}.tags a[data-v-11c89a0f]{margin-left:.2rem}.tags a[data-v-11c89a0f]:hover{color:#007bff}</style><style>.content-wrapper[data-v-3c9f8a67]{margin-bottom:40px;margin-top:40px}@media(min-width:769px){.content-wrapper[data-v-3c9f8a67]{display:flex;justify-content:space-around}.content-wrapper .side[data-v-3c9f8a67]{width:20%}}@media(max-width:768px){.content-wrapper[data-v-3c9f8a67]{margin:30px}}main[data-v-3c9f8a67]{min-height:calc(40vh - 120px);width:50%}@media(max-width:1024px){main[data-v-3c9f8a67]{width:75%}}@media(max-width:768px){main[data-v-3c9f8a67]{width:unset}}</style><style>header[data-v-bf9b66e4]{align-items:center;box-shadow:0 2px 4px #0000001a;display:flex;flex-direction:column;height:62px;justify-content:center;padding-bottom:16px;padding-top:20px;position:fixed;top:0;transition:background-color .3s ease,height .3s ease,padding-top .3s ease,backdrop-filter .3s ease;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%;z-index:2}header.scrolled[data-v-bf9b66e4]{height:58px;padding-bottom:16px;padding-top:16px}header.scrolled[data-v-bf9b66e4],header.show-mobile-menu[data-v-bf9b66e4]{-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#3c4658b3}header.show-mobile-menu[data-v-bf9b66e4]{height:-moz-fit-content;height:fit-content}.header-container[data-v-bf9b66e4]{color:#fff;min-width:70%}@media(max-width:1024px){.header-container[data-v-bf9b66e4]{min-width:75%;padding-left:16px;padding-right:16px}}@media(max-width:768px){.header-container[data-v-bf9b66e4]{min-width:100%}}.header-container .header-title[data-v-bf9b66e4]{font-weight:700;text-shadow:0 0 10px rgba(0,0,0,.3)}.header[data-v-bf9b66e4]{justify-content:space-between}.header[data-v-bf9b66e4],.header-right[data-v-bf9b66e4]{align-items:center;display:flex}.header-right[data-v-bf9b66e4]{gap:16px}.mobile-menu-dropdown[data-v-bf9b66e4]{border-radius:8px;display:flex;flex-direction:column;padding:8px 0;width:100%}.mobile-menu-dropdown a[data-v-bf9b66e4]{font-size:18px;font-weight:500;padding:12px 24px;text-align:center}.mobile-menu-dropdown a[data-v-bf9b66e4],a[data-v-bf9b66e4]{color:#fff;text-decoration:none}.lang-switch[data-v-bf9b66e4]{align-items:center;background:#ffffff1a;border:1px solid hsla(0,0%,100%,.3);border-radius:999px;color:#fff;cursor:pointer;display:flex;font-size:14px;justify-content:center;padding:6px 12px;transition:background .2s ease,border-color .2s ease}.lang-switch[data-v-bf9b66e4]:hover{background:#fff3;border-color:#fff9}.search-trigger[data-v-bf9b66e4]{align-items:center;background:#ffffff1a;border:1px solid hsla(0,0%,100%,.3);border-radius:999px;color:#fff;cursor:pointer;display:flex;font-size:14px;gap:6px;padding:6px 12px;transition:background .2s ease,border-color .2s ease}.search-trigger[data-v-bf9b66e4]:hover{background:#fff3;border-color:#fff9}.search-trigger span[aria-hidden=true][data-v-bf9b66e4]{font-size:16px;line-height:1}@media(max-width:768px){.pc[data-v-bf9b66e4],.search-trigger .search-trigger__label[data-v-bf9b66e4]{display:none}}</style><style>.post-navigation[data-v-a35c130b]{display:flex;flex-wrap:wrap;gap:1rem}.nav-button[data-v-a35c130b]{align-items:center;border:1px solid #e1e4e8;color:#24292e;cursor:pointer;display:flex;flex:0 1 calc(50% - .5rem);gap:1rem;max-width:calc(50% - .5rem);min-width:280px;padding:1.25rem 1.5rem;text-decoration:none;transition:border-color .2s ease}@media(prefers-color-scheme:dark){.nav-button[data-v-a35c130b]{border:1px solid #444c5a;color:#c9d1d9}}.nav-button[data-v-a35c130b]:hover{border-color:#007bff}.nav-button:hover .nav-arrow[data-v-a35c130b],.nav-button:hover .nav-label[data-v-a35c130b],.nav-button:hover .nav-title[data-v-a35c130b]{color:#007bff}.nav-button.prev[data-v-a35c130b]{margin-right:auto}.nav-button.prev .nav-content[data-v-a35c130b]{text-align:left}.nav-button.next[data-v-a35c130b]{flex-direction:row-reverse;margin-left:auto}.nav-button.next .nav-content[data-v-a35c130b]{text-align:right}.nav-arrow[data-v-a35c130b]{color:#6a737d;flex-shrink:0;font-weight:600;line-height:1}.nav-content[data-v-a35c130b]{display:flex;flex:1;flex-direction:column;gap:.5rem;min-width:0}.nav-label[data-v-a35c130b]{color:#6a737d;font-size:.875rem;font-weight:500}.nav-title[data-v-a35c130b]{display:-webkit-box;font-size:1rem;font-weight:600;-webkit-line-clamp:2;line-clamp:2;overflow:hidden;text-overflow:ellipsis;transition:color .2s ease;-webkit-box-orient:vertical;color:#24292e;line-height:1.4}@media(prefers-color-scheme:dark){.nav-title[data-v-a35c130b]{color:#c9d1d9}}@media(max-width:768px){.post-navigation[data-v-a35c130b]{flex-direction:column;gap:.75rem}.nav-button[data-v-a35c130b]{min-width:100%}}</style><style>#waline{--waline-theme-color:#3f72af;--waline-active-color:#173f70}#waline .wl-panel{border-radius:0;margin:0}@media(prefers-color-scheme:dark){#waline .wl-panel{border-color:#444c5a}}#waline .wl-btn{border-radius:0}</style><style>.toc[data-v-c35f8c0a]{background:#fafafa;border:1px solid #e5e5e5;max-height:calc(100vh - 120px);overflow-y:auto;padding:1.25rem}@media(prefers-color-scheme:dark){.toc[data-v-c35f8c0a]{background:#181c27;border:1px solid #444c5a}}@media(max-width:768px){.toc[data-v-c35f8c0a]{display:none}}.toc-title[data-v-c35f8c0a]{border-bottom:1px solid #e5e5e5;color:#333;font-size:1rem;font-weight:600;margin-bottom:1rem;padding-bottom:.5rem}@media(prefers-color-scheme:dark){.toc-title[data-v-c35f8c0a]{border-bottom:1px solid #444c5a;color:#fff}}.toc-list[data-v-c35f8c0a]{list-style:none;margin:0;padding:0}.toc-item[data-v-c35f8c0a]{line-height:1.5;margin:.3rem 0;max-height:100px;opacity:1;overflow:hidden;transition:max-height .25s ease,opacity .25s ease,margin .25s ease}.toc-item.collapsed[data-v-c35f8c0a]{margin:0;max-height:0;opacity:0}.toc-item a[data-v-c35f8c0a]{color:#666;display:block;font-size:.875rem;padding:.35rem .5rem;text-decoration:none;transition:color .2s,background-color .2s}@media(prefers-color-scheme:dark){.toc-item a[data-v-c35f8c0a]{color:#ccc}}.toc-item a[data-v-c35f8c0a]:hover{background-color:#3b82f614;color:#007bff}.toc-item.active a[data-v-c35f8c0a]{background-color:#3b82f61f;color:#007bff;font-weight:500}.toc-item.toc-level-1[data-v-c35f8c0a]{padding-left:0}.toc-item.toc-level-1 a[data-v-c35f8c0a]{font-weight:500}.toc-item.toc-level-2[data-v-c35f8c0a]{padding-left:.75rem}.toc-item.toc-level-3[data-v-c35f8c0a]{padding-left:1.5rem}.toc-item.toc-level-3 a[data-v-c35f8c0a]{font-size:.85rem}.toc-item.toc-level-4[data-v-c35f8c0a]{padding-left:2.25rem}.toc-item.toc-level-4 a[data-v-c35f8c0a]{font-size:.825rem}.toc-item.toc-level-5[data-v-c35f8c0a]{padding-left:3rem}.toc-item.toc-level-5 a[data-v-c35f8c0a]{font-size:.8rem}.toc-item.toc-level-6[data-v-c35f8c0a]{padding-left:3.75rem}.toc-item.toc-level-6 a[data-v-c35f8c0a]{font-size:.775rem}.toc[data-v-c35f8c0a]::-webkit-scrollbar{width:5px}.toc[data-v-c35f8c0a]::-webkit-scrollbar-track{background:transparent}.toc[data-v-c35f8c0a]::-webkit-scrollbar-thumb{background:#d1d5db}.toc[data-v-c35f8c0a]::-webkit-scrollbar-thumb:hover{background:#9ca3af}</style><style>footer[data-v-71f6d0ea]{color:#fff;justify-content:center;position:relative;width:100%}.footer-content[data-v-71f6d0ea],footer[data-v-71f6d0ea]{align-items:center;display:flex}.footer-content[data-v-71f6d0ea]{flex-direction:column;gap:12px;padding:20px;z-index:1}.footer-mask[data-v-71f6d0ea]{background:linear-gradient(180deg,#0000004d,#00000080);inset:0;position:absolute}@media(prefers-color-scheme:dark){.footer-mask[data-v-71f6d0ea]{background:linear-gradient(180deg,#0009,#000c)}}</style><style>.prose-heading[data-v-a22a06c0]{position:relative}.prose-heading:hover .heading-anchor[data-v-a22a06c0]{opacity:1}.heading-anchor[data-v-a22a06c0]{color:#3b82f6;font-weight:400;margin-left:.5rem;opacity:0;text-decoration:none;transition:opacity .2s,color .2s}.heading-anchor[data-v-a22a06c0]:hover{color:#007bff}.anchor-icon[data-v-a22a06c0]{display:inline-block}.prose-h2[data-v-a22a06c0]{margin:1.75rem 0 .875rem}</style><style>.prose-heading[data-v-894c4550]{position:relative}.prose-heading:hover .heading-anchor[data-v-894c4550]{opacity:1}.heading-anchor[data-v-894c4550]{color:#3b82f6;font-weight:400;margin-left:.5rem;opacity:0;text-decoration:none;transition:opacity .2s,color .2s}.heading-anchor[data-v-894c4550]:hover{color:#007bff}.anchor-icon[data-v-894c4550]{display:inline-block}.prose-h3[data-v-894c4550]{margin:1.5rem 0 .75rem}</style><style>pre[data-v-a9c19cc1]{font-size:14px}</style><style>@media(max-width:768px){.pc-nav[data-v-c5a90b55]{display:none}}.mobile-nav[data-v-c5a90b55]{cursor:pointer;display:none}@media(max-width:768px){.mobile-nav[data-v-c5a90b55]{align-items:center;display:flex;justify-content:center}}.mobile-nav .container[data-v-c5a90b55]{align-items:center;display:flex;flex-direction:column;height:20px;justify-content:center;margin:0 auto;width:25px}.mobile-nav-item[data-v-c5a90b55]{background:#fff;border-radius:2px;flex-shrink:0;height:2px;margin:2.5px 0;width:100%}a[data-v-c5a90b55]{color:#fff;margin-left:16px;margin-right:16px;text-decoration:none}</style><style>.banner[data-v-a96b3d82]{height:60vh;width:100%}.mask[data-v-a96b3d82]{align-items:center;background:#0000001a;display:flex;height:100%;justify-content:center;width:100%}@media(prefers-color-scheme:dark){.mask[data-v-a96b3d82]{background:#00000080}}.title-container[data-v-a96b3d82]{align-items:center;color:#fff;display:flex;height:100%;justify-content:center;margin:auto;width:50%}@media(max-width:768px){.title-container[data-v-a96b3d82]{width:80%}}.title[data-v-a96b3d82]{color:#fff;margin:auto auto auto 0;padding-top:58px;text-shadow:0 0 5px rgba(0,0,0,.7)}.title h1[data-v-a96b3d82]{font-size:32px;font-weight:700;margin:0}.title p[data-v-a96b3d82]{font-size:16px;font-weight:300;margin:8px 0}@media(max-width:768px){.title[data-v-a96b3d82]{margin:auto;text-align:center}}</style><style>.search-overlay-enter-active[data-v-63592d71],.search-overlay-leave-active[data-v-63592d71]{transition:opacity .2s ease}.search-overlay-enter-from[data-v-63592d71],.search-overlay-leave-to[data-v-63592d71]{opacity:0}.search-overlay[data-v-63592d71]{align-items:flex-start;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);background:#00000059;display:flex;justify-content:center;inset:0;padding:120px 16px 40px;position:fixed;z-index:2000}.search-overlay__panel[data-v-63592d71]{background:#fffffff2;box-shadow:0 18px 50px #00000040;display:flex;flex-direction:column;max-height:calc(100vh - 160px);overflow:hidden;width:min(720px,100%)}.search-overlay__header[data-v-63592d71]{align-items:center;border-bottom:1px solid rgba(0,0,0,.05);display:flex;gap:12px;padding:16px 20px 16px 16px}.search-overlay__input[data-v-63592d71]{background:#ffffffd9;border:1px solid rgba(0,0,0,.12);flex:1;font-size:16px;padding:12px 16px;transition:border-color .2s ease}.search-overlay__input[data-v-63592d71]:focus{border-color:#007bff;outline:none}.search-overlay__close[data-v-63592d71]{background:transparent;border:none;border-radius:50%;color:#0000008c;cursor:pointer;font-size:24px;height:32px;line-height:24px;width:32px}.search-overlay__close[data-v-63592d71]:hover{color:#000c}.search-overlay__body[data-v-63592d71]{overflow-y:auto;padding:8px 0 20px}.search-overlay__state[data-v-63592d71]{color:#00000094;margin:20px;text-align:center}.search-overlay__count[data-v-63592d71]{color:#000000b3;font-weight:600;margin:12px 24px 0}.search-overlay__list[data-v-63592d71]{display:flex;flex-direction:column;gap:12px;list-style:none;margin:16px 0 0;padding:0 8px 8px}.search-overlay__item[data-v-63592d71]{background:#ffffffe6;border-radius:12px;box-shadow:0 8px 18px #00000014;transition:transform .2s ease}.search-overlay__item[data-v-63592d71]:hover{transform:translateY(-2px)}.search-overlay__link[data-v-63592d71]{color:inherit;display:block;padding:16px 20px;text-decoration:none}.search-overlay__item-title[data-v-63592d71]{color:#007bff;font-size:18px;font-weight:700;margin:0}.search-overlay__item-meta[data-v-63592d71]{color:#0009;font-size:13px;margin:8px 0 0}.search-overlay__item-meta span[data-v-63592d71]{color:#0000008c}.search-overlay__item-snippet[data-v-63592d71]{color:#000c;font-size:14px;line-height:1.6;margin:12px 0 0}@media(max-width:768px){.search-overlay[data-v-63592d71]{padding:80px 12px 20px}.search-overlay__panel[data-v-63592d71]{max-height:calc(100vh - 120px)}}</style><link rel="stylesheet" href="/_nuxt/entry.0KQ4aIgo.css" crossorigin><link rel="stylesheet" href="/_nuxt/DefaultLayout.BA7Bwg4r.css" crossorigin><link rel="preload" as="fetch" crossorigin="anonymous" href="/en/2025/07/13/vue-markdown-render-improvement-2/_payload.json?8d0bcaca-2955-4636-a191-89d0572e86fa"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/IczjO-1h.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DBrZT7qh.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/WNgm348u.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DYnd_5Ma.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BD33eLel.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DhMy4BPa.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B7x2W5cJ.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DJqhqlZj.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CK1FyAUb.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BJ2rSuA5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/D-GaJKpu.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dkr3xXqY.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/x7T-s0N2.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/LCBnvAPw.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DIw5Q53i.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CY3BLQ13.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/8d0bcaca-2955-4636-a191-89d0572e86fa.json"><script src="/js/u.js" defer data-website-id="5346b89b-f4bf-4593-971d-1f41a1118bc1"></script><link rel="prefetch" as="style" href="https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"><link rel="alternate" type="application/rss+xml" title="竹林里有冰的博客 RSS Feed (Chinese)" href="https://zhul.in/rss.xml"><link rel="alternate" type="application/atom+xml" title="竹林里有冰的博客 Atom Feed (English)" href="https://zhul.in/en/rss.xml"><meta name="description" content><meta property="og:type" content="website"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="keywords" content="Vue.js,Markdown,AST,JavaScript,Web,unified"><script type="module" src="/_nuxt/IczjO-1h.js" crossorigin></script><meta name="twitter:card" content="summary_large_image"><meta property="og:title" data-infer="" content="Vue Markdown Rendering Optimization in Practice (Part 2): Farewell to DOM Manipulation, Embrace AST and Functional Rendering | 竹林里有冰的博客"><meta property="og:description" data-infer="" content><link rel="canonical" href="https://zhul.in/en/2025/07/13/vue-markdown-render-improvement-2/"><meta property="og:url" content="https://zhul.in/en/2025/07/13/vue-markdown-render-improvement-2/"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="竹林里有冰的博客"></head><body><!--teleport start anchor--><!----><!--teleport anchor--><div id="__nuxt"><!--[--><div></div><div data-v-11c89a0f data-v-3c9f8a67><!--[--><header class="" data-v-bf9b66e4><div class="header-container" data-v-bf9b66e4><div class="header" data-v-bf9b66e4><a href="/en/" class="header-title" data-v-bf9b66e4>Zhullyb&#39;s Blog</a><div class="header-right" data-v-bf9b66e4><nav data-v-bf9b66e4 data-v-c5a90b55><div class="pc-nav" data-v-c5a90b55><!--[--><a href="/en/" class="" data-v-c5a90b55>Home</a><a href="/en/archives/" class="" data-v-c5a90b55>Archives</a><a href="/en/tags/" class="" data-v-c5a90b55>Tags</a><a href="/en/links/" class="" data-v-c5a90b55>Links</a><a href="/en/about/" class="" data-v-c5a90b55>About</a><!--]--></div><div class="mobile-nav" data-v-c5a90b55><div class="container" data-v-c5a90b55><!--[--><div class="mobile-nav-item" data-v-c5a90b55></div><div class="mobile-nav-item" data-v-c5a90b55></div><div class="mobile-nav-item" data-v-c5a90b55></div><!--]--></div></div></nav><a href="/2025/07/13/vue-markdown-render-improvement-2/" class="lang-switch" aria-label="Switch Language" data-v-bf9b66e4><span class="lang-switch__label" data-v-bf9b66e4>中</span></a><button type="button" class="search-trigger pc" aria-label="Search" data-v-bf9b66e4><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-bf9b66e4><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.47 6.47 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"></path></svg><span class="search-trigger__label" data-v-bf9b66e4>Search</span></button></div></div></div><!----></header><div class="banner" style="background-repeat:no-repeat;background-position:center center;background-size:cover;background-image:url(&quot;data:image/svg+xml,%3csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; version=&#39;1.1&#39; xmlns:xlink=&#39;http://www.w3.org/1999/xlink&#39; xmlns:svgjs=&#39;http://svgjs.dev/svgjs&#39; width=&#39;1440&#39; height=&#39;560&#39; preserveAspectRatio=&#39;none&#39; viewBox=&#39;0 0 1440 560&#39;%3e%3cg clip-path=&#39;url(%26quot%3b%23SvgjsClipPath1000%26quot%3b)&#39; fill=&#39;none&#39;%3e%3crect width=&#39;1440&#39; height=&#39;560&#39; x=&#39;0&#39; y=&#39;0&#39; fill=&#39;%230e2a47&#39;%3e%3c/rect%3e%3cpath d=&#39;M1036.18 140.35C1056.41 141.57 1076.7 134.68 1091.22 120.54 1105.92 106.22 1115.17 85.91 1113.03 65.5 1111.04 46.53 1093.97 34.67 1080.78 20.9 1067.1 6.63 1055.91-13.43 1036.18-14.7 1015.89-16.01 999.69 0.26 985.43 14.75 971.33 29.08 956.87 45.39 957.27 65.5 957.67 85.37 973 100.59 987.42 114.26 1001.32 127.45 1017.05 139.19 1036.18 140.35&#39; fill=&#39;%23488fdb&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M1042.18 134.35C1062.41 135.57 1082.7 128.68 1097.22 114.54 1111.92 100.22 1121.17 79.91 1119.03 59.5 1117.04 40.53 1099.97 28.67 1086.78 14.9 1073.1 0.63 1061.91-19.43 1042.18-20.7 1021.89-22.01 1005.69-5.74 991.43 8.75 977.33 23.08 962.87 39.39 963.27 59.5 963.67 79.37 979 94.59 993.42 108.26 1007.32 121.45 1023.05 133.19 1042.18 134.35&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%232164aa&#39;%3e%3c/path%3e%3cpath d=&#39;M1329.38 128.11C1347.9 128.29 1364.02 117.84 1377.77 105.44 1392.47 92.18 1408.11 76.85 1408.18 57.05 1408.25 37.21 1392.17 22.31 1378.11 8.32 1364.1-5.63 1349.15-21.69 1329.38-21.37 1309.77-21.05 1296.2-3.86 1282.23 9.9 1268.09 23.82 1249.8 37.21 1249.73 57.05 1249.66 76.92 1267.08 91.29 1281.91 104.52 1295.62 116.75 1311.01 127.93 1329.38 128.11&#39; fill=&#39;%23488fdb&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M1312.38 112.11C1330.9 112.29 1347.02 101.84 1360.77 89.44 1375.47 76.18 1391.11 60.85 1391.18 41.05 1391.25 21.21 1375.17 6.31 1361.11-7.68 1347.1-21.63 1332.15-37.69 1312.38-37.37 1292.77-37.05 1279.2-19.86 1265.23-6.1 1251.09 7.82 1232.8 21.21 1232.73 41.05 1232.66 60.92 1250.08 75.29 1264.91 88.52 1278.62 100.75 1294.01 111.93 1312.38 112.11&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%232164aa&#39;%3e%3c/path%3e%3cpath d=&#39;M741.74 353.24C757.66 353.74 775.45 353.66 786.31 342.01 796.99 330.55 795.23 313.03 793.75 297.44 792.45 283.69 787.08 271.48 778.6 260.58 768.49 247.6 758.11 232.22 741.74 230.65 724.54 229 708.21 239.56 697.03 252.73 686.65 264.96 684.52 281.41 685.05 297.44 685.56 312.82 688.9 328.51 699.87 339.31 710.77 350.04 726.46 352.76 741.74 353.24&#39; fill=&#39;%232774c6&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M722.74 367.24C738.66 367.74 756.45 367.66 767.31 356.01 777.99 344.55 776.23 327.03 774.75 311.44 773.45 297.69 768.08 285.48 759.6 274.58 749.49 261.6 739.11 246.22 722.74 244.65 705.54 243 689.21 253.56 678.03 266.73 667.65 278.96 665.52 295.41 666.05 311.44 666.56 326.82 669.9 342.51 680.87 353.31 691.77 364.04 707.46 366.76 722.74 367.24&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%231b518b&#39;%3e%3c/path%3e%3cpath d=&#39;M1012.88 606.09C1024.88 606.49 1035.45 599.26 1043.98 590.8 1052.55 582.3 1060.15 571.76 1059.65 559.7 1059.16 547.97 1049.74 539.44 1041.5 531.08 1033.17 522.64 1024.74 512.09 1012.88 512.29 1001.1 512.48 993.01 523.2 985.19 532.01 978.01 540.1 971.05 548.88 970.78 559.7 970.51 570.74 976.37 580.61 983.79 588.79 991.67 597.48 1001.16 605.7 1012.88 606.09&#39; fill=&#39;%23488fdb&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M992.88 599.09C1004.88 599.49 1015.45 592.26 1023.98 583.8 1032.55 575.3 1040.15 564.76 1039.65 552.7 1039.16 540.97 1029.74 532.44 1021.5 524.08 1013.17 515.64 1004.74 505.09 992.88 505.29 981.1 505.48 973.01 516.2 965.19 525.01 958.01 533.1 951.05 541.88 950.78 552.7 950.51 563.74 956.37 573.61 963.79 581.79 971.67 590.48 981.16 598.7 992.88 599.09&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%232164aa&#39;%3e%3c/path%3e%3cpath d=&#39;M1347.76 557.03C1375.03 558.66 1402.09 544.49 1418.86 522.93 1434.16 503.26 1429.17 476.75 1429.58 451.83 1430 426.2 1439.08 396.75 1421.25 378.34 1403.34 359.84 1373.51 366.86 1347.76 367.35 1322.79 367.83 1295.36 364.14 1277.02 381.09 1258.27 398.43 1254.91 426.33 1256.37 451.83 1257.74 475.75 1268.99 496.8 1284.7 514.89 1301.94 534.73 1321.53 555.46 1347.76 557.03&#39; fill=&#39;%23fd3f3f&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M1337.76 564.03C1365.03 565.66 1392.09 551.49 1408.86 529.93 1424.16 510.26 1419.17 483.75 1419.58 458.83 1420 433.2 1429.08 403.75 1411.25 385.34 1393.34 366.84 1363.51 373.86 1337.76 374.35 1312.79 374.83 1285.36 371.14 1267.02 388.09 1248.27 405.43 1244.91 433.33 1246.37 458.83 1247.74 482.75 1258.99 503.8 1274.7 521.89 1291.94 541.73 1311.53 562.46 1337.76 564.03&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%23db0202&#39;%3e%3c/path%3e%3cpath d=&#39;M815.32 552.91C828.51 552.18 841.08 548.41 851.14 539.85 862.18 530.45 872.78 518.53 872.75 504.03 872.72 489.55 861.83 477.96 850.97 468.38 840.92 459.52 828.71 453.94 815.32 453.38 801.28 452.79 786.76 455.61 776.54 465.25 766.06 475.13 761.84 489.63 761.61 504.03 761.38 518.69 764.47 534.17 775.31 544.04 785.81 553.6 801.14 553.69 815.32 552.91&#39; fill=&#39;%232774c6&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M809.32 533.91C822.51 533.18 835.08 529.41 845.14 520.85 856.18 511.45 866.78 499.53 866.75 485.03 866.72 470.55 855.83 458.96 844.97 449.38 834.92 440.52 822.71 434.94 809.32 434.38 795.28 433.79 780.76 436.61 770.54 446.25 760.06 456.13 755.84 470.63 755.61 485.03 755.38 499.69 758.47 515.17 769.31 525.04 779.81 534.6 795.14 534.69 809.32 533.91&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%231b518b&#39;%3e%3c/path%3e%3cpath d=&#39;M547.86 405.44C559.98 404.82 572.43 403.82 581.56 395.82 591.24 387.33 596.49 374.98 597.26 362.12 598.08 348.4 595.08 334.31 585.84 324.14 576.2 313.52 562.12 306.19 547.86 307.71 534.5 309.13 526.72 321.97 517.18 331.44 507.57 340.97 494.33 348.65 493.01 362.12 491.62 376.34 499.32 390.59 510.53 399.45 520.81 407.57 534.78 406.11 547.86 405.44&#39; fill=&#39;%2354c076&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M536.86 424.44C548.98 423.82 561.43 422.82 570.56 414.82 580.24 406.33 585.49 393.98 586.26 381.12 587.08 367.4 584.08 353.31 574.84 343.14 565.2 332.52 551.12 325.19 536.86 326.71 523.5 328.13 515.72 340.97 506.18 350.44 496.57 359.97 483.33 367.65 482.01 381.12 480.62 395.34 488.32 409.59 499.53 418.45 509.81 426.57 523.78 425.11 536.86 424.44&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%23348d50&#39;%3e%3c/path%3e%3cpath d=&#39;M257.24 215.31C282.96 215.02 309.19 208.12 326.78 189.36 343.93 171.07 346.06 144.88 346.78 119.82 347.53 93.72 348.73 65.23 330.9 46.16 312.7 26.69 283.85 22.62 257.24 24.03 232.14 25.36 209.35 36.4 190.98 53.56 171.86 71.43 155.65 93.67 154.72 119.82 153.76 146.75 166.37 172.6 186.09 190.97 205.16 208.73 231.18 215.61 257.24 215.31&#39; fill=&#39;%23fd3f3f&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M265.24 203.31C290.96 203.02 317.19 196.12 334.78 177.36 351.93 159.07 354.06 132.88 354.78 107.82 355.53 81.72 356.73 53.23 338.9 34.16 320.7 14.69 291.85 10.62 265.24 12.03 240.14 13.36 217.35 24.4 198.98 41.56 179.86 59.43 163.65 81.67 162.72 107.82 161.76 134.75 174.37 160.6 194.09 178.97 213.16 196.73 239.18 203.61 265.24 203.31&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%23db0202&#39;%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cclipPath id=&#39;SvgjsClipPath1000&#39;%3e%3crect width=&#39;1440&#39; height=&#39;560&#39; x=&#39;0&#39; y=&#39;0&#39;%3e%3c/rect%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e&quot;);" data-v-bf9b66e4 data-v-a96b3d82><div class="mask" data-v-a96b3d82><div class="title-container" data-v-a96b3d82><div class="title" data-v-a96b3d82><h1 data-v-a96b3d82>Vue Markdown Rendering Optimization in Practice (Part 2): Farewell to DOM Manipulation, Embrace AST and Functional Rendering</h1><!----></div></div></div></div><!--teleport start--><!--teleport end--><!--]--><div class="content-wrapper" data-v-3c9f8a67><div class="before-main side" data-v-3c9f8a67><!--[--><!--]--></div><main data-v-3c9f8a67><!--[--><article class="markdown-body" data-v-11c89a0f><h2 id="recap-when-morphdom-meets-vue" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Recap: When <code><!--[-->morphdom<!--]--></code> Meets Vue<!--]--><a href="#recap-when-morphdom-meets-vue" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->In <a href="/2025/07/12/vue-markdown-render-improvement-1/" class=""><!--[-->the previous article<!--]--></a>, we embarked on a performance optimization journey for Markdown rendering. From the most primitive full refresh with <code><!--[-->v-html<!--]--></code>, to block-by-block updates, we eventually brought out the &quot;ultimate weapon&quot; - <code><!--[-->morphdom<!--]--></code>. By directly comparing and manipulating the real DOM, it updates the view with minimal cost, perfectly solving the performance bottleneck and interaction state loss issues in real-time rendering.<!--]--></p><p><!--[-->However, a fundamental problem has always existed: in Vue&#39;s territory, bypassing Vue&#39;s Virtual DOM and Diff algorithm to let a third-party library directly &quot;operate&quot; on the real DOM always feels somewhat &quot;unorthodox.&quot; It&#39;s like introducing an old master with a hammer and wrench for manual repairs in a precision automated factory. Although the job is done well, it always feels like it disrupts the original workflow and isn&#39;t &quot;Vue&quot; enough.<!--]--></p><p><!--[-->So, is there a more elegant, more &quot;native&quot; approach that allows us to enjoy precise updates while fully integrating with Vue&#39;s ecosystem?<!--]--></p><p><!--[-->With this question in mind, I consulted friends in frontend development groups.<!--]--></p><blockquote><!--[--><p><!--[-->If you&#39;re building a renderer, your approach isn&#39;t the best practice. Each time you update, you generate the full virtual HTML, then optimize performance by subtracting from the HTML. However, the incremental part of each update is clear - why not directly use this incremental part for addition? The incremental part cannot be directly obtained through markdown-it, but a better approach is to transform at this step: first parse the Markdown structure, then use Vue&#39;s dynamic rendering capabilities to generate the DOM. This way, DOM reuse can leverage Vue&#39;s own abilities. — <a href="https://site.j10c.cc/" rel="nofollow"><!--[-->j10c<!--]--></a><!--]--></p><!--]--></blockquote><blockquote><!--[--><p><!--[-->You can use unified with the remark-parse plugin to parse markdown strings into AST, then render based on the AST using render functions. — bii &amp; <a href="https://github.com/nekomeowww" rel="nofollow"><!--[-->nekomeowww<!--]--></a><!--]--></p><!--]--></blockquote><h2 id="new-approach-from-string-conversion-to-structured-rendering" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->New Approach: From &quot;String Conversion&quot; to &quot;Structured Rendering&quot;<!--]--><a href="#new-approach-from-string-conversion-to-structured-rendering" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->Our previous solutions, whether <code><!--[-->v-html<!--]--></code> or <code><!--[-->morphdom<!--]--></code>, shared a core approach:<!--]--></p><p><!--[--><code><!--[-->Markdown String<!--]--></code> -&gt; <code><!--[-->markdown-it<!--]--></code> -&gt; <code><!--[-->HTML String<!--]--></code> -&gt; <code><!--[-->Browser/morphdom<!--]--></code> -&gt; <code><!--[-->DOM<!--]--></code><!--]--></p><p><!--[-->The problem with this pipeline is that starting from the <code><!--[-->HTML String<!--]--></code> step, we lose the <strong><!--[-->original structural information<!--]--></strong> of Markdown. We get a bunch of unstructured text that Vue cannot understand its internal logic and can only swallow it whole.<!--]--></p><p><!--[-->The new approach transforms the process into:<!--]--></p><p><!--[--><code><!--[-->Markdown String<!--]--></code> -&gt; <code><!--[-->AST (Abstract Syntax Tree)<!--]--></code> -&gt; <code><!--[-->Vue VNodes (Virtual Nodes)<!--]--></code> -&gt; <code><!--[-->Vue<!--]--></code> -&gt; <code><!--[-->DOM<!--]--></code><!--]--></p><h3 id="what-is-ast" class="prose-heading prose-h3" data-v-894c4550><!--[-->What is AST?<!--]--><a href="#what-is-ast" class="heading-anchor" aria-label="链接到此标题" data-v-894c4550><span class="anchor-icon" data-v-894c4550>#</span></a></h3><p><!--[--><strong><!--[-->AST (Abstract Syntax Tree)<!--]--></strong> is a structured representation of source code or markup language. It parses a long string of text into a hierarchical tree-like object. For Markdown, a level-1 heading becomes a node with <code><!--[-->type: &#39;heading&#39;, depth: 1<!--]--></code>, a paragraph becomes a node with <code><!--[-->type: &#39;paragraph&#39;<!--]--></code>, and the text within the paragraph becomes the <code><!--[-->children<!--]--></code> of the <code><!--[-->paragraph<!--]--></code> node.<!--]--></p><p><!--[-->Once we convert Markdown into an AST, we essentially have a &quot;structural blueprint&quot; of the entire document. We&#39;re no longer facing a pile of ambiguous HTML strings, but rather a clear, programmable JavaScript object.<!--]--></p><h3 id="our-new-tools-unified-and-remark" class="prose-heading prose-h3" data-v-894c4550><!--[-->Our New Tools: unified and remark<!--]--><a href="#our-new-tools-unified-and-remark" class="heading-anchor" aria-label="链接到此标题" data-v-894c4550><span class="anchor-icon" data-v-894c4550>#</span></a></h3><p><!--[-->To implement the <code><!--[-->Markdown -&gt; AST<!--]--></code> conversion, we introduce the <code><!--[-->unified<!--]--></code> ecosystem.<!--]--></p><ul><!--[--><li><!--[--><strong><!--[--><a href="https://github.com/unifiedjs/unified" rel="nofollow"><!--[-->unified<!--]--></a><!--]--></strong>: A powerful content processing engine. Think of it as an assembly line where raw text is the raw material, and you process it through parsing, transformation, and serialization by adding different &quot;plugins.&quot;<!--]--></li><li><!--[--><strong><!--[--><a href="https://github.com/remarkjs/remark" rel="nofollow"><!--[-->remark-parse<!--]--></a><!--]--></strong>: A <code><!--[-->unified<!--]--></code> plugin specifically responsible for parsing Markdown text into AST (specifically in <a href="https://github.com/syntax-tree/mdast" rel="nofollow"><!--[-->mdast<!--]--></a> format).<!--]--></li><!--]--></ul><h2 id="step-1-parse-markdown-into-ast" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Step 1: Parse Markdown into AST<!--]--><a href="#step-1-parse-markdown-into-ast" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->First, we need to install the dependencies:<!--]--></p><pre class="language-bash shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sAdtL">npm</span><span class="sDhpE"> install</span><span class="sDhpE"> unified</span><span class="sDhpE"> remark-parse
</span></span></code><!--]--></pre><p><!--[-->Then, we can easily convert a Markdown string into an AST:<!--]--></p><pre class="language-javascript shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sLKXg">import</span><span class="s5ixo"> { </span><span class="sJa8x">unified</span><span class="s5ixo"> } </span><span class="sLKXg">from</span><span class="sDhpE"> &#39;unified&#39;
</span></span><span class="line" line="2"><span class="sLKXg">import</span><span class="sJa8x"> remarkParse</span><span class="sLKXg"> from</span><span class="sDhpE"> &#39;remark-parse&#39;
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span class="sLKXg">const</span><span class="sNmU0"> markdownContent</span><span class="s_Sar"> =</span><span class="sDhpE"> &#39;# Hello, AST!</span><span class="s_Sar">\n\n</span><span class="sDhpE">This is a paragraph.&#39;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span class="sW2Sy">// Create a processor instance
</span></span><span class="line" line="7"><span class="sLKXg">const</span><span class="sNmU0"> processor</span><span class="s_Sar"> =</span><span class="sAdtL"> unified</span><span class="s5ixo">().</span><span class="sAdtL">use</span><span class="s5ixo">(</span><span class="sz0mV">remarkParse</span><span class="s5ixo">)
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span class="sW2Sy">// Parse Markdown content
</span></span><span class="line" line="10"><span class="sLKXg">const</span><span class="sNmU0"> ast</span><span class="s_Sar"> =</span><span class="s7GmK"> processor</span><span class="s5ixo">.</span><span class="sAdtL">parse</span><span class="s5ixo">(</span><span class="sz0mV">markdownContent</span><span class="s5ixo">)
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span class="s7GmK">console</span><span class="s5ixo">.</span><span class="sAdtL">log</span><span class="s5ixo">(</span><span class="sNmU0">JSON</span><span class="s5ixo">.</span><span class="sAdtL">stringify</span><span class="s5ixo">(</span><span class="sz0mV">ast</span><span class="s5ixo">, </span><span class="sAGMh">null</span><span class="s5ixo">, </span><span class="sAGMh">2</span><span class="s5ixo">))
</span></span></code><!--]--></pre><p><!--[-->Running the above code will give us a JSON object like the following, which is our coveted AST:<!--]--></p><pre class="language-json shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="s5ixo">{
</span></span><span class="line" line="2"><span class="sJa8x">  &quot;type&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;root&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="3"><span class="sJa8x">  &quot;children&quot;</span><span class="s5ixo">: [
</span></span><span class="line" line="4"><span class="s5ixo">    {
</span></span><span class="line" line="5"><span class="sJa8x">      &quot;type&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;heading&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="6"><span class="sJa8x">      &quot;depth&quot;</span><span class="s5ixo">: </span><span class="sAGMh">1</span><span class="s5ixo">,
</span></span><span class="line" line="7"><span class="sJa8x">      &quot;children&quot;</span><span class="s5ixo">: [
</span></span><span class="line" line="8"><span class="s5ixo">        {
</span></span><span class="line" line="9"><span class="sJa8x">          &quot;type&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;text&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="10"><span class="sJa8x">          &quot;value&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;Hello, AST!&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="11"><span class="sJa8x">          &quot;position&quot;</span><span class="s5ixo">: { </span><span class="sUNH4">...</span><span class="s5ixo"> }
</span></span><span class="line" line="12"><span class="s5ixo">        }
</span></span><span class="line" line="13"><span class="s5ixo">      ],
</span></span><span class="line" line="14"><span class="sJa8x">      &quot;position&quot;</span><span class="s5ixo">: { </span><span class="sUNH4">...</span><span class="s5ixo"> }
</span></span><span class="line" line="15"><span class="s5ixo">    },
</span></span><span class="line" line="16"><span class="s5ixo">    {
</span></span><span class="line" line="17"><span class="sJa8x">      &quot;type&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;paragraph&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="18"><span class="sJa8x">      &quot;children&quot;</span><span class="s5ixo">: [
</span></span><span class="line" line="19"><span class="s5ixo">        {
</span></span><span class="line" line="20"><span class="sJa8x">          &quot;type&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;text&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="21"><span class="sJa8x">          &quot;value&quot;</span><span class="s5ixo">: </span><span class="sDhpE">&quot;This is a paragraph.&quot;</span><span class="s5ixo">,
</span></span><span class="line" line="22"><span class="sJa8x">          &quot;position&quot;</span><span class="s5ixo">: { </span><span class="sUNH4">...</span><span class="s5ixo"> }
</span></span><span class="line" line="23"><span class="s5ixo">        }
</span></span><span class="line" line="24"><span class="s5ixo">      ],
</span></span><span class="line" line="25"><span class="sJa8x">      &quot;position&quot;</span><span class="s5ixo">: { </span><span class="sUNH4">...</span><span class="s5ixo"> }
</span></span><span class="line" line="26"><span class="s5ixo">    }
</span></span><span class="line" line="27"><span class="s5ixo">  ],
</span></span><span class="line" line="28"><span class="sJa8x">  &quot;position&quot;</span><span class="s5ixo">: { </span><span class="sUNH4">...</span><span class="s5ixo"> }
</span></span><span class="line" line="29"><span class="s5ixo">}
</span></span></code><!--]--></pre><h2 id="step-2-from-ast-to-vue-vnodes" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Step 2: From AST to Vue VNodes<!--]--><a href="#step-2-from-ast-to-vue-vnodes" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->Having obtained the AST, the next step is to actually &quot;construct&quot; this &quot;structural blueprint&quot; into a user-visible interface. In Vue&#39;s world, the blueprint for describing UI is the Virtual Node (VNode), and the <code><!--[-->h()<!--]--></code> function (i.e., hyperscript) is the brush for creating VNodes.<!--]--></p><p><!--[-->Our task is to write a render function that can recursively traverse the AST and generate corresponding VNodes for each node type (<code><!--[-->heading<!--]--></code>, <code><!--[-->paragraph<!--]--></code>, <code><!--[-->text<!--]--></code>, etc.).<!--]--></p><p><!--[-->Here&#39;s a simple render function implementation:<!--]--></p><pre class="language-javascript shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sLKXg">function</span><span class="sAdtL"> renderAst</span><span class="s5ixo">(</span><span class="s8iYz">node</span><span class="s5ixo">) {
</span></span><span class="line" line="2"><span class="sLKXg">  if</span><span class="s5ixo"> (</span><span class="s_Sar">!</span><span class="sz0mV">node</span><span class="s5ixo">) </span><span class="sLKXg">return</span><span class="sAGMh"> null
</span></span><span class="line" line="3"><span class="sLKXg">  switch</span><span class="s5ixo"> (</span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="sJa8x">type</span><span class="s5ixo">) {
</span></span><span class="line" line="4"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;root&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="5"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;div&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="6"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;paragraph&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="7"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;p&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="8"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;text&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="9"><span class="sLKXg">      return</span><span class="s7GmK"> node</span><span class="s5ixo">.</span><span class="sJa8x">value
</span></span><span class="line" line="10"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;emphasis&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="11"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;em&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="12"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;strong&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="13"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;strong&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="14"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;inlineCode&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="15"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;code&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="sJa8x">value</span><span class="s5ixo">)
</span></span><span class="line" line="16"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;heading&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="17"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;h&#39;</span><span class="s_Sar"> +</span><span class="s7GmK"> node</span><span class="s5ixo">.</span><span class="sJa8x">depth</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="18"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;code&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="19"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;pre&#39;</span><span class="s5ixo">, {}, [</span><span class="sAdtL">h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;code&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="sj4iG">value</span><span class="s5ixo">)])
</span></span><span class="line" line="20"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;list&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="21"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="sJa8x">ordered</span><span class="s7DPa"> ?</span><span class="sDhpE"> &#39;ol&#39;</span><span class="s7DPa"> :</span><span class="sDhpE"> &#39;ul&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="22"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;listItem&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="23"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;li&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="24"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;thematicBreak&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="25"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;hr&#39;</span><span class="s5ixo">)
</span></span><span class="line" line="26"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;blockquote&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="27"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;blockquote&#39;</span><span class="s5ixo">, {}, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="28"><span class="sLKXg">    case</span><span class="sDhpE"> &#39;link&#39;</span><span class="s5ixo">:
</span></span><span class="line" line="29"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;a&#39;</span><span class="s5ixo">, { </span><span class="sJa8x">href</span><span class="st7oF">:</span><span class="s7GmK"> node</span><span class="s5ixo">.</span><span class="sJa8x">url</span><span class="s5ixo">, </span><span class="sJa8x">target</span><span class="st7oF">:</span><span class="sDhpE"> &#39;_blank&#39;</span><span class="s5ixo"> }, </span><span class="s7GmK">node</span><span class="s5ixo">.</span><span class="s2QsP">children</span><span class="s5ixo">.</span><span class="sAdtL">map</span><span class="s5ixo">(</span><span class="sz0mV">renderAst</span><span class="s5ixo">))
</span></span><span class="line" line="30"><span class="sLKXg">    default</span><span class="s5ixo">:
</span></span><span class="line" line="31"><span class="sW2Sy">      // Other unimplemented types
</span></span><span class="line" line="32"><span class="sLKXg">      return</span><span class="sAdtL"> h</span><span class="s5ixo">(</span><span class="sDhpE">&#39;span&#39;</span><span class="s5ixo">, { }, </span><span class="sDhpE">`[</span><span class="sAOjX">${</span><span class="s7GmK">node</span><span class="sMj0N">.</span><span class="sJa8x">type</span><span class="sAOjX">}</span><span class="sDhpE">]`</span><span class="s5ixo">)
</span></span><span class="line" line="33"><span class="s5ixo">  }
</span></span><span class="line" line="34"><span class="s5ixo">}
</span></span></code><!--]--></pre><h2 id="step-3-encapsulate-vue-component" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Step 3: Encapsulate Vue Component<!--]--><a href="#step-3-encapsulate-vue-component" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->Integrating the above logic, we can build a Vue component. Given the characteristic of directly generating VNodes, using a functional component or explicit <code><!--[-->render<!--]--></code> function is most appropriate.<!--]--></p><pre class="language-vue shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="s5ixo">&lt;</span><span class="sJa8x">template</span><span class="s5ixo">&gt;
</span></span><span class="line" line="2"><span class="s5ixo">  &lt;</span><span class="sJa8x">component</span><span class="s5ixo"> :</span><span class="sAGMh">is</span><span class="s5ixo">=</span><span class="s5ixo">&quot;</span><span class="sz0mV">VNodeTree</span><span class="s5ixo">&quot;</span><span class="s5ixo"> /&gt;
</span></span><span class="line" line="3"><span class="s5ixo">&lt;/</span><span class="sJa8x">template</span><span class="s5ixo">&gt;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span class="s5ixo">&lt;</span><span class="sJa8x">script</span><span class="sAGMh"> setup</span><span class="s5ixo">&gt;
</span></span><span class="line" line="6"><span class="sLKXg">import</span><span class="s5ixo"> { </span><span class="sJa8x">computed</span><span class="s5ixo">, </span><span class="sJa8x">h</span><span class="s5ixo">, </span><span class="sJa8x">shallowRef</span><span class="s5ixo">, </span><span class="sJa8x">watchEffect</span><span class="s5ixo"> } </span><span class="sLKXg">from</span><span class="sDhpE"> &#39;vue&#39;
</span></span><span class="line" line="7"><span class="sLKXg">import</span><span class="s5ixo"> { </span><span class="sJa8x">unified</span><span class="s5ixo"> } </span><span class="sLKXg">from</span><span class="sDhpE"> &#39;unified&#39;
</span></span><span class="line" line="8"><span class="sLKXg">import</span><span class="sJa8x"> remarkParse</span><span class="sLKXg"> from</span><span class="sDhpE"> &#39;remark-parse&#39;
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span class="sLKXg">const</span><span class="sNmU0"> props</span><span class="s_Sar"> =</span><span class="sAdtL"> defineProps</span><span class="s5ixo">({
</span></span><span class="line" line="11"><span class="sJa8x">  mdText</span><span class="st7oF">:</span><span class="s5ixo"> {
</span></span><span class="line" line="12"><span class="sJa8x">    type</span><span class="st7oF">:</span><span class="sz0mV"> String</span><span class="s5ixo">,
</span></span><span class="line" line="13"><span class="sJa8x">    default</span><span class="st7oF">:</span><span class="sDhpE"> &#39;&#39;
</span></span><span class="line" line="14"><span class="s5ixo">  }
</span></span><span class="line" line="15"><span class="s5ixo">})
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span class="sLKXg">const</span><span class="sNmU0"> ast</span><span class="s_Sar"> =</span><span class="sAdtL"> shallowRef</span><span class="s5ixo">(</span><span class="sAGMh">null</span><span class="s5ixo">)
</span></span><span class="line" line="18"><span class="sLKXg">const</span><span class="sNmU0"> parser</span><span class="s_Sar"> =</span><span class="sAdtL"> unified</span><span class="s5ixo">().</span><span class="sAdtL">use</span><span class="s5ixo">(</span><span class="sz0mV">remarkParse</span><span class="s5ixo">)
</span></span><span class="line" line="19"><span emptylineplaceholder="true">
</span></span><span class="line" line="20"><span class="sAdtL">watchEffect</span><span class="s5ixo">(() </span><span class="sLKXg">=&gt;</span><span class="s5ixo"> {
</span></span><span class="line" line="21"><span class="s7GmK">  ast</span><span class="s5ixo">.</span><span class="sJa8x">value</span><span class="s_Sar"> =</span><span class="s7GmK"> parser</span><span class="s5ixo">.</span><span class="sAdtL">parse</span><span class="s5ixo">(</span><span class="s7GmK">props</span><span class="s5ixo">.</span><span class="sJa8x">mdText</span><span class="s5ixo">)
</span></span><span class="line" line="22"><span class="s5ixo">})
</span></span><span class="line" line="23"><span emptylineplaceholder="true">
</span></span><span class="line" line="24"><span class="sW2Sy">// AST render function (same as renderAst function above)
</span></span><span class="line" line="25"><span class="sLKXg">function</span><span class="sAdtL"> renderAst</span><span class="s5ixo">(</span><span class="s8iYz">node</span><span class="s5ixo">) { </span><span class="st7oF">...</span><span class="s5ixo"> }
</span></span><span class="line" line="26"><span emptylineplaceholder="true">
</span></span><span class="line" line="27"><span class="sLKXg">const</span><span class="sNmU0"> VNodeTree</span><span class="s_Sar"> =</span><span class="sAdtL"> computed</span><span class="s5ixo">(() </span><span class="sLKXg">=&gt;</span><span class="sAdtL"> renderAst</span><span class="s5ixo">(</span><span class="s7GmK">ast</span><span class="s5ixo">.</span><span class="sJa8x">value</span><span class="s5ixo">))
</span></span><span class="line" line="28"><span emptylineplaceholder="true">
</span></span><span class="line" line="29"><span class="s5ixo">&lt;/</span><span class="sJa8x">script</span><span class="s5ixo">&gt;
</span></span></code><!--]--></pre><p><!--[-->Now it can be used like a regular component:<!--]--></p><pre class="language-vue shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="s5ixo">&lt;</span><span class="sJa8x">template</span><span class="s5ixo">&gt;
</span></span><span class="line" line="2"><span class="s5ixo">  &lt;</span><span class="sJa8x">MarkdownRenderer</span><span class="s5ixo"> :</span><span class="sAGMh">mdText</span><span class="s5ixo">=</span><span class="s5ixo">&quot;</span><span class="sz0mV">markdownContent</span><span class="s5ixo">&quot;</span><span class="s5ixo"> /&gt;
</span></span><span class="line" line="3"><span class="s5ixo">&lt;/</span><span class="sJa8x">template</span><span class="s5ixo">&gt;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span class="s5ixo">&lt;</span><span class="sJa8x">script</span><span class="sAGMh"> setup</span><span class="s5ixo">&gt;
</span></span><span class="line" line="6"><span class="sLKXg">import</span><span class="s5ixo"> { </span><span class="sJa8x">ref</span><span class="s5ixo"> } </span><span class="sLKXg">from</span><span class="sDhpE"> &#39;vue&#39;
</span></span><span class="line" line="7"><span class="sLKXg">import</span><span class="sJa8x"> MarkdownRenderer</span><span class="sLKXg"> from</span><span class="sDhpE"> &#39;./MarkdownRenderer.vue&#39;
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span class="sLKXg">const</span><span class="sNmU0"> markdownContent</span><span class="s_Sar"> =</span><span class="sAdtL"> ref</span><span class="s5ixo">(</span><span class="sDhpE">&#39;# Hello Vue</span><span class="s_Sar">\n\n</span><span class="sDhpE">This is rendered via AST!&#39;</span><span class="s5ixo">)
</span></span><span class="line" line="10"><span class="s5ixo">&lt;/</span><span class="sJa8x">script</span><span class="s5ixo">&gt;
</span></span></code><!--]--></pre><h2 id="huge-advantages-of-the-ast-approach" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Huge Advantages of the AST Approach<!--]--><a href="#huge-advantages-of-the-ast-approach" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->After switching to the AST track, we gained unprecedented superpowers:<!--]--></p><ol><!--[--><li><!--[--><strong><!--[-->Native Integration, Excellent Performance<!--]--></strong>: We no longer need the brute force refresh of <code><!--[-->v-html<!--]--></code>, nor do we need &quot;external help&quot; like <code><!--[-->morphdom<!--]--></code>. All updates are handled by Vue&#39;s own Diff algorithm, which is not only highly performant but also fully aligned with Vue&#39;s design philosophy - truly &quot;one of our own.&quot;<!--]--></li><li><!--[--><strong><!--[-->High Flexibility and Extensibility<!--]--></strong>: AST, as a programmable JavaScript object, provides a solid foundation for customized processing:<ul><!--[--><li><!--[--><strong><!--[-->Element Replacement<!--]--></strong>: Native elements (like <code><!--[-->&lt;h2&gt;<!--]--></code>) can be seamlessly replaced with custom Vue components (like <code><!--[-->&lt;FancyHeading&gt;<!--]--></code>), only requiring adjustments to the corresponding <code><!--[-->case<!--]--></code> logic in the <code><!--[-->renderAst<!--]--></code> function.<!--]--></li><li><!--[--><strong><!--[-->Logic Injection<!--]--></strong>: Attributes like <code><!--[-->target=&quot;_blank&quot;<!--]--></code> and <code><!--[-->rel=&quot;noopener noreferrer&quot;<!--]--></code> can be conveniently added to external links <code><!--[-->&lt;a&gt;<!--]--></code>, or lazy-load components can wrap images <code><!--[-->&lt;img&gt;<!--]--></code> - such operations are easy to implement at the AST level.<!--]--></li><li><!--[--><strong><!--[-->Ecosystem Integration<!--]--></strong>: Fully leverage <code><!--[-->unified<!--]--></code>&#39;s rich plugin ecosystem (such as <code><!--[-->remark-gfm<!--]--></code> for GFM syntax support, <code><!--[-->remark-prism<!--]--></code> for code highlighting), only requiring the introduction of corresponding plugins in the processor chain (<code><!--[-->.use(pluginName)<!--]--></code>).<!--]--></li><!--]--></ul><!--]--></li><li><!--[--><strong><!--[-->Separation of Concerns<!--]--></strong>: Parsing logic (<code><!--[-->remark<!--]--></code>), rendering logic (<code><!--[-->renderAst<!--]--></code>), and business logic (Vue components) are clearly separated, resulting in clearer code structure and stronger maintainability.<!--]--></li><li><!--[--><strong><!--[-->Type Safety and Predictability<!--]--></strong>: Compared to manipulating strings or raw HTML, rendering logic based on structured AST is easier to type-check and reason about.<!--]--></li><!--]--></ol><h2 id="conclusion-evolution-from-functional-implementation-to-architectural-optimization" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Conclusion: Evolution from Functional Implementation to Architectural Optimization<!--]--><a href="#conclusion-evolution-from-functional-implementation-to-architectural-optimization" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->Reviewing the optimization journey:<!--]--></p><ul><!--[--><li><!--[--><strong><!--[-->v-html<!--]--></strong>: Simple implementation, but with performance and security concerns.<!--]--></li><li><!--[--><strong><!--[-->Block updates<!--]--></strong>: Alleviated some performance issues, but the solution had limitations.<!--]--></li><li><!--[--><strong><!--[-->morphdom<!--]--></strong>: Effectively improved performance and user experience, but existed in isolation from Vue&#39;s core mechanisms.<!--]--></li><li><!--[--><strong><!--[-->AST + Functional Rendering<!--]--></strong>: Returns to Vue&#39;s native paradigm, providing an ultimate solution with excellent performance, flexibility, and maintainability.<!--]--></li><!--]--></ul><p><!--[-->By adopting AST, we not only solved specific technical challenges but, more importantly, achieved a paradigm shift - from result-oriented programming (HTML strings) to process and structure-oriented programming (AST). This enables us to dive deep into the essence of content, thereby achieving precise control over the rendering process.<!--]--></p><p><!--[-->This optimization practice from &quot;full refresh&quot; to &quot;structured rendering&quot; is not only a technical process of performance improvement but also a systematic exploration of deeply understanding modern frontend engineering thinking. The final Markdown rendering solution achieved high standards in performance, functionality, and architectural elegance.<!--]--></p><style>html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .sNmU0, html code.shiki .sNmU0{--shiki-default:#986801;--shiki-dark:#E5C07B}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}html pre.shiki code .sz0mV, html code.shiki .sz0mV{--shiki-default:#383A42;--shiki-dark:#E06C75}html pre.shiki code .s7GmK, html code.shiki .s7GmK{--shiki-default:#383A42;--shiki-dark:#E5C07B}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sUNH4, html code.shiki .sUNH4{--shiki-default:white;--shiki-dark:#FFFFFF}html pre.shiki code .s8iYz, html code.shiki .s8iYz{--shiki-default:#383A42;--shiki-default-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic}html pre.shiki code .s2QsP, html code.shiki .s2QsP{--shiki-default:#E45649;--shiki-dark:#E5C07B}html pre.shiki code .sj4iG, html code.shiki .sj4iG{--shiki-default:#C18401;--shiki-dark:#E06C75}html pre.shiki code .s7DPa, html code.shiki .s7DPa{--shiki-default:#0184BC;--shiki-dark:#C678DD}html pre.shiki code .st7oF, html code.shiki .st7oF{--shiki-default:#0184BC;--shiki-dark:#ABB2BF}html pre.shiki code .sAOjX, html code.shiki .sAOjX{--shiki-default:#CA1243;--shiki-dark:#C678DD}html pre.shiki code .sMj0N, html code.shiki .sMj0N{--shiki-default:#50A14F;--shiki-dark:#ABB2BF}</style></article><hr class="article-end-hr" data-v-11c89a0f><div class="tags" data-v-11c89a0f><svg viewBox="0 0 512 512" width="1.2em" height="1.2em" data-v-11c89a0f><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M403.29 32H280.36a14.46 14.46 0 0 0-10.2 4.2L24.4 281.9a28.85 28.85 0 0 0 0 40.7l117 117a28.86 28.86 0 0 0 40.71 0L427.8 194a14.46 14.46 0 0 0 4.2-10.2v-123A28.66 28.66 0 0 0 403.29 32"></path><path fill="currentColor" d="M352 144a32 32 0 1 1 32-32a32 32 0 0 1-32 32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="m230 480l262-262a13.8 13.8 0 0 0 4-10V80"></path></svg><!--[--><a href="/en/tags/Vue.js/" class="" data-v-11c89a0f>#Vue.js</a><a href="/en/tags/Markdown/" class="" data-v-11c89a0f>#Markdown</a><a href="/en/tags/AST/" class="" data-v-11c89a0f>#AST</a><a href="/en/tags/JavaScript/" class="" data-v-11c89a0f>#JavaScript</a><a href="/en/tags/Web/" class="" data-v-11c89a0f>#Web</a><a href="/en/tags/unified/" class="" data-v-11c89a0f>#unified</a><!--]--></div><nav class="post-navigation" data-v-11c89a0f data-v-a35c130b><a href="/en/2025/08/11/dns-resolve-time-destroyed-my-optimization-for-pic-cdn/" class="nav-button prev" data-v-a35c130b><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="nav-arrow" data-v-a35c130b><path fill="currentColor" d="M10 22L0 12L10 2l1.775 1.775L3.55 12l8.225 8.225z"></path></svg><div class="nav-content" data-v-a35c130b><span class="nav-label" data-v-a35c130b>Previous</span><span class="nav-title" data-v-a35c130b>How DNS Resolution Latency Destroyed My Image Hosting Optimization</span></div></a><a href="/en/2025/07/12/vue-markdown-render-improvement-1/" class="nav-button next" data-v-a35c130b><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="nav-arrow" data-v-a35c130b><path fill="currentColor" d="M8.025 22L6.25 20.225L14.475 12L6.25 3.775L8.025 2l10 10z"></path></svg><div class="nav-content" data-v-a35c130b><span class="nav-label" data-v-a35c130b>Next</span><span class="nav-title" data-v-a35c130b>Vue Markdown Rendering Optimization in Practice (Part 1): From Brute Force Refresh, Chunked Updates to Morphdom&#39;s Elegant Transformation</span></div></a></nav><div id="waline" data-v-11c89a0f><span></span></div><!--]--></main><div class="after-main side" data-v-3c9f8a67><!--[--><aside data-v-11c89a0f><nav class="toc" data-v-11c89a0f data-v-c35f8c0a><div class="toc-title" data-v-c35f8c0a>Contents</div><ul class="toc-list" data-v-c35f8c0a><!--[--><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#recap-when-morphdom-meets-vue" data-v-c35f8c0a>Recap: When morphdom Meets Vue</a></li><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#new-approach-from-string-conversion-to-structured-rendering" data-v-c35f8c0a>New Approach: From &quot;String Conversion&quot; to &quot;Structured Rendering&quot;</a></li><li class="toc-item toc-level-3" data-v-c35f8c0a><a href="#what-is-ast" data-v-c35f8c0a>What is AST?</a></li><li class="toc-item toc-level-3" data-v-c35f8c0a><a href="#our-new-tools-unified-and-remark" data-v-c35f8c0a>Our New Tools: unified and remark</a></li><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#step-1-parse-markdown-into-ast" data-v-c35f8c0a>Step 1: Parse Markdown into AST</a></li><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#step-2-from-ast-to-vue-vnodes" data-v-c35f8c0a>Step 2: From AST to Vue VNodes</a></li><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#step-3-encapsulate-vue-component" data-v-c35f8c0a>Step 3: Encapsulate Vue Component</a></li><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#huge-advantages-of-the-ast-approach" data-v-c35f8c0a>Huge Advantages of the AST Approach</a></li><li class="toc-item toc-level-2" data-v-c35f8c0a><a href="#conclusion-evolution-from-functional-implementation-to-architectural-optimization" data-v-c35f8c0a>Conclusion: Evolution from Functional Implementation to Architectural Optimization</a></li><!--]--></ul></nav></aside><!--]--></div></div><footer style="min-height:120px;background-repeat:no-repeat;background-position:center center;background-size:cover;background-image:url(&quot;data:image/svg+xml,%3csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; version=&#39;1.1&#39; xmlns:xlink=&#39;http://www.w3.org/1999/xlink&#39; xmlns:svgjs=&#39;http://svgjs.dev/svgjs&#39; width=&#39;1440&#39; height=&#39;560&#39; preserveAspectRatio=&#39;none&#39; viewBox=&#39;0 0 1440 560&#39;%3e%3cg clip-path=&#39;url(%26quot%3b%23SvgjsClipPath1000%26quot%3b)&#39; fill=&#39;none&#39;%3e%3crect width=&#39;1440&#39; height=&#39;560&#39; x=&#39;0&#39; y=&#39;0&#39; fill=&#39;%230e2a47&#39;%3e%3c/rect%3e%3cpath d=&#39;M1036.18 140.35C1056.41 141.57 1076.7 134.68 1091.22 120.54 1105.92 106.22 1115.17 85.91 1113.03 65.5 1111.04 46.53 1093.97 34.67 1080.78 20.9 1067.1 6.63 1055.91-13.43 1036.18-14.7 1015.89-16.01 999.69 0.26 985.43 14.75 971.33 29.08 956.87 45.39 957.27 65.5 957.67 85.37 973 100.59 987.42 114.26 1001.32 127.45 1017.05 139.19 1036.18 140.35&#39; fill=&#39;%23488fdb&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M1042.18 134.35C1062.41 135.57 1082.7 128.68 1097.22 114.54 1111.92 100.22 1121.17 79.91 1119.03 59.5 1117.04 40.53 1099.97 28.67 1086.78 14.9 1073.1 0.63 1061.91-19.43 1042.18-20.7 1021.89-22.01 1005.69-5.74 991.43 8.75 977.33 23.08 962.87 39.39 963.27 59.5 963.67 79.37 979 94.59 993.42 108.26 1007.32 121.45 1023.05 133.19 1042.18 134.35&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%232164aa&#39;%3e%3c/path%3e%3cpath d=&#39;M1329.38 128.11C1347.9 128.29 1364.02 117.84 1377.77 105.44 1392.47 92.18 1408.11 76.85 1408.18 57.05 1408.25 37.21 1392.17 22.31 1378.11 8.32 1364.1-5.63 1349.15-21.69 1329.38-21.37 1309.77-21.05 1296.2-3.86 1282.23 9.9 1268.09 23.82 1249.8 37.21 1249.73 57.05 1249.66 76.92 1267.08 91.29 1281.91 104.52 1295.62 116.75 1311.01 127.93 1329.38 128.11&#39; fill=&#39;%23488fdb&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M1312.38 112.11C1330.9 112.29 1347.02 101.84 1360.77 89.44 1375.47 76.18 1391.11 60.85 1391.18 41.05 1391.25 21.21 1375.17 6.31 1361.11-7.68 1347.1-21.63 1332.15-37.69 1312.38-37.37 1292.77-37.05 1279.2-19.86 1265.23-6.1 1251.09 7.82 1232.8 21.21 1232.73 41.05 1232.66 60.92 1250.08 75.29 1264.91 88.52 1278.62 100.75 1294.01 111.93 1312.38 112.11&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%232164aa&#39;%3e%3c/path%3e%3cpath d=&#39;M741.74 353.24C757.66 353.74 775.45 353.66 786.31 342.01 796.99 330.55 795.23 313.03 793.75 297.44 792.45 283.69 787.08 271.48 778.6 260.58 768.49 247.6 758.11 232.22 741.74 230.65 724.54 229 708.21 239.56 697.03 252.73 686.65 264.96 684.52 281.41 685.05 297.44 685.56 312.82 688.9 328.51 699.87 339.31 710.77 350.04 726.46 352.76 741.74 353.24&#39; fill=&#39;%232774c6&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M722.74 367.24C738.66 367.74 756.45 367.66 767.31 356.01 777.99 344.55 776.23 327.03 774.75 311.44 773.45 297.69 768.08 285.48 759.6 274.58 749.49 261.6 739.11 246.22 722.74 244.65 705.54 243 689.21 253.56 678.03 266.73 667.65 278.96 665.52 295.41 666.05 311.44 666.56 326.82 669.9 342.51 680.87 353.31 691.77 364.04 707.46 366.76 722.74 367.24&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%231b518b&#39;%3e%3c/path%3e%3cpath d=&#39;M1012.88 606.09C1024.88 606.49 1035.45 599.26 1043.98 590.8 1052.55 582.3 1060.15 571.76 1059.65 559.7 1059.16 547.97 1049.74 539.44 1041.5 531.08 1033.17 522.64 1024.74 512.09 1012.88 512.29 1001.1 512.48 993.01 523.2 985.19 532.01 978.01 540.1 971.05 548.88 970.78 559.7 970.51 570.74 976.37 580.61 983.79 588.79 991.67 597.48 1001.16 605.7 1012.88 606.09&#39; fill=&#39;%23488fdb&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M992.88 599.09C1004.88 599.49 1015.45 592.26 1023.98 583.8 1032.55 575.3 1040.15 564.76 1039.65 552.7 1039.16 540.97 1029.74 532.44 1021.5 524.08 1013.17 515.64 1004.74 505.09 992.88 505.29 981.1 505.48 973.01 516.2 965.19 525.01 958.01 533.1 951.05 541.88 950.78 552.7 950.51 563.74 956.37 573.61 963.79 581.79 971.67 590.48 981.16 598.7 992.88 599.09&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%232164aa&#39;%3e%3c/path%3e%3cpath d=&#39;M1347.76 557.03C1375.03 558.66 1402.09 544.49 1418.86 522.93 1434.16 503.26 1429.17 476.75 1429.58 451.83 1430 426.2 1439.08 396.75 1421.25 378.34 1403.34 359.84 1373.51 366.86 1347.76 367.35 1322.79 367.83 1295.36 364.14 1277.02 381.09 1258.27 398.43 1254.91 426.33 1256.37 451.83 1257.74 475.75 1268.99 496.8 1284.7 514.89 1301.94 534.73 1321.53 555.46 1347.76 557.03&#39; fill=&#39;%23fd3f3f&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M1337.76 564.03C1365.03 565.66 1392.09 551.49 1408.86 529.93 1424.16 510.26 1419.17 483.75 1419.58 458.83 1420 433.2 1429.08 403.75 1411.25 385.34 1393.34 366.84 1363.51 373.86 1337.76 374.35 1312.79 374.83 1285.36 371.14 1267.02 388.09 1248.27 405.43 1244.91 433.33 1246.37 458.83 1247.74 482.75 1258.99 503.8 1274.7 521.89 1291.94 541.73 1311.53 562.46 1337.76 564.03&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%23db0202&#39;%3e%3c/path%3e%3cpath d=&#39;M815.32 552.91C828.51 552.18 841.08 548.41 851.14 539.85 862.18 530.45 872.78 518.53 872.75 504.03 872.72 489.55 861.83 477.96 850.97 468.38 840.92 459.52 828.71 453.94 815.32 453.38 801.28 452.79 786.76 455.61 776.54 465.25 766.06 475.13 761.84 489.63 761.61 504.03 761.38 518.69 764.47 534.17 775.31 544.04 785.81 553.6 801.14 553.69 815.32 552.91&#39; fill=&#39;%232774c6&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M809.32 533.91C822.51 533.18 835.08 529.41 845.14 520.85 856.18 511.45 866.78 499.53 866.75 485.03 866.72 470.55 855.83 458.96 844.97 449.38 834.92 440.52 822.71 434.94 809.32 434.38 795.28 433.79 780.76 436.61 770.54 446.25 760.06 456.13 755.84 470.63 755.61 485.03 755.38 499.69 758.47 515.17 769.31 525.04 779.81 534.6 795.14 534.69 809.32 533.91&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%231b518b&#39;%3e%3c/path%3e%3cpath d=&#39;M547.86 405.44C559.98 404.82 572.43 403.82 581.56 395.82 591.24 387.33 596.49 374.98 597.26 362.12 598.08 348.4 595.08 334.31 585.84 324.14 576.2 313.52 562.12 306.19 547.86 307.71 534.5 309.13 526.72 321.97 517.18 331.44 507.57 340.97 494.33 348.65 493.01 362.12 491.62 376.34 499.32 390.59 510.53 399.45 520.81 407.57 534.78 406.11 547.86 405.44&#39; fill=&#39;%2354c076&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M536.86 424.44C548.98 423.82 561.43 422.82 570.56 414.82 580.24 406.33 585.49 393.98 586.26 381.12 587.08 367.4 584.08 353.31 574.84 343.14 565.2 332.52 551.12 325.19 536.86 326.71 523.5 328.13 515.72 340.97 506.18 350.44 496.57 359.97 483.33 367.65 482.01 381.12 480.62 395.34 488.32 409.59 499.53 418.45 509.81 426.57 523.78 425.11 536.86 424.44&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%23348d50&#39;%3e%3c/path%3e%3cpath d=&#39;M257.24 215.31C282.96 215.02 309.19 208.12 326.78 189.36 343.93 171.07 346.06 144.88 346.78 119.82 347.53 93.72 348.73 65.23 330.9 46.16 312.7 26.69 283.85 22.62 257.24 24.03 232.14 25.36 209.35 36.4 190.98 53.56 171.86 71.43 155.65 93.67 154.72 119.82 153.76 146.75 166.37 172.6 186.09 190.97 205.16 208.73 231.18 215.61 257.24 215.31&#39; fill=&#39;%23fd3f3f&#39; stroke=&#39;none&#39;%3e%3c/path%3e%3cpath d=&#39;M265.24 203.31C290.96 203.02 317.19 196.12 334.78 177.36 351.93 159.07 354.06 132.88 354.78 107.82 355.53 81.72 356.73 53.23 338.9 34.16 320.7 14.69 291.85 10.62 265.24 12.03 240.14 13.36 217.35 24.4 198.98 41.56 179.86 59.43 163.65 81.67 162.72 107.82 161.76 134.75 174.37 160.6 194.09 178.97 213.16 196.73 239.18 203.61 265.24 203.31&#39; fill=&#39;none&#39; stroke-width=&#39;2&#39; stroke=&#39;%23db0202&#39;%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cclipPath id=&#39;SvgjsClipPath1000&#39;%3e%3crect width=&#39;1440&#39; height=&#39;560&#39; x=&#39;0&#39; y=&#39;0&#39;%3e%3c/rect%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e&quot;);" data-v-3c9f8a67 data-v-71f6d0ea><div class="footer-mask" data-v-71f6d0ea></div><div class="footer-content" data-v-71f6d0ea><div data-v-71f6d0ea>©2020 - 2025 By zhullyb</div><!----></div></footer></div><!--]--></div><div id="teleports"></div><script type="application/ld+json" data-nuxt-schema-org="true" data-hid="schema-org-graph">{"@context":"https://schema.org","@graph":[{"@id":"https://zhul.in/en/#website","@type":"WebSite","description":"这里是我的个人博客，专注于分享技术干货、学习心得和生活感悟，涵盖前端开发、后端架构、人工智能、编程技巧、工具推荐等多个领域。我持续更新原创内容，记录成长过程中的思考与收获，致力于帮助更多开发者和技术爱好者提升技能、拓展视野。如果你对技术、产品和互联网行业感兴趣，相信你能在这里找到有价值的知识与灵感。","inLanguage":"en-US","name":"竹林里有冰的博客","url":"https://zhul.in/en/","translationOfWork":{"@id":"https://zhul.in/#website"}},{"@id":"https://zhul.in/en/2025/07/13/vue-markdown-render-improvement-2/#webpage","@type":"WebPage","description":true,"name":"Vue Markdown Rendering Optimization in Practice (Part 2): Farewell to DOM Manipulation, Embrace AST and Functional Rendering","url":"https://zhul.in/en/2025/07/13/vue-markdown-render-improvement-2/","isPartOf":{"@id":"https://zhul.in/en/#website"},"potentialAction":[{"@type":"ReadAction","target":["https://zhul.in/en/2025/07/13/vue-markdown-render-improvement-2/"]}]}]}</script><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/en/2025/07/13/vue-markdown-render-improvement-2/_payload.json?8d0bcaca-2955-4636-a191-89d0572e86fa">[{"state":1,"once":22,"_errors":23,"serverRendered":6,"path":25,"prerenderedAt":26},["Reactive",2],{"$si18n:cached-locale-configs":3,"$si18n:resolved-locale":9,"$snuxt-seo-utils:routeRules":10,"$ssite-config":11},{"zh":4,"en":7},{"fallbacks":5,"cacheable":6},[],true,{"fallbacks":8,"cacheable":6},[],"en",{"head":-1,"seoMeta":-1},{"_priority":12,"currentLocale":16,"defaultLocale":17,"description":18,"env":19,"name":20,"trailingSlash":6,"url":21},{"name":13,"env":14,"url":13,"description":13,"defaultLocale":15,"trailingSlash":13,"currentLocale":15},-3,-15,-2,"en-US","zh-CN","这里是我的个人博客，专注于分享技术干货、学习心得和生活感悟，涵盖前端开发、后端架构、人工智能、编程技巧、工具推荐等多个领域。我持续更新原创内容，记录成长过程中的思考与收获，致力于帮助更多开发者和技术爱好者提升技能、拓展视野。如果你对技术、产品和互联网行业感兴趣，相信你能在这里找到有价值的知识与灵感。","production","竹林里有冰的博客","https://zhul.in/",["Set"],["ShallowReactive",24],{"post-2025-07-13-vue-markdown-render-improvement-2-en":-1,"surround-2025-07-13-vue-markdown-render-improvement-2-en":-1,"randomIndex/2025/07/13/vue-markdown-render-improvement-2/":-1,"language-switch-/en/2025/07/13/vue-markdown-render-improvement-2/-zh":-1,"posts-search-sections":-1},"/en/2025/07/13/vue-markdown-render-improvement-2/",1763660826364]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},"seo-utils":{canonicalQueryWhitelist:["page","sort","filter","search","q","category","tag"],canonicalLowercase:true},i18n:{baseUrl:"",defaultLocale:"zh",rootRedirect:"",redirectStatusCode:302,skipSettingLocaleOnNavigate:false,locales:[{code:"zh",language:"zh-CN",name:"简体中文",_hreflang:"zh-CN",_sitemap:"zh-CN"},{code:"en",language:"en-US",name:"English",_hreflang:"en-US",_sitemap:"en-US"}],detectBrowserLanguage:false,experimental:{localeDetector:"",typedPages:true,typedOptionsAndMessages:false,alternateLinkCanonicalQueries:true,devCache:false,cacheLifetime:"",stripMessagesPayload:false,preload:false,strictSeo:false,nitroContextDetection:true,httpCacheDuration:10},domainLocales:{zh:{domain:""},en:{domain:""}}}},app:{baseURL:"/",buildId:"8d0bcaca-2955-4636-a191-89d0572e86fa",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>