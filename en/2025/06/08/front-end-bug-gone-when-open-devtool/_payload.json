[{"data":1,"prerenderedAt":769},["ShallowReactive",2],{"post-2025-06-08-front-end-bug-gone-when-open-devtool-en":3,"surround-2025-06-08-front-end-bug-gone-when-open-devtool-en":756,"randomIndex/2025/06/08/front-end-bug-gone-when-open-devtool/":273,"language-switch-/en/2025/06/08/front-end-bug-gone-when-open-devtool/-zh":768},{"title":4,"date":5,"path":6,"tags":7,"body":13,"description":103},"Quantum Mechanics in Frontend Development ‚Äî The Bug That Vanishes as Soon as You Open F12","2025-06-08 01:22:13","/2025/06/08/front-end-bug-gone-when-open-devtool",[8,9,10,11,12],"Web","HTML","CSS","JavaScript","Debug",{"type":14,"value":15,"toc":748},"minimark",[16,21,34,49,56,63,71,90,94,97,295,302,308,318,321,327,330,373,381,394,397,468,474,650,670,673,677,683,698,705,712,716,745],[17,18,20],"h2",{"id":19},"first-observation-of-the-frontend-quantum-state-phenomenon","First Observation of the Frontend \"Quantum State\" Phenomenon",[22,23,24,25,29,30,33],"p",{},"This story sounds bizarre‚Äîeven surreal. Half a month ago, while happily coding at my desk (with hotpot and songs in the background üç≤üé§), I stumbled upon a truly uncanny bug. As a bona fide human software engineer, writing bugs is normal‚Äîbut this one defied all intuition: the moment I opened DevTools (F12) to inspect the relevant DOM structure, the bug ",[26,27,28],"em",{},"vanished",". Close DevTools, hit Ctrl+F5 to hard-refresh, and ",[26,31,32],{},"bam","‚Äîthe bug reappeared.",[22,35,36,37,41,42],{},"Below is a live demo embedded via ",[38,39,40],"code",{},"\u003Ciframe>",":\n",[43,44,48],"a",{"href":45,"rel":46},"https://static.031130.xyz/demo/scroll-jump-bug.html",[47],"nofollow","demo",[50,51],"iframe",{"src":45,"width":52,"height":53,"allowFullScreen":54,"loading":55},"100%",500,true,"lazy",[22,57,58],{},[59,60],"img",{"alt":61,"src":62},"‚ÄúHow to Observe‚Äù Guide","https://static.031130.xyz/uploads/2025/06/08/65620d31fce6f.webp",[22,64,65,66,70],{},"This bug left me utterly bewildered. I‚Äôm no physicist‚Äîwhy did ",[67,68,69],"strong",{},"observer effect"," from quantum mechanics show up in my frontend code?! ü§Ø",[72,73,74,84,87],"blockquote",{},[22,75,76,79,80,83],{},[67,77,78],{},"Observer effect",": the act of ",[26,81,82],{},"observation"," inevitably influences the phenomenon being observed.",[22,85,86],{},"In quantum experiments‚Äîfor example, to measure an electron‚Äôs velocity‚Äîyou might fire two photons at it over a time interval. But the first photon already disturbs the electron‚Äôs motion, making the original velocity impossible to determine (Heisenberg‚Äôs uncertainty principle). Similarly, rapidly observing a decaying particle can apparently slow its decay rate.",[22,88,89],{},"‚Äî Wikipedia",[17,91,93],{"id":92},"quantum-fog-browser-mechanics","Quantum Fog ‚ùå ‚Üí Browser Mechanics ‚úÖ",[22,95,96],{},"Let‚Äôs briefly examine the problematic code snippet from the demo:",[98,99,104],"pre",{"className":100,"code":101,"language":102,"meta":103,"style":103},"language-javascript shiki shiki-themes one-light one-dark-pro","if (scrollIndex >= groupLength) {\n  setTimeout(() => {\n    wrapper.style.transition = \"none\";\n    scrollIndex = 0;\n    wrapper.style.transform = `translateY(-${scrollIndex * itemHeight}px)`;\n\n    requestAnimationFrame(() => {\n      wrapper.style.transition = \"transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)\";\n    });\n  }, 500);\n}\n","javascript","",[38,105,106,133,149,179,193,232,238,250,271,277,289],{"__ignoreMap":103},[107,108,111,115,119,123,127,130],"span",{"class":109,"line":110},"line",1,[107,112,114],{"class":113},"sLKXg","if",[107,116,118],{"class":117},"s5ixo"," (",[107,120,122],{"class":121},"sz0mV","scrollIndex",[107,124,126],{"class":125},"s_Sar"," >=",[107,128,129],{"class":121}," groupLength",[107,131,132],{"class":117},") {\n",[107,134,136,140,143,146],{"class":109,"line":135},2,[107,137,139],{"class":138},"sAdtL","  setTimeout",[107,141,142],{"class":117},"(() ",[107,144,145],{"class":113},"=>",[107,147,148],{"class":117}," {\n",[107,150,152,156,159,163,165,169,172,176],{"class":109,"line":151},3,[107,153,155],{"class":154},"s7GmK","    wrapper",[107,157,158],{"class":117},".",[107,160,162],{"class":161},"s2QsP","style",[107,164,158],{"class":117},[107,166,168],{"class":167},"sJa8x","transition",[107,170,171],{"class":125}," =",[107,173,175],{"class":174},"sDhpE"," \"none\"",[107,177,178],{"class":117},";\n",[107,180,182,185,187,191],{"class":109,"line":181},4,[107,183,184],{"class":121},"    scrollIndex",[107,186,171],{"class":125},[107,188,190],{"class":189},"sAGMh"," 0",[107,192,178],{"class":117},[107,194,196,198,200,202,204,207,209,212,216,218,221,224,227,230],{"class":109,"line":195},5,[107,197,155],{"class":154},[107,199,158],{"class":117},[107,201,162],{"class":161},[107,203,158],{"class":117},[107,205,206],{"class":167},"transform",[107,208,171],{"class":125},[107,210,211],{"class":174}," `translateY(-",[107,213,215],{"class":214},"sAOjX","${",[107,217,122],{"class":121},[107,219,220],{"class":125}," *",[107,222,223],{"class":121}," itemHeight",[107,225,226],{"class":214},"}",[107,228,229],{"class":174},"px)`",[107,231,178],{"class":117},[107,233,235],{"class":109,"line":234},6,[107,236,237],{"emptyLinePlaceholder":54},"\n",[107,239,241,244,246,248],{"class":109,"line":240},7,[107,242,243],{"class":138},"    requestAnimationFrame",[107,245,142],{"class":117},[107,247,145],{"class":113},[107,249,148],{"class":117},[107,251,253,256,258,260,262,264,266,269],{"class":109,"line":252},8,[107,254,255],{"class":154},"      wrapper",[107,257,158],{"class":117},[107,259,162],{"class":161},[107,261,158],{"class":117},[107,263,168],{"class":167},[107,265,171],{"class":125},[107,267,268],{"class":174}," \"transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)\"",[107,270,178],{"class":117},[107,272,274],{"class":109,"line":273},9,[107,275,276],{"class":117},"    });\n",[107,278,280,283,286],{"class":109,"line":279},10,[107,281,282],{"class":117},"  }, ",[107,284,285],{"class":189},"500",[107,287,288],{"class":117},");\n",[107,290,292],{"class":109,"line":291},11,[107,293,294],{"class":117},"}\n",[22,296,297,298,301],{},"The requirement was to implement an ",[26,299,300],{},"infinite vertical scrolling"," title list. Three titles are shown at a time; every 2 seconds, the list scrolls up as a group‚Äîthe top item exits view, and a new item enters from below (again, the demo clarifies this visually).",[22,303,304,305,307],{},"When reaching the bottom, we disable CSS transitions, instantly relocate (",[38,306,206],{},") the wrapper back to the ‚Äútop‚Äù of the logical loop (i.e., visually reset to the same three titles), then re-enable transitions‚Äîcreating a seamless infinite loop illusion.",[22,309,310,311,314,315,158],{},"But here‚Äôs the twist: even though we explicitly set ",[38,312,313],{},"transition: none",", the jump ",[26,316,317],{},"still exhibited a transition animation",[22,319,320],{},"Frankly, this was the most despair-inducing bug in my short dev career. Not only was the behavior seemingly supernatural, but searching online felt hopeless‚ÄîI didn‚Äôt even know how to phrase the issue!",[22,322,323],{},[59,324],{"alt":325,"src":326},"This is Xiao Maicha, the senior who got me into frontend development","https://static.031130.xyz/uploads/2025/06/08/475a61b332454.webp",[22,328,329],{},"Out of desperation, I fed the code to ChatGPT-4o‚Äîand got a lifeline:",[72,331,332,351],{},[22,333,334,335,338,339,342,343,346,347,350],{},"The phenomenon you describe ‚Äî ‚Äú",[67,336,337],{},"a jarring upward jump on the 9th scroll",", which ",[67,340,341],{},"disappears when DevTools is open","‚Äù ‚Äî is almost certainly due to ",[67,344,345],{},"frame skipping"," (frame rate fluctuations) or ",[67,348,349],{},"timer precision issues"," in the browser‚Äôs rendering pipeline.",[22,352,353,354,357,358,360,361,364,365,368,369,372],{},"Such bugs commonly arise when combining ",[38,355,356],{},"setInterval","-driven animation with improperly timed style switches (e.g., ",[38,359,168],{}," toggles), causing ",[26,362,363],{},"transition frame skips",". Opening DevTools often ",[67,366,367],{},"forces frame redraws"," or ",[67,370,371],{},"increases timer resolution",", thereby masking the issue.",[17,374,376,377,380],{"id":375},"great-news-requestanimationframe-to-the-rescue","Great News: ",[38,378,379],{},"requestAnimationFrame"," to the Rescue! üéâ",[72,382,383,391],{},[22,384,385,390],{},[67,386,387],{},[38,388,389],{},"window.requestAnimationFrame()"," tells the browser you wish to perform an animation and requests that the browser call a specified function to update an animation before the next repaint.",[22,392,393],{},"‚Äî MDN",[22,395,396],{},"Here‚Äôs the fix suggested by GPT‚Äîsimple yet highly effective:",[98,398,402],{"className":399,"code":400,"language":401,"meta":103,"style":103},"language-diff shiki shiki-themes one-light one-dark-pro","if (scrollIndex >= groupLength) {\n  setTimeout(() => {\n    wrapper.style.transition = \"none\";\n    scrollIndex = 0;\n    wrapper.style.transform = `translateY(-${scrollIndex * itemHeight}px)`;\n\n    requestAnimationFrame(() => {\n+     requestAnimationFrame(() => {\n        wrapper.style.transition = \"transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)\";\n+     });\n    });\n  }, 500);\n}\n","diff",[38,403,404,409,414,419,424,429,433,438,443,448,453,457,463],{"__ignoreMap":103},[107,405,406],{"class":109,"line":110},[107,407,408],{"class":117},"if (scrollIndex >= groupLength) {\n",[107,410,411],{"class":109,"line":135},[107,412,413],{"class":117},"  setTimeout(() => {\n",[107,415,416],{"class":109,"line":151},[107,417,418],{"class":117},"    wrapper.style.transition = \"none\";\n",[107,420,421],{"class":109,"line":181},[107,422,423],{"class":117},"    scrollIndex = 0;\n",[107,425,426],{"class":109,"line":195},[107,427,428],{"class":117},"    wrapper.style.transform = `translateY(-${scrollIndex * itemHeight}px)`;\n",[107,430,431],{"class":109,"line":234},[107,432,237],{"emptyLinePlaceholder":54},[107,434,435],{"class":109,"line":240},[107,436,437],{"class":117},"    requestAnimationFrame(() => {\n",[107,439,440],{"class":109,"line":252},[107,441,442],{"class":174},"+     requestAnimationFrame(() => {\n",[107,444,445],{"class":109,"line":273},[107,446,447],{"class":117},"        wrapper.style.transition = \"transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)\";\n",[107,449,450],{"class":109,"line":279},[107,451,452],{"class":174},"+     });\n",[107,454,455],{"class":109,"line":291},[107,456,276],{"class":117},[107,458,460],{"class":109,"line":459},12,[107,461,462],{"class":117},"  }, 500);\n",[107,464,466],{"class":109,"line":465},13,[107,467,294],{"class":117},[22,469,470,471,473],{},"If nested ",[38,472,379],{}," calls feel confusing, here‚Äôs an equivalent‚Äîbut clearer‚Äîversion:",[98,475,477],{"className":100,"code":476,"language":102,"meta":103,"style":103},"if (scrollIndex >= groupLength) {\n  setTimeout(() => {\n    scrollIndex = 0;\n\n    requestAnimationFrame(() => {\n      // Frame 1: Apply instant jump (no transition)\n      wrapper.style.transition = \"none\";\n      wrapper.style.transform = `translateY(-${scrollIndex * itemHeight}px)`;\n\n      // Enqueue next frame\n      requestAnimationFrame(() => {\n        // Frame 2: Re-enable smooth transition\n        wrapper.style.transition = \"transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)\";\n      });\n    });\n  }, 500);\n}\n",[38,478,479,493,503,513,517,527,533,551,581,585,590,601,606,625,631,636,645],{"__ignoreMap":103},[107,480,481,483,485,487,489,491],{"class":109,"line":110},[107,482,114],{"class":113},[107,484,118],{"class":117},[107,486,122],{"class":121},[107,488,126],{"class":125},[107,490,129],{"class":121},[107,492,132],{"class":117},[107,494,495,497,499,501],{"class":109,"line":135},[107,496,139],{"class":138},[107,498,142],{"class":117},[107,500,145],{"class":113},[107,502,148],{"class":117},[107,504,505,507,509,511],{"class":109,"line":151},[107,506,184],{"class":121},[107,508,171],{"class":125},[107,510,190],{"class":189},[107,512,178],{"class":117},[107,514,515],{"class":109,"line":181},[107,516,237],{"emptyLinePlaceholder":54},[107,518,519,521,523,525],{"class":109,"line":195},[107,520,243],{"class":138},[107,522,142],{"class":117},[107,524,145],{"class":113},[107,526,148],{"class":117},[107,528,529],{"class":109,"line":234},[107,530,532],{"class":531},"sW2Sy","      // Frame 1: Apply instant jump (no transition)\n",[107,534,535,537,539,541,543,545,547,549],{"class":109,"line":240},[107,536,255],{"class":154},[107,538,158],{"class":117},[107,540,162],{"class":161},[107,542,158],{"class":117},[107,544,168],{"class":167},[107,546,171],{"class":125},[107,548,175],{"class":174},[107,550,178],{"class":117},[107,552,553,555,557,559,561,563,565,567,569,571,573,575,577,579],{"class":109,"line":252},[107,554,255],{"class":154},[107,556,158],{"class":117},[107,558,162],{"class":161},[107,560,158],{"class":117},[107,562,206],{"class":167},[107,564,171],{"class":125},[107,566,211],{"class":174},[107,568,215],{"class":214},[107,570,122],{"class":121},[107,572,220],{"class":125},[107,574,223],{"class":121},[107,576,226],{"class":214},[107,578,229],{"class":174},[107,580,178],{"class":117},[107,582,583],{"class":109,"line":273},[107,584,237],{"emptyLinePlaceholder":54},[107,586,587],{"class":109,"line":279},[107,588,589],{"class":531},"      // Enqueue next frame\n",[107,591,592,595,597,599],{"class":109,"line":291},[107,593,594],{"class":138},"      requestAnimationFrame",[107,596,142],{"class":117},[107,598,145],{"class":113},[107,600,148],{"class":117},[107,602,603],{"class":109,"line":459},[107,604,605],{"class":531},"        // Frame 2: Re-enable smooth transition\n",[107,607,608,611,613,615,617,619,621,623],{"class":109,"line":465},[107,609,610],{"class":154},"        wrapper",[107,612,158],{"class":117},[107,614,162],{"class":161},[107,616,158],{"class":117},[107,618,168],{"class":167},[107,620,171],{"class":125},[107,622,268],{"class":174},[107,624,178],{"class":117},[107,626,628],{"class":109,"line":627},14,[107,629,630],{"class":117},"      });\n",[107,632,634],{"class":109,"line":633},15,[107,635,276],{"class":117},[107,637,639,641,643],{"class":109,"line":638},16,[107,640,282],{"class":117},[107,642,285],{"class":189},[107,644,288],{"class":117},[107,646,648],{"class":109,"line":647},17,[107,649,294],{"class":117},[22,651,652,653,656,657,659,660,662,663,666,667,669],{},"The core idea: we must ",[26,654,655],{},"guarantee"," that setting the new ",[38,658,206],{}," (the ‚Äúteleport‚Äù) and re-enabling ",[38,661,168],{}," happen in ",[26,664,665],{},"separate animation frames",". Two nested ",[38,668,379],{}," calls ensure exactly that.",[50,671],{"src":672,"width":52,"height":53,"allowFullScreen":54,"loading":55},"https://static.031130.xyz/demo/scroll-jump-bug-fixed.html",[17,674,676],{"id":675},"taming-the-quantum-state-a-new-skill-for-frontend-developers","Taming the Quantum State: A New Skill for Frontend Developers",[22,678,679,680,682],{},"With double ",[38,681,379],{},", we‚Äôve successfully tamed this ‚Äúquantum‚Äù bug. Now, regardless of whether DevTools is open, the animation behaves consistently‚Äîno more vanishing acts.",[22,684,685,686,690,691,694,695,697],{},"So it turns out: in frontend development, we need not just JavaScript expertise‚Äî",[687,688,689],"del",{},"but perhaps a dash of quantum mechanics, too",". üòâ\nNext time you encounter a bug that ‚Äúcollapses upon observation‚Äù, try this ",[67,692,693],{},"‚Äúquantum entanglement solution‚Äù",": double ",[38,696,379],{},"‚Äîit might just decohere your bug from a probabilistic ‚Äúquantum state‚Äù into a deterministic ‚Äúclassical state‚Äù.",[22,699,700,701,704],{},"And if you‚Äôve battled even weirder bugs‚Äîplease share! After all, in the universe of code, we never know what exotic form the next bug will take. Perhaps, that‚Äôs precisely where the ",[26,702,703],{},"fun"," of programming lies. üêõ‚ú®",[72,706,707],{},[22,708,709],{},[26,710,711],{},"This article was co-authored with assistance from ChatGPT and DeepSeek‚Äîbut the bug? Sadly, 100% real (and tearful).",[17,713,715],{"id":714},"see-also","See Also",[717,718,719,727,737],"ul",{},[720,721,722],"li",{},[43,723,726],{"href":724,"rel":725},"https://en.wikipedia.org/wiki/Observer_effect_(physics)",[47],"Observer Effect ‚Äî Wikipedia",[720,728,729],{},[43,730,733,736],{"href":731,"rel":732},"https://developer.mozilla.org/en-US/docs/Web/API/Window/requestAnimationFrame",[47],[38,734,735],{},"Window.requestAnimationFrame()"," ‚Äî MDN Web Docs",[720,738,739,744],{},[43,740,743],{"href":741,"rel":742},"https://www.ruanyifeng.com/blog/2015/09/web-page-performance-in-depth.html",[47],"A Deep Dive into Web Page Performance ‚Äî Ruan Yifeng‚Äôs Blog","\"",[162,746,747],{},"html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sz0mV, html code.shiki .sz0mV{--shiki-default:#383A42;--shiki-dark:#E06C75}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .s7GmK, html code.shiki .s7GmK{--shiki-default:#383A42;--shiki-dark:#E5C07B}html pre.shiki code .s2QsP, html code.shiki .s2QsP{--shiki-default:#E45649;--shiki-dark:#E5C07B}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sAOjX, html code.shiki .sAOjX{--shiki-default:#CA1243;--shiki-dark:#C678DD}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}",{"title":103,"searchDepth":135,"depth":135,"links":749},[750,751,752,754,755],{"id":19,"depth":135,"text":20},{"id":92,"depth":135,"text":93},{"id":375,"depth":135,"text":753},"Great News: requestAnimationFrame to the Rescue! üéâ",{"id":675,"depth":135,"text":676},{"id":714,"depth":135,"text":715},[757,763],{"title":758,"path":759,"stem":760,"date":761,"lang":762,"children":-1},"Migration from node-sass to dart-sass: A Troubleshooting Chronicle","/2025/07/05/node-sass-migration-to-dart-sass","posts/en/node-sass-migration-to-dart-sass","2025-07-05 17:57:02","en",{"title":764,"path":765,"stem":766,"date":767,"lang":762,"children":-1},"In 2025, How to Choose the Right Video Compression Algorithm for Web Pages?","/2025/06/02/choosing-the-right-video-compression-format-for-web-in-2025","posts/en/choosing-the-right-video-compression-format-for-web-in-2025","2025-06-02 20:59:10","/2025/06/08/front-end-bug-gone-when-open-devtool/",1766526715839]