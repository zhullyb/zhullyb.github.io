<!DOCTYPE html><html  lang="en-US"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>SSH to the Rescue - Running APT Updates on Internal Network Servers via SSH Tunnels | 竹林里有冰的博客</title><link rel="preconnect" href="https://static.031130.xyz" crossorigin><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"><style>[data-v-6c2349ae] .markdown-body{font-family:inherit;font-size:inherit}[data-v-6c2349ae] .markdown-body h2,[data-v-6c2349ae] .markdown-body h3,[data-v-6c2349ae] .markdown-body h4,[data-v-6c2349ae] .markdown-body h5,[data-v-6c2349ae] .markdown-body h6{scroll-margin-top:78px}[data-v-6c2349ae] .markdown-body h2>a,[data-v-6c2349ae] .markdown-body h3>a,[data-v-6c2349ae] .markdown-body h4>a,[data-v-6c2349ae] .markdown-body h5>a,[data-v-6c2349ae] .markdown-body h6>a{color:unset}@media(prefers-color-scheme:dark){[data-v-6c2349ae] .markdown-body{--bgColor-default:#252d38;--bgColor-muted:#181c27}[data-v-6c2349ae] .markdown-body .shiki,[data-v-6c2349ae] .markdown-body .shiki span{color:var(--shiki-dark)!important}}aside[data-v-6c2349ae]{position:sticky;top:78px}[data-v-6c2349ae] #waline{margin-top:3rem}.article-end-hr[data-v-6c2349ae]{border:none;border-top:1px solid #e1e4e8;margin:1rem 0}@media(prefers-color-scheme:dark){.article-end-hr[data-v-6c2349ae]{border-color:#444c56}}.tags[data-v-6c2349ae]{margin:1rem 0}.tags[data-v-6c2349ae] *{vertical-align:middle}.tags svg[data-v-6c2349ae]{font-size:.9em}.tags a[data-v-6c2349ae]{display:inline-block;margin-left:.2rem}.tags a[data-v-6c2349ae]:hover{color:#007bff}</style><style>.content-wrapper[data-v-40d23075]{margin-bottom:40px;margin-top:40px}@media(min-width:1025px){.content-wrapper[data-v-40d23075]{display:flex;justify-content:space-around}.content-wrapper .side[data-v-40d23075]{width:20%}}@media(max-width:1024px){.content-wrapper[data-v-40d23075]{margin:30px}}main[data-v-40d23075]{min-height:calc(40vh - 120px);width:50%}@media(max-width:1024px){main[data-v-40d23075]{width:unset}}</style><style>header[data-v-c4c9a290]{align-items:center;box-shadow:0 2px 4px #0000001a;display:flex;flex-direction:column;height:62px;justify-content:center;padding-bottom:16px;padding-top:20px;position:fixed;top:0;transition:background-color .3s ease,height .3s ease,padding-top .3s ease,backdrop-filter .3s ease;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%;z-index:2}header.scrolled[data-v-c4c9a290]{height:58px;padding-bottom:16px;padding-top:16px}header.scrolled[data-v-c4c9a290],header.show-mobile-menu[data-v-c4c9a290]{-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#3c4658b3}header.show-mobile-menu[data-v-c4c9a290]{height:-moz-fit-content;height:fit-content}.header-container[data-v-c4c9a290]{color:#fff;min-width:70%}@media(max-width:1024px){.header-container[data-v-c4c9a290]{min-width:100%;padding-left:16px;padding-right:16px}}.header-container .header-title[data-v-c4c9a290]{font-weight:700;text-shadow:0 0 10px rgba(0,0,0,.3)}.header[data-v-c4c9a290]{justify-content:space-between}.header[data-v-c4c9a290],.header-right[data-v-c4c9a290]{align-items:center;display:flex}.header-right[data-v-c4c9a290]{gap:16px}.mobile-menu-dropdown[data-v-c4c9a290]{border-radius:8px;display:flex;flex-direction:column;padding:8px 0;width:100%}.mobile-menu-dropdown a[data-v-c4c9a290]{font-size:18px;font-weight:500;padding:12px 24px;text-align:center}.mobile-menu-dropdown a[data-v-c4c9a290],a[data-v-c4c9a290]{color:#fff;text-decoration:none}.lang-switch[data-v-c4c9a290]{align-items:center;background:#ffffff1a;border:1px solid hsla(0,0%,100%,.3);border-radius:999px;color:#fff;cursor:pointer;display:flex;font-size:14px;justify-content:center;padding:6px 12px;transition:background .2s ease,border-color .2s ease}.lang-switch[data-v-c4c9a290]:hover{background:#fff3;border-color:#fff9}.search-trigger[data-v-c4c9a290]{align-items:center;background:#ffffff1a;border:1px solid hsla(0,0%,100%,.3);border-radius:999px;color:#fff;cursor:pointer;display:flex;font-size:14px;gap:6px;padding:6px 12px;transition:background .2s ease,border-color .2s ease}.search-trigger[data-v-c4c9a290]:hover{background:#fff3;border-color:#fff9}.search-trigger span[aria-hidden=true][data-v-c4c9a290]{font-size:16px;line-height:1}@media(max-width:1024px){.search-trigger[data-v-c4c9a290]{display:none}}</style><style>.post-navigation[data-v-a35c130b]{display:flex;flex-wrap:wrap;gap:1rem}.nav-button[data-v-a35c130b]{align-items:center;border:1px solid #e1e4e8;color:#24292e;cursor:pointer;display:flex;flex:0 1 calc(50% - .5rem);gap:1rem;max-width:calc(50% - .5rem);min-width:280px;padding:1.25rem 1.5rem;text-decoration:none;transition:border-color .2s ease}@media(prefers-color-scheme:dark){.nav-button[data-v-a35c130b]{border:1px solid #444c5a;color:#c9d1d9}}.nav-button[data-v-a35c130b]:hover{border-color:#007bff}.nav-button:hover .nav-arrow[data-v-a35c130b],.nav-button:hover .nav-label[data-v-a35c130b],.nav-button:hover .nav-title[data-v-a35c130b]{color:#007bff}.nav-button.prev[data-v-a35c130b]{margin-right:auto}.nav-button.prev .nav-content[data-v-a35c130b]{text-align:left}.nav-button.next[data-v-a35c130b]{flex-direction:row-reverse;margin-left:auto}.nav-button.next .nav-content[data-v-a35c130b]{text-align:right}.nav-arrow[data-v-a35c130b]{color:#6a737d;flex-shrink:0;font-weight:600;line-height:1}.nav-content[data-v-a35c130b]{display:flex;flex:1;flex-direction:column;gap:.5rem;min-width:0}.nav-label[data-v-a35c130b]{color:#6a737d;font-size:.875rem;font-weight:500}.nav-title[data-v-a35c130b]{display:-webkit-box;font-size:1rem;font-weight:600;-webkit-line-clamp:2;line-clamp:2;overflow:hidden;text-overflow:ellipsis;transition:color .2s ease;-webkit-box-orient:vertical;color:#24292e;line-height:1.4}@media(prefers-color-scheme:dark){.nav-title[data-v-a35c130b]{color:#c9d1d9}}@media(max-width:720px){.post-navigation[data-v-a35c130b]{flex-direction:column;gap:.75rem}.nav-button[data-v-a35c130b]{min-width:100%}}</style><style>#waline{--waline-theme-color:#3f72af;--waline-active-color:#173f70}#waline .wl-panel{border-radius:0;margin:0}@media(prefers-color-scheme:dark){#waline .wl-panel{border-color:#444c5a}}#waline .wl-btn{border-radius:0}</style><style>.toc[data-v-bdce45f2]{background:#fafafa;border:1px solid #e5e5e5;max-height:calc(100vh - 120px);overflow-y:auto;padding:1.25rem}@media(prefers-color-scheme:dark){.toc[data-v-bdce45f2]{background:#181c27;border:1px solid #444c5a}}@media(max-width:1024px){.toc[data-v-bdce45f2]{display:none}}.toc-title[data-v-bdce45f2]{border-bottom:1px solid #e5e5e5;color:#333;font-size:1rem;font-weight:600;margin-bottom:1rem;padding-bottom:.5rem}@media(prefers-color-scheme:dark){.toc-title[data-v-bdce45f2]{border-bottom:1px solid #444c5a;color:#fff}}.toc-list[data-v-bdce45f2]{list-style:none;margin:0;padding:0}.toc-item[data-v-bdce45f2]{line-height:1.5;margin:.3rem 0;max-height:100px;opacity:1;overflow:hidden;transition:max-height .25s ease,opacity .25s ease,margin .25s ease}.toc-item.collapsed[data-v-bdce45f2]{margin:0;max-height:0;opacity:0}.toc-item a[data-v-bdce45f2]{color:#666;display:block;font-size:.875rem;padding:.35rem .5rem;text-decoration:none;transition:color .2s,background-color .2s}@media(prefers-color-scheme:dark){.toc-item a[data-v-bdce45f2]{color:#ccc}}.toc-item a[data-v-bdce45f2]:hover{background-color:#3b82f614;color:#007bff}.toc-item.active a[data-v-bdce45f2]{background-color:#3b82f61f;color:#007bff;font-weight:500}.toc-item.toc-level-1[data-v-bdce45f2]{padding-left:0}.toc-item.toc-level-1 a[data-v-bdce45f2]{font-weight:500}.toc-item.toc-level-2[data-v-bdce45f2]{padding-left:.75rem}.toc-item.toc-level-3[data-v-bdce45f2]{padding-left:1.5rem}.toc-item.toc-level-3 a[data-v-bdce45f2]{font-size:.85rem}.toc-item.toc-level-4[data-v-bdce45f2]{padding-left:2.25rem}.toc-item.toc-level-4 a[data-v-bdce45f2]{font-size:.825rem}.toc-item.toc-level-5[data-v-bdce45f2]{padding-left:3rem}.toc-item.toc-level-5 a[data-v-bdce45f2]{font-size:.8rem}.toc-item.toc-level-6[data-v-bdce45f2]{padding-left:3.75rem}.toc-item.toc-level-6 a[data-v-bdce45f2]{font-size:.775rem}.toc[data-v-bdce45f2]::-webkit-scrollbar{width:5px}.toc[data-v-bdce45f2]::-webkit-scrollbar-track{background:transparent}.toc[data-v-bdce45f2]::-webkit-scrollbar-thumb{background:#d1d5db}.toc[data-v-bdce45f2]::-webkit-scrollbar-thumb:hover{background:#9ca3af}</style><style>footer[data-v-5bcc226c]{color:#fff;justify-content:center;position:relative;width:100%}.footer-content[data-v-5bcc226c],footer[data-v-5bcc226c]{align-items:center;display:flex}.footer-content[data-v-5bcc226c]{flex-direction:column;gap:8px;padding:20px;z-index:1}.footer-mask[data-v-5bcc226c]{background:linear-gradient(180deg,#0000004d,#00000080);inset:0;position:absolute}@media(prefers-color-scheme:dark){.footer-mask[data-v-5bcc226c]{background:linear-gradient(180deg,#0009,#000c)}}.social[data-v-5bcc226c]{gap:16px;margin-bottom:12px}.social[data-v-5bcc226c],.social-icons[data-v-5bcc226c]{align-items:center;display:flex}.social-icons[data-v-5bcc226c]{background-color:#ffffff1a;border-radius:50%;cursor:pointer;height:48px;justify-content:center;width:48px}.social-icons[data-v-5bcc226c]:hover{background-color:#fff3}.social-icons svg[data-v-5bcc226c]{fill:#fff;height:20px;width:20px}</style><style>.promo-card[data-v-f771117d]{background:#0003;border:.5px solid #eee;box-sizing:border-box;display:flex;flex-direction:column;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif;gap:16px;max-width:310px;padding:24px;zoom:.8}.card-header[data-v-f771117d]{justify-content:space-between}.card-header[data-v-f771117d],.header-left[data-v-f771117d]{align-items:center;display:flex}.header-left[data-v-f771117d]{gap:8px}.logo-img[data-v-f771117d]{display:block;height:auto;width:100%}.logo-yxvm-container[data-v-f771117d]{margin-left:2px;width:100px}.plus-separator[data-v-f771117d]{color:#fff;font-size:20px;font-weight:700}.logo-nodeseek-container[data-v-f771117d]{width:40px}.github-link[data-v-f771117d]{color:#fff;display:block;transition:color .2s ease-in-out;width:20px}.github-link[data-v-f771117d]:hover{color:#38bdf8}.github-icon[data-v-f771117d]{fill:currentColor;height:100%;width:100%}.card-title[data-v-f771117d]{color:#fff;font-size:18px;font-weight:500;line-height:1.2;margin:0;text-transform:capitalize}.card-description[data-v-f771117d]{color:#94a3b8;font-size:14px;line-height:1.5;margin:0}.card-footer[data-v-f771117d]{color:#e4e4e7;display:flex;font-size:13px;font-weight:500;gap:4px;justify-content:flex-end}</style><style>.prose-img-wrapper[data-v-4f488808]{display:inline-block;position:relative}.prose-img[data-v-4f488808]{border-radius:4px;box-shadow:0 1px 4px #00000014;max-width:100%;transition:box-shadow .2s}.prose-img[data-v-4f488808]:hover{box-shadow:0 4px 16px #0000002e}.prose-img-caption[data-v-4f488808]{color:#666;display:block;font-size:.875rem;font-style:italic;margin-top:.25rem;text-align:center}.prose-img-preview-mask[data-v-4f488808]{align-items:center;animation:fadeIn-4f488808 .2s;background:#000000d9;display:flex;justify-content:center;inset:0;position:fixed;z-index:9999}.prose-img-preview-img[data-v-4f488808]{background:#fff;border-radius:8px;box-shadow:0 8px 32px #0006;max-height:90vh;max-width:90vw;will-change:transform}.prose-img-preview-img[data-v-4f488808],.prose-img-preview-scale-indicator[data-v-4f488808]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.prose-img-preview-scale-indicator[data-v-4f488808]{background:#00000080;border-radius:4px;bottom:32px;color:#fff;font-size:1rem;left:50%;padding:2px 10px;pointer-events:none;position:absolute;transform:translate(-50%);z-index:10001}.prose-img-preview-close[data-v-4f488808]{background:none;border:none;color:#fff;cursor:pointer;font-size:2.5rem;line-height:1;padding:0 .5rem;position:absolute;right:48px;top:32px;transition:color .2s;z-index:10000}.prose-img-preview-close[data-v-4f488808]:hover{color:#ffb3b3}@keyframes fadeIn-4f488808{0%{opacity:0}to{opacity:1}}</style><style>.prose-heading[data-v-a22a06c0]{position:relative}.prose-heading:hover .heading-anchor[data-v-a22a06c0]{opacity:1}.heading-anchor[data-v-a22a06c0]{color:#3b82f6;font-weight:400;margin-left:.5rem;opacity:0;text-decoration:none;transition:opacity .2s,color .2s}.heading-anchor[data-v-a22a06c0]:hover{color:#007bff}.anchor-icon[data-v-a22a06c0]{display:inline-block}.prose-h2[data-v-a22a06c0]{margin:1.75rem 0 .875rem}</style><style>pre[data-v-a9c19cc1]{font-size:14px}</style><style>@media(max-width:1024px){.pc-nav[data-v-49e970ab]{display:none}}.mobile-nav[data-v-49e970ab]{cursor:pointer;display:none}@media(max-width:1024px){.mobile-nav[data-v-49e970ab]{align-items:center;display:flex;justify-content:center}}.mobile-nav .container[data-v-49e970ab]{align-items:center;display:flex;flex-direction:column;height:20px;justify-content:center;margin:0 auto;width:25px}.mobile-nav-item[data-v-49e970ab]{background:#fff;border-radius:2px;flex-shrink:0;height:2px;margin:2.5px 0;width:100%}a[data-v-49e970ab]{color:#fff;margin-left:16px;margin-right:16px;text-decoration:none}</style><style>.banner[data-v-0f1d2f14]{height:60vh;width:100%}.mask[data-v-0f1d2f14]{align-items:center;background:#0000001a;display:flex;height:100%;justify-content:center;width:100%}@media(prefers-color-scheme:dark){.mask[data-v-0f1d2f14]{background:#00000080}}.title-container[data-v-0f1d2f14]{align-items:center;color:#fff;display:flex;height:100%;justify-content:center;margin:auto;width:50%}@media(max-width:1024px){.title-container[data-v-0f1d2f14]{width:80%}}.title[data-v-0f1d2f14]{color:#fff;margin:auto auto auto 0;padding-top:58px;text-shadow:0 0 5px rgba(0,0,0,.7)}.title h1[data-v-0f1d2f14]{font-size:32px;font-weight:700;margin:0}@media(max-width:720px){.title h1[data-v-0f1d2f14]{font-size:24px}}.title p[data-v-0f1d2f14]{font-size:16px;font-weight:300;margin:8px 0}@media(max-width:1024px){.title[data-v-0f1d2f14]{margin:auto;text-align:center}}</style><style>.search-overlay-enter-active[data-v-63592d71],.search-overlay-leave-active[data-v-63592d71]{transition:opacity .2s ease}.search-overlay-enter-from[data-v-63592d71],.search-overlay-leave-to[data-v-63592d71]{opacity:0}.search-overlay[data-v-63592d71]{align-items:flex-start;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);background:#00000059;display:flex;justify-content:center;inset:0;padding:120px 16px 40px;position:fixed;z-index:2000}.search-overlay__panel[data-v-63592d71]{background:#fffffff2;box-shadow:0 18px 50px #00000040;display:flex;flex-direction:column;max-height:calc(100vh - 160px);overflow:hidden;width:min(720px,100%)}.search-overlay__header[data-v-63592d71]{align-items:center;border-bottom:1px solid rgba(0,0,0,.05);display:flex;gap:12px;padding:16px 20px 16px 16px}.search-overlay__input[data-v-63592d71]{background:#ffffffd9;border:1px solid rgba(0,0,0,.12);flex:1;font-size:16px;padding:12px 16px;transition:border-color .2s ease}.search-overlay__input[data-v-63592d71]:focus{border-color:#007bff;outline:none}.search-overlay__close[data-v-63592d71]{background:transparent;border:none;border-radius:50%;color:#0000008c;cursor:pointer;font-size:24px;height:32px;line-height:24px;width:32px}.search-overlay__close[data-v-63592d71]:hover{color:#000c}.search-overlay__body[data-v-63592d71]{overflow-y:auto;padding:8px 0 20px}.search-overlay__state[data-v-63592d71]{color:#00000094;margin:20px;text-align:center}.search-overlay__count[data-v-63592d71]{color:#000000b3;font-weight:600;margin:12px 24px 0}.search-overlay__list[data-v-63592d71]{display:flex;flex-direction:column;gap:12px;list-style:none;margin:16px 0 0;padding:0 8px 8px}.search-overlay__item[data-v-63592d71]{background:#ffffffe6;border-radius:12px;box-shadow:0 8px 18px #00000014;transition:transform .2s ease}.search-overlay__item[data-v-63592d71]:hover{transform:translateY(-2px)}.search-overlay__link[data-v-63592d71]{color:inherit;display:block;padding:16px 20px;text-decoration:none}.search-overlay__item-title[data-v-63592d71]{color:#007bff;font-size:18px;font-weight:700;margin:0}.search-overlay__item-meta[data-v-63592d71]{color:#0009;font-size:13px;margin:8px 0 0}.search-overlay__item-meta span[data-v-63592d71]{color:#0000008c}.search-overlay__item-snippet[data-v-63592d71]{color:#000c;font-size:14px;line-height:1.6;margin:12px 0 0}@media(max-width:768px){.search-overlay[data-v-63592d71]{padding:80px 12px 20px}.search-overlay__panel[data-v-63592d71]{max-height:calc(100vh - 120px)}}</style><link rel="stylesheet" href="/_nuxt/entry.7EIxnZzq.css" crossorigin><link rel="stylesheet" href="/_nuxt/DefaultLayout.Dgtf9Uq0.css" crossorigin><link rel="preload" as="fetch" crossorigin="anonymous" href="/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/_payload.json?58f3fc24-dbca-4691-a064-611e839dcd7d"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CEDVQc9y.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/fxplNDXR.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C8FUS-Aj.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DkxpNR9K.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BcvbHrNU.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/D4UzeKSc.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BOCDyyRD.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ZpXFZHIA.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/p6Se_rxJ.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/jcsf-Bft.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CYDcYK-2.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BlcBjEGb.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C8jnMsMq.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/1NC641Nf.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/58f3fc24-dbca-4691-a064-611e839dcd7d.json"><script src="/js/u.js" defer data-website-id="5346b89b-f4bf-4593-971d-1f41a1118bc1"></script><link rel="prefetch" as="style" href="https://s4.zstatic.net/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"><link rel="alternate" type="application/rss+xml" title="竹林里有冰的博客 RSS Feed (Chinese)" href="https://zhul.in/rss.xml"><link rel="alternate" type="application/atom+xml" title="竹林里有冰的博客 Atom Feed (English)" href="https://zhul.in/en/rss.xml"><meta name="description" content="This all started when Jinghong's former technical director complained that the school's internal network servers couldn't connect to the external network, making APT installation and updates extremely difficult. He had to manually download packages from the source, along with their dependencies, and the dependencies of those dependencies... and then transfer all these packages to the server via sftp/rsync or similar methods for manual installation."><meta property="og:type" content="website"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="keywords" content="Apt,Network,OpenSSH,Caddy,Linux,Debian"><script type="module" src="/_nuxt/CEDVQc9y.js" crossorigin></script><meta name="twitter:card" content="summary_large_image"><meta property="og:title" data-infer="" content="SSH to the Rescue - Running APT Updates on Internal Network Servers via SSH Tunnels | 竹林里有冰的博客"><meta property="og:description" data-infer="" content="This all started when Jinghong's former technical director complained that the school's internal network servers couldn't connect to the external network, making APT installation and updates extremely difficult. He had to manually download packages from the source, along with their dependencies, and the dependencies of those dependencies... and then transfer all these packages to the server via sftp/rsync or similar methods for manual installation."><link rel="canonical" href="https://zhul.in/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/"><meta property="og:url" content="https://zhul.in/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="竹林里有冰的博客"></head><body><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><div id="__nuxt"><!--[--><div></div><div data-v-6c2349ae data-v-40d23075><!--[--><header class="" data-v-c4c9a290><div class="header-container" data-v-c4c9a290><div class="header" data-v-c4c9a290><a href="/en/" class="header-title" data-v-c4c9a290>Zhullyb&#39;s Blog</a><div class="header-right" data-v-c4c9a290><nav data-v-c4c9a290 data-v-49e970ab><div class="pc-nav" data-v-49e970ab><!--[--><a href="/en/" class="" data-v-49e970ab>Home</a><a href="/en/archives/" class="" data-v-49e970ab>Archives</a><a href="/en/tags/" class="" data-v-49e970ab>Tags</a><a href="/en/links/" class="" data-v-49e970ab>Links</a><a href="/en/about/" class="" data-v-49e970ab>About</a><!--]--></div><div class="mobile-nav" data-v-49e970ab><div class="container" data-v-49e970ab><!--[--><div class="mobile-nav-item" data-v-49e970ab></div><div class="mobile-nav-item" data-v-49e970ab></div><div class="mobile-nav-item" data-v-49e970ab></div><!--]--></div></div></nav><a href="/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/" class="lang-switch" aria-label="Switch Language" data-v-c4c9a290><span class="lang-switch__label" data-v-c4c9a290>中</span></a><button type="button" class="search-trigger" aria-label="Search" data-v-c4c9a290><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-c4c9a290><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.47 6.47 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"></path></svg><span class="search-trigger__label" data-v-c4c9a290>Search</span></button></div></div></div><!----></header><div class="banner" style="background-color:#ee5522;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;100&#39; height=&#39;100&#39; viewBox=&#39;0 0 200 200&#39;%3E%3Cdefs%3E%3ClinearGradient id=&#39;a&#39; gradientUnits=&#39;userSpaceOnUse&#39; x1=&#39;100&#39; y1=&#39;33&#39; x2=&#39;100&#39; y2=&#39;-3&#39;%3E%3Cstop offset=&#39;0&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;0&#39;/%3E%3Cstop offset=&#39;1&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;1&#39;/%3E%3C/linearGradient%3E%3ClinearGradient id=&#39;b&#39; gradientUnits=&#39;userSpaceOnUse&#39; x1=&#39;100&#39; y1=&#39;135&#39; x2=&#39;100&#39; y2=&#39;97&#39;%3E%3Cstop offset=&#39;0&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;0&#39;/%3E%3Cstop offset=&#39;1&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;1&#39;/%3E%3C/linearGradient%3E%3C/defs%3E%3Cg fill=&#39;%23d23d09&#39; fill-opacity=&#39;0.6&#39;%3E%3Crect x=&#39;100&#39; width=&#39;100&#39; height=&#39;100&#39;/%3E%3Crect y=&#39;100&#39; width=&#39;100&#39; height=&#39;100&#39;/%3E%3C/g%3E%3Cg fill-opacity=&#39;0.5&#39;%3E%3Cpolygon fill=&#39;url(%23a)&#39; points=&#39;100 30 0 0 200 0&#39;/%3E%3Cpolygon fill=&#39;url(%23b)&#39; points=&#39;100 100 0 130 0 100 200 100 200 130&#39;/%3E%3C/g%3E%3C/svg%3E&quot;);" data-v-c4c9a290 data-v-0f1d2f14><div class="mask" data-v-0f1d2f14><div class="title-container" data-v-0f1d2f14><div class="title" data-v-0f1d2f14><h1 data-v-0f1d2f14>SSH to the Rescue - Running APT Updates on Internal Network Servers via SSH Tunnels</h1><!----></div></div></div></div><!--teleport start--><!--teleport end--><!--]--><div class="content-wrapper" data-v-40d23075><div class="before-main side" data-v-40d23075><!--[--><!--]--></div><main data-v-40d23075><!--[--><article class="markdown-body" data-v-6c2349ae><p><!--[-->This all started when Jinghong&#39;s <a href="https://blog.cnpatrickstar.com/" rel="nofollow"><!--[-->former technical director<!--]--></a> complained that the school&#39;s internal network servers couldn&#39;t connect to the external network, making APT installation and updates extremely difficult. He had to manually download packages from the source, along with their dependencies, and the dependencies of those dependencies... and then transfer all these packages to the server via sftp/rsync or similar methods for manual installation.<!--]--></p><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/0447b7d64886a.webp" alt="" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><!----><!--teleport start--><!--teleport end--></span><!--]--></p><p><!--[-->Thus, this article was born. We can use Caddy (Nginx works too, of course) on our local machine to reverse proxy an APT mirror site, establish port forwarding through an SSH tunnel, allowing the internal network server to access the local Caddy server and thereby reach the external mirror site.<!--]--></p><h2 id="prerequisites" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Prerequisites<!--]--><a href="#prerequisites" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><ul><!--[--><li><!--[-->Your control machine (your own computer) can directly connect to the computer via SSH (possibly using some network tools), rather than first logging into a jump host via SSH and then logging into the target server from there. The latter situation can certainly achieve our goal using similar methods, but would be more complex.<!--]--></li><li><!--[-->Your control machine (your own computer) can connect to public mirror sites while connected to the internal network server (<del>if not, you might want to sync a local mirror in advance to create an offline mirror site</del>).<!--]--></li><!--]--></ul><h2 id="reverse-proxying-the-mirror-site" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Reverse Proxying the Mirror Site<!--]--><a href="#reverse-proxying-the-mirror-site" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->I chose Caddy over Nginx here - on one hand, Caddy&#39;s configuration files are simpler to write, and on the other hand, Caddy is written in Golang, so it&#39;s a single binary that works everywhere, and Windows can directly <a href="https://caddyserver.com/download" rel="nofollow"><!--[-->download<!--]--></a> and run it.<!--]--></p><p><!--[-->Using the most common Tsinghua TUNA mirror site as an example, a simple Caddy configuration file looks like this:<!--]--></p><pre class="language-nginx shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="s5ixo">:</span><span class="sLKXg">8080</span><span class="s5ixo"> {
</span></span><span class="line" line="2"><span class="sLKXg">    reverse_proxy</span><span class="s5ixo"> https://mirrors.tuna.tsinghua.edu.cn {
</span></span><span class="line" line="3"><span class="sLKXg">        header_up</span><span class="s5ixo"> Host {http.reverse_proxy.upstream.hostport}
</span></span><span class="line" line="4"><span class="s5ixo">    }
</span></span><span class="line" line="5"><span class="s5ixo">}
</span></span></code><!--]--></pre><p><!--[-->Save the above code as a file named Caddyfile, then run it using the caddy command in the saved path:<!--]--></p><pre class="language-bash shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sAdtL">caddy</span><span class="sDhpE"> run</span><span class="sAGMh"> --config</span><span class="sDhpE"> ./Caddyfile
</span></span></code><!--]--></pre><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/8ef15a08e4852.webp" alt="" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><!----><!--teleport start--><!--teleport end--></span><!--]--></p><p><!--[-->If there are no errors, you should be able to see the Tsinghua mirror site on your local port 8080:<!--]--></p><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/a9083c95c07a2.webp" alt="" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><!----><!--teleport start--><!--teleport end--></span><!--]--></p><blockquote><!--[--><p><!--[-->You may notice that the reverse proxied page differs slightly from Tsinghua&#39;s mirror site - it doesn&#39;t have Tsinghua&#39;s logo. This is probably because the page&#39;s JavaScript checks the host, and if it&#39;s not Tsinghua or BFSU&#39;s page, it won&#39;t add the school name. But this doesn&#39;t affect our ability to fetch updates from these mirror sites.<!--]--></p><!--]--></blockquote><h2 id="establishing-the-ssh-tunnel" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Establishing the SSH Tunnel<!--]--><a href="#establishing-the-ssh-tunnel" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->To establish the tunnel, use the following command:<!--]--></p><pre class="language-bash shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sAdtL">ssh</span><span class="sAGMh"> -R</span><span class="sDhpE"> 8085:localhost:8080</span><span class="sDhpE"> root@remote.example.com
</span></span></code><!--]--></pre><p><!--[-->The -R flag indicates establishing a reverse tunnel. For other parameter options, you can refer to this blog post &quot;<a href="https://www.entropy-tree.top/2024/04/18/ssh-tunneling-techniques/" rel="nofollow"><!--[-->SSH Tunneling Techniques<!--]--></a>&quot;, also written by a Jinghong senior.<!--]--></p><p><!--[-->At this point, we&#39;ve established SSH port forwarding from the internal network server&#39;s port 8085 to our local machine&#39;s port 8080. (I used port 8085 to distinguish it from port 8080; in practice, you can use any available port)<!--]--></p><p><!--[-->We can test whether we can access it normally on the server using curl. Here I simply accessed a README file in the Debian source root directory:<!--]--></p><pre class="language-bash shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sAdtL">curl</span><span class="sDhpE"> http://localhost:8085/debian/README
</span></span></code><!--]--></pre><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/597c4af0d398d.webp" alt="" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><!----><!--teleport start--><!--teleport end--></span><!--]--></p><h2 id="changing-sources" class="prose-heading prose-h2" data-v-a22a06c0><!--[-->Changing Sources<!--]--><a href="#changing-sources" class="heading-anchor" aria-label="链接到此标题" data-v-a22a06c0><span class="anchor-icon" data-v-a22a06c0>#</span></a></h2><p><!--[-->So now we have a reverse proxy of the Tsinghua open source mirror site on the internal network server&#39;s port 8085, and we can access all content in the mirror site through port 8085.<!--]--></p><p><!--[-->First, follow the <a href="https://mirrors.tuna.tsinghua.edu.cn/help/debian/" rel="nofollow"><!--[-->instructions from Tsinghua Open Source Mirror Site<!--]--></a> to change sources. <strong><!--[-->Remember to check &quot;Force security updates to use mirror&quot;<!--]--></strong>.<!--]--></p><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/46e3c7030ded4.webp" alt="" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><!----><!--teleport start--><!--teleport end--></span><!--]--></p><p><!--[-->Then, we replace all instances of <a href="https://mirrors.tuna.tsinghua.edu.cn" rel="nofollow"><!--[-->https://mirrors.tuna.tsinghua.edu.cn<!--]--></a> in the sources with <a href="http://localhost:8085" rel="nofollow"><!--[-->http://localhost:8085<!--]--></a>:<!--]--></p><pre class="language-bash shiki shiki-themes one-light one-dark-pro" style="" data-v-a9c19cc1><!--[--><code><span class="line" line="1"><span class="sAdtL">sed</span><span class="sAGMh"> -i</span><span class="sDhpE"> &#39;s|https\?://mirrors\.tuna\.tsinghua\.edu\.cn|http://localhost:8085|g&#39;</span><span class="sDhpE"> `</span><span class="sAdtL">grep</span><span class="sAGMh"> -rlE</span><span class="sDhpE"> &#39;http(s)?://mirrors\.tuna\.tsinghua\.edu\.cn&#39; /etc/apt/`
</span></span></code><!--]--></pre><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/a8f0c70d48f5b.webp" alt="Running apt update" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><span class="prose-img-caption" data-v-4f488808>Running apt update</span><!--teleport start--><!--teleport end--></span><!--]--></p><p><!--[--><span class="prose-img-wrapper" data-v-4f488808><img src="https://static.031130.xyz/uploads/2025/03/30/07919bf939e92.webp" alt="Installing unzip using apt" title="" loading="lazy" class="prose-img" style="cursor:zoom-in;" data-v-4f488808><span class="prose-img-caption" data-v-4f488808>Installing unzip using apt</span><!--teleport start--><!--teleport end--></span><!--]--></p><p><!--[-->As you can see, we&#39;ve successfully implemented APT updates and software installation on the internal network server through an SSH tunnel.<!--]--></p><blockquote><!--[--><p><!--[-->Friendly reminder: SSH tunnels were frequently used in the early 2010s to establish cross-border access, but quickly faded from the scene due to their distinctive traffic characteristics. Therefore, don&#39;t use SSH for large amounts of cross-border network transmission, as it&#39;s easy to get blocked.<!--]--></p><!--]--></blockquote><p><!--[-->Of course, there are many ways to achieve this goal. Other tools like frp can achieve the same effect, but the SSH tunnel solution can be started and stopped on demand without additional configuration, which is why I primarily recommend it.<!--]--></p><style>html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}</style></article><hr class="article-end-hr" data-v-6c2349ae><div class="tags" data-v-6c2349ae><svg viewBox="0 0 512 512" width="1.2em" height="1.2em" data-v-6c2349ae><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M403.29 32H280.36a14.46 14.46 0 0 0-10.2 4.2L24.4 281.9a28.85 28.85 0 0 0 0 40.7l117 117a28.86 28.86 0 0 0 40.71 0L427.8 194a14.46 14.46 0 0 0 4.2-10.2v-123A28.66 28.66 0 0 0 403.29 32"></path><path fill="currentColor" d="M352 144a32 32 0 1 1 32-32a32 32 0 0 1-32 32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="m230 480l262-262a13.8 13.8 0 0 0 4-10V80"></path></svg><!--[--><a href="/en/tags/Apt/" class="" data-v-6c2349ae>#Apt</a><a href="/en/tags/Network/" class="" data-v-6c2349ae>#Network</a><a href="/en/tags/OpenSSH/" class="" data-v-6c2349ae>#OpenSSH</a><a href="/en/tags/Caddy/" class="" data-v-6c2349ae>#Caddy</a><a href="/en/tags/Linux/" class="" data-v-6c2349ae>#Linux</a><a href="/en/tags/Debian/" class="" data-v-6c2349ae>#Debian</a><!--]--></div><nav class="post-navigation" data-v-6c2349ae data-v-a35c130b><a href="/en/2025/04/21/how-we-copy-text-to-clipboard-with-js-in-2025/" class="nav-button prev" data-v-a35c130b><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="nav-arrow" data-v-a35c130b><path fill="currentColor" d="M10 22L0 12L10 2l1.775 1.775L3.55 12l8.225 8.225z"></path></svg><div class="nav-content" data-v-a35c130b><span class="nav-label" data-v-a35c130b>Previous</span><span class="nav-title" data-v-a35c130b>How to Copy Text to Clipboard with JavaScript in 2025</span></div></a><a href="/en/2025/02/28/cudy-tr3000-daed-install-record/" class="nav-button next" data-v-a35c130b><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="nav-arrow" data-v-a35c130b><path fill="currentColor" d="M8.025 22L6.25 20.225L14.475 12L6.25 3.775L8.025 2l10 10z"></path></svg><div class="nav-content" data-v-a35c130b><span class="nav-label" data-v-a35c130b>Next</span><span class="nav-title" data-v-a35c130b>Cudy TR3000 daed Installation Guide</span></div></a></nav><div id="waline" data-v-6c2349ae><span></span></div><!--]--></main><div class="after-main side" data-v-40d23075><!--[--><aside data-v-6c2349ae><nav class="toc" data-v-6c2349ae data-v-bdce45f2><div class="toc-title" data-v-bdce45f2>Contents</div><ul class="toc-list" data-v-bdce45f2><!--[--><li class="toc-item toc-level-2" data-v-bdce45f2><a href="#prerequisites" data-v-bdce45f2>Prerequisites</a></li><li class="toc-item toc-level-2" data-v-bdce45f2><a href="#reverse-proxying-the-mirror-site" data-v-bdce45f2>Reverse Proxying the Mirror Site</a></li><li class="toc-item toc-level-2" data-v-bdce45f2><a href="#establishing-the-ssh-tunnel" data-v-bdce45f2>Establishing the SSH Tunnel</a></li><li class="toc-item toc-level-2" data-v-bdce45f2><a href="#changing-sources" data-v-bdce45f2>Changing Sources</a></li><!--]--></ul></nav></aside><!--]--></div></div><footer style="min-height:120px;background-color:#ee5522;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;100&#39; height=&#39;100&#39; viewBox=&#39;0 0 200 200&#39;%3E%3Cdefs%3E%3ClinearGradient id=&#39;a&#39; gradientUnits=&#39;userSpaceOnUse&#39; x1=&#39;100&#39; y1=&#39;33&#39; x2=&#39;100&#39; y2=&#39;-3&#39;%3E%3Cstop offset=&#39;0&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;0&#39;/%3E%3Cstop offset=&#39;1&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;1&#39;/%3E%3C/linearGradient%3E%3ClinearGradient id=&#39;b&#39; gradientUnits=&#39;userSpaceOnUse&#39; x1=&#39;100&#39; y1=&#39;135&#39; x2=&#39;100&#39; y2=&#39;97&#39;%3E%3Cstop offset=&#39;0&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;0&#39;/%3E%3Cstop offset=&#39;1&#39; stop-color=&#39;%23000&#39; stop-opacity=&#39;1&#39;/%3E%3C/linearGradient%3E%3C/defs%3E%3Cg fill=&#39;%23d23d09&#39; fill-opacity=&#39;0.6&#39;%3E%3Crect x=&#39;100&#39; width=&#39;100&#39; height=&#39;100&#39;/%3E%3Crect y=&#39;100&#39; width=&#39;100&#39; height=&#39;100&#39;/%3E%3C/g%3E%3Cg fill-opacity=&#39;0.5&#39;%3E%3Cpolygon fill=&#39;url(%23a)&#39; points=&#39;100 30 0 0 200 0&#39;/%3E%3Cpolygon fill=&#39;url(%23b)&#39; points=&#39;100 100 0 130 0 100 200 100 200 130&#39;/%3E%3C/g%3E%3C/svg%3E&quot;);" data-v-40d23075 data-v-5bcc226c><div class="footer-mask" data-v-5bcc226c></div><div class="footer-content" data-v-5bcc226c><div class="social" data-v-5bcc226c><a href="https://github.com/zhullyb/" rel="noopener noreferrer" class="social-icons" aria-label="Github" data-v-5bcc226c><svg viewBox="0 0 56 56" width="1.2em" height="1.2em" data-v-5bcc226c><path fill="currentColor" fill-rule="evenodd" d="M3 28c0 11.046 7.163 20.416 17.097 23.722c1.25.23 1.707-.542 1.707-1.205c0-.593-.022-2.166-.034-4.251c-6.954 1.51-8.421-3.352-8.421-3.352c-1.138-2.889-2.777-3.658-2.777-3.658c-2.27-1.55.172-1.519.172-1.519c2.51.177 3.83 2.577 3.83 2.577c2.23 3.82 5.851 2.716 7.276 2.076c.227-1.614.873-2.716 1.586-3.34c-5.55-.631-11.387-2.777-11.387-12.357c0-2.729.974-4.962 2.574-6.708c-.258-.632-1.116-3.175.245-6.616c0 0 2.098-.673 6.874 2.563c1.994-.556 4.133-.832 6.259-.843c2.124.01 4.262.287 6.258.843c4.773-3.236 6.868-2.563 6.868-2.563c1.365 3.44.507 5.984.25 6.616c1.603 1.746 2.57 3.98 2.57 6.708c0 9.605-5.846 11.718-11.414 12.336c.896.772 1.696 2.298 1.696 4.63c0 3.342-.031 6.038-.031 6.858c0 .669.451 1.447 1.719 1.203C45.844 48.407 53 39.043 53 28C53 14.194 41.806 3 27.998 3C14.194 3 3 14.193 3 28"></path></svg></a><a class="social-icons" href="/en/rss.xml" target="_blank" rel="noopener noreferrer" aria-label="RSS" data-v-5bcc226c><svg viewBox="0 0 56 56" width="1.2em" height="1.2em" data-v-5bcc226c><path fill="currentColor" fill-rule="evenodd" d="M11 37a8 8 0 1 1 0 16a8 8 0 0 1 0-16M3 3c27.614 0 50 22.386 50 50h-8c0-23.196-18.804-42-42-42zm0 15c19.33 0 35 15.67 35 35h-8c0-14.912-12.088-27-27-27z"></path></svg></a><a href="/en/donate/" class="social-icons" aria-label="Donate" data-v-5bcc226c><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-5bcc226c><path fill="currentColor" d="M17.726 13.02L14 16H9v-1h4.065a.5.5 0 0 0 .416-.777l-.888-1.332A2 2 0 0 0 10.93 12H3a1 1 0 0 0-1 1v6a2 2 0 0 0 2 2h9.639a3 3 0 0 0 2.258-1.024L22 13l-1.452-.484a3 3 0 0 0-2.822.504m1.532-5.63c.451-.465.73-1.108.73-1.818s-.279-1.353-.73-1.818A2.45 2.45 0 0 0 17.494 3S16.25 2.997 15 4.286C13.75 2.997 12.506 3 12.506 3a2.45 2.45 0 0 0-1.764.753c-.451.466-.73 1.108-.73 1.818s.279 1.354.73 1.818L15 12z"></path></svg></a><a class="social-icons" href="mailto:zhullyb@outlook.com" aria-label="Email" data-v-5bcc226c><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-5bcc226c><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H4V8l8 5l8-5zm-8-7L4 6h16z"></path></svg></a></div><div class="center-y" style="gap:4px;font-weight:600;" data-v-5bcc226c><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" style="font-size:0.9em;" data-v-5bcc226c><g fill="none"><path d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12"></path><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12Z"></path><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="M15.182 15.183a4.5 4.5 0 1 1 0-6.364"></path></g></svg> 2020 - 2025 zhullyb </div><div class="center-y" style="gap:8px;font-weight:600;" data-v-5bcc226c> Proudly Powered by <a href="https://nuxt.com/" rel="noopener noreferrer" class="center-y" aria-label="Nuxt" data-v-5bcc226c><svg viewBox="0 0 512 121" width="5.09em" height="1.2em" style="fill:white;" data-v-5bcc226c><path fill="#00DC82" d="M103.405 120.261h68.52c2.177 0 4.314-.555 6.2-1.61a12.2 12.2 0 0 0 4.536-4.403a11.75 11.75 0 0 0 1.66-6.013c0-2.111-.575-4.185-1.665-6.013l-46.016-77.31a12.2 12.2 0 0 0-4.536-4.402a12.7 12.7 0 0 0-6.198-1.61a12.7 12.7 0 0 0-6.198 1.61a12.2 12.2 0 0 0-4.537 4.402l-11.766 19.78l-23.004-38.68a12.2 12.2 0 0 0-4.539-4.401A12.7 12.7 0 0 0 69.663 0a12.7 12.7 0 0 0-6.199 1.61a12.2 12.2 0 0 0-4.538 4.402l-57.262 96.21A11.74 11.74 0 0 0 0 108.235c0 2.11.571 4.185 1.659 6.013a12.2 12.2 0 0 0 4.537 4.402a12.7 12.7 0 0 0 6.2 1.611h43.01c17.042 0 29.61-7.26 38.257-21.426l20.994-35.268l11.245-18.874l33.75 56.694h-44.995zm-48.7-18.893l-30.016-.007l44.994-75.588l22.45 37.794l-15.031 25.261c-5.743 9.191-12.267 12.54-22.397 12.54"></path><path d="M215.04 119.13h20.119V74.115c0-12.881-1.342-25.762-1.342-25.762l1.186 2.641c1.871 4.088 5.77 12.297 10.349 20.149l27.494 47.985h21.594V20.044h-20.252l.002 45.862c.056 12.598 1.339 25.055 1.339 25.055l-1.014-2.296c-1.79-3.986-5.764-12.539-10.386-20.636l-27.63-47.985H215.04zm143.205-71.342v39.068c0 9.059-5.767 15.853-13.949 15.853c-7.644 0-13.01-6.228-13.01-14.863V47.788h-18.642v44.446c0 16.279 9.925 28.028 25.08 28.028c9.255 0 16.765-4.247 20.52-11.041v9.908h18.778V47.788zm73.38 34.255l22.669-34.255H433.77l-12.337 18.826l-12.342-18.826h-20.386l22.669 34.114l-24.411 37.227h19.986l14.616-21.94l14.484 21.94h19.852zm43.627-34.255h-13.011v16.42h13.011v29.017c0 16.562 10.059 25.904 25.618 25.904H512v-16.561h-8.582c-6.035 0-9.525-3.256-9.525-10.192V64.207H512v-16.42h-18.107v-21.09h-18.64z"></path></svg></a></div><div class="promo-card" style="margin-top:12px;" data-v-5bcc226c data-v-f771117d><div class="card-header" data-v-f771117d><div class="header-left" data-v-f771117d><div class="logo-yxvm-container" data-v-f771117d><a href="https://yxvm.com/" target="_blank" rel="noopener noreferrer" data-v-f771117d><img src="/static/yxvm-logo.png" alt="yxvm" class="logo-img" data-v-f771117d></a></div><span class="plus-separator" data-v-f771117d>+</span><div class="logo-nodeseek-container" data-v-f771117d><a href="https://www.nodeseek.com" target="_blank" rel="noopener noreferrer" data-v-f771117d><img src="/static/logo2.png" alt="nodeseek" class="logo-img" data-v-f771117d></a></div></div><div data-v-f771117d><a href="https://github.com/NodeSeekDev/NodeSupport" target="_blank" rel="noopener noreferrer" class="github-link" data-v-f771117d><svg class="github-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 20 20" data-v-f771117d><g stroke-width="0" id="SVGRepo_bgCarrier" data-v-f771117d></g><g stroke-linejoin="round" stroke-linecap="round" id="SVGRepo_tracerCarrier" data-v-f771117d></g><g id="SVGRepo_iconCarrier" data-v-f771117d><title data-v-f771117d>github [#142]</title><desc data-v-f771117d>Created with Sketch.</desc><defs data-v-f771117d></defs><g stroke-width="1" stroke="none" id="Page-1" data-v-f771117d><g transform="translate(-140.000000, -7559.000000)" id="Dribbble-Light-Preview" data-v-f771117d><g transform="translate(56.000000, 160.000000)" id="icons" data-v-f771117d><path id="github-[#142]" d="M94,7399 C99.523,7399 104,7403.59 104,7409.253 C104,7413.782 101.138,7417.624 97.167,7418.981 C96.66,7419.082 96.48,7418.762 96.48,7418.489 C96.48,7418.151 96.492,7417.047 96.492,7415.675 C96.492,7414.719 96.172,7414.095 95.813,7413.777 C98.04,7413.523 100.38,7412.656 100.38,7408.718 C100.38,7407.598 99.992,7406.684 99.35,7405.966 C99.454,7405.707 99.797,7404.664 99.252,7403.252 C99.252,7403.252 98.414,7402.977 96.505,7404.303 C95.706,7404.076 94.85,7403.962 94,7403.958 C93.15,7403.962 92.295,7404.076 91.497,7404.303 C89.586,7402.977 88.746,7403.252 88.746,7403.252 C88.203,7404.664 88.546,7405.707 88.649,7405.966 C88.01,7406.684 87.619,7407.598 87.619,7408.718 C87.619,7412.646 89.954,7413.526 92.175,7413.785 C91.889,7414.041 91.63,7414.493 91.54,7415.156 C90.97,7415.418 89.522,7415.871 88.63,7414.304 C88.63,7414.304 88.101,7413.319 87.097,7413.247 C87.097,7413.247 86.122,7413.234 87.029,7413.87 C87.029,7413.87 87.684,7414.185 88.139,7415.37 C88.139,7415.37 88.726,7417.2 91.508,7416.58 C91.513,7417.437 91.522,7418.245 91.522,7418.489 C91.522,7418.76 91.338,7419.077 90.839,7418.982 C86.865,7417.627 84,7413.783 84,7409.253 C84,7403.59 88.478,7399 94,7399" data-v-f771117d></path></g></g></g></g></svg></a></div></div><h1 class="card-title" data-v-f771117d> NodeSupport Project </h1><p class="card-description" data-v-f771117d> Provide free server sponsorship to high-quality blogs, channels, open-source projects, and popular app. </p><div class="card-footer" data-v-f771117d><span data-v-f771117d>Support ID:</span><span data-v-f771117d>61</span></div></div><!----></div></footer></div><!--]--></div><div id="teleports"></div><script type="application/ld+json" data-nuxt-schema-org="true" data-hid="schema-org-graph">{"@context":"https://schema.org","@graph":[{"@id":"https://zhul.in/en/#website","@type":"WebSite","description":"这里是我的个人博客，专注于分享技术干货、学习心得和生活感悟，涵盖前端开发、后端架构、人工智能、编程技巧、工具推荐等多个领域。我持续更新原创内容，记录成长过程中的思考与收获，致力于帮助更多开发者和技术爱好者提升技能、拓展视野。如果你对技术、产品和互联网行业感兴趣，相信你能在这里找到有价值的知识与灵感。","inLanguage":"en-US","name":"竹林里有冰的博客","url":"https://zhul.in/en/","translationOfWork":{"@id":"https://zhul.in/#website"}},{"@id":"https://zhul.in/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/#webpage","@type":"WebPage","description":"This all started when Jinghong's former technical director complained that the school's internal network servers couldn't connect to the external network, making APT installation and updates extremely difficult. He had to manually download packages from the source, along with their dependencies, and the dependencies of those dependencies... and then transfer all these packages to the server via sftp/rsync or similar methods for manual installation.","name":"SSH to the Rescue - Running APT Updates on Internal Network Servers via SSH Tunnels","url":"https://zhul.in/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/","isPartOf":{"@id":"https://zhul.in/en/#website"},"potentialAction":[{"@type":"ReadAction","target":["https://zhul.in/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/"]}]}]}</script><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/_payload.json?58f3fc24-dbca-4691-a064-611e839dcd7d">[{"state":1,"once":22,"_errors":23,"serverRendered":6,"path":25,"prerenderedAt":26},["Reactive",2],{"$si18n:cached-locale-configs":3,"$si18n:resolved-locale":9,"$snuxt-seo-utils:routeRules":10,"$ssite-config":11},{"zh":4,"en":7},{"fallbacks":5,"cacheable":6},[],true,{"fallbacks":8,"cacheable":6},[],"en",{"head":-1,"seoMeta":-1},{"_priority":12,"currentLocale":16,"defaultLocale":17,"description":18,"env":19,"name":20,"trailingSlash":6,"url":21},{"name":13,"env":14,"url":13,"description":13,"defaultLocale":15,"trailingSlash":13,"currentLocale":15},-3,-15,-2,"en-US","zh-CN","这里是我的个人博客，专注于分享技术干货、学习心得和生活感悟，涵盖前端开发、后端架构、人工智能、编程技巧、工具推荐等多个领域。我持续更新原创内容，记录成长过程中的思考与收获，致力于帮助更多开发者和技术爱好者提升技能、拓展视野。如果你对技术、产品和互联网行业感兴趣，相信你能在这里找到有价值的知识与灵感。","production","竹林里有冰的博客","https://zhul.in/",["Set"],["ShallowReactive",24],{"post-2025-03-30-apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy-en":-1,"surround-2025-03-30-apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy-en":-1,"randomIndex/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/":-1,"language-switch-/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/-zh":-1,"posts-search-sections":-1},"/en/2025/03/30/apt-upgrade-on-internal-server-via-ssh-tunnel-and-reverse-proxy/",1763917715355]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},"seo-utils":{canonicalQueryWhitelist:["page","sort","filter","search","q","category","tag"],canonicalLowercase:true},i18n:{baseUrl:"",defaultLocale:"zh",rootRedirect:"",redirectStatusCode:302,skipSettingLocaleOnNavigate:false,locales:[{code:"zh",language:"zh-CN",name:"简体中文",_hreflang:"zh-CN",_sitemap:"zh-CN"},{code:"en",language:"en-US",name:"English",_hreflang:"en-US",_sitemap:"en-US"}],detectBrowserLanguage:false,experimental:{localeDetector:"",typedPages:true,typedOptionsAndMessages:false,alternateLinkCanonicalQueries:true,devCache:false,cacheLifetime:"",stripMessagesPayload:false,preload:false,strictSeo:false,nitroContextDetection:true,httpCacheDuration:10},domainLocales:{zh:{domain:""},en:{domain:""}}}},app:{baseURL:"/",buildId:"58f3fc24-dbca-4691-a064-611e839dcd7d",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>