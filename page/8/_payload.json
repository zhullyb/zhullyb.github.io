[{"data":1,"prerenderedAt":2599},["ShallowReactive",2],{"randomIndex/page/8/":3,"index-page-8":4,"posts-total":2598},5,[5,149,251,708,863,1097,1308,1713,2077,2161],{"title":6,"date":7,"path":8,"tags":9,"body":12},"使用 VirtScreen 将 Pad 作为副屏","2022-10-04 00:19:20","/2022/10/04/use-virtscreen-to-turn-pad-into-another-screen",[10,11],"Linux","Hardware",{"type":13,"value":14,"toc":137},"minimark",[15,22,33,37,40,48,64,67,74,80,83,87,94,97,106,109,112,115,118,121,124,127,130],[16,17,18],"blockquote",{},[19,20,21],"p",{},"由于浙江工地大专的朝晖尚9宿舍实在是太小了，我没有办法放下一块便携显示屏，所以只能把家中闲置的 Huawei Pad M6 作为自己的副屏。",[19,23,24,25,32],{},"经过一轮搜索下来，我找到了 ",[26,27,31],"a",{"href":28,"rel":29},"https://github.com/kbumsik/VirtScreen",[30],"nofollow","VirtScreen"," 作为工具。",[34,35,36],"h2",{"id":36},"安装",[19,38,39],{},"在 Archlinux 上，大概有三种以上的方式进行安装:",[19,41,42,43],{},"一、使用 AUR 上的 ",[26,44,47],{"href":45,"rel":46},"https://aur.archlinux.org/package/virtscreen/",[30],"virtscreen",[19,49,50,51,55,56,59,60,63],{},"遇到的唯一一个麻烦是作为依赖之一的 ",[52,53,54],"code",{},"python-quamash"," 在 python3.10 上无法直接安装。通过 AUR 的评论区得知，需要将 ",[52,57,58],{},"collections.Mapping"," 改为 ",[52,61,62],{},"collections.abc.Mapping"," 方可通过安装。",[19,65,66],{},"二、使用 dderjoel 的 fork 进行安装",[19,68,69,70],{},"见 ",[26,71,72],{"href":72,"rel":73},"https://github.com/dderjoel/VirtScreen/blob/master/package/archlinux/PKGBUILD",[30],[19,75,76,77],{},"三、直接通过 appimage 安装，不过需要自己手动安装 ",[52,78,79],{},"x11vnc",[34,81,82],{"id":82},"配置",[84,85,86],"h3",{"id":86},"系统层",[19,88,89,90,93],{},"打开软件以后，我们需要先在 ",[52,91,92],{},"Display->Virtual Display->Advaced"," 选择 VIRTUAL1 作为显示屏。",[19,95,96],{},"如果没有这个选项，可能需要根据自己的显卡做出相应的调整。",[19,98,99,100,105],{},"可以参考 ",[26,101,104],{"href":102,"rel":103},"https://wiki.archlinux.org/title/Extreme_Multihead#Using_a_virtual_output",[30],"ArchWiki","。",[84,107,108],{"id":108},"软件层",[19,110,111],{},"在这里，我们需要根据我们作为副屏的设备的屏幕分辨率来计算我们需要在 VirtScreen 中设置的分辨率参数。",[19,113,114],{},"我的 Huawei Pad M6 是 2560*1600 的分辨率，但 VirtScreen 最高支持只有 1920*1080，所以我们需要选择 1280*800，并开启高分辨率选项。",[19,116,117],{},"VNC 那边只需要根据自己的需求设置一下密码即可。",[34,119,120],{"id":120},"使用",[19,122,123],{},"在 VirtScreen 的 Display 界面点击 \"Enable Virtual Screen\"，切换到 VNC 界面点击 \"Start VNC Server\"，可以勾选右侧的 \"Auto\"。",[19,125,126],{},"Pad 端只需要安装任意一个 VNC 客户端即可，我这里使用的是\"VNC Viewer\"。",[34,128,129],{"id":129},"图片",[19,131,132],{},[133,134],"img",{"alt":135,"src":136},"效果图","https://static.031130.xyz/uploads/2024/08/12/633b1bd1ba8f4.webp",{"title":138,"searchDepth":139,"depth":139,"links":140},"",2,[141,142,147,148],{"id":36,"depth":139,"text":36},{"id":82,"depth":139,"text":82,"children":143},[144,146],{"id":86,"depth":145,"text":86},3,{"id":108,"depth":145,"text":108},{"id":120,"depth":139,"text":120},{"id":129,"depth":139,"text":129},{"title":150,"date":151,"path":152,"tags":153,"body":156},"在 Archlinux 下使用 l2tp 协议连接校园网","2022-09-29 14:30:46","/2022/09/29/use-l2tp-protocol-to-connect-internet",[154,155],"Archlinux","Network",{"type":13,"value":157,"toc":249},[158,163,171,177,180,189,198,201,229,232,239,245],[16,159,160],{},[19,161,162],{},"由于高考爆炸，所以不得不进入浙江工地大专来度过自己接下来四年的人生（希望到时候可以借助学校的力量润出去）。",[19,164,165,166,170],{},"学校这边由于某些不可描述的原因，将校园卡与宽带捆绑销售，且每次登陆校园网时都需要使用定制的 l2tp 协议客户端进行上网，且该客户端将会禁用用户的无线网卡（",[167,168,169],"del",{},"这不明摆着想让我们宿舍每个人都花一次钱","）。",[19,172,173],{},[133,174],{"alt":175,"src":176},"学校定制的 l2tp 拨号客户端","https://static.031130.xyz/uploads/2024/08/12/63353e0e1978c.webp",[19,178,179],{},"更惨的是，学校仅提供了 Windows 与 MacOS 的客户端。",[19,181,182,183,188],{},"在 ",[26,184,187],{"href":185,"rel":186},"https://imbearchild.cyou/",[30],"BearChild"," 的提醒下，我意识到 Linux 下也可以有 l2tp 协议。",[19,190,191,192,197],{},"谷歌搜索了一番，我在简书上捞到了这篇文章",[26,193,196],{"href":194,"rel":195},"https://www.jianshu.com/p/85cd5bd3c7a2",[30],"《ubuntu 连校园网 via l2tp》","。不过这显然有些麻烦，我们的客户端不需要 pppoe 拨号，只需要插上网线后连接 l2tp 协议即可联网。",[19,199,200],{},"所幸，NetworkManager 非常贴心地为我们提供了 l2tp 的插件，在 Archlinux 下使用如下命令即可完成安装。",[202,203,207],"pre",{"className":204,"code":205,"language":206,"meta":138,"style":138},"language-bash shiki shiki-themes one-light one-dark-pro","sudo pacman -S networkmanager-l2tp\n","bash",[52,208,209],{"__ignoreMap":138},[210,211,214,218,222,226],"span",{"class":212,"line":213},"line",1,[210,215,217],{"class":216},"sAdtL","sudo",[210,219,221],{"class":220},"sDhpE"," pacman",[210,223,225],{"class":224},"sAGMh"," -S",[210,227,228],{"class":220}," networkmanager-l2tp\n",[19,230,231],{},"安装完成后，就可以在图形化界面下进行我们的设置操作。",[19,233,234,235,238],{},"由于定制的客户端已经把 l2tp 服务器 ip 写死且显示在界面上了，我们就不需要再去抓包截取服务器 ip，直接使用这边的 ",[52,236,237],{},"192.168.115.1"," 即可。",[19,240,241],{},[133,242],{"alt":243,"src":244},"KDE 下的 NetworkManager l2tp 设置界面","https://static.031130.xyz/uploads/2024/08/12/63354161dbe28.webp",[246,247,248],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":250},[],{"title":252,"date":253,"path":254,"tags":255,"body":256},"为 Element 添加自己喜欢的贴纸","2022-08-10 19:51:19","/2022/08/10/add-sticker-support-for-element",null,{"type":13,"value":257,"toc":700},[258,263,266,282,290,293,320,324,327,343,347,350,372,375,378,403,410,414,421,438,441,452,458,461,464,467,487,491,494,501,507,513,519,526,532,535,680,686,689,692,697],[16,259,260],{},[19,261,262],{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[34,264,265],{"id":265},"需要准备的",[267,268,269,273,276,279],"ul",{},[270,271,272],"li",{},"PC 端 element",[270,274,275],{},"python3.6+ 环境",[270,277,278],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[270,280,281],{},"可能需要能够突破大局域网限制的网络环境",[19,283,284,285],{},"需要用到的项目 ",[26,286,289],{"href":287,"rel":288},"https://github.com/maunium/stickerpicker",[30],"maunium/stickerpicker",[34,291,292],{"id":292},"克隆主项目",[202,294,296],{"className":204,"code":295,"language":206,"meta":138,"style":138},"git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n",[52,297,298],{"__ignoreMap":138},[210,299,300,303,306,309,313,317],{"class":212,"line":213},[210,301,302],{"class":216},"git",[210,304,305],{"class":220}," clone",[210,307,308],{"class":220}," https://github.com/maunium/stickerpicker.git",[210,310,312],{"class":311},"s5ixo"," && ",[210,314,316],{"class":315},"s_Sar","cd",[210,318,319],{"class":220}," stickerpicker\n",[34,321,323],{"id":322},"使用-pip-安装依赖","使用 pip 安装依赖",[19,325,326],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[202,328,330],{"className":204,"code":329,"language":206,"meta":138,"style":138},"pip install .\n",[52,331,332],{"__ignoreMap":138},[210,333,334,337,340],{"class":212,"line":213},[210,335,336],{"class":216},"pip",[210,338,339],{"class":220}," install",[210,341,342],{"class":220}," .\n",[34,344,346],{"id":345},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[19,348,349],{},"在项目根目录下创新一个新的目录。",[202,351,353],{"className":204,"code":352,"language":206,"meta":138,"style":138},"mkdir \u003Cpack directory>\n",[52,354,355],{"__ignoreMap":138},[210,356,357,360,363,366,369],{"class":212,"line":213},[210,358,359],{"class":216},"mkdir",[210,361,362],{"class":311}," \u003C",[210,364,365],{"class":220},"pack",[210,367,368],{"class":220}," director",[210,370,371],{"class":311},"y>\n",[19,373,374],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[19,376,377],{},"执行命令进行打包",[202,379,381],{"className":204,"code":380,"language":206,"meta":138,"style":138},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[52,382,383],{"__ignoreMap":138},[210,384,385,388,390,392,394,397,400],{"class":212,"line":213},[210,386,387],{"class":216},"sticker-pack",[210,389,362],{"class":311},[210,391,365],{"class":220},[210,393,368],{"class":220},[210,395,396],{"class":311},"y> ",[210,398,399],{"class":224},"--add-to-index",[210,401,402],{"class":220}," web/packs/\n",[19,404,405,406,409],{},"如果想要给目录贴纸包命名，则可以追加",[52,407,408],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[34,411,413],{"id":412},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[19,415,416,417,420],{},"项目内已经为我们准备了 ",[52,418,419],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[202,422,424],{"className":204,"code":423,"language":206,"meta":138,"style":138},"sticker-import \u003Cpack_url>\n",[52,425,426],{"__ignoreMap":138},[210,427,428,430,432,435],{"class":212,"line":213},[210,429,419],{"class":216},[210,431,362],{"class":311},[210,433,434],{"class":220},"pack_ur",[210,436,437],{"class":311},"l>\n",[19,439,440],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[19,442,443,444,447,448,451],{},"matrix 的 ",[52,445,446],{},"homeserver"," 和 ",[52,449,450],{},"access token"," 可以在 PC 端 element 的设置里找到",[19,453,454],{},[133,455],{"alt":456,"src":457},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[19,459,460],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[19,462,463],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[465,466],"hr",{},[19,468,469,470,473,474,477,478,483,484],{},"接着我们需要做的事情就是将 ",[52,471,472],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[52,475,476],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[26,479,482],{"href":480,"rel":481},"https://blog.zhaose.cyou/",[30],"@朝色"," 的 url 也可以直接拿来使用 ",[52,485,486],{},"https://sticker.zhaose.cyou/web/",[34,488,490],{"id":489},"添加到-element","添加到 element",[19,492,493],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[19,495,496,497,500],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[52,498,499],{},"/devtools"," 并发送",[19,502,503],{},[133,504],{"alt":505,"src":506},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[19,508,509,510],{},"将会出现如下页面，选择 ",[52,511,512],{},"Explore account data",[19,514,515],{},[133,516],{"alt":517,"src":518},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[19,520,521,522,525],{},"找到 ",[52,523,524],{},"m.widgets","，如果没有，就点击下图标出的按钮",[19,527,528],{},[133,529],{"alt":530,"src":531},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[19,533,534],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[202,536,540],{"className":537,"code":538,"language":539,"meta":138,"style":138},"language-json shiki shiki-themes one-light one-dark-pro","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[52,541,542,547,556,563,578,590,603,612,618,631,644,657,668,674],{"__ignoreMap":138},[210,543,544],{"class":212,"line":213},[210,545,546],{"class":311},"{\n",[210,548,549,553],{"class":212,"line":139},[210,550,552],{"class":551},"sJa8x","    \"stickerpicker\"",[210,554,555],{"class":311},": {\n",[210,557,558,561],{"class":212,"line":145},[210,559,560],{"class":551},"        \"content\"",[210,562,555],{"class":311},[210,564,566,569,572,575],{"class":212,"line":565},4,[210,567,568],{"class":551},"            \"type\"",[210,570,571],{"class":311},": ",[210,573,574],{"class":220},"\"m.stickerpicker\"",[210,576,577],{"class":311},",\n",[210,579,580,583,585,588],{"class":212,"line":3},[210,581,582],{"class":551},"            \"url\"",[210,584,571],{"class":311},[210,586,587],{"class":220},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[210,589,577],{"class":311},[210,591,593,596,598,601],{"class":212,"line":592},6,[210,594,595],{"class":551},"            \"name\"",[210,597,571],{"class":311},[210,599,600],{"class":220},"\"Stickerpicker\"",[210,602,577],{"class":311},[210,604,606,609],{"class":212,"line":605},7,[210,607,608],{"class":551},"            \"data\"",[210,610,611],{"class":311},": {}\n",[210,613,615],{"class":212,"line":614},8,[210,616,617],{"class":311},"        },\n",[210,619,621,624,626,629],{"class":212,"line":620},9,[210,622,623],{"class":551},"        \"sender\"",[210,625,571],{"class":311},[210,627,628],{"class":220},"\"@you:matrix.server.name\"",[210,630,577],{"class":311},[210,632,634,637,639,642],{"class":212,"line":633},10,[210,635,636],{"class":551},"        \"state_key\"",[210,638,571],{"class":311},[210,640,641],{"class":220},"\"stickerpicker\"",[210,643,577],{"class":311},[210,645,647,650,652,655],{"class":212,"line":646},11,[210,648,649],{"class":551},"        \"type\"",[210,651,571],{"class":311},[210,653,654],{"class":220},"\"m.widget\"",[210,656,577],{"class":311},[210,658,660,663,665],{"class":212,"line":659},12,[210,661,662],{"class":551},"        \"id\"",[210,664,571],{"class":311},[210,666,667],{"class":220},"\"stickerpicker\"\n",[210,669,671],{"class":212,"line":670},13,[210,672,673],{"class":311},"    }\n",[210,675,677],{"class":212,"line":676},14,[210,678,679],{"class":311},"}\n",[19,681,682],{},[133,683],{"alt":684,"src":685},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[19,687,688],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[19,690,691],{},"补一张效果图",[19,693,694],{},[133,695],{"alt":135,"src":696},"https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[246,698,699],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":138,"searchDepth":139,"depth":139,"links":701},[702,703,704,705,706,707],{"id":265,"depth":139,"text":265},{"id":292,"depth":139,"text":292},{"id":322,"depth":139,"text":323},{"id":345,"depth":139,"text":346},{"id":412,"depth":139,"text":413},{"id":489,"depth":139,"text":490},{"title":709,"date":710,"path":711,"tags":712,"body":716},"nodejs16：是我配不上 openssl 3 咯？","2022-08-04 17:31:49","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16",[713,714,715],"Fedora","nodejs","OpenSSL",{"type":13,"value":717,"toc":861},[718,724,727,743,758,761,764,766,769,778,784,787,831,833,856],[19,719,720],{},[133,721],{"alt":722,"src":723},"长毛象的截图.png","https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp",[19,725,726],{},"今年上半年升级 Fedora 36 的时候遇到了这个问题。",[19,728,729,730,733,734,739,740,742],{},"那会儿很无奈，一直在等 nodejs16 合并提供 ",[52,731,732],{},"--openssl-legacy-provider"," 的",[26,735,738],{"href":736,"rel":737},"https://github.com/nodejs/node/pull/42972",[30],"那个 PR","。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 ",[52,741,732],{}," 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。",[19,744,745,746,751,752,757],{},"然而，nodejs 在他们的官网上发布的",[26,747,750],{"href":748,"rel":749},"https://nodejs.org/en/blog/announcements/nodejs16-eol/",[30],"一篇博客","刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有",[26,753,756],{"href":754,"rel":755},"https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/",[30],"寒晶雪提供的中文翻译","）",[19,759,760],{},"博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）",[19,762,763],{},"很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。",[465,765],{},[19,767,768],{},"不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）",[19,770,771,772,777],{},"前几天我给 ",[26,773,776],{"href":774,"rel":775},"https://github.com/atpoossfl/repo",[30],"atpoossfl 仓库","打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。",[19,779,780],{},[133,781],{"alt":782,"src":783},"此为 nvm 安装的 nodejs14 目录","https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp",[19,785,786],{},"所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。",[16,788,789],{},[19,790,791,792,795,796,799,800,803,804,807,808,813,814,817,818,821,822,825,826,447,828,830],{},"使用 Fedora 的用户需要注意，Fedora 官方源中的",[52,793,794],{},"yarnpkg","在打包时遇到了错误，他们将 ",[52,797,798],{},"/usr/lib/node_modules/yarn/bin/yarn.js"," 的 shebang 给改成了 ",[52,801,802],{},"#!/usr/bin/node","，应当改回 ",[52,805,806],{},"#!/usr/bin/env node","才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 ",[26,809,812],{"href":810,"rel":811},"https://dl.yarnpkg.com/rpm/yarn.repo",[30],"dl.yarnpkg.com"," 提供的 ",[52,815,816],{},"yarn"," 软件包。在写 specfile 的 ",[52,819,820],{},"BuildRequires"," 时，可以直接写成 ",[52,823,824],{},"/usr/bin/yarn"," 来避免频繁在 ",[52,827,816],{},[52,829,794],{}," 这两个包名间改动。",[465,832],{},[19,834,835,836,447,839,842,843,845,846,851,852,855],{},"更好的消息是，nodejs 已经在 ",[52,837,838],{},"v16.17.0-proposal",[52,840,841],{},"v16.x-staging"," 分支收下了这个为 nodejs16 提供 ",[52,844,732],{}," 的 ",[26,847,850],{"href":848,"rel":849},"https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f",[30],"commit","。相信在不久的将来，这个 commit 将会进入主线，并在 ",[52,853,854],{},"v16.17"," 版本的 nodejs16 上发挥它的作用。",[19,857,858],{},[133,859],{"alt":850,"src":860},"https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp",{"title":138,"searchDepth":139,"depth":139,"links":862},[],{"title":864,"date":865,"path":866,"tags":867,"body":869},"如何拯救失声的 hollywood","2022-07-25 11:25:44","/2022/07/25/restore-the-sound-of-hollywood",[868,10],"Fun",{"type":13,"value":870,"toc":1095},[871,874,883,886,891,894,897,905,916,936,947,956,959,974,1090,1093],[19,872,873],{},"我刚开始接触 Linux 下的 hollywood 时，我记得它运行时是有声音的，应该是 007 的主题音乐，如今再次装上 hollywood，却发现音乐没了。",[19,875,876,877,882],{},"在 Github 找到 hollywood，发现有一个 ",[26,878,881],{"href":879,"rel":880},"https://github.com/dustinkirkland/hollywood/issues/58",[30],"issue"," 也提到了这个问题。",[19,884,885],{},"原作者在该 issue 中回复道",[16,887,888],{},[19,889,890],{},"没错，它只是一段视频，音频受到版权保护。",[19,892,893],{},"所以不难看出，作者因为版权问题而去掉了音频，进而导致 hollywood 失声。但我们作为用户，是不是可以想办法获取到老版本中那段带有音频的 mp4 文件呢？",[19,895,896],{},"答案是肯定的。",[19,898,899,900,105],{},"得益于 git 的版本控制特色，在 hollywood 的 github 仓库中，我们可以找到原来的 ",[26,901,904],{"href":902,"rel":903},"https://github.com/dustinkirkland/hollywood/blob/67839229f878a08521885e9fc05dd2d3ba10ddd1/share/hollywood/mi.mp4",[30],"mp4 文件",[19,906,907,908,911,912,915],{},"下载这个 mp4 文件后，我们将其放入 ",[52,909,910],{},"/usr/share/hollywood/"," 路径下，重命名为 ",[52,913,914],{},"soundwave.mp4","，并确保其被正确设定为 0644 权限。",[202,917,919],{"className":204,"code":918,"language":206,"meta":138,"style":138},"sudo install -Dm644 ./mi.mp4 /usr/share/hollywood/soundwave.mp4\n",[52,920,921],{"__ignoreMap":138},[210,922,923,925,927,930,933],{"class":212,"line":213},[210,924,217],{"class":216},[210,926,339],{"class":220},[210,928,929],{"class":224}," -Dm644",[210,931,932],{"class":220}," ./mi.mp4",[210,934,935],{"class":220}," /usr/share/hollywood/soundwave.mp4\n",[19,937,938,939,942,943,946],{},"接下来试着跑一跑 ",[52,940,941],{},"hollywood","，发现依然没有声音。再次查阅源码，发现缺少了 ",[52,944,945],{},"mplayer"," 这个依赖。",[19,948,949,950,952,953,955],{},"使用包管理器安装 ",[52,951,945],{}," 后，运行 ",[52,954,941],{}," 就可以听到声音了。",[19,957,958],{},"然而，你觉不觉得这个音乐。。。听上去怪怪的。。。",[19,960,961,962,964,965,970,971],{},"没错，作者在去掉音频后，给 ",[52,963,914],{}," ",[26,966,969],{"href":967,"rel":968},"https://github.com/dustinkirkland/hollywood/commit/95f77d570d86cd8b8fe0e0939049609f81d1bae0#diff-3e2bf53af1a38136a109ac4fa1b11189e7b6fcd4385e1c68683093f73c6ac485",[30],"设定了加速播放","。而我们现在需要这段视频被原速播放。编辑 ",[52,972,973],{},"/usr/lib/hollywood/mplayer",[202,975,979],{"className":976,"code":977,"language":978,"meta":138,"style":138},"language-diff shiki shiki-themes one-light one-dark-pro","#!/bin/bash\n#\n# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\ncommand -v mplayer >/dev/null 2>&1 || exit 1\ntrap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\nPKG=hollywood\ndir=\"$(dirname $0)/../../share/$PKG\"\n-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n","diff",[52,980,981,986,991,996,1000,1005,1010,1015,1019,1024,1028,1033,1038,1043,1048,1054,1060,1066,1072,1078,1084],{"__ignoreMap":138},[210,982,983],{"class":212,"line":213},[210,984,985],{},"#!/bin/bash\n",[210,987,988],{"class":212,"line":139},[210,989,990],{},"#\n",[210,992,993],{"class":212,"line":145},[210,994,995],{},"# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n",[210,997,998],{"class":212,"line":565},[210,999,990],{},[210,1001,1002],{"class":212,"line":3},[210,1003,1004],{},"# Licensed under the Apache License, Version 2.0 (the \"License\");\n",[210,1006,1007],{"class":212,"line":592},[210,1008,1009],{},"# you may not use this file except in compliance with the License.\n",[210,1011,1012],{"class":212,"line":605},[210,1013,1014],{},"# You may obtain a copy of the License at\n",[210,1016,1017],{"class":212,"line":614},[210,1018,990],{},[210,1020,1021],{"class":212,"line":620},[210,1022,1023],{},"#    http://www.apache.org/licenses/LICENSE-2.0\n",[210,1025,1026],{"class":212,"line":633},[210,1027,990],{},[210,1029,1030],{"class":212,"line":646},[210,1031,1032],{},"# Unless required by applicable law or agreed to in writing, software\n",[210,1034,1035],{"class":212,"line":659},[210,1036,1037],{},"# distributed under the License is distributed on an \"AS IS\" BASIS,\n",[210,1039,1040],{"class":212,"line":670},[210,1041,1042],{},"# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",[210,1044,1045],{"class":212,"line":676},[210,1046,1047],{},"# See the License for the specific language governing permissions and\n",[210,1049,1051],{"class":212,"line":1050},15,[210,1052,1053],{},"# limitations under the License.\n",[210,1055,1057],{"class":212,"line":1056},16,[210,1058,1059],{},"command -v mplayer >/dev/null 2>&1 || exit 1\n",[210,1061,1063],{"class":212,"line":1062},17,[210,1064,1065],{},"trap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\n",[210,1067,1069],{"class":212,"line":1068},18,[210,1070,1071],{},"PKG=hollywood\n",[210,1073,1075],{"class":212,"line":1074},19,[210,1076,1077],{},"dir=\"$(dirname $0)/../../share/$PKG\"\n",[210,1079,1081],{"class":212,"line":1080},20,[210,1082,1083],{},"-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n",[210,1085,1087],{"class":212,"line":1086},21,[210,1088,1089],{},"+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n",[19,1091,1092],{},"再次运行，确认修改已经成功。",[246,1094,248],{},{"title":138,"searchDepth":139,"depth":139,"links":1096},[],{"title":1098,"date":1099,"path":1100,"tags":1101,"body":1104},"处理 fcitx5 的文字候选框在 tg 客户端上闪烁的问题","2022-07-03 13:52:44","/2022/07/03/fcitx5-blinking-on-tg-under-wayland-kde",[10,1102,1103],"笔记","KDE",{"type":13,"value":1105,"toc":1298},[1106,1117,1120,1123,1129,1132,1135,1143,1146,1149,1152,1158,1165,1176,1179,1182,1185,1188,1203,1206,1210,1213,1234,1237,1245,1248,1252,1258,1261,1268,1275,1282,1295],[16,1107,1108],{},[19,1109,1110,1111,1116],{},"文章开头，先要感谢 fcitx5 的开发者 ",[26,1112,1115],{"href":1113,"rel":1114},"https://www.csslayer.info/wordpress/",[30],"老K"," 帮我 debug 这个问题",[34,1118,1119],{"id":1119},"鬼畜的文字候选框",[19,1121,1122],{},"在新装的 Fedora 36 KDE Wayland 下使用 fcitx5 时遇到了文字候选框前后移动晃眼的问题（如下图）",[19,1124,1125],{},[133,1126],{"alt":1127,"src":1128},"fcitx5 blinking","https://static.031130.xyz/uploads/2024/08/12/62c13162a6efc.gif",[34,1130,1131],{"id":1131},"解决方案",[19,1133,1134],{},"当我向老K提出这个问题上的时候，老K告诉我这是预期行为，一共有两个解决方案。",[267,1136,1137,1140],{},[270,1138,1139],{},"使用 qt 的 text input",[270,1141,1142],{},"关掉 kwin 的淡入淡出特效",[19,1144,1145],{},"但由于我并不熟悉 KWin 的特效，所以我选择了前者的方案。",[19,1147,1148],{},"首先，需要确保自己的 Plasma 版本在 5.24 或以上，fcitx5 的版本号在 5.0.14 以上。",[19,1150,1151],{},"然后我们需要让 KWin 去启动 fcitx5。KCM 为此提供了一个非常简单的方式，如下图",[19,1153,1154],{},[133,1155],{"alt":1156,"src":1157},"选择 fcitx5 就好啦","https://static.031130.xyz/uploads/2024/08/12/62c134907ada9.webp",[19,1159,1160,1161,1164],{},"随后需要确保环境变量没有设置 ",[52,1162,1163],{},"QT_IM_MODULE ","。一定要确保这个变量不存在，连空也不行，必须是 unset。",[19,1166,1167,1168,1171,1172,1175],{},"理论上来说，是不需要重启的，但我的环境变量是 ",[52,1169,1170],{},"fcitx5-autostart"," 这个 rpm 包在 ",[52,1173,1174],{},"/etc/profile.d/fcitx5.sh","里面设置的，我需要重启系统来使新的环境变量生效。",[19,1177,1178],{},"重启后，如果没有什么意外的话，就算成功了。",[34,1180,1181],{"id":1181},"绝对不会缺席的意外",[19,1183,1184],{},"很遗憾，我遇到了意外。",[19,1186,1187],{},"完成上述操作后，文字候选框依然有问题。",[19,1189,1190,1191,1194,1195,1198,1199,1202],{},"在老K的正确推测下，是因为我在 Fedora 下曾经使用过 ",[52,1192,1193],{},"im-settings","，该程序在 ",[52,1196,1197],{},"$HOME/.config/environment.d/"," 路径下重新帮我设置回了 ",[52,1200,1201],{},"QT_IM_MODULE"," 这个变量，从而使得 tg 启动时还在使用 IM MODULE，而不是预期的 qt text input。",[19,1204,1205],{},"删除这两个影响环境变量的文件后，在 tg 输入时，fcitx5 的文字候选框恢复了正常。",[34,1207,1209],{"id":1208},"debug-过程中用到的两个方式","debug 过程中用到的两个方式",[84,1211,1212],{"id":1212},"dbus-send",[202,1214,1216],{"className":204,"code":1215,"language":206,"meta":138,"style":138},"dbus-send --print-reply=literal --dest=org.fcitx.Fcitx5 /controller org.fcitx.Fcitx.Controller1.DebugInfo\n",[52,1217,1218],{"__ignoreMap":138},[210,1219,1220,1222,1225,1228,1231],{"class":212,"line":213},[210,1221,1212],{"class":216},[210,1223,1224],{"class":224}," --print-reply=literal",[210,1226,1227],{"class":224}," --dest=org.fcitx.Fcitx5",[210,1229,1230],{"class":220}," /controller",[210,1232,1233],{"class":220}," org.fcitx.Fcitx.Controller1.DebugInfo\n",[19,1235,1236],{},"运行如上命令后，我得到了如下的输出",[202,1238,1243],{"className":1239,"code":1241,"language":1242},[1240],"language-text","   Group [x11::1] has 0 InputContext(s)\nGroup [wayland:] has 5 InputContext(s)\n  IC [a50fe208d42e4611b240c0b66a2fa0b9] program:konsole frontend:dbus cap:e001800060 focus:1\n  IC [d7d4d5c05e9c445aab1af9c7dfb5fbd4] program:telegram-desktop frontend:dbus cap:e001800060 focus:0\n  IC [ac72ec3edf58481bbdf838352520efd5] program:krunner frontend:dbus cap:e001820060 focus:0\n  IC [d8b450176e204953837248f786204c29] program:plasmashell frontend:dbus cap:e001800060 focus:0\n  IC [df252979343d42ebbe9bd82ead6ff194] program: frontend:wayland cap:40 focus:0\nInput Context without group\n","text",[52,1244,1241],{"__ignoreMap":138},[19,1246,1247],{},"老K指出，出现了 telegram 的那一行表明 tg 还是在用 IM Module，所以是环境变量有问题",[84,1249,1251],{"id":1250},"proc-查看程序运行时的环境变量","/proc 查看程序运行时的环境变量",[19,1253,1254],{},[133,1255],{"alt":1256,"src":1257},"获取到的环境变量","https://static.031130.xyz/uploads/2024/08/12/62c138b030469.webp",[34,1259,1260],{"id":1260},"参考资料",[19,1262,1263],{},[26,1264,1267],{"href":1265,"rel":1266},"https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/",[30],"Use Plasma 5.24 to type in Alacritty (Or any other text-input-v3 client) with Fcitx 5 on Wayland",[19,1269,1270],{},[26,1271,1274],{"href":1272,"rel":1273},"https://fcitx-im.org/wiki/FAQ#Candidate_window_is_blinking_under_wayland_with_Fcitx_5",[30],"Candidate window is blinking under wayland with Fcitx 5",[19,1276,1277],{},[26,1278,1281],{"href":1279,"rel":1280},"https://www.cnblogs.com/hupeng1234/p/6735403.html",[30],"查看进程的环境变量",[19,1283,1284],{},[1285,1286,1287,1288,447,1291,1294],"em",{},"注: 上述参考资料均已在 ",[52,1289,1290],{},"web.archive.org",[52,1292,1293],{},"archive.ph"," 做过存档，如遇到原站点无法访问的情况，可自行前往这两个站点查看存档。",[246,1296,1297],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":1299},[1300,1301,1302,1303,1307],{"id":1119,"depth":139,"text":1119},{"id":1131,"depth":139,"text":1131},{"id":1181,"depth":139,"text":1181},{"id":1208,"depth":139,"text":1209,"children":1304},[1305,1306],{"id":1212,"depth":145,"text":1212},{"id":1250,"depth":145,"text":1251},{"id":1260,"depth":139,"text":1260},{"title":1309,"date":1310,"path":1311,"tags":1312,"body":1314},"使用caddy反向代理维基百科中文站点","2022-05-30 08:59:21","/2022/05/30/use-caddy-to-proxy-wikipedia",[1313],"Caddy",{"type":13,"value":1315,"toc":1707},[1316,1319,1327,1330,1333,1363,1367,1645,1648,1654,1661,1668,1675,1677,1699,1704],[19,1317,1318],{},"反代的目的无非是两点",[267,1320,1321,1324],{},[270,1322,1323],{},"满足自己在无代理情况下访问无法访问的站点的需求",[270,1325,1326],{},"方便将站点分享给亲朋好友。",[19,1328,1329],{},"一直以来，我都想用 caddy 去反代一份维基百科来用，今天刚好就顺手解决了。",[34,1331,1332],{"id":1332},"注意事项",[267,1334,1335,1338,1341,1344],{},[270,1336,1337],{},"用于反代的机子需要有对目标站点的访问能力",[270,1339,1340],{},"最好准备一个新的域名作为白手套，防止被污染",[270,1342,1343],{},"建议增加密码保护，一来使得小鸡流量不被滥用，二来防止防火墙检测到站点内容",[270,1345,1346,1347,1350,1351,1354,1355,1359,1360,1362],{},"本文使用的 caddy 开启了 ",[52,1348,1349],{},"replace_response"," 插件，可以使用 ",[52,1352,1353],{},"xcaddy"," 编译或直接前往 ",[26,1356,1357],{"href":1357,"rel":1358},"https://caddyserver.com/download",[30]," 勾选相应插件后下载。安装时，建议先根据官方文档安装原版 caddy，再用启用了 ",[52,1361,1349],{}," 插件的 caddy 二进制文件覆盖掉原版 caddy，这样就不需要去手写 systemd 相关的文件了。",[34,1364,1366],{"id":1365},"caddyfile","Caddyfile",[202,1368,1372],{"className":1369,"code":1370,"language":1371,"meta":138,"style":138},"language-nginx shiki shiki-themes one-light one-dark-pro","{\n        order replace after encode\n}\n\nhttps://zhwiki.example.com {\n\n        reverse_proxy * https://zh.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://m.zhwiki.example.com {\n\n        reverse_proxy * https://zh.m.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://up.zhwiki.example.com {\n        reverse_proxy * https://upload.wikimedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n        }\n}\n\n","nginx",[52,1373,1374,1378,1383,1387,1393,1398,1402,1407,1412,1417,1422,1427,1432,1437,1442,1447,1452,1456,1461,1466,1471,1476,1481,1486,1491,1497,1502,1508,1513,1518,1523,1528,1533,1538,1543,1548,1553,1558,1563,1568,1573,1578,1583,1588,1593,1599,1605,1610,1615,1620,1625,1630,1635,1640],{"__ignoreMap":138},[210,1375,1376],{"class":212,"line":213},[210,1377,546],{},[210,1379,1380],{"class":212,"line":139},[210,1381,1382],{},"        order replace after encode\n",[210,1384,1385],{"class":212,"line":145},[210,1386,679],{},[210,1388,1389],{"class":212,"line":565},[210,1390,1392],{"emptyLinePlaceholder":1391},true,"\n",[210,1394,1395],{"class":212,"line":3},[210,1396,1397],{},"https://zhwiki.example.com {\n",[210,1399,1400],{"class":212,"line":592},[210,1401,1392],{"emptyLinePlaceholder":1391},[210,1403,1404],{"class":212,"line":605},[210,1405,1406],{},"        reverse_proxy * https://zh.wikipedia.org {\n",[210,1408,1409],{"class":212,"line":614},[210,1410,1411],{},"                header_up Host {upstream_hostport}\n",[210,1413,1414],{"class":212,"line":620},[210,1415,1416],{},"                header_up X-Real-IP {http.request.remote.host}\n",[210,1418,1419],{"class":212,"line":633},[210,1420,1421],{},"                header_up X-Forwarded-For {http.request.remote.host}\n",[210,1423,1424],{"class":212,"line":646},[210,1425,1426],{},"                header_up X-Forwarded-Port {http.request.port}\n",[210,1428,1429],{"class":212,"line":659},[210,1430,1431],{},"                header_up X-Forwarded-Proto {http.request.scheme}\n",[210,1433,1434],{"class":212,"line":670},[210,1435,1436],{},"                header_up Accept-Encoding identity\n",[210,1438,1439],{"class":212,"line":676},[210,1440,1441],{},"                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n",[210,1443,1444],{"class":212,"line":1050},[210,1445,1446],{},"                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n",[210,1448,1449],{"class":212,"line":1056},[210,1450,1451],{},"        }\n",[210,1453,1454],{"class":212,"line":1062},[210,1455,1392],{"emptyLinePlaceholder":1391},[210,1457,1458],{"class":212,"line":1068},[210,1459,1460],{},"        replace {\n",[210,1462,1463],{"class":212,"line":1074},[210,1464,1465],{},"                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n",[210,1467,1468],{"class":212,"line":1080},[210,1469,1470],{},"                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n",[210,1472,1473],{"class":212,"line":1086},[210,1474,1475],{},"                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n",[210,1477,1479],{"class":212,"line":1478},22,[210,1480,1451],{},[210,1482,1484],{"class":212,"line":1483},23,[210,1485,679],{},[210,1487,1489],{"class":212,"line":1488},24,[210,1490,1392],{"emptyLinePlaceholder":1391},[210,1492,1494],{"class":212,"line":1493},25,[210,1495,1496],{},"https://m.zhwiki.example.com {\n",[210,1498,1500],{"class":212,"line":1499},26,[210,1501,1392],{"emptyLinePlaceholder":1391},[210,1503,1505],{"class":212,"line":1504},27,[210,1506,1507],{},"        reverse_proxy * https://zh.m.wikipedia.org {\n",[210,1509,1511],{"class":212,"line":1510},28,[210,1512,1411],{},[210,1514,1516],{"class":212,"line":1515},29,[210,1517,1416],{},[210,1519,1521],{"class":212,"line":1520},30,[210,1522,1421],{},[210,1524,1526],{"class":212,"line":1525},31,[210,1527,1426],{},[210,1529,1531],{"class":212,"line":1530},32,[210,1532,1431],{},[210,1534,1536],{"class":212,"line":1535},33,[210,1537,1436],{},[210,1539,1541],{"class":212,"line":1540},34,[210,1542,1441],{},[210,1544,1546],{"class":212,"line":1545},35,[210,1547,1446],{},[210,1549,1551],{"class":212,"line":1550},36,[210,1552,1451],{},[210,1554,1556],{"class":212,"line":1555},37,[210,1557,1392],{"emptyLinePlaceholder":1391},[210,1559,1561],{"class":212,"line":1560},38,[210,1562,1460],{},[210,1564,1566],{"class":212,"line":1565},39,[210,1567,1465],{},[210,1569,1571],{"class":212,"line":1570},40,[210,1572,1470],{},[210,1574,1576],{"class":212,"line":1575},41,[210,1577,1475],{},[210,1579,1581],{"class":212,"line":1580},42,[210,1582,1451],{},[210,1584,1586],{"class":212,"line":1585},43,[210,1587,679],{},[210,1589,1591],{"class":212,"line":1590},44,[210,1592,1392],{"emptyLinePlaceholder":1391},[210,1594,1596],{"class":212,"line":1595},45,[210,1597,1598],{},"https://up.zhwiki.example.com {\n",[210,1600,1602],{"class":212,"line":1601},46,[210,1603,1604],{},"        reverse_proxy * https://upload.wikimedia.org {\n",[210,1606,1608],{"class":212,"line":1607},47,[210,1609,1411],{},[210,1611,1613],{"class":212,"line":1612},48,[210,1614,1416],{},[210,1616,1618],{"class":212,"line":1617},49,[210,1619,1421],{},[210,1621,1623],{"class":212,"line":1622},50,[210,1624,1426],{},[210,1626,1628],{"class":212,"line":1627},51,[210,1629,1431],{},[210,1631,1633],{"class":212,"line":1632},52,[210,1634,1436],{},[210,1636,1638],{"class":212,"line":1637},53,[210,1639,1451],{},[210,1641,1643],{"class":212,"line":1642},54,[210,1644,679],{},[34,1646,1647],{"id":1647},"简单解释",[19,1649,1650,1651,1653],{},"第一大段是启用 ",[52,1652,1349],{}," 插件的部分，直接照抄即可。",[19,1655,1656,1657,1660],{},"第二和第三大段的思路是一致的，分别反向代理了 PC 端和移动段的网页。两行 ",[52,1658,1659],{}," header_down"," 的写法是受到了知乎上那篇 Github 反代的启发，避免了源站发出 302 重定向时访客被带到源站去。replace 部分不用多说，就是将针对三个源站域名的请求改到反代站域名。",[19,1662,1663,1664,1667],{},"第四大段就是中规中举地反代了 ",[52,1665,1666],{},"upload.wikimedia.org"," 这个域名，上面存放的大多数是媒体文件，如果条件允许的话其实可以考虑使用多个服务器反代。",[19,1669,1670,1671,105],{},"密码保护在我这份 Caddyfile 中没有启用，如果有需要的话可以参考我的",[26,1672,1674],{"href":1673},"/2021/10/21/picuploader-on-archlinux-with-caddy/#%E8%AE%BE%E7%BD%AE%E8%AE%BF%E9%97%AE%E5%AF%86%E7%A0%81%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89","另一篇博客",[34,1676,1260],{"id":1260},[19,1678,1679,1684,1689,1694],{},[26,1680,1683],{"href":1681,"rel":1682},"https://caddyserver.com/docs/",[30],"Caddy 官方文档",[26,1685,1688],{"href":1686,"rel":1687},"https://zhuanlan.zhihu.com/p/476390779",[30],"The Road to Serfdom——如何为GitHub搭建反向代理",[26,1690,1693],{"href":1691,"rel":1692},"https://ichon.me/post/1026.html",[30],"使用 Caddy 配置 Wikipedia 反向代理",[26,1695,1698],{"href":1696,"rel":1697},"https://learningman.top/archives/365",[30],"使用 Caddy 反代 ghcr.io",[19,1700,1701],{},[1285,1702,1703],{},"所有参考资料除官方文档外均使用 web.archive.org 和 archive.ph 进行存档，如有无法访问的情况，请自行前往存档站获取历史存档。",[246,1705,1706],{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":1708},[1709,1710,1711,1712],{"id":1332,"depth":139,"text":1332},{"id":1365,"depth":139,"text":1366},{"id":1647,"depth":139,"text":1647},{"id":1260,"depth":139,"text":1260},{"title":1714,"date":1715,"path":1716,"tags":1717,"body":1718},"创建一个本地的 Fedora 镜像源","2022-05-11 04:18:26","/2022/05/11/setup-a-local-fedora-source",[713,1313],{"type":13,"value":1719,"toc":2068},[1720,1729,1732,1755,1758,1761,1768,1771,1774,1785,1792,1804,1810,1816,1819,1827,1844,1849,1855,1859,1862,1865,1874,1877,1883,1886,1905,1908,1914,1917,1923,1930,1995,2002,2056,2065],[16,1721,1722],{},[19,1723,1724,1725,1728],{},"Fedora 36 在多次跳票后，总算是在 5月10日正式发布了。截止北京时间 5月11日凌晨两点，上海交通大学开源镜像站的上游 ",[52,1726,1727],{},"rsync://download-ib01.fedoraproject.org/","  仍然没有同步 Fedora 36 的 Release 源。鉴于 Release 自 freeze 以后基本是不会有什么大变动的，也不需要及时同步更新，干脆就直接建立一个本地的镜像源。",[34,1730,1731],{"id":1731},"准备",[1733,1734,1735,1742,1752],"ol",{},[270,1736,1737,1738,1741],{},"一块足够大的硬盘",[1739,1740],"br",{},"根据我个人实测，单 Fedora 36 的 x86_64 架构 的 Release 源中的 binary rpm 就占用了 89.6 GB，具体准备多的的硬盘空间还得看你具体需要同步些什么。",[270,1743,1744,1745,1747,1748,1751],{},"符合要求的上游",[1739,1746],{},"这里所说的符合要求一共是两个方面，一是允许 rsync 同步，二是有你想要的文件。我通过 getfedora.org 的下载按钮的转发目标得知 ",[52,1749,1750],{},"mirror.karneval.cz"," 已经完成了 Fedora 36 Release 源的同步。",[270,1753,1754],{},"良好的网络条件",[19,1756,1757],{},"这里说的良好的网络条件，并不一定是说需要访问境外站点的能力，而是你和你的上游之间的网络访问畅通，不要动不动就i断开连接那种。如果你选择的是国内镜像站作为你的上游，那一般不会有什么问题。",[34,1759,1760],{"id":1760},"开始同步",[19,1762,1763,1764,1767],{},"现在的主流方案一般都是选择 ",[52,1765,1766],{},"rsync"," 直接开整。",[84,1769,1770],{"id":1770},"试探环节",[19,1772,1773],{},"很多镜像站的 rsync 文件路径和 http 文件路径路径是不同的。",[19,1775,1776,1777,1780,1781,1784],{},"比如说，我这里用的 mirror.karneval.cz 的 http 页面显示的 fedora 仓库路径在 ",[52,1778,1779],{},"/pub/fedora","，但 rsync 同步时需要使用 ",[52,1782,1783],{},"/fedora"," 路径。",[19,1786,1787,1788,1791],{},"为了确定这一点，我们可以先通过 ",[52,1789,1790],{},"rsync rsync://example.com"," 进行预览",[202,1793,1795],{"className":204,"code":1794,"language":206,"meta":138,"style":138},"rsync rsync://mirror.karneval.cz\n",[52,1796,1797],{"__ignoreMap":138},[210,1798,1799,1801],{"class":212,"line":213},[210,1800,1766],{"class":216},[210,1802,1803],{"class":220}," rsync://mirror.karneval.cz\n",[19,1805,1806],{},[133,1807],{"alt":1808,"src":1809},"image-20220511103736493","https://static.031130.xyz/uploads/2024/08/12/627b2177c4da2.webp",[19,1811,1812,1813],{},"通过一层一层预览目录的方式，找到需要同步的路径是 ",[52,1814,1815],{},"/fedora/linux/releases/36/Everything/x86_64/os/",[84,1817,1818],{"id":1818},"同步环节",[19,1820,1821,1822,447,1824,1826],{},"通过 ",[52,1823,359],{},[52,1825,316],{}," 创建并进入我们准备用于同步源码的文件夹，然后开始执行同步命令。",[202,1828,1830],{"className":204,"code":1829,"language":206,"meta":138,"style":138},"rsync -avP rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/ .\n",[52,1831,1832],{"__ignoreMap":138},[210,1833,1834,1836,1839,1842],{"class":212,"line":213},[210,1835,1766],{"class":216},[210,1837,1838],{"class":224}," -avP",[210,1840,1841],{"class":220}," rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/",[210,1843,342],{"class":220},[19,1845,1846],{},[1285,1847,1848],{},"Ps: 中途如果由于各种原因而中断了同步过程，可以再次使用上述命令继续同步，rsync 会保证文件完整性。",[19,1850,1851],{},[133,1852],{"alt":1853,"src":1854},"耗费两个半小时，同步成功","https://static.031130.xyz/uploads/2024/08/12/627b22fa44446.webp",[34,1856,1858],{"id":1857},"安装配置并启用-static-server-可选","安装、配置并启用 static server (可选)",[19,1860,1861],{},"如果只需要本机使用，那么直接跳过这一步即可；如果需要给局域网内的其他机器提供镜像源，那么需要启用 static server。",[19,1863,1864],{},"我这里选择的是 caddy，性能虽然比 nginx 略逊一筹，但胜在配置简单。",[19,1866,1867,1868,1873],{},"caddy 的安装可以直接参考",[26,1869,1872],{"href":1870,"rel":1871},"https://caddyserver.com/docs/install",[30],"官方文档","，这里不再赘述。",[19,1875,1876],{},"配置也不过那么几行的事情，我给个 example。端口号只要和别的程序没有冲突，就可以随意指定。443 端口需要 ssl 证书比较麻烦，局域网内直接用非标准端口即可。",[202,1878,1881],{"className":1879,"code":1880,"language":1242},[1240],":14567 {\n        root * /the/directory/you/use\n\n        file_server {\n                browse\n        }\n}\n",[52,1882,1880],{"__ignoreMap":138},[19,1884,1885],{},"配置完后直接以普通用户的权限启用即可，使用 systemd 启用需要解决 caddy 用户对目标无权限的问题。",[202,1887,1889],{"className":204,"code":1888,"language":206,"meta":138,"style":138},"caddy run --config /etc/caddy/Caddyfile\n",[52,1890,1891],{"__ignoreMap":138},[210,1892,1893,1896,1899,1902],{"class":212,"line":213},[210,1894,1895],{"class":216},"caddy",[210,1897,1898],{"class":220}," run",[210,1900,1901],{"class":224}," --config",[210,1903,1904],{"class":220}," /etc/caddy/Caddyfile\n",[19,1906,1907],{},"浏览器输入对应的 ip 和端口，应该就可以访问了。",[19,1909,1910],{},[133,1911],{"alt":1912,"src":1913},"image-20220511113417004","https://static.031130.xyz/uploads/2024/08/12/627b2ebd23331.webp",[34,1915,1916],{"id":1916},"修改源配置文件",[19,1918,1919,1920,238],{},"由于我们仅同步了 Release 源，就只需要修改 ",[52,1921,1922],{},"/etc/yum.repo.d/fedora.repo",[19,1924,1925,1926,1929],{},"如果镜像源在本机上，可以直接使用 ",[52,1927,1928],{},"file://"," 协议头:",[202,1931,1933],{"className":976,"code":1932,"language":978,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=file:///the/directory/you/use\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,1934,1935,1940,1945,1950,1955,1960,1965,1970,1975,1980,1985,1990],{"__ignoreMap":138},[210,1936,1937],{"class":212,"line":213},[210,1938,1939],{},"[fedora]\n",[210,1941,1942],{"class":212,"line":139},[210,1943,1944],{},"name=Fedora $releasever - $basearch\n",[210,1946,1947],{"class":212,"line":145},[210,1948,1949],{},"+ baseurl=file:///the/directory/you/use\n",[210,1951,1952],{"class":212,"line":565},[210,1953,1954],{},"- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\n",[210,1956,1957],{"class":212,"line":3},[210,1958,1959],{},"enabled=1\n",[210,1961,1962],{"class":212,"line":592},[210,1963,1964],{},"countme=1\n",[210,1966,1967],{"class":212,"line":605},[210,1968,1969],{},"metadata_expire=7d\n",[210,1971,1972],{"class":212,"line":614},[210,1973,1974],{},"repo_gpgcheck=0\n",[210,1976,1977],{"class":212,"line":620},[210,1978,1979],{},"type=rpm\n",[210,1981,1982],{"class":212,"line":633},[210,1983,1984],{},"gpgcheck=1\n",[210,1986,1987],{"class":212,"line":646},[210,1988,1989],{},"gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\n",[210,1991,1992],{"class":212,"line":659},[210,1993,1994],{},"skip_if_unavailable=False\n",[19,1996,1997,1998,2001],{},"如果镜像源在同局域网设备上，通过 ",[52,1999,2000],{},"http://"," 协议也能达到相同的效果:",[202,2003,2005],{"className":976,"code":2004,"language":978,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=http://192.168.1.233:14567\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,2006,2007,2011,2015,2020,2024,2028,2032,2036,2040,2044,2048,2052],{"__ignoreMap":138},[210,2008,2009],{"class":212,"line":213},[210,2010,1939],{},[210,2012,2013],{"class":212,"line":139},[210,2014,1944],{},[210,2016,2017],{"class":212,"line":145},[210,2018,2019],{},"+ baseurl=http://192.168.1.233:14567\n",[210,2021,2022],{"class":212,"line":565},[210,2023,1954],{},[210,2025,2026],{"class":212,"line":3},[210,2027,1959],{},[210,2029,2030],{"class":212,"line":592},[210,2031,1964],{},[210,2033,2034],{"class":212,"line":605},[210,2035,1969],{},[210,2037,2038],{"class":212,"line":614},[210,2039,1974],{},[210,2041,2042],{"class":212,"line":620},[210,2043,1979],{},[210,2045,2046],{"class":212,"line":633},[210,2047,1984],{},[210,2049,2050],{"class":212,"line":646},[210,2051,1989],{},[210,2053,2054],{"class":212,"line":659},[210,2055,1994],{},[19,2057,2058],{},[1285,2059,2060,2061,2064],{},"Ps: 提供镜像源的机子的局域网 ip 可以通过 ",[52,2062,2063],{},"ip -br a"," 命令获取",[246,2066,2067],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}",{"title":138,"searchDepth":139,"depth":139,"links":2069},[2070,2071,2075,2076],{"id":1731,"depth":139,"text":1731},{"id":1760,"depth":139,"text":1760,"children":2072},[2073,2074],{"id":1770,"depth":145,"text":1770},{"id":1818,"depth":145,"text":1818},{"id":1857,"depth":139,"text":1858},{"id":1916,"depth":139,"text":1916},{"title":2078,"date":2079,"path":2080,"tags":2081,"body":2084},"好软推荐——FastOCR","2022-04-14 05:55:18","/2022/04/14/fastocr-experience",[2082,2083],"Experience","OpenSource Project",{"type":13,"value":2085,"toc":2159},[2086,2089,2103,2124,2130,2144,2150,2153],[19,2087,2088],{},"前两天在 PC 端有 OCR 的需求，需求如下",[267,2090,2091,2094,2097,2100],{},[270,2092,2093],{},"自带框选功能或者图片上传前的编辑功能",[270,2095,2096],{},"硬盘占用小，不要 electron (((已经受够了",[270,2098,2099],{},"支持系统托盘或者快捷键快速调出",[270,2101,2102],{},"免费",[19,2104,2105,2106,2111,2112,2117,2118,2123],{},"在",[26,2107,2110],{"href":2108,"rel":2109},"https://liolok.com/",[30],"李皓奇","的推荐下试用了 Arch 群",[26,2113,2116],{"href":2114,"rel":2115},"https://github.com/BruceZhang1993",[30],"兔兔","拿 python 和 qt 写的 ",[26,2119,2122],{"href":2120,"rel":2121},"https://github.com/BruceZhang1993/FastOCR",[30],"fastocr","，体验可以说是相当不错了。四个要求基本都能完美满足！",[19,2125,2126],{},[133,2127],{"alt":2128,"src":2129},"操作简单快捷","https://static.031130.xyz/uploads/2024/08/12/a4ddb3b05e19c.gif",[19,2131,2132,2133,2136,2137,2136,2140,2143],{},"支持 ",[1285,2134,2135],{},"百度","、",[1285,2138,2139],{},"有道",[1285,2141,2142],{},"旷视Face++"," 三家的接口，免费额度绝对够我试用的（大不了一家用完了换一家嘛",[19,2145,2146],{},[133,2147],{"alt":2148,"src":2149},"设置界面","https://static.031130.xyz/uploads/2024/08/12/488835757d5e3.webp",[19,2151,2152],{},"此外，空间占用小，算上依赖也不过 31MB 的硬盘空间占用，连半个 electron 都不到，运行起来反而更加流畅 \u003C^_^>",[19,2154,2155],{},[133,2156],{"alt":2157,"src":2158},"诶？哪里来的atpoossfl","https://static.031130.xyz/uploads/2024/08/12/a404346841d02.webp",{"title":138,"searchDepth":139,"depth":139,"links":2160},[],{"title":2162,"date":2163,"path":2164,"tags":2165,"body":2169},"抛弃PicGo，直接使用curl将图片上传到LskyPro","2022-03-31 19:19:14","/2022/03/31/upload-pic-to-lskypro-with-curl",[2166,2167,2168],"Shell Script","图床","Lsky Pro",{"type":13,"value":2170,"toc":2596},[2171,2178,2196,2208,2217,2222,2225,2228,2239,2242,2577,2582,2585,2588,2593],[19,2172,2173,2174,2177],{},"前一阵子为了图床折腾了好长一段时间。刚开始用的是 cloudinary，虽然每月有限制，但强在境内访问速度还不错，可惜后来 ",[52,2175,2176],{},"res.cloudinary.com"," 这个域名在某些地方被 DNS 污染了，而自定义域名是付费版的功能，就不得不放弃了。",[19,2179,2180,2181,2184,2185,2190,2191,105],{},"后来也尝试过 npm图床 的方案，可惜面对这种滥用公共资源的行为我无法接受~~（肯定不是因为受不了那繁琐的上传步骤，随便传张图都得 bump 下版本号的原因）~~，而且现在境内的能作为图床使用的 npm 镜像似乎也就只剩下 ",[52,2182,2183],{},"npm.elemecdn.com"," 这一个能够正常回源了，没准哪天就用不了了，所以就去投奔了",[26,2186,2189],{"href":2187,"rel":2188},"https://dusays.com/",[30],"杜老师","的",[26,2192,2195],{"href":2193,"rel":2194},"https://7bu.top/",[30],"去不图床",[19,2197,2198,2199,2203,2204,2207],{},"去不图床采用开源图床程序 ",[26,2200,2168],{"href":2201,"rel":2202},"https://www.lsky.pro/",[30]," 搭建，没有免费服务，且配置了鉴黄服务，看起来就是打算长久做下去的图床站点。境内使用腾讯云cdn，境外采用 cloudflare cdn，速度都挺让我满意的。",[167,2205,2206],{},"（杜老师看见请给我打钱，或者多送我点空间也行","（x",[19,2209,2210,2211,2216],{},"Typora 一直是我写博客的主用 Markdown 编辑器，之前我采用 Typora 调用 ",[26,2212,2215],{"href":2213,"rel":2214},"https://github.com/xiebruce/PicUploader",[30],"PicUploader(php)"," 自动上传图片的方案写博客，体验相当不错，如图:",[19,2218,2219],{},[133,2220],{"alt":138,"src":2221},"https://static.031130.xyz/uploads/2024/08/12/62f3b881e3c4c.gif",[19,2223,2224],{},"可惜 PicUploader 目前仍然没有支持 LskyPro 的上传，我采用的是现在烂大街的 Typora+PicGo+LskyPro插件 的方案去实现 Typora 的自动上传图片功能。",[19,2226,2227],{},"这个方案有明显的弊端：",[267,2229,2230,2233,2236],{},[270,2231,2232],{},"PicGo 运行依赖于 electron，极大地消耗了系统资源。",[270,2234,2235],{},"PicGo 面对多张图片( >=4张 )同时上传时容易报错。",[270,2237,2238],{},"PicGo 对于 Linux 的支持比较有限，作者可能不熟悉 Linux，直到半个月前我去交了一个 pr 才支持 wayland 下使用 wl-clipboard 将图片链接复制到粘贴版。",[19,2240,2241],{},"正好 LskyPro 有详细的文档，应该可以用 curl 手糊一段 Shell 脚本实现直接上传，资源占用小，唯一的弊端是上传完成后的图片不容易管理。脚本如下",[202,2243,2245],{"className":204,"code":2244,"language":206,"meta":138,"style":138},"#!/bin/bash\n\nAPI_URL=\"https://7bu.top/api/v1\"\n\nAUTH_TOKEN=\"\"\n\nmarkdown=false\nwhile [[ \"$#\" -gt 0 ]]; do\n    case $1 in\n        -m|--markdown) markdown=true; shift ;;\n        *) break ;;\n    esac\ndone\n\nfor images in \"$@\"; do\n    UPLOAD_RESPONSE=$(curl -s -X POST \"$API_URL/upload\" \\\n        -H 'Content-Type: multipart/form-data' \\\n        -H \"Authorization: Bearer $AUTH_TOKEN\" \\\n        -F \"file=@$images\")\n\n    if [ \"$markdown\" = true ]; then\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.markdown\n    else\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.url\n    fi\ndone\n",[52,2246,2247,2252,2256,2268,2272,2282,2286,2296,2326,2338,2369,2379,2384,2389,2393,2416,2449,2459,2473,2489,2493,2520,2544,2549,2568,2573],{"__ignoreMap":138},[210,2248,2249],{"class":212,"line":213},[210,2250,985],{"class":2251},"sW2Sy",[210,2253,2254],{"class":212,"line":139},[210,2255,1392],{"emptyLinePlaceholder":1391},[210,2257,2258,2261,2265],{"class":212,"line":145},[210,2259,2260],{"class":551},"API_URL",[210,2262,2264],{"class":2263},"sknuh","=",[210,2266,2267],{"class":220},"\"https://7bu.top/api/v1\"\n",[210,2269,2270],{"class":212,"line":565},[210,2271,1392],{"emptyLinePlaceholder":1391},[210,2273,2274,2277,2279],{"class":212,"line":3},[210,2275,2276],{"class":551},"AUTH_TOKEN",[210,2278,2264],{"class":2263},[210,2280,2281],{"class":220},"\"\"\n",[210,2283,2284],{"class":212,"line":592},[210,2285,1392],{"emptyLinePlaceholder":1391},[210,2287,2288,2291,2293],{"class":212,"line":605},[210,2289,2290],{"class":551},"markdown",[210,2292,2264],{"class":2263},[210,2294,2295],{"class":220},"false\n",[210,2297,2298,2302,2305,2308,2312,2314,2317,2320,2323],{"class":212,"line":614},[210,2299,2301],{"class":2300},"sLKXg","while",[210,2303,2304],{"class":311}," [[ ",[210,2306,2307],{"class":220},"\"",[210,2309,2311],{"class":2310},"s2QsP","$#",[210,2313,2307],{"class":220},[210,2315,2316],{"class":2263}," -gt",[210,2318,2319],{"class":224}," 0",[210,2321,2322],{"class":311}," ]]; ",[210,2324,2325],{"class":2300},"do\n",[210,2327,2328,2331,2335],{"class":212,"line":620},[210,2329,2330],{"class":2300},"    case",[210,2332,2334],{"class":2333},"s8iYz"," $1",[210,2336,2337],{"class":2300}," in\n",[210,2339,2340,2344,2347,2350,2353,2355,2357,2360,2363,2366],{"class":212,"line":633},[210,2341,2343],{"class":2342},"sDaw7","        -m",[210,2345,2346],{"class":311},"|",[210,2348,2349],{"class":2342},"--markdown",[210,2351,2352],{"class":311},") ",[210,2354,2290],{"class":551},[210,2356,2264],{"class":2263},[210,2358,2359],{"class":220},"true",[210,2361,2362],{"class":311},"; ",[210,2364,2365],{"class":315},"shift",[210,2367,2368],{"class":311}," ;;\n",[210,2370,2371,2374,2377],{"class":212,"line":646},[210,2372,2373],{"class":311},"        *) ",[210,2375,2376],{"class":2300},"break",[210,2378,2368],{"class":311},[210,2380,2381],{"class":212,"line":659},[210,2382,2383],{"class":2300},"    esac\n",[210,2385,2386],{"class":212,"line":670},[210,2387,2388],{"class":2300},"done\n",[210,2390,2391],{"class":212,"line":676},[210,2392,1392],{"emptyLinePlaceholder":1391},[210,2394,2395,2398,2401,2404,2407,2410,2412,2414],{"class":212,"line":1050},[210,2396,2397],{"class":2300},"for",[210,2399,2400],{"class":551}," images",[210,2402,2403],{"class":2300}," in",[210,2405,2406],{"class":220}," \"",[210,2408,2409],{"class":2333},"$@",[210,2411,2307],{"class":220},[210,2413,2362],{"class":311},[210,2415,2325],{"class":2300},[210,2417,2418,2421,2423,2426,2429,2432,2435,2438,2440,2443,2446],{"class":212,"line":1056},[210,2419,2420],{"class":551},"    UPLOAD_RESPONSE",[210,2422,2264],{"class":2263},[210,2424,2425],{"class":311},"$(",[210,2427,2428],{"class":216},"curl",[210,2430,2431],{"class":224}," -s",[210,2433,2434],{"class":224}," -X",[210,2436,2437],{"class":220}," POST",[210,2439,2406],{"class":220},[210,2441,2442],{"class":551},"$API_URL",[210,2444,2445],{"class":220},"/upload\"",[210,2447,2448],{"class":315}," \\\n",[210,2450,2451,2454,2457],{"class":212,"line":1062},[210,2452,2453],{"class":224},"        -H",[210,2455,2456],{"class":220}," 'Content-Type: multipart/form-data'",[210,2458,2448],{"class":315},[210,2460,2461,2463,2466,2469,2471],{"class":212,"line":1068},[210,2462,2453],{"class":224},[210,2464,2465],{"class":220}," \"Authorization: Bearer ",[210,2467,2468],{"class":551},"$AUTH_TOKEN",[210,2470,2307],{"class":220},[210,2472,2448],{"class":315},[210,2474,2475,2478,2481,2484,2486],{"class":212,"line":1074},[210,2476,2477],{"class":224},"        -F",[210,2479,2480],{"class":220}," \"file=@",[210,2482,2483],{"class":551},"$images",[210,2485,2307],{"class":220},[210,2487,2488],{"class":311},")\n",[210,2490,2491],{"class":212,"line":1080},[210,2492,1392],{"emptyLinePlaceholder":1391},[210,2494,2495,2498,2501,2503,2506,2508,2511,2514,2517],{"class":212,"line":1086},[210,2496,2497],{"class":2300},"    if",[210,2499,2500],{"class":311}," [ ",[210,2502,2307],{"class":220},[210,2504,2505],{"class":551},"$markdown",[210,2507,2307],{"class":220},[210,2509,2510],{"class":2263}," =",[210,2512,2513],{"class":224}," true",[210,2515,2516],{"class":311}," ]; ",[210,2518,2519],{"class":2300},"then\n",[210,2521,2522,2525,2527,2530,2532,2535,2538,2541],{"class":212,"line":1478},[210,2523,2524],{"class":315},"        echo",[210,2526,2406],{"class":220},[210,2528,2529],{"class":551},"$UPLOAD_RESPONSE",[210,2531,2307],{"class":220},[210,2533,2534],{"class":311}," | ",[210,2536,2537],{"class":216},"jq",[210,2539,2540],{"class":224}," -r",[210,2542,2543],{"class":220}," .data.links.markdown\n",[210,2545,2546],{"class":212,"line":1483},[210,2547,2548],{"class":2300},"    else\n",[210,2550,2551,2553,2555,2557,2559,2561,2563,2565],{"class":212,"line":1488},[210,2552,2524],{"class":315},[210,2554,2406],{"class":220},[210,2556,2529],{"class":551},[210,2558,2307],{"class":220},[210,2560,2534],{"class":311},[210,2562,2537],{"class":216},[210,2564,2540],{"class":224},[210,2566,2567],{"class":220}," .data.links.url\n",[210,2569,2570],{"class":212,"line":1493},[210,2571,2572],{"class":2300},"    fi\n",[210,2574,2575],{"class":212,"line":1499},[210,2576,2388],{"class":2300},[16,2578,2579],{},[19,2580,2581],{},"2022/04/02更新: 第六行 $@ - \"$@\"，解决文件名中出现空格时导致的上传失败问题。",[19,2583,2584],{},"需要借助 jq 来读取返回的 json，各 Linux 发行版源内应该都有打包，自行安装即可。",[19,2586,2587],{},"授予x可执行权限后，Typora 内直接填写自定义命令输入脚本所在位置即可实现 Typora 自动上传图片了。",[16,2589,2590],{},[19,2591,2592],{},"2023/12/12更新: 支持 -m 或 --markdown 参数，使脚本输出 markdown 格式的链接。",[246,2594,2595],{},"html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .sknuh, html code.shiki .sknuh{--shiki-default:#383A42;--shiki-dark:#56B6C2}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .s2QsP, html code.shiki .s2QsP{--shiki-default:#E45649;--shiki-dark:#E5C07B}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .s8iYz, html code.shiki .s8iYz{--shiki-default:#383A42;--shiki-default-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic}html pre.shiki code .sDaw7, html code.shiki .sDaw7{--shiki-default:#0184BC;--shiki-dark:#E06C75}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":139,"depth":139,"links":2597},[],127,1761769025534]