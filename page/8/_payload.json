[{"data":1,"prerenderedAt":2603},["ShallowReactive",2],{"randomIndex/page/8/":3,"index-page-8":4,"posts-total":2602},2,[5,148,250,714,869,1103,1314,1719,2083,2167],{"title":6,"date":7,"path":8,"tags":9,"body":12},"使用 VirtScreen 将 Pad 作为副屏","2022-10-04 00:19:20","/2022/10/04/use-virtscreen-to-turn-pad-into-another-screen",[10,11],"Linux","Hardware",{"type":13,"value":14,"toc":137},"minimark",[15,22,33,37,40,48,64,67,74,80,83,87,94,97,106,109,112,115,118,121,124,127,130],[16,17,18],"blockquote",{},[19,20,21],"p",{},"由于浙江工地大专的朝晖尚9宿舍实在是太小了，我没有办法放下一块便携显示屏，所以只能把家中闲置的 Huawei Pad M6 作为自己的副屏。",[19,23,24,25,32],{},"经过一轮搜索下来，我找到了 ",[26,27,31],"a",{"href":28,"rel":29},"https://github.com/kbumsik/VirtScreen",[30],"nofollow","VirtScreen"," 作为工具。",[34,35,36],"h2",{"id":36},"安装",[19,38,39],{},"在 Archlinux 上，大概有三种以上的方式进行安装:",[19,41,42,43],{},"一、使用 AUR 上的 ",[26,44,47],{"href":45,"rel":46},"https://aur.archlinux.org/package/virtscreen/",[30],"virtscreen",[19,49,50,51,55,56,59,60,63],{},"遇到的唯一一个麻烦是作为依赖之一的 ",[52,53,54],"code",{},"python-quamash"," 在 python3.10 上无法直接安装。通过 AUR 的评论区得知，需要将 ",[52,57,58],{},"collections.Mapping"," 改为 ",[52,61,62],{},"collections.abc.Mapping"," 方可通过安装。",[19,65,66],{},"二、使用 dderjoel 的 fork 进行安装",[19,68,69,70],{},"见 ",[26,71,72],{"href":72,"rel":73},"https://github.com/dderjoel/VirtScreen/blob/master/package/archlinux/PKGBUILD",[30],[19,75,76,77],{},"三、直接通过 appimage 安装，不过需要自己手动安装 ",[52,78,79],{},"x11vnc",[34,81,82],{"id":82},"配置",[84,85,86],"h3",{"id":86},"系统层",[19,88,89,90,93],{},"打开软件以后，我们需要先在 ",[52,91,92],{},"Display->Virtual Display->Advaced"," 选择 VIRTUAL1 作为显示屏。",[19,95,96],{},"如果没有这个选项，可能需要根据自己的显卡做出相应的调整。",[19,98,99,100,105],{},"可以参考 ",[26,101,104],{"href":102,"rel":103},"https://wiki.archlinux.org/title/Extreme_Multihead#Using_a_virtual_output",[30],"ArchWiki","。",[84,107,108],{"id":108},"软件层",[19,110,111],{},"在这里，我们需要根据我们作为副屏的设备的屏幕分辨率来计算我们需要在 VirtScreen 中设置的分辨率参数。",[19,113,114],{},"我的 Huawei Pad M6 是 2560*1600 的分辨率，但 VirtScreen 最高支持只有 1920*1080，所以我们需要选择 1280*800，并开启高分辨率选项。",[19,116,117],{},"VNC 那边只需要根据自己的需求设置一下密码即可。",[34,119,120],{"id":120},"使用",[19,122,123],{},"在 VirtScreen 的 Display 界面点击 \"Enable Virtual Screen\"，切换到 VNC 界面点击 \"Start VNC Server\"，可以勾选右侧的 \"Auto\"。",[19,125,126],{},"Pad 端只需要安装任意一个 VNC 客户端即可，我这里使用的是\"VNC Viewer\"。",[34,128,129],{"id":129},"图片",[19,131,132],{},[133,134],"img",{"alt":135,"src":136},"效果图","https://static.031130.xyz/uploads/2024/08/12/633b1bd1ba8f4.webp",{"title":138,"searchDepth":3,"depth":3,"links":139},"",[140,141,146,147],{"id":36,"depth":3,"text":36},{"id":82,"depth":3,"text":82,"children":142},[143,145],{"id":86,"depth":144,"text":86},3,{"id":108,"depth":144,"text":108},{"id":120,"depth":3,"text":120},{"id":129,"depth":3,"text":129},{"title":149,"date":150,"path":151,"tags":152,"body":155},"在 Archlinux 下使用 l2tp 协议连接校园网","2022-09-29 14:30:46","/2022/09/29/use-l2tp-protocol-to-connect-internet",[153,154],"Archlinux","Network",{"type":13,"value":156,"toc":248},[157,162,170,176,179,188,197,200,228,231,238,244],[16,158,159],{},[19,160,161],{},"由于高考爆炸，所以不得不进入浙江工地大专来度过自己接下来四年的人生（希望到时候可以借助学校的力量润出去）。",[19,163,164,165,169],{},"学校这边由于某些不可描述的原因，将校园卡与宽带捆绑销售，且每次登陆校园网时都需要使用定制的 l2tp 协议客户端进行上网，且该客户端将会禁用用户的无线网卡（",[166,167,168],"del",{},"这不明摆着想让我们宿舍每个人都花一次钱","）。",[19,171,172],{},[133,173],{"alt":174,"src":175},"学校定制的 l2tp 拨号客户端","https://static.031130.xyz/uploads/2024/08/12/63353e0e1978c.webp",[19,177,178],{},"更惨的是，学校仅提供了 Windows 与 MacOS 的客户端。",[19,180,181,182,187],{},"在 ",[26,183,186],{"href":184,"rel":185},"https://imbearchild.cyou/",[30],"BearChild"," 的提醒下，我意识到 Linux 下也可以有 l2tp 协议。",[19,189,190,191,196],{},"谷歌搜索了一番，我在简书上捞到了这篇文章",[26,192,195],{"href":193,"rel":194},"https://www.jianshu.com/p/85cd5bd3c7a2",[30],"《ubuntu 连校园网 via l2tp》","。不过这显然有些麻烦，我们的客户端不需要 pppoe 拨号，只需要插上网线后连接 l2tp 协议即可联网。",[19,198,199],{},"所幸，NetworkManager 非常贴心地为我们提供了 l2tp 的插件，在 Archlinux 下使用如下命令即可完成安装。",[201,202,206],"pre",{"className":203,"code":204,"language":205,"meta":138,"style":138},"language-bash shiki shiki-themes github-light github-dark","sudo pacman -S networkmanager-l2tp\n","bash",[52,207,208],{"__ignoreMap":138},[209,210,213,217,221,225],"span",{"class":211,"line":212},"line",1,[209,214,216],{"class":215},"sScJk","sudo",[209,218,220],{"class":219},"sZZnC"," pacman",[209,222,224],{"class":223},"sj4cs"," -S",[209,226,227],{"class":219}," networkmanager-l2tp\n",[19,229,230],{},"安装完成后，就可以在图形化界面下进行我们的设置操作。",[19,232,233,234,237],{},"由于定制的客户端已经把 l2tp 服务器 ip 写死且显示在界面上了，我们就不需要再去抓包截取服务器 ip，直接使用这边的 ",[52,235,236],{},"192.168.115.1"," 即可。",[19,239,240],{},[133,241],{"alt":242,"src":243},"KDE 下的 NetworkManager l2tp 设置界面","https://static.031130.xyz/uploads/2024/08/12/63354161dbe28.webp",[245,246,247],"style",{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":3,"depth":3,"links":249},[],{"title":251,"date":252,"path":253,"tags":254,"body":255},"为 Element 添加自己喜欢的贴纸","2022-08-10 19:51:19","/2022/08/10/add-sticker-support-for-element",null,{"type":13,"value":256,"toc":706},[257,262,265,281,289,292,318,322,325,341,345,348,374,377,380,407,414,418,425,444,447,458,464,467,470,473,493,497,500,507,513,519,525,532,538,541,686,692,695,698,703],[16,258,259],{},[19,260,261],{},"在读这篇文章之前，你应该已经知道 element、matrix 是什么，这部分内容咱就不过多展开讲了。",[34,263,264],{"id":264},"需要准备的",[266,267,268,272,275,278],"ul",{},[269,270,271],"li",{},"PC 端 element",[269,273,274],{},"python3.6+ 环境",[269,276,277],{},"能够挂静态资源的站点（比如 Github Pages、Gitlab Pages、Vercel 等免费平台的账号）",[269,279,280],{},"可能需要能够突破大局域网限制的网络环境",[19,282,283,284],{},"需要用到的项目 ",[26,285,288],{"href":286,"rel":287},"https://github.com/maunium/stickerpicker",[30],"maunium/stickerpicker",[34,290,291],{"id":291},"克隆主项目",[201,293,295],{"className":203,"code":294,"language":205,"meta":138,"style":138},"git clone https://github.com/maunium/stickerpicker.git && cd stickerpicker\n",[52,296,297],{"__ignoreMap":138},[209,298,299,302,305,308,312,315],{"class":211,"line":212},[209,300,301],{"class":215},"git",[209,303,304],{"class":219}," clone",[209,306,307],{"class":219}," https://github.com/maunium/stickerpicker.git",[209,309,311],{"class":310},"sVt8B"," && ",[209,313,314],{"class":223},"cd",[209,316,317],{"class":219}," stickerpicker\n",[34,319,321],{"id":320},"使用-pip-安装依赖","使用 pip 安装依赖",[19,323,324],{},"其实本来想直接用包管理去安装这个项目的依赖的，可惜我看了一眼依赖列表，有整整一半的依赖没有被 Fedora 打包，所以干脆就直接用 pip 安装算了。",[201,326,328],{"className":203,"code":327,"language":205,"meta":138,"style":138},"pip install .\n",[52,329,330],{"__ignoreMap":138},[209,331,332,335,338],{"class":211,"line":212},[209,333,334],{"class":215},"pip",[209,336,337],{"class":219}," install",[209,339,340],{"class":219}," .\n",[34,342,344],{"id":343},"选择一将本地图片制成贴纸包","选择一：将本地图片制成贴纸包",[19,346,347],{},"在项目根目录下创新一个新的目录。",[201,349,351],{"className":203,"code":350,"language":205,"meta":138,"style":138},"mkdir \u003Cpack directory>\n",[52,352,353],{"__ignoreMap":138},[209,354,355,358,362,365,368,371],{"class":211,"line":212},[209,356,357],{"class":215},"mkdir",[209,359,361],{"class":360},"szBVR"," \u003C",[209,363,364],{"class":219},"pack",[209,366,367],{"class":219}," director",[209,369,370],{"class":310},"y",[209,372,373],{"class":360},">\n",[19,375,376],{},"将需要的图片放入其中。如果需要排序，可以在图片的文件名最前面加上数字标号。",[19,378,379],{},"执行命令进行打包",[201,381,383],{"className":203,"code":382,"language":205,"meta":138,"style":138},"sticker-pack \u003Cpack directory> --add-to-index web/packs/\n",[52,384,385],{"__ignoreMap":138},[209,386,387,390,392,394,396,398,401,404],{"class":211,"line":212},[209,388,389],{"class":215},"sticker-pack",[209,391,361],{"class":360},[209,393,364],{"class":219},[209,395,367],{"class":219},[209,397,370],{"class":310},[209,399,400],{"class":360},">",[209,402,403],{"class":223}," --add-to-index",[209,405,406],{"class":219}," web/packs/\n",[19,408,409,410,413],{},"如果想要给目录贴纸包命名，则可以追加",[52,411,412],{},"--title \u003Ccustom title>","，否则将直接设置为目录名",[34,415,417],{"id":416},"选择二从-tg-获取现成的贴纸包","选择二：从 tg 获取现成的贴纸包",[19,419,420,421,424],{},"项目内已经为我们准备了 ",[52,422,423],{},"sticker-import"," 命令来帮助我们直接从 tg 获取表情包，那我们直接收下",[201,426,428],{"className":203,"code":427,"language":205,"meta":138,"style":138},"sticker-import \u003Cpack_url>\n",[52,429,430],{"__ignoreMap":138},[209,431,432,434,436,439,442],{"class":211,"line":212},[209,433,423],{"class":215},[209,435,361],{"class":360},[209,437,438],{"class":219},"pack_ur",[209,440,441],{"class":310},"l",[209,443,373],{"class":360},[19,445,446],{},"第一次使用时，会要求我们登陆 matrix 和 tg 账号",[19,448,449,450,453,454,457],{},"matrix 的 ",[52,451,452],{},"homeserver"," 和 ",[52,455,456],{},"access token"," 可以在 PC 端 element 的设置里找到",[19,459,460],{},[133,461],{"alt":462,"src":463},"element 在 pc 端上而设置界面","https://static.031130.xyz/uploads/2024/08/12/62f4dab8c7647.webp",[19,465,466],{},"tg 登陆时需要你输入手机号码，或者某一个 tg bot 的 token，这个大家都懂。",[19,468,469],{},"运行完成后，贴纸包就被上传到了你所使用的 matrix homeserver 上。",[471,472],"hr",{},[19,474,475,476,479,480,483,484,489,490],{},"接着我们需要做的事情就是将 ",[52,477,478],{},"web"," 文件夹部署到 github pages 等做成静态站点，这个比较简单，不再赘述，我这里直接部署在了 ",[52,481,482],{},"https://matrix-sticker.zhullyb.top"," 我们下文就直接拿它做演示，看得上的也可以直接拿来用。另外，",[26,485,488],{"href":486,"rel":487},"https://blog.zhaose.cyou/",[30],"@朝色"," 的 url 也可以直接拿来使用 ",[52,491,492],{},"https://sticker.zhaose.cyou/web/",[34,494,496],{"id":495},"添加到-element","添加到 element",[19,498,499],{},"这是本篇文章最吊诡的地方，element 其实并没有为我们准备这么一个添加自定义 sticker 的地方，从某种意义上讲，我们是把我们的 sticker 给 hack 进去。",[19,501,502,503,506],{},"在 element 的 pc 端找到任意一个对话框，输入 ",[52,504,505],{},"/devtools"," 并发送",[19,508,509],{},[133,510],{"alt":511,"src":512},"如图","https://static.031130.xyz/uploads/2024/08/12/62f4f4d55f4d3.webp",[19,514,515,516],{},"将会出现如下页面，选择 ",[52,517,518],{},"Explore account data",[19,520,521],{},[133,522],{"alt":523,"src":524},"1660220693791.png","https://static.031130.xyz/uploads/2024/08/12/62f4f5179fd73.webp",[19,526,527,528,531],{},"找到 ",[52,529,530],{},"m.widgets","，如果没有，就点击下图标出的按钮",[19,533,534],{},[133,535],{"alt":536,"src":537},"1660220786171.png","https://static.031130.xyz/uploads/2024/08/12/62f4f57459b6f.webp",[19,539,540],{},"在新的页面中，填写如下内容，url 那一行应当改为自己部署的页面，并发送请求",[201,542,546],{"className":543,"code":544,"language":545,"meta":138,"style":138},"language-json shiki shiki-themes github-light github-dark","{\n    \"stickerpicker\": {\n        \"content\": {\n            \"type\": \"m.stickerpicker\",\n            \"url\": \"https://matrix-sticker.zhullyb.top/?theme=$theme\",\n            \"name\": \"Stickerpicker\",\n            \"data\": {}\n        },\n        \"sender\": \"@you:matrix.server.name\",\n        \"state_key\": \"stickerpicker\",\n        \"type\": \"m.widget\",\n        \"id\": \"stickerpicker\"\n    }\n}\n","json",[52,547,548,553,561,568,583,596,609,618,624,637,650,663,674,680],{"__ignoreMap":138},[209,549,550],{"class":211,"line":212},[209,551,552],{"class":310},"{\n",[209,554,555,558],{"class":211,"line":3},[209,556,557],{"class":223},"    \"stickerpicker\"",[209,559,560],{"class":310},": {\n",[209,562,563,566],{"class":211,"line":144},[209,564,565],{"class":223},"        \"content\"",[209,567,560],{"class":310},[209,569,571,574,577,580],{"class":211,"line":570},4,[209,572,573],{"class":223},"            \"type\"",[209,575,576],{"class":310},": ",[209,578,579],{"class":219},"\"m.stickerpicker\"",[209,581,582],{"class":310},",\n",[209,584,586,589,591,594],{"class":211,"line":585},5,[209,587,588],{"class":223},"            \"url\"",[209,590,576],{"class":310},[209,592,593],{"class":219},"\"https://matrix-sticker.zhullyb.top/?theme=$theme\"",[209,595,582],{"class":310},[209,597,599,602,604,607],{"class":211,"line":598},6,[209,600,601],{"class":223},"            \"name\"",[209,603,576],{"class":310},[209,605,606],{"class":219},"\"Stickerpicker\"",[209,608,582],{"class":310},[209,610,612,615],{"class":211,"line":611},7,[209,613,614],{"class":223},"            \"data\"",[209,616,617],{"class":310},": {}\n",[209,619,621],{"class":211,"line":620},8,[209,622,623],{"class":310},"        },\n",[209,625,627,630,632,635],{"class":211,"line":626},9,[209,628,629],{"class":223},"        \"sender\"",[209,631,576],{"class":310},[209,633,634],{"class":219},"\"@you:matrix.server.name\"",[209,636,582],{"class":310},[209,638,640,643,645,648],{"class":211,"line":639},10,[209,641,642],{"class":223},"        \"state_key\"",[209,644,576],{"class":310},[209,646,647],{"class":219},"\"stickerpicker\"",[209,649,582],{"class":310},[209,651,653,656,658,661],{"class":211,"line":652},11,[209,654,655],{"class":223},"        \"type\"",[209,657,576],{"class":310},[209,659,660],{"class":219},"\"m.widget\"",[209,662,582],{"class":310},[209,664,666,669,671],{"class":211,"line":665},12,[209,667,668],{"class":223},"        \"id\"",[209,670,576],{"class":310},[209,672,673],{"class":219},"\"stickerpicker\"\n",[209,675,677],{"class":211,"line":676},13,[209,678,679],{"class":310},"    }\n",[209,681,683],{"class":211,"line":682},14,[209,684,685],{"class":310},"}\n",[19,687,688],{},[133,689],{"alt":690,"src":691},"发送请求","https://static.031130.xyz/uploads/2024/08/12/62f4f6d9e120e.webp",[19,693,694],{},"重启 element，此时就可以享受到自己导入的 sticker 了，手机端的 element 设置也将会被同步。",[19,696,697],{},"补一张效果图",[19,699,700],{},[133,701],{"alt":135,"src":702},"https://static.031130.xyz/uploads/2024/08/12/62f4f7728b1e6.webp",[245,704,705],{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}",{"title":138,"searchDepth":3,"depth":3,"links":707},[708,709,710,711,712,713],{"id":264,"depth":3,"text":264},{"id":291,"depth":3,"text":291},{"id":320,"depth":3,"text":321},{"id":343,"depth":3,"text":344},{"id":416,"depth":3,"text":417},{"id":495,"depth":3,"text":496},{"title":715,"date":716,"path":717,"tags":718,"body":722},"nodejs16：是我配不上 openssl 3 咯？","2022-08-04 17:31:49","/2022/08/04/a-fucking-store-about-openssl3-and-nodejs16",[719,720,721],"Fedora","nodejs","OpenSSL",{"type":13,"value":723,"toc":867},[724,730,733,749,764,767,770,772,775,784,790,793,837,839,862],[19,725,726],{},[133,727],{"alt":728,"src":729},"长毛象的截图.png","https://static.031130.xyz/uploads/2024/08/12/62eba4eabc963.webp",[19,731,732],{},"今年上半年升级 Fedora 36 的时候遇到了这个问题。",[19,734,735,736,739,740,745,746,748],{},"那会儿很无奈，一直在等 nodejs16 合并提供 ",[52,737,738],{},"--openssl-legacy-provider"," 的",[26,741,744],{"href":742,"rel":743},"https://github.com/nodejs/node/pull/42972",[30],"那个 PR","。nodejs16 是一个 lts 版本，照道理来说，既然要提供 Long-term Support，而 openssl 1 作为它的依赖之一，生命周期结束又在 nodejs16 之前，那是不是应该给 nodejs16 backport 在 nodejs17 上实现的 ",[52,747,738],{}," 参数选项呢？否则绝大多数发行版都会在 openssl 1 的生命周期结束之前切换到 openssl 3，那 nodejs16 不就没法用了嘛。",[19,750,751,752,757,758,763],{},"然而，nodejs 在他们的官网上发布的",[26,753,756],{"href":754,"rel":755},"https://nodejs.org/en/blog/announcements/nodejs16-eol/",[30],"一篇博客","刷新了我的世界观，而此前的那个 PR 甚至一度被关停。（此处有",[26,759,762],{"href":760,"rel":761},"https://whiteboard-ui8.pages.dev/translation/nodejs-eol-v16-0626/",[30],"寒晶雪提供的中文翻译","）",[19,765,766],{},"博客称他们将会把 nodejs16 的生命周期结束时间提前以防止 openssl 1 生命周期在 nodejs16 生命周期结束之前结束（这种做法甚至还有先例）",[19,768,769],{},"很无奈，那会儿有两个 npm 管理的软件没法在 Fedora 36 上编译出来，就一直搁置了下去。",[471,771],{},[19,773,774],{},"不过好在，事情还是有转机的。（要不然就这档子鸡毛蒜皮的小事我也不会专门去写篇博客出来）",[19,776,777,778,783],{},"前几天我给 ",[26,779,782],{"href":780,"rel":781},"https://github.com/atpoossfl/repo",[30],"atpoossfl 仓库","打了 rpm 版本的 nvm 以后，意外地发现 nvm 所提供的 nodejs 会自带 openssl。",[19,785,786],{},[133,787],{"alt":788,"src":789},"此为 nvm 安装的 nodejs14 目录","https://static.031130.xyz/uploads/2024/08/12/62ebadf02a5b3.webp",[19,791,792],{},"所以我们只需要使用 nvm 安装的 nodejs16 即可解决 Fedora36 以后没有 openssl 1 的问题。",[16,794,795],{},[19,796,797,798,801,802,805,806,809,810,813,814,819,820,823,824,827,828,831,832,453,834,836],{},"使用 Fedora 的用户需要注意，Fedora 官方源中的",[52,799,800],{},"yarnpkg","在打包时遇到了错误，他们将 ",[52,803,804],{},"/usr/lib/node_modules/yarn/bin/yarn.js"," 的 shebang 给改成了 ",[52,807,808],{},"#!/usr/bin/node","，应当改回 ",[52,811,812],{},"#!/usr/bin/env node","才能让 yarn 正常使用上 nvm 提供的 nodejs；或者干脆添加 ",[26,815,818],{"href":816,"rel":817},"https://dl.yarnpkg.com/rpm/yarn.repo",[30],"dl.yarnpkg.com"," 提供的 ",[52,821,822],{},"yarn"," 软件包。在写 specfile 的 ",[52,825,826],{},"BuildRequires"," 时，可以直接写成 ",[52,829,830],{},"/usr/bin/yarn"," 来避免频繁在 ",[52,833,822],{},[52,835,800],{}," 这两个包名间改动。",[471,838],{},[19,840,841,842,453,845,848,849,851,852,857,858,861],{},"更好的消息是，nodejs 已经在 ",[52,843,844],{},"v16.17.0-proposal",[52,846,847],{},"v16.x-staging"," 分支收下了这个为 nodejs16 提供 ",[52,850,738],{}," 的 ",[26,853,856],{"href":854,"rel":855},"https://github.com/nodejs/node/commit/e7b99e8c8d229ee2cc1d657ae44f715e7e5f852f",[30],"commit","。相信在不久的将来，这个 commit 将会进入主线，并在 ",[52,859,860],{},"v16.17"," 版本的 nodejs16 上发挥它的作用。",[19,863,864],{},[133,865],{"alt":856,"src":866},"https://static.031130.xyz/uploads/2024/08/12/62ebb0927943f.webp",{"title":138,"searchDepth":3,"depth":3,"links":868},[],{"title":870,"date":871,"path":872,"tags":873,"body":875},"如何拯救失声的 hollywood","2022-07-25 11:25:44","/2022/07/25/restore-the-sound-of-hollywood",[874,10],"Fun",{"type":13,"value":876,"toc":1101},[877,880,889,892,897,900,903,911,922,942,953,962,965,980,1096,1099],[19,878,879],{},"我刚开始接触 Linux 下的 hollywood 时，我记得它运行时是有声音的，应该是 007 的主题音乐，如今再次装上 hollywood，却发现音乐没了。",[19,881,882,883,888],{},"在 Github 找到 hollywood，发现有一个 ",[26,884,887],{"href":885,"rel":886},"https://github.com/dustinkirkland/hollywood/issues/58",[30],"issue"," 也提到了这个问题。",[19,890,891],{},"原作者在该 issue 中回复道",[16,893,894],{},[19,895,896],{},"没错，它只是一段视频，音频受到版权保护。",[19,898,899],{},"所以不难看出，作者因为版权问题而去掉了音频，进而导致 hollywood 失声。但我们作为用户，是不是可以想办法获取到老版本中那段带有音频的 mp4 文件呢？",[19,901,902],{},"答案是肯定的。",[19,904,905,906,105],{},"得益于 git 的版本控制特色，在 hollywood 的 github 仓库中，我们可以找到原来的 ",[26,907,910],{"href":908,"rel":909},"https://github.com/dustinkirkland/hollywood/blob/67839229f878a08521885e9fc05dd2d3ba10ddd1/share/hollywood/mi.mp4",[30],"mp4 文件",[19,912,913,914,917,918,921],{},"下载这个 mp4 文件后，我们将其放入 ",[52,915,916],{},"/usr/share/hollywood/"," 路径下，重命名为 ",[52,919,920],{},"soundwave.mp4","，并确保其被正确设定为 0644 权限。",[201,923,925],{"className":203,"code":924,"language":205,"meta":138,"style":138},"sudo install -Dm644 ./mi.mp4 /usr/share/hollywood/soundwave.mp4\n",[52,926,927],{"__ignoreMap":138},[209,928,929,931,933,936,939],{"class":211,"line":212},[209,930,216],{"class":215},[209,932,337],{"class":219},[209,934,935],{"class":223}," -Dm644",[209,937,938],{"class":219}," ./mi.mp4",[209,940,941],{"class":219}," /usr/share/hollywood/soundwave.mp4\n",[19,943,944,945,948,949,952],{},"接下来试着跑一跑 ",[52,946,947],{},"hollywood","，发现依然没有声音。再次查阅源码，发现缺少了 ",[52,950,951],{},"mplayer"," 这个依赖。",[19,954,955,956,958,959,961],{},"使用包管理器安装 ",[52,957,951],{}," 后，运行 ",[52,960,947],{}," 就可以听到声音了。",[19,963,964],{},"然而，你觉不觉得这个音乐。。。听上去怪怪的。。。",[19,966,967,968,970,971,976,977],{},"没错，作者在去掉音频后，给 ",[52,969,920],{}," ",[26,972,975],{"href":973,"rel":974},"https://github.com/dustinkirkland/hollywood/commit/95f77d570d86cd8b8fe0e0939049609f81d1bae0#diff-3e2bf53af1a38136a109ac4fa1b11189e7b6fcd4385e1c68683093f73c6ac485",[30],"设定了加速播放","。而我们现在需要这段视频被原速播放。编辑 ",[52,978,979],{},"/usr/lib/hollywood/mplayer",[201,981,985],{"className":982,"code":983,"language":984,"meta":138,"style":138},"language-diff shiki shiki-themes github-light github-dark","#!/bin/bash\n#\n# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\ncommand -v mplayer >/dev/null 2>&1 || exit 1\ntrap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\nPKG=hollywood\ndir=\"$(dirname $0)/../../share/$PKG\"\n-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n","diff",[52,986,987,992,997,1002,1006,1011,1016,1021,1025,1030,1034,1039,1044,1049,1054,1060,1066,1072,1078,1084,1090],{"__ignoreMap":138},[209,988,989],{"class":211,"line":212},[209,990,991],{},"#!/bin/bash\n",[209,993,994],{"class":211,"line":3},[209,995,996],{},"#\n",[209,998,999],{"class":211,"line":144},[209,1000,1001],{},"# Copyright 2014 Dustin Kirkland \u003Cdustin.kirkland@gmail.com>\n",[209,1003,1004],{"class":211,"line":570},[209,1005,996],{},[209,1007,1008],{"class":211,"line":585},[209,1009,1010],{},"# Licensed under the Apache License, Version 2.0 (the \"License\");\n",[209,1012,1013],{"class":211,"line":598},[209,1014,1015],{},"# you may not use this file except in compliance with the License.\n",[209,1017,1018],{"class":211,"line":611},[209,1019,1020],{},"# You may obtain a copy of the License at\n",[209,1022,1023],{"class":211,"line":620},[209,1024,996],{},[209,1026,1027],{"class":211,"line":626},[209,1028,1029],{},"#    http://www.apache.org/licenses/LICENSE-2.0\n",[209,1031,1032],{"class":211,"line":639},[209,1033,996],{},[209,1035,1036],{"class":211,"line":652},[209,1037,1038],{},"# Unless required by applicable law or agreed to in writing, software\n",[209,1040,1041],{"class":211,"line":665},[209,1042,1043],{},"# distributed under the License is distributed on an \"AS IS\" BASIS,\n",[209,1045,1046],{"class":211,"line":676},[209,1047,1048],{},"# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",[209,1050,1051],{"class":211,"line":682},[209,1052,1053],{},"# See the License for the specific language governing permissions and\n",[209,1055,1057],{"class":211,"line":1056},15,[209,1058,1059],{},"# limitations under the License.\n",[209,1061,1063],{"class":211,"line":1062},16,[209,1064,1065],{},"command -v mplayer >/dev/null 2>&1 || exit 1\n",[209,1067,1069],{"class":211,"line":1068},17,[209,1070,1071],{},"trap \"pkill -f -9 lib/hollywood/ >/dev/null 2>&1; exit\" INT\n",[209,1073,1075],{"class":211,"line":1074},18,[209,1076,1077],{},"PKG=hollywood\n",[209,1079,1081],{"class":211,"line":1080},19,[209,1082,1083],{},"dir=\"$(dirname $0)/../../share/$PKG\"\n",[209,1085,1087],{"class":211,"line":1086},20,[209,1088,1089],{},"-DISPLAY= mplayer -vo caca -loop 0 -ss $((RANDOM % 100)) -speed 100 $MPLAYER_OPTS $dir/soundwave.mp4\n",[209,1091,1093],{"class":211,"line":1092},21,[209,1094,1095],{},"+DISPLAY= mplayer -vo caca -loop 0 $MPLAYER_OPTS $dir/soundwave.mp4\n",[19,1097,1098],{},"再次运行，确认修改已经成功。",[245,1100,247],{},{"title":138,"searchDepth":3,"depth":3,"links":1102},[],{"title":1104,"date":1105,"path":1106,"tags":1107,"body":1110},"处理 fcitx5 的文字候选框在 tg 客户端上闪烁的问题","2022-07-03 13:52:44","/2022/07/03/fcitx5-blinking-on-tg-under-wayland-kde",[10,1108,1109],"笔记","KDE",{"type":13,"value":1111,"toc":1304},[1112,1123,1126,1129,1135,1138,1141,1149,1152,1155,1158,1164,1171,1182,1185,1188,1191,1194,1209,1212,1216,1219,1240,1243,1251,1254,1258,1264,1267,1274,1281,1288,1301],[16,1113,1114],{},[19,1115,1116,1117,1122],{},"文章开头，先要感谢 fcitx5 的开发者 ",[26,1118,1121],{"href":1119,"rel":1120},"https://www.csslayer.info/wordpress/",[30],"老K"," 帮我 debug 这个问题",[34,1124,1125],{"id":1125},"鬼畜的文字候选框",[19,1127,1128],{},"在新装的 Fedora 36 KDE Wayland 下使用 fcitx5 时遇到了文字候选框前后移动晃眼的问题（如下图）",[19,1130,1131],{},[133,1132],{"alt":1133,"src":1134},"fcitx5 blinking","https://static.031130.xyz/uploads/2024/08/12/62c13162a6efc.gif",[34,1136,1137],{"id":1137},"解决方案",[19,1139,1140],{},"当我向老K提出这个问题上的时候，老K告诉我这是预期行为，一共有两个解决方案。",[266,1142,1143,1146],{},[269,1144,1145],{},"使用 qt 的 text input",[269,1147,1148],{},"关掉 kwin 的淡入淡出特效",[19,1150,1151],{},"但由于我并不熟悉 KWin 的特效，所以我选择了前者的方案。",[19,1153,1154],{},"首先，需要确保自己的 Plasma 版本在 5.24 或以上，fcitx5 的版本号在 5.0.14 以上。",[19,1156,1157],{},"然后我们需要让 KWin 去启动 fcitx5。KCM 为此提供了一个非常简单的方式，如下图",[19,1159,1160],{},[133,1161],{"alt":1162,"src":1163},"选择 fcitx5 就好啦","https://static.031130.xyz/uploads/2024/08/12/62c134907ada9.webp",[19,1165,1166,1167,1170],{},"随后需要确保环境变量没有设置 ",[52,1168,1169],{},"QT_IM_MODULE ","。一定要确保这个变量不存在，连空也不行，必须是 unset。",[19,1172,1173,1174,1177,1178,1181],{},"理论上来说，是不需要重启的，但我的环境变量是 ",[52,1175,1176],{},"fcitx5-autostart"," 这个 rpm 包在 ",[52,1179,1180],{},"/etc/profile.d/fcitx5.sh","里面设置的，我需要重启系统来使新的环境变量生效。",[19,1183,1184],{},"重启后，如果没有什么意外的话，就算成功了。",[34,1186,1187],{"id":1187},"绝对不会缺席的意外",[19,1189,1190],{},"很遗憾，我遇到了意外。",[19,1192,1193],{},"完成上述操作后，文字候选框依然有问题。",[19,1195,1196,1197,1200,1201,1204,1205,1208],{},"在老K的正确推测下，是因为我在 Fedora 下曾经使用过 ",[52,1198,1199],{},"im-settings","，该程序在 ",[52,1202,1203],{},"$HOME/.config/environment.d/"," 路径下重新帮我设置回了 ",[52,1206,1207],{},"QT_IM_MODULE"," 这个变量，从而使得 tg 启动时还在使用 IM MODULE，而不是预期的 qt text input。",[19,1210,1211],{},"删除这两个影响环境变量的文件后，在 tg 输入时，fcitx5 的文字候选框恢复了正常。",[34,1213,1215],{"id":1214},"debug-过程中用到的两个方式","debug 过程中用到的两个方式",[84,1217,1218],{"id":1218},"dbus-send",[201,1220,1222],{"className":203,"code":1221,"language":205,"meta":138,"style":138},"dbus-send --print-reply=literal --dest=org.fcitx.Fcitx5 /controller org.fcitx.Fcitx.Controller1.DebugInfo\n",[52,1223,1224],{"__ignoreMap":138},[209,1225,1226,1228,1231,1234,1237],{"class":211,"line":212},[209,1227,1218],{"class":215},[209,1229,1230],{"class":223}," --print-reply=literal",[209,1232,1233],{"class":223}," --dest=org.fcitx.Fcitx5",[209,1235,1236],{"class":219}," /controller",[209,1238,1239],{"class":219}," org.fcitx.Fcitx.Controller1.DebugInfo\n",[19,1241,1242],{},"运行如上命令后，我得到了如下的输出",[201,1244,1249],{"className":1245,"code":1247,"language":1248},[1246],"language-text","   Group [x11::1] has 0 InputContext(s)\nGroup [wayland:] has 5 InputContext(s)\n  IC [a50fe208d42e4611b240c0b66a2fa0b9] program:konsole frontend:dbus cap:e001800060 focus:1\n  IC [d7d4d5c05e9c445aab1af9c7dfb5fbd4] program:telegram-desktop frontend:dbus cap:e001800060 focus:0\n  IC [ac72ec3edf58481bbdf838352520efd5] program:krunner frontend:dbus cap:e001820060 focus:0\n  IC [d8b450176e204953837248f786204c29] program:plasmashell frontend:dbus cap:e001800060 focus:0\n  IC [df252979343d42ebbe9bd82ead6ff194] program: frontend:wayland cap:40 focus:0\nInput Context without group\n","text",[52,1250,1247],{"__ignoreMap":138},[19,1252,1253],{},"老K指出，出现了 telegram 的那一行表明 tg 还是在用 IM Module，所以是环境变量有问题",[84,1255,1257],{"id":1256},"proc-查看程序运行时的环境变量","/proc 查看程序运行时的环境变量",[19,1259,1260],{},[133,1261],{"alt":1262,"src":1263},"获取到的环境变量","https://static.031130.xyz/uploads/2024/08/12/62c138b030469.webp",[34,1265,1266],{"id":1266},"参考资料",[19,1268,1269],{},[26,1270,1273],{"href":1271,"rel":1272},"https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/",[30],"Use Plasma 5.24 to type in Alacritty (Or any other text-input-v3 client) with Fcitx 5 on Wayland",[19,1275,1276],{},[26,1277,1280],{"href":1278,"rel":1279},"https://fcitx-im.org/wiki/FAQ#Candidate_window_is_blinking_under_wayland_with_Fcitx_5",[30],"Candidate window is blinking under wayland with Fcitx 5",[19,1282,1283],{},[26,1284,1287],{"href":1285,"rel":1286},"https://www.cnblogs.com/hupeng1234/p/6735403.html",[30],"查看进程的环境变量",[19,1289,1290],{},[1291,1292,1293,1294,453,1297,1300],"em",{},"注: 上述参考资料均已在 ",[52,1295,1296],{},"web.archive.org",[52,1298,1299],{},"archive.ph"," 做过存档，如遇到原站点无法访问的情况，可自行前往这两个站点查看存档。",[245,1302,1303],{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":3,"depth":3,"links":1305},[1306,1307,1308,1309,1313],{"id":1125,"depth":3,"text":1125},{"id":1137,"depth":3,"text":1137},{"id":1187,"depth":3,"text":1187},{"id":1214,"depth":3,"text":1215,"children":1310},[1311,1312],{"id":1218,"depth":144,"text":1218},{"id":1256,"depth":144,"text":1257},{"id":1266,"depth":3,"text":1266},{"title":1315,"date":1316,"path":1317,"tags":1318,"body":1320},"使用caddy反向代理维基百科中文站点","2022-05-30 08:59:21","/2022/05/30/use-caddy-to-proxy-wikipedia",[1319],"Caddy",{"type":13,"value":1321,"toc":1713},[1322,1325,1333,1336,1339,1369,1373,1651,1654,1660,1667,1674,1681,1683,1705,1710],[19,1323,1324],{},"反代的目的无非是两点",[266,1326,1327,1330],{},[269,1328,1329],{},"满足自己在无代理情况下访问无法访问的站点的需求",[269,1331,1332],{},"方便将站点分享给亲朋好友。",[19,1334,1335],{},"一直以来，我都想用 caddy 去反代一份维基百科来用，今天刚好就顺手解决了。",[34,1337,1338],{"id":1338},"注意事项",[266,1340,1341,1344,1347,1350],{},[269,1342,1343],{},"用于反代的机子需要有对目标站点的访问能力",[269,1345,1346],{},"最好准备一个新的域名作为白手套，防止被污染",[269,1348,1349],{},"建议增加密码保护，一来使得小鸡流量不被滥用，二来防止防火墙检测到站点内容",[269,1351,1352,1353,1356,1357,1360,1361,1365,1366,1368],{},"本文使用的 caddy 开启了 ",[52,1354,1355],{},"replace_response"," 插件，可以使用 ",[52,1358,1359],{},"xcaddy"," 编译或直接前往 ",[26,1362,1363],{"href":1363,"rel":1364},"https://caddyserver.com/download",[30]," 勾选相应插件后下载。安装时，建议先根据官方文档安装原版 caddy，再用启用了 ",[52,1367,1355],{}," 插件的 caddy 二进制文件覆盖掉原版 caddy，这样就不需要去手写 systemd 相关的文件了。",[34,1370,1372],{"id":1371},"caddyfile","Caddyfile",[201,1374,1378],{"className":1375,"code":1376,"language":1377,"meta":138,"style":138},"language-nginx shiki shiki-themes github-light github-dark","{\n        order replace after encode\n}\n\nhttps://zhwiki.example.com {\n\n        reverse_proxy * https://zh.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://m.zhwiki.example.com {\n\n        reverse_proxy * https://zh.m.wikipedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n        }\n\n        replace {\n                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n        }\n}\n\nhttps://up.zhwiki.example.com {\n        reverse_proxy * https://upload.wikimedia.org {\n                header_up Host {upstream_hostport}\n                header_up X-Real-IP {http.request.remote.host}\n                header_up X-Forwarded-For {http.request.remote.host}\n                header_up X-Forwarded-Port {http.request.port}\n                header_up X-Forwarded-Proto {http.request.scheme}\n                header_up Accept-Encoding identity\n        }\n}\n\n","nginx",[52,1379,1380,1384,1389,1393,1399,1404,1408,1413,1418,1423,1428,1433,1438,1443,1448,1453,1458,1462,1467,1472,1477,1482,1487,1492,1497,1503,1508,1514,1519,1524,1529,1534,1539,1544,1549,1554,1559,1564,1569,1574,1579,1584,1589,1594,1599,1605,1611,1616,1621,1626,1631,1636,1641,1646],{"__ignoreMap":138},[209,1381,1382],{"class":211,"line":212},[209,1383,552],{},[209,1385,1386],{"class":211,"line":3},[209,1387,1388],{},"        order replace after encode\n",[209,1390,1391],{"class":211,"line":144},[209,1392,685],{},[209,1394,1395],{"class":211,"line":570},[209,1396,1398],{"emptyLinePlaceholder":1397},true,"\n",[209,1400,1401],{"class":211,"line":585},[209,1402,1403],{},"https://zhwiki.example.com {\n",[209,1405,1406],{"class":211,"line":598},[209,1407,1398],{"emptyLinePlaceholder":1397},[209,1409,1410],{"class":211,"line":611},[209,1411,1412],{},"        reverse_proxy * https://zh.wikipedia.org {\n",[209,1414,1415],{"class":211,"line":620},[209,1416,1417],{},"                header_up Host {upstream_hostport}\n",[209,1419,1420],{"class":211,"line":626},[209,1421,1422],{},"                header_up X-Real-IP {http.request.remote.host}\n",[209,1424,1425],{"class":211,"line":639},[209,1426,1427],{},"                header_up X-Forwarded-For {http.request.remote.host}\n",[209,1429,1430],{"class":211,"line":652},[209,1431,1432],{},"                header_up X-Forwarded-Port {http.request.port}\n",[209,1434,1435],{"class":211,"line":665},[209,1436,1437],{},"                header_up X-Forwarded-Proto {http.request.scheme}\n",[209,1439,1440],{"class":211,"line":676},[209,1441,1442],{},"                header_up Accept-Encoding identity\n",[209,1444,1445],{"class":211,"line":682},[209,1446,1447],{},"                header_down location (https://zh.wikipedia.org/)(.*) https://zhwiki.example.com/$2\n",[209,1449,1450],{"class":211,"line":1056},[209,1451,1452],{},"                header_down location (https://zh.m.wikipedia.org/)(.*) http://m.zhwiki.example.com/$2\n",[209,1454,1455],{"class":211,"line":1062},[209,1456,1457],{},"        }\n",[209,1459,1460],{"class":211,"line":1068},[209,1461,1398],{"emptyLinePlaceholder":1397},[209,1463,1464],{"class":211,"line":1074},[209,1465,1466],{},"        replace {\n",[209,1468,1469],{"class":211,"line":1080},[209,1470,1471],{},"                \"upload.wikimedia.org\" \"up.zhwiki.example.com\"\n",[209,1473,1474],{"class":211,"line":1086},[209,1475,1476],{},"                \"zh.wikipedia.org\" \"zhwiki.example.com\"\n",[209,1478,1479],{"class":211,"line":1092},[209,1480,1481],{},"                \"zh.m.wikipedia.org\" \"m.zhwiki.example.com\"\n",[209,1483,1485],{"class":211,"line":1484},22,[209,1486,1457],{},[209,1488,1490],{"class":211,"line":1489},23,[209,1491,685],{},[209,1493,1495],{"class":211,"line":1494},24,[209,1496,1398],{"emptyLinePlaceholder":1397},[209,1498,1500],{"class":211,"line":1499},25,[209,1501,1502],{},"https://m.zhwiki.example.com {\n",[209,1504,1506],{"class":211,"line":1505},26,[209,1507,1398],{"emptyLinePlaceholder":1397},[209,1509,1511],{"class":211,"line":1510},27,[209,1512,1513],{},"        reverse_proxy * https://zh.m.wikipedia.org {\n",[209,1515,1517],{"class":211,"line":1516},28,[209,1518,1417],{},[209,1520,1522],{"class":211,"line":1521},29,[209,1523,1422],{},[209,1525,1527],{"class":211,"line":1526},30,[209,1528,1427],{},[209,1530,1532],{"class":211,"line":1531},31,[209,1533,1432],{},[209,1535,1537],{"class":211,"line":1536},32,[209,1538,1437],{},[209,1540,1542],{"class":211,"line":1541},33,[209,1543,1442],{},[209,1545,1547],{"class":211,"line":1546},34,[209,1548,1447],{},[209,1550,1552],{"class":211,"line":1551},35,[209,1553,1452],{},[209,1555,1557],{"class":211,"line":1556},36,[209,1558,1457],{},[209,1560,1562],{"class":211,"line":1561},37,[209,1563,1398],{"emptyLinePlaceholder":1397},[209,1565,1567],{"class":211,"line":1566},38,[209,1568,1466],{},[209,1570,1572],{"class":211,"line":1571},39,[209,1573,1471],{},[209,1575,1577],{"class":211,"line":1576},40,[209,1578,1476],{},[209,1580,1582],{"class":211,"line":1581},41,[209,1583,1481],{},[209,1585,1587],{"class":211,"line":1586},42,[209,1588,1457],{},[209,1590,1592],{"class":211,"line":1591},43,[209,1593,685],{},[209,1595,1597],{"class":211,"line":1596},44,[209,1598,1398],{"emptyLinePlaceholder":1397},[209,1600,1602],{"class":211,"line":1601},45,[209,1603,1604],{},"https://up.zhwiki.example.com {\n",[209,1606,1608],{"class":211,"line":1607},46,[209,1609,1610],{},"        reverse_proxy * https://upload.wikimedia.org {\n",[209,1612,1614],{"class":211,"line":1613},47,[209,1615,1417],{},[209,1617,1619],{"class":211,"line":1618},48,[209,1620,1422],{},[209,1622,1624],{"class":211,"line":1623},49,[209,1625,1427],{},[209,1627,1629],{"class":211,"line":1628},50,[209,1630,1432],{},[209,1632,1634],{"class":211,"line":1633},51,[209,1635,1437],{},[209,1637,1639],{"class":211,"line":1638},52,[209,1640,1442],{},[209,1642,1644],{"class":211,"line":1643},53,[209,1645,1457],{},[209,1647,1649],{"class":211,"line":1648},54,[209,1650,685],{},[34,1652,1653],{"id":1653},"简单解释",[19,1655,1656,1657,1659],{},"第一大段是启用 ",[52,1658,1355],{}," 插件的部分，直接照抄即可。",[19,1661,1662,1663,1666],{},"第二和第三大段的思路是一致的，分别反向代理了 PC 端和移动段的网页。两行 ",[52,1664,1665],{}," header_down"," 的写法是受到了知乎上那篇 Github 反代的启发，避免了源站发出 302 重定向时访客被带到源站去。replace 部分不用多说，就是将针对三个源站域名的请求改到反代站域名。",[19,1668,1669,1670,1673],{},"第四大段就是中规中举地反代了 ",[52,1671,1672],{},"upload.wikimedia.org"," 这个域名，上面存放的大多数是媒体文件，如果条件允许的话其实可以考虑使用多个服务器反代。",[19,1675,1676,1677,105],{},"密码保护在我这份 Caddyfile 中没有启用，如果有需要的话可以参考我的",[26,1678,1680],{"href":1679},"/2021/10/21/picuploader-on-archlinux-with-caddy/#%E8%AE%BE%E7%BD%AE%E8%AE%BF%E9%97%AE%E5%AF%86%E7%A0%81%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89","另一篇博客",[34,1682,1266],{"id":1266},[19,1684,1685,1690,1695,1700],{},[26,1686,1689],{"href":1687,"rel":1688},"https://caddyserver.com/docs/",[30],"Caddy 官方文档",[26,1691,1694],{"href":1692,"rel":1693},"https://zhuanlan.zhihu.com/p/476390779",[30],"The Road to Serfdom——如何为GitHub搭建反向代理",[26,1696,1699],{"href":1697,"rel":1698},"https://ichon.me/post/1026.html",[30],"使用 Caddy 配置 Wikipedia 反向代理",[26,1701,1704],{"href":1702,"rel":1703},"https://learningman.top/archives/365",[30],"使用 Caddy 反代 ghcr.io",[19,1706,1707],{},[1291,1708,1709],{},"所有参考资料除官方文档外均使用 web.archive.org 和 archive.ph 进行存档，如有无法访问的情况，请自行前往存档站获取历史存档。",[245,1711,1712],{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":3,"depth":3,"links":1714},[1715,1716,1717,1718],{"id":1338,"depth":3,"text":1338},{"id":1371,"depth":3,"text":1372},{"id":1653,"depth":3,"text":1653},{"id":1266,"depth":3,"text":1266},{"title":1720,"date":1721,"path":1722,"tags":1723,"body":1724},"创建一个本地的 Fedora 镜像源","2022-05-11 04:18:26","/2022/05/11/setup-a-local-fedora-source",[719,1319],{"type":13,"value":1725,"toc":2074},[1726,1735,1738,1761,1764,1767,1774,1777,1780,1791,1798,1810,1816,1822,1825,1833,1850,1855,1861,1865,1868,1871,1880,1883,1889,1892,1911,1914,1920,1923,1929,1936,2001,2008,2062,2071],[16,1727,1728],{},[19,1729,1730,1731,1734],{},"Fedora 36 在多次跳票后，总算是在 5月10日正式发布了。截止北京时间 5月11日凌晨两点，上海交通大学开源镜像站的上游 ",[52,1732,1733],{},"rsync://download-ib01.fedoraproject.org/","  仍然没有同步 Fedora 36 的 Release 源。鉴于 Release 自 freeze 以后基本是不会有什么大变动的，也不需要及时同步更新，干脆就直接建立一个本地的镜像源。",[34,1736,1737],{"id":1737},"准备",[1739,1740,1741,1748,1758],"ol",{},[269,1742,1743,1744,1747],{},"一块足够大的硬盘",[1745,1746],"br",{},"根据我个人实测，单 Fedora 36 的 x86_64 架构 的 Release 源中的 binary rpm 就占用了 89.6 GB，具体准备多的的硬盘空间还得看你具体需要同步些什么。",[269,1749,1750,1751,1753,1754,1757],{},"符合要求的上游",[1745,1752],{},"这里所说的符合要求一共是两个方面，一是允许 rsync 同步，二是有你想要的文件。我通过 getfedora.org 的下载按钮的转发目标得知 ",[52,1755,1756],{},"mirror.karneval.cz"," 已经完成了 Fedora 36 Release 源的同步。",[269,1759,1760],{},"良好的网络条件",[19,1762,1763],{},"这里说的良好的网络条件，并不一定是说需要访问境外站点的能力，而是你和你的上游之间的网络访问畅通，不要动不动就i断开连接那种。如果你选择的是国内镜像站作为你的上游，那一般不会有什么问题。",[34,1765,1766],{"id":1766},"开始同步",[19,1768,1769,1770,1773],{},"现在的主流方案一般都是选择 ",[52,1771,1772],{},"rsync"," 直接开整。",[84,1775,1776],{"id":1776},"试探环节",[19,1778,1779],{},"很多镜像站的 rsync 文件路径和 http 文件路径路径是不同的。",[19,1781,1782,1783,1786,1787,1790],{},"比如说，我这里用的 mirror.karneval.cz 的 http 页面显示的 fedora 仓库路径在 ",[52,1784,1785],{},"/pub/fedora","，但 rsync 同步时需要使用 ",[52,1788,1789],{},"/fedora"," 路径。",[19,1792,1793,1794,1797],{},"为了确定这一点，我们可以先通过 ",[52,1795,1796],{},"rsync rsync://example.com"," 进行预览",[201,1799,1801],{"className":203,"code":1800,"language":205,"meta":138,"style":138},"rsync rsync://mirror.karneval.cz\n",[52,1802,1803],{"__ignoreMap":138},[209,1804,1805,1807],{"class":211,"line":212},[209,1806,1772],{"class":215},[209,1808,1809],{"class":219}," rsync://mirror.karneval.cz\n",[19,1811,1812],{},[133,1813],{"alt":1814,"src":1815},"image-20220511103736493","https://static.031130.xyz/uploads/2024/08/12/627b2177c4da2.webp",[19,1817,1818,1819],{},"通过一层一层预览目录的方式，找到需要同步的路径是 ",[52,1820,1821],{},"/fedora/linux/releases/36/Everything/x86_64/os/",[84,1823,1824],{"id":1824},"同步环节",[19,1826,1827,1828,453,1830,1832],{},"通过 ",[52,1829,357],{},[52,1831,314],{}," 创建并进入我们准备用于同步源码的文件夹，然后开始执行同步命令。",[201,1834,1836],{"className":203,"code":1835,"language":205,"meta":138,"style":138},"rsync -avP rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/ .\n",[52,1837,1838],{"__ignoreMap":138},[209,1839,1840,1842,1845,1848],{"class":211,"line":212},[209,1841,1772],{"class":215},[209,1843,1844],{"class":223}," -avP",[209,1846,1847],{"class":219}," rsync://mirror.karneval.cz/fedora/linux/releases/36/Everything/x86_64/os/",[209,1849,340],{"class":219},[19,1851,1852],{},[1291,1853,1854],{},"Ps: 中途如果由于各种原因而中断了同步过程，可以再次使用上述命令继续同步，rsync 会保证文件完整性。",[19,1856,1857],{},[133,1858],{"alt":1859,"src":1860},"耗费两个半小时，同步成功","https://static.031130.xyz/uploads/2024/08/12/627b22fa44446.webp",[34,1862,1864],{"id":1863},"安装配置并启用-static-server-可选","安装、配置并启用 static server (可选)",[19,1866,1867],{},"如果只需要本机使用，那么直接跳过这一步即可；如果需要给局域网内的其他机器提供镜像源，那么需要启用 static server。",[19,1869,1870],{},"我这里选择的是 caddy，性能虽然比 nginx 略逊一筹，但胜在配置简单。",[19,1872,1873,1874,1879],{},"caddy 的安装可以直接参考",[26,1875,1878],{"href":1876,"rel":1877},"https://caddyserver.com/docs/install",[30],"官方文档","，这里不再赘述。",[19,1881,1882],{},"配置也不过那么几行的事情，我给个 example。端口号只要和别的程序没有冲突，就可以随意指定。443 端口需要 ssl 证书比较麻烦，局域网内直接用非标准端口即可。",[201,1884,1887],{"className":1885,"code":1886,"language":1248},[1246],":14567 {\n        root * /the/directory/you/use\n\n        file_server {\n                browse\n        }\n}\n",[52,1888,1886],{"__ignoreMap":138},[19,1890,1891],{},"配置完后直接以普通用户的权限启用即可，使用 systemd 启用需要解决 caddy 用户对目标无权限的问题。",[201,1893,1895],{"className":203,"code":1894,"language":205,"meta":138,"style":138},"caddy run --config /etc/caddy/Caddyfile\n",[52,1896,1897],{"__ignoreMap":138},[209,1898,1899,1902,1905,1908],{"class":211,"line":212},[209,1900,1901],{"class":215},"caddy",[209,1903,1904],{"class":219}," run",[209,1906,1907],{"class":223}," --config",[209,1909,1910],{"class":219}," /etc/caddy/Caddyfile\n",[19,1912,1913],{},"浏览器输入对应的 ip 和端口，应该就可以访问了。",[19,1915,1916],{},[133,1917],{"alt":1918,"src":1919},"image-20220511113417004","https://static.031130.xyz/uploads/2024/08/12/627b2ebd23331.webp",[34,1921,1922],{"id":1922},"修改源配置文件",[19,1924,1925,1926,237],{},"由于我们仅同步了 Release 源，就只需要修改 ",[52,1927,1928],{},"/etc/yum.repo.d/fedora.repo",[19,1930,1931,1932,1935],{},"如果镜像源在本机上，可以直接使用 ",[52,1933,1934],{},"file://"," 协议头:",[201,1937,1939],{"className":982,"code":1938,"language":984,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=file:///the/directory/you/use\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,1940,1941,1946,1951,1956,1961,1966,1971,1976,1981,1986,1991,1996],{"__ignoreMap":138},[209,1942,1943],{"class":211,"line":212},[209,1944,1945],{},"[fedora]\n",[209,1947,1948],{"class":211,"line":3},[209,1949,1950],{},"name=Fedora $releasever - $basearch\n",[209,1952,1953],{"class":211,"line":144},[209,1954,1955],{},"+ baseurl=file:///the/directory/you/use\n",[209,1957,1958],{"class":211,"line":570},[209,1959,1960],{},"- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\n",[209,1962,1963],{"class":211,"line":585},[209,1964,1965],{},"enabled=1\n",[209,1967,1968],{"class":211,"line":598},[209,1969,1970],{},"countme=1\n",[209,1972,1973],{"class":211,"line":611},[209,1974,1975],{},"metadata_expire=7d\n",[209,1977,1978],{"class":211,"line":620},[209,1979,1980],{},"repo_gpgcheck=0\n",[209,1982,1983],{"class":211,"line":626},[209,1984,1985],{},"type=rpm\n",[209,1987,1988],{"class":211,"line":639},[209,1989,1990],{},"gpgcheck=1\n",[209,1992,1993],{"class":211,"line":652},[209,1994,1995],{},"gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\n",[209,1997,1998],{"class":211,"line":665},[209,1999,2000],{},"skip_if_unavailable=False\n",[19,2002,2003,2004,2007],{},"如果镜像源在同局域网设备上，通过 ",[52,2005,2006],{},"http://"," 协议也能达到相同的效果:",[201,2009,2011],{"className":982,"code":2010,"language":984,"meta":138,"style":138},"[fedora]\nname=Fedora $releasever - $basearch\n+ baseurl=http://192.168.1.233:14567\n- metalink=https://mirrors.fedoraproject.org/metalink?repo=fedora-$releasever&arch=$basearch\nenabled=1\ncountme=1\nmetadata_expire=7d\nrepo_gpgcheck=0\ntype=rpm\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch\nskip_if_unavailable=False\n",[52,2012,2013,2017,2021,2026,2030,2034,2038,2042,2046,2050,2054,2058],{"__ignoreMap":138},[209,2014,2015],{"class":211,"line":212},[209,2016,1945],{},[209,2018,2019],{"class":211,"line":3},[209,2020,1950],{},[209,2022,2023],{"class":211,"line":144},[209,2024,2025],{},"+ baseurl=http://192.168.1.233:14567\n",[209,2027,2028],{"class":211,"line":570},[209,2029,1960],{},[209,2031,2032],{"class":211,"line":585},[209,2033,1965],{},[209,2035,2036],{"class":211,"line":598},[209,2037,1970],{},[209,2039,2040],{"class":211,"line":611},[209,2041,1975],{},[209,2043,2044],{"class":211,"line":620},[209,2045,1980],{},[209,2047,2048],{"class":211,"line":626},[209,2049,1985],{},[209,2051,2052],{"class":211,"line":639},[209,2053,1990],{},[209,2055,2056],{"class":211,"line":652},[209,2057,1995],{},[209,2059,2060],{"class":211,"line":665},[209,2061,2000],{},[19,2063,2064],{},[1291,2065,2066,2067,2070],{},"Ps: 提供镜像源的机子的局域网 ip 可以通过 ",[52,2068,2069],{},"ip -br a"," 命令获取",[245,2072,2073],{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}",{"title":138,"searchDepth":3,"depth":3,"links":2075},[2076,2077,2081,2082],{"id":1737,"depth":3,"text":1737},{"id":1766,"depth":3,"text":1766,"children":2078},[2079,2080],{"id":1776,"depth":144,"text":1776},{"id":1824,"depth":144,"text":1824},{"id":1863,"depth":3,"text":1864},{"id":1922,"depth":3,"text":1922},{"title":2084,"date":2085,"path":2086,"tags":2087,"body":2090},"好软推荐——FastOCR","2022-04-14 05:55:18","/2022/04/14/fastocr-experience",[2088,2089],"Experience","OpenSource Project",{"type":13,"value":2091,"toc":2165},[2092,2095,2109,2130,2136,2150,2156,2159],[19,2093,2094],{},"前两天在 PC 端有 OCR 的需求，需求如下",[266,2096,2097,2100,2103,2106],{},[269,2098,2099],{},"自带框选功能或者图片上传前的编辑功能",[269,2101,2102],{},"硬盘占用小，不要 electron (((已经受够了",[269,2104,2105],{},"支持系统托盘或者快捷键快速调出",[269,2107,2108],{},"免费",[19,2110,2111,2112,2117,2118,2123,2124,2129],{},"在",[26,2113,2116],{"href":2114,"rel":2115},"https://liolok.com/",[30],"李皓奇","的推荐下试用了 Arch 群",[26,2119,2122],{"href":2120,"rel":2121},"https://github.com/BruceZhang1993",[30],"兔兔","拿 python 和 qt 写的 ",[26,2125,2128],{"href":2126,"rel":2127},"https://github.com/BruceZhang1993/FastOCR",[30],"fastocr","，体验可以说是相当不错了。四个要求基本都能完美满足！",[19,2131,2132],{},[133,2133],{"alt":2134,"src":2135},"操作简单快捷","https://static.031130.xyz/uploads/2024/08/12/a4ddb3b05e19c.gif",[19,2137,2138,2139,2142,2143,2142,2146,2149],{},"支持 ",[1291,2140,2141],{},"百度","、",[1291,2144,2145],{},"有道",[1291,2147,2148],{},"旷视Face++"," 三家的接口，免费额度绝对够我试用的（大不了一家用完了换一家嘛",[19,2151,2152],{},[133,2153],{"alt":2154,"src":2155},"设置界面","https://static.031130.xyz/uploads/2024/08/12/488835757d5e3.webp",[19,2157,2158],{},"此外，空间占用小，算上依赖也不过 31MB 的硬盘空间占用，连半个 electron 都不到，运行起来反而更加流畅 \u003C^_^>",[19,2160,2161],{},[133,2162],{"alt":2163,"src":2164},"诶？哪里来的atpoossfl","https://static.031130.xyz/uploads/2024/08/12/a404346841d02.webp",{"title":138,"searchDepth":3,"depth":3,"links":2166},[],{"title":2168,"date":2169,"path":2170,"tags":2171,"body":2175},"抛弃PicGo，直接使用curl将图片上传到LskyPro","2022-03-31 19:19:14","/2022/03/31/upload-pic-to-lskypro-with-curl",[2172,2173,2174],"Shell Script","图床","Lsky Pro",{"type":13,"value":2176,"toc":2600},[2177,2184,2202,2214,2223,2228,2231,2234,2245,2248,2581,2586,2589,2592,2597],[19,2178,2179,2180,2183],{},"前一阵子为了图床折腾了好长一段时间。刚开始用的是 cloudinary，虽然每月有限制，但强在境内访问速度还不错，可惜后来 ",[52,2181,2182],{},"res.cloudinary.com"," 这个域名在某些地方被 DNS 污染了，而自定义域名是付费版的功能，就不得不放弃了。",[19,2185,2186,2187,2190,2191,2196,2197,105],{},"后来也尝试过 npm图床 的方案，可惜面对这种滥用公共资源的行为我无法接受~~（肯定不是因为受不了那繁琐的上传步骤，随便传张图都得 bump 下版本号的原因）~~，而且现在境内的能作为图床使用的 npm 镜像似乎也就只剩下 ",[52,2188,2189],{},"npm.elemecdn.com"," 这一个能够正常回源了，没准哪天就用不了了，所以就去投奔了",[26,2192,2195],{"href":2193,"rel":2194},"https://dusays.com/",[30],"杜老师","的",[26,2198,2201],{"href":2199,"rel":2200},"https://7bu.top/",[30],"去不图床",[19,2203,2204,2205,2209,2210,2213],{},"去不图床采用开源图床程序 ",[26,2206,2174],{"href":2207,"rel":2208},"https://www.lsky.pro/",[30]," 搭建，没有免费服务，且配置了鉴黄服务，看起来就是打算长久做下去的图床站点。境内使用腾讯云cdn，境外采用 cloudflare cdn，速度都挺让我满意的。",[166,2211,2212],{},"（杜老师看见请给我打钱，或者多送我点空间也行","（x",[19,2215,2216,2217,2222],{},"Typora 一直是我写博客的主用 Markdown 编辑器，之前我采用 Typora 调用 ",[26,2218,2221],{"href":2219,"rel":2220},"https://github.com/xiebruce/PicUploader",[30],"PicUploader(php)"," 自动上传图片的方案写博客，体验相当不错，如图:",[19,2224,2225],{},[133,2226],{"alt":138,"src":2227},"https://static.031130.xyz/uploads/2024/08/12/62f3b881e3c4c.gif",[19,2229,2230],{},"可惜 PicUploader 目前仍然没有支持 LskyPro 的上传，我采用的是现在烂大街的 Typora+PicGo+LskyPro插件 的方案去实现 Typora 的自动上传图片功能。",[19,2232,2233],{},"这个方案有明显的弊端：",[266,2235,2236,2239,2242],{},[269,2237,2238],{},"PicGo 运行依赖于 electron，极大地消耗了系统资源。",[269,2240,2241],{},"PicGo 面对多张图片( >=4张 )同时上传时容易报错。",[269,2243,2244],{},"PicGo 对于 Linux 的支持比较有限，作者可能不熟悉 Linux，直到半个月前我去交了一个 pr 才支持 wayland 下使用 wl-clipboard 将图片链接复制到粘贴版。",[19,2246,2247],{},"正好 LskyPro 有详细的文档，应该可以用 curl 手糊一段 Shell 脚本实现直接上传，资源占用小，唯一的弊端是上传完成后的图片不容易管理。脚本如下",[201,2249,2251],{"className":203,"code":2250,"language":205,"meta":138,"style":138},"#!/bin/bash\n\nAPI_URL=\"https://7bu.top/api/v1\"\n\nAUTH_TOKEN=\"\"\n\nmarkdown=false\nwhile [[ \"$#\" -gt 0 ]]; do\n    case $1 in\n        -m|--markdown) markdown=true; shift ;;\n        *) break ;;\n    esac\ndone\n\nfor images in \"$@\"; do\n    UPLOAD_RESPONSE=$(curl -s -X POST \"$API_URL/upload\" \\\n        -H 'Content-Type: multipart/form-data' \\\n        -H \"Authorization: Bearer $AUTH_TOKEN\" \\\n        -F \"file=@$images\")\n\n    if [ \"$markdown\" = true ]; then\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.markdown\n    else\n        echo \"$UPLOAD_RESPONSE\" | jq -r .data.links.url\n    fi\ndone\n",[52,2252,2253,2258,2262,2273,2277,2287,2291,2301,2329,2341,2373,2383,2388,2393,2397,2420,2453,2463,2477,2493,2497,2524,2548,2553,2572,2577],{"__ignoreMap":138},[209,2254,2255],{"class":211,"line":212},[209,2256,991],{"class":2257},"sJ8bj",[209,2259,2260],{"class":211,"line":3},[209,2261,1398],{"emptyLinePlaceholder":1397},[209,2263,2264,2267,2270],{"class":211,"line":144},[209,2265,2266],{"class":310},"API_URL",[209,2268,2269],{"class":360},"=",[209,2271,2272],{"class":219},"\"https://7bu.top/api/v1\"\n",[209,2274,2275],{"class":211,"line":570},[209,2276,1398],{"emptyLinePlaceholder":1397},[209,2278,2279,2282,2284],{"class":211,"line":585},[209,2280,2281],{"class":310},"AUTH_TOKEN",[209,2283,2269],{"class":360},[209,2285,2286],{"class":219},"\"\"\n",[209,2288,2289],{"class":211,"line":598},[209,2290,1398],{"emptyLinePlaceholder":1397},[209,2292,2293,2296,2298],{"class":211,"line":611},[209,2294,2295],{"class":310},"markdown",[209,2297,2269],{"class":360},[209,2299,2300],{"class":219},"false\n",[209,2302,2303,2306,2309,2312,2315,2317,2320,2323,2326],{"class":211,"line":620},[209,2304,2305],{"class":360},"while",[209,2307,2308],{"class":310}," [[ ",[209,2310,2311],{"class":219},"\"",[209,2313,2314],{"class":223},"$#",[209,2316,2311],{"class":219},[209,2318,2319],{"class":360}," -gt",[209,2321,2322],{"class":223}," 0",[209,2324,2325],{"class":310}," ]]; ",[209,2327,2328],{"class":360},"do\n",[209,2330,2331,2334,2338],{"class":211,"line":626},[209,2332,2333],{"class":360},"    case",[209,2335,2337],{"class":2336},"s4XuR"," $1",[209,2339,2340],{"class":360}," in\n",[209,2342,2343,2347,2350,2353,2356,2359,2361,2364,2367,2370],{"class":211,"line":639},[209,2344,2346],{"class":2345},"sA_wV","        -m",[209,2348,2349],{"class":360},"|",[209,2351,2352],{"class":2345},"--markdown",[209,2354,2355],{"class":360},")",[209,2357,2358],{"class":310}," markdown",[209,2360,2269],{"class":360},[209,2362,2363],{"class":219},"true",[209,2365,2366],{"class":310},"; ",[209,2368,2369],{"class":223},"shift",[209,2371,2372],{"class":310}," ;;\n",[209,2374,2375,2378,2381],{"class":211,"line":652},[209,2376,2377],{"class":360},"        *)",[209,2379,2380],{"class":360}," break",[209,2382,2372],{"class":310},[209,2384,2385],{"class":211,"line":665},[209,2386,2387],{"class":360},"    esac\n",[209,2389,2390],{"class":211,"line":676},[209,2391,2392],{"class":360},"done\n",[209,2394,2395],{"class":211,"line":682},[209,2396,1398],{"emptyLinePlaceholder":1397},[209,2398,2399,2402,2405,2408,2411,2414,2416,2418],{"class":211,"line":1056},[209,2400,2401],{"class":360},"for",[209,2403,2404],{"class":310}," images ",[209,2406,2407],{"class":360},"in",[209,2409,2410],{"class":219}," \"",[209,2412,2413],{"class":223},"$@",[209,2415,2311],{"class":219},[209,2417,2366],{"class":310},[209,2419,2328],{"class":360},[209,2421,2422,2425,2427,2430,2433,2436,2439,2442,2444,2447,2450],{"class":211,"line":1062},[209,2423,2424],{"class":310},"    UPLOAD_RESPONSE",[209,2426,2269],{"class":360},[209,2428,2429],{"class":310},"$(",[209,2431,2432],{"class":215},"curl",[209,2434,2435],{"class":223}," -s",[209,2437,2438],{"class":223}," -X",[209,2440,2441],{"class":219}," POST",[209,2443,2410],{"class":219},[209,2445,2446],{"class":310},"$API_URL",[209,2448,2449],{"class":219},"/upload\"",[209,2451,2452],{"class":223}," \\\n",[209,2454,2455,2458,2461],{"class":211,"line":1068},[209,2456,2457],{"class":223},"        -H",[209,2459,2460],{"class":219}," 'Content-Type: multipart/form-data'",[209,2462,2452],{"class":223},[209,2464,2465,2467,2470,2473,2475],{"class":211,"line":1074},[209,2466,2457],{"class":223},[209,2468,2469],{"class":219}," \"Authorization: Bearer ",[209,2471,2472],{"class":310},"$AUTH_TOKEN",[209,2474,2311],{"class":219},[209,2476,2452],{"class":223},[209,2478,2479,2482,2485,2488,2490],{"class":211,"line":1080},[209,2480,2481],{"class":223},"        -F",[209,2483,2484],{"class":219}," \"file=@",[209,2486,2487],{"class":310},"$images",[209,2489,2311],{"class":219},[209,2491,2492],{"class":310},")\n",[209,2494,2495],{"class":211,"line":1086},[209,2496,1398],{"emptyLinePlaceholder":1397},[209,2498,2499,2502,2505,2507,2510,2512,2515,2518,2521],{"class":211,"line":1092},[209,2500,2501],{"class":360},"    if",[209,2503,2504],{"class":310}," [ ",[209,2506,2311],{"class":219},[209,2508,2509],{"class":310},"$markdown",[209,2511,2311],{"class":219},[209,2513,2514],{"class":360}," =",[209,2516,2517],{"class":223}," true",[209,2519,2520],{"class":310}," ]; ",[209,2522,2523],{"class":360},"then\n",[209,2525,2526,2529,2531,2534,2536,2539,2542,2545],{"class":211,"line":1484},[209,2527,2528],{"class":223},"        echo",[209,2530,2410],{"class":219},[209,2532,2533],{"class":310},"$UPLOAD_RESPONSE",[209,2535,2311],{"class":219},[209,2537,2538],{"class":360}," |",[209,2540,2541],{"class":215}," jq",[209,2543,2544],{"class":223}," -r",[209,2546,2547],{"class":219}," .data.links.markdown\n",[209,2549,2550],{"class":211,"line":1489},[209,2551,2552],{"class":360},"    else\n",[209,2554,2555,2557,2559,2561,2563,2565,2567,2569],{"class":211,"line":1494},[209,2556,2528],{"class":223},[209,2558,2410],{"class":219},[209,2560,2533],{"class":310},[209,2562,2311],{"class":219},[209,2564,2538],{"class":360},[209,2566,2541],{"class":215},[209,2568,2544],{"class":223},[209,2570,2571],{"class":219}," .data.links.url\n",[209,2573,2574],{"class":211,"line":1499},[209,2575,2576],{"class":360},"    fi\n",[209,2578,2579],{"class":211,"line":1505},[209,2580,2392],{"class":360},[16,2582,2583],{},[19,2584,2585],{},"2022/04/02更新: 第六行 $@ - \"$@\"，解决文件名中出现空格时导致的上传失败问题。",[19,2587,2588],{},"需要借助 jq 来读取返回的 json，各 Linux 发行版源内应该都有打包，自行安装即可。",[19,2590,2591],{},"授予x可执行权限后，Typora 内直接填写自定义命令输入脚本所在位置即可实现 Typora 自动上传图片了。",[16,2593,2594],{},[19,2595,2596],{},"2023/12/12更新: 支持 -m 或 --markdown 参数，使脚本输出 markdown 格式的链接。",[245,2598,2599],{},"html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .s4XuR, html code.shiki .s4XuR{--shiki-default:#E36209;--shiki-dark:#FFAB70}html pre.shiki code .sA_wV, html code.shiki .sA_wV{--shiki-default:#032F62;--shiki-dark:#DBEDFF}html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":138,"searchDepth":3,"depth":3,"links":2601},[],127,1761699276514]