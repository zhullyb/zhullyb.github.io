[{"data":1,"prerenderedAt":3617},["ShallowReactive",2],{"randomIndex/page/10/":3,"language-switch-/page/10/-en":4,"index-page-10-zh":5,"posts-total-zh":3616},1,"/en/",[6,345,615,719,804,1090,1564,1906,2302,3295],{"title":7,"date":8,"path":9,"tags":10,"body":12},"Cutefish的前世今生","2021-12-12 00:10:34","/2021/12/12/the-history-of-cutefish",[11],"OpenSource Project",{"type":13,"value":14,"toc":331},"minimark",[15,22,25,28,31,34,39,44,47,54,69,73,76,106,109,118,122,130,139,143,161,164,173,177,182,185,240,243,257,259],[16,17,18],"blockquote",{},[19,20,21],"p",{},"CutefishOS是由我们国内的开发者主导（目前也主要是他们在开发）的桌面环境。不过似乎对于他的前世今生，似乎很多人都有误解。尤其是很多人认为他是一个Archlinux-based发行版；部分用户分不清他到底是基于Debian还是基于Ubuntu；还有人把它和 JingOS 弄混了。",[19,23,24],{},"先把这些问题的回答写在最前面:",[19,26,27],{},"CutefishOS 是一个基于Debian的发行版，他的前身 CyberOS 是一个基于 Archlinux 的发行版。但要注意: Cutefish （不加OS）可以单独指代 CutefishOS 所使用的桌面环境，为了避免混淆，本文中我将使用CutefishDE来指代他的桌面环境。",[19,29,30],{},"CutefishOS 和 JingOS 目前只是官网互加友链的关系，并不是相同的东西。Cutefish的开发方向是基于qt重写一套UI，而JingOS则更像是在开发一套KDE的主题。",[32,33],"hr",{},[35,36,38],"h2",{"id":37},"cutefish的历史","Cutefish的历史",[40,41,43],"h3",{"id":42},"cyberos的故事","CyberOS的故事",[19,45,46],{},"第一次体验到这个UI其实是在21年的3月，在Archlinux的QQ群里，群主向我们推荐了 CyberOS ，这是一个基于 Archlinux 的发行版。",[19,48,49],{},[50,51],"img",{"alt":52,"src":53},"QQ群公告","https://static.031130.xyz/uploads/2024/08/12/62f3cae911901.webp",[19,55,56,57],{},"由于基于 Archlinux，我直接就添加了CyberOS的源作为第三方源安装上了CyberDE，",[58,59,60,61,68],"del",{},"那会儿还顺手水了篇博客，由于后来事情发展太快，这篇博客早就不适用了，就干脆删了，现在在我的Github还能找到那会儿的",[62,63,67],"a",{"href":64,"rel":65},"https://github.com/zhullyb/blog/blob/20210430/_posts/2021-03-21-install-cyber-desktop-on-your-archlinux.md",[66],"nofollow","存档","。",[40,70,72],{"id":71},"更名cutefishos","更名CutefishOS",[19,74,75],{},"后来根据 CutefishOS 的QQ群的群主所说，是因为当时没注重海外平台的宣发，导致 CyberOS 的用户名在 Twitter 被抢注，因此决定改名 CutefishOS 。由于时间较为久远，QQ群的聊天记录已经几乎找不到了，我无法放出。",[19,77,78,79,90,98],{},"关于CutefishOS的创始时间我已经记不清了，但是可以推测是在21年的4~5月份左右。",[80,81,82],"sup",{},[62,83,89],{"href":84,"ariaDescribedBy":85,"dataFootnoteRef":87,"id":88},"#user-content-fn-1",[86],"footnote-label","","user-content-fnref-1","1",[80,91,92],{},[62,93,97],{"href":94,"ariaDescribedBy":95,"dataFootnoteRef":87,"id":96},"#user-content-fn-2",[86],"user-content-fnref-2","2",[80,99,100],{},[62,101,105],{"href":102,"ariaDescribedBy":103,"dataFootnoteRef":87,"id":104},"#user-content-fn-3",[86],"user-content-fnref-3","3",[40,107,108],{"id":108},"官网上线",[19,110,111,112,117],{},"21年5月12日，",[62,113,116],{"href":114,"rel":115},"https://cutefishos.com",[66],"cutefishos.com"," 上线，暂时不提供安装镜像。",[40,119,121],{"id":120},"进军arch系","进军Arch系",[19,123,124,125,68],{},"5月26日，CutefishDE进入 ",[62,126,129],{"href":127,"rel":128},"https://archlinux.org/groups/x86_64/cutefish/",[66],"Archlinux官方源",[19,131,132,133,138],{},"同日，Github 组织 manjaro-cutefish 放出了使用 CutefishDE 的 ",[62,134,137],{"href":135,"rel":136},"https://github.com/manjaro-cutefish/download/releases",[66],"manjaro安装镜像","。这个组织和官方的 github.com/cutefishos 没有共同维护者，因此可以基本断定是第三方打包的。",[40,140,142],{"id":141},"ubuntu第三方打包版的跟进","Ubuntu第三方打包版的跟进",[19,144,145,146,154,155,160],{},"大约在7月中旬左右",[80,147,148],{},[62,149,153],{"href":150,"ariaDescribedBy":151,"dataFootnoteRef":87,"id":152},"#user-content-fn-4",[86],"user-content-fnref-4","4","，Github出现了一位名为 cutefish-ubuntu 的用户，开始在 Ubutnu 上编译 CutefishDE ，并通过 ",[62,156,159],{"href":157,"rel":158},"https://cutefish-ubuntu.github.io/",[66],"GithubPages"," 发布安装镜像，依然是第三方打包的安装镜像。",[40,162,163],{"id":163},"官方版本释出",[19,165,166,167,172],{},"21年国庆长假期间，cutefishos.com 释出由 Cutefish官方发布的",[62,168,171],{"href":169,"rel":170},"https://cutefishos.com/download",[66],"基于Debian的CutefishOS镜像","，搭载的DE是 0.5 版本的，英文版网页提供 Google Drive 和 Mega 的下载链接，中文版本网页非常贴心地添加了使用飞书下载的方式方便国内用户下载。",[40,174,176],{"id":175},"rpm系的跟进","RPM系的跟进",[178,179,181],"h4",{"id":180},"copr","COPR",[19,183,184],{},"copr上分别有三名用户打包了CutefishDE/CyberDE，我以表格形式简单罗列一下",[186,187,188,204],"table",{},[189,190,191],"thead",{},[192,193,194,198,201],"tr",{},[195,196,197],"th",{},"用户名",[195,199,200],{},"打包的DE",[195,202,203],{},"第一次打包日期",[205,206,207,219,230],"tbody",{},[192,208,209,213,216],{},[210,211,212],"td",{},"rmnscnce",[210,214,215],{},"cutefish",[210,217,218],{},"2021.8.19",[192,220,221,224,227],{},[210,222,223],{},"cappyishihara",[210,225,226],{},"cyber",[210,228,229],{},"2021.11.17",[192,231,232,235,237],{},[210,233,234],{},"jesonlay",[210,236,215],{},[210,238,239],{},"2021.12.06",[178,241,242],{"id":242},"论坛用户",[19,244,245,246,251,252,68],{},"21年12月2日，一为名为",[62,247,250],{"href":248,"rel":249},"https://bbs.cutefishos.com/u/gesangtome",[66],"gesangtome","的网友在CutefishOS的论坛上",[62,253,256],{"href":254,"rel":255},"https://bbs.cutefishos.com/d/331-fedoracutefish",[66],"发布了自己编译的CutefishDE",[32,258],{},[260,261,264,269],"section",{"className":262,"dataFootnotes":87},[263],"footnotes",[35,265,268],{"className":266,"id":86},[267],"sr-only","Footnotes",[270,271,272,288,302,316],"ol",{},[273,274,276,277,280,281],"li",{"id":275},"user-content-fn-1","通过whois查询得知",[278,279,116],"code",{}," 这个域名注册时间为21年3月31日 ",[62,282,287],{"href":283,"ariaLabel":284,"className":285,"dataFootnoteBackref":87},"#user-content-fnref-1","Back to reference 1",[286],"data-footnote-backref","↩",[273,289,291,296,297],{"id":290},"user-content-fn-2",[62,292,295],{"href":293,"rel":294},"https://github.com/archlinux/svntogit-community/commit/b92bb9ae8fd35178cdfebb6f56b55f20722aa7dd",[66],"Cutefish进入Archlinux官方源","是在5月26日 ",[62,298,287],{"href":299,"ariaLabel":300,"className":301,"dataFootnoteBackref":87},"#user-content-fnref-2","Back to reference 2",[286],[273,303,305,310,311],{"id":304},"user-content-fn-3",[62,306,309],{"href":307,"rel":308},"https://github.com/cyberos",[66],"CyberOS的Github仓库","最后一次内容变更是在21年的5月23日 ",[62,312,287],{"href":313,"ariaLabel":314,"className":315,"dataFootnoteBackref":87},"#user-content-fnref-3","Back to reference 3",[286],[273,317,319,320,325,326],{"id":318},"user-content-fn-4","这里参考的是 cutefish-ubuntu/cutefish-ubuntu.github.io 仓库的",[62,321,324],{"href":322,"rel":323},"https://github.com/cutefish-ubuntu/cutefish-ubuntu.github.io/commit/237a480992a74d8c75c1f4ec51511550ce97c64b",[66],"第一个commit","的时间 ",[62,327,287],{"href":328,"ariaLabel":329,"className":330,"dataFootnoteBackref":87},"#user-content-fnref-4","Back to reference 4",[286],{"title":87,"searchDepth":332,"depth":332,"links":333},2,[334,344],{"id":37,"depth":332,"text":38,"children":335},[336,338,339,340,341,342,343],{"id":42,"depth":337,"text":43},3,{"id":71,"depth":337,"text":72},{"id":108,"depth":337,"text":108},{"id":120,"depth":337,"text":121},{"id":141,"depth":337,"text":142},{"id":163,"depth":337,"text":163},{"id":175,"depth":337,"text":176},{"id":86,"depth":332,"text":268},{"title":346,"date":347,"path":348,"tags":349,"body":352},"wolai再打包遇到的问题--electron应用的dev判断机制","2021-12-03 22:53:25","/2021/12/03/dev-app-update-in-wolai",[350,351],"Archlinux","electron",{"type":13,"value":353,"toc":612},[354,367,373,376,388,391,399,404,411,420,472,475,478,560,563,569,572,608],[19,355,356,357,362,363,366],{},"之前对于electron懵懵懂懂的时候就把 ",[62,358,361],{"href":359,"rel":360},"https://www.wolai.com/",[66],"wolai"," 给打包上了 AUR ，那会儿年少无知，也不懂得把内置的 electron 拆开来换成系统内置的以节省空间。前一阵子给CN源打完 Motrix 以后突然想起来自己在 AUR 上还有维护一个叫 wolai 的electron 应用，于是打算把软件内置的 electron 拆出来。尝试使用 ",[278,364,365],{},"electron /path/to/app.asar"," 命令启动的时候发现了以下的问题。",[19,368,369],{},[50,370],{"alt":371,"src":372},"报错了","https://static.031130.xyz/uploads/2024/08/12/62f3caf822bec.webp",[19,374,375],{},"虽然这个报错无关紧要，直接右上角叉掉也不影响软件正常使用，但是就这样推上 AUR 似乎有些不太妥当。于是使用搜索引擎查找答案。",[19,377,378,379,382,383],{},"发现是使用系统自带的 electron 启动时，app.asar 内置的一个叫 ",[278,380,381],{},"electron-updater"," 的模块在自动检测更新时会误认为我们此时处于开发模式，于是会尝试读取 app.asar 内部的 dev-app-update.yml 以查询更新。",[80,384,385],{},[62,386,89],{"href":84,"ariaDescribedBy":387,"dataFootnoteRef":87,"id":88},[86],[19,389,390],{},"但问题在于这个 app.asar 并不是 wolai 开发者在开发时使用 development 模式打出来的包，应该是 production ，所以内置的那个文件名叫 app-update.yml ，少了个dev 前缀，就很尴尬。",[19,392,393,394],{},"以下内容来自一篇简书的文章",[80,395,396],{},[62,397,97],{"href":94,"ariaDescribedBy":398,"dataFootnoteRef":87,"id":96},[86],[16,400,401],{},[19,402,403],{},"所以调试的时候可以建一个default-app.yml文件放在D:\\hzhh123\\workspace\\vue-work\\electron-demo1\\node_modules\\electron\\dist\\resources\\default_app.asar 下，这里就涉及到asar解压缩，但是这样会很麻烦，打包后也需要这样替换，麻烦，所幸electron-updater中提供了这个文件的属性配置updateConfigPath，可以通过设置这个属性来解决这个问题",[19,405,406,407,410],{},"很遗憾，我们并不是该应用的开发者，并不能指定",[278,408,409],{},"electron-uploader","构建时的参数，所以只能考虑解压缩 app.asar 手动放入 dev-app-update.yml 的方案。",[19,412,413,414,419],{},"根据又一篇简书的文章",[80,415,416],{},[62,417,105],{"href":102,"ariaDescribedBy":418,"dataFootnoteRef":87,"id":104},[86],"，我们了解到 npm 中有一个叫 asar 的程序可以帮助我们解压缩 app.asar。我这里直接将内容搬过来",[16,421,422,425,451,454],{},[19,423,424],{},"解压",[426,427,431],"pre",{"className":428,"code":429,"language":430,"meta":87,"style":87},"language-bash shiki shiki-themes one-light one-dark-pro","asar extract 压缩文件  解压文件夹\n","bash",[278,432,433],{"__ignoreMap":87},[434,435,437,441,445,448],"span",{"class":436,"line":3},"line",[434,438,440],{"class":439},"sAdtL","asar",[434,442,444],{"class":443},"sDhpE"," extract",[434,446,447],{"class":443}," 压缩文件",[434,449,450],{"class":443},"  解压文件夹\n",[19,452,453],{},"压缩：如果压缩文件存在，则会被替换",[426,455,457],{"className":428,"code":456,"language":430,"meta":87,"style":87},"asar pack 文件夹  压缩文件名\n",[278,458,459],{"__ignoreMap":87},[434,460,461,463,466,469],{"class":436,"line":3},[434,462,440],{"class":439},[434,464,465],{"class":443}," pack",[434,467,468],{"class":443}," 文件夹",[434,470,471],{"class":443},"  压缩文件名\n",[19,473,474],{},"原文是让我们直接使用 npm 下载安装 asar 程序，然而这就会让打包过程变得很复杂，所幸 Archlinux 官方源中已经将这个程序打完了，我们可以直接将 asar 写入 makedepends。",[19,476,477],{},"大概就写成了这个样子。",[426,479,481],{"className":428,"code":480,"language":430,"meta":87,"style":87},"asar extract ${srcdir}/squashfs-root/resources/app.asar ${srcdir}/new_app\nmv  ${srcdir}/squashfs-root/resources/app-update.yml ${srcdir}/new_app/dev-app-update.yml\nasar pack ${srcdir}/new_app ${srcdir}/squashfs-root/resources/app.asar\n",[278,482,483,512,536],{"__ignoreMap":87},[434,484,485,487,489,493,497,500,503,505,507,509],{"class":436,"line":3},[434,486,440],{"class":439},[434,488,444],{"class":443},[434,490,492],{"class":491},"sr1Ac"," ${",[434,494,496],{"class":495},"sJa8x","srcdir",[434,498,499],{"class":491},"}",[434,501,502],{"class":443},"/squashfs-root/resources/app.asar",[434,504,492],{"class":491},[434,506,496],{"class":495},[434,508,499],{"class":491},[434,510,511],{"class":443},"/new_app\n",[434,513,514,517,520,522,524,527,529,531,533],{"class":436,"line":332},[434,515,516],{"class":439},"mv",[434,518,519],{"class":491},"  ${",[434,521,496],{"class":495},[434,523,499],{"class":491},[434,525,526],{"class":443},"/squashfs-root/resources/app-update.yml",[434,528,492],{"class":491},[434,530,496],{"class":495},[434,532,499],{"class":491},[434,534,535],{"class":443},"/new_app/dev-app-update.yml\n",[434,537,538,540,542,544,546,548,551,553,555,557],{"class":436,"line":337},[434,539,440],{"class":439},[434,541,465],{"class":443},[434,543,492],{"class":491},[434,545,496],{"class":495},[434,547,499],{"class":491},[434,549,550],{"class":443},"/new_app",[434,552,492],{"class":491},[434,554,496],{"class":495},[434,556,499],{"class":491},[434,558,559],{"class":443},"/squashfs-root/resources/app.asar\n",[19,561,562],{},"程序正常启动，没有弹出之前的对话框了。",[19,564,565],{},[50,566],{"alt":567,"src":568},"成功啦","https://static.031130.xyz/uploads/2024/08/12/62f3cafb6b04d.webp",[19,570,571],{},"参考:",[260,573,575,578],{"className":574,"dataFootnotes":87},[263],[35,576,268],{"className":577,"id":86},[267],[270,579,580,590,599],{},[273,581,582,586,587],{"id":275},[62,583,584],{"href":584,"rel":585},"https://github.com/electron-userland/electron-builder/issues/1505",[66]," ",[62,588,287],{"href":283,"ariaLabel":284,"className":589,"dataFootnoteBackref":87},[286],[273,591,592,586,596],{"id":290},[62,593,594],{"href":594,"rel":595},"https://www.jianshu.com/p/15bde714e198",[66],[62,597,287],{"href":299,"ariaLabel":300,"className":598,"dataFootnoteBackref":87},[286],[273,600,601,586,605],{"id":304},[62,602,603],{"href":603,"rel":604},"https://www.jianshu.com/p/17d97e6bf174",[66],[62,606,287],{"href":313,"ariaLabel":314,"className":607,"dataFootnoteBackref":87},[286],[609,610,611],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sr1Ac, html code.shiki .sr1Ac{--shiki-default:#E45649;--shiki-dark:#ABB2BF}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":87,"searchDepth":332,"depth":332,"links":613},[614],{"id":86,"depth":332,"text":268},{"title":616,"date":617,"path":618,"tags":619,"body":621},"Typora与我","2021-11-26 23:05:05","/2021/11/26/typora-and-me",[620],"Casual Talk",{"type":13,"value":622,"toc":716},[623,626,629,632,634,637,646,649,655,662,664,675,678,689,692,702],[19,624,625],{},"Typora 要收费了，$14.9 买断制，支持三设备激活。而且尚且不知道这里买断的是单个大版本更新还是多个大版本更新。",[19,627,628],{},"很多人说，不要紧，我们有VsCode、我们有Vnote、我们有MarkText。。。",[19,630,631],{},"但我还是不习惯。",[32,633],{},[19,635,636],{},"Typora真的就是个非常纯粹的Markdown编辑器，他有所见即所得的视觉效果，同时为我提供了沉浸式的写作体验。",[19,638,639,640,645],{},"当我在使用Typora写文章的时候，我就是个非常单纯的内容创作者，我不需要去考虑各种Markdown的语法格式，我只需要用文字写下我所想的，然后通过右键菜单把文字的样式调整到一个能够合理突出主次的程度，便完成了。若是用的时间长了，记住了打开菜单时旁边现实的快捷键，那速度便更快了。即使有插入图片/视频的需求，我也只需要将图片复制进 Typora 的编辑框，我在Typora预先设置好的自定义上传命令会自动调用我部署在本地的",[62,641,644],{"href":642,"rel":643},"https://github.com/xiebruce/PicUploader",[66],"PicUploader","完成上传，并将媒体文件以 Markdown/html 语法呈现在编辑框中。",[19,647,648],{},"这样一来，我的行文思路就是连贯、不受打断的。即使需要从系统中截取一些图片作说明用途，我也可以通过 Flameshot 截取图片并简单画几个箭头、标几个序号或者框几个按钮后复制到剪切板，并最终粘贴到Typora的编辑框中，整个过程就像是我在和别人QQ聊天时截个图发过去一般简单。",[19,650,651],{},[50,652],{"alt":653,"src":654},"gif缩略图有点小，建议是点开来看","https://static.031130.xyz/uploads/2024/08/12/62f3b881e3c4c.gif",[19,656,657,658,661],{},"倘若我使用别的Markdown编辑器，我便需要将图片保存到本地、手动上传到图床、手动写markdown的",[278,659,660],{},"![]()","语法，如此一来，我的精力就被分散了，那我也就不会有为文章插入图片的兴趣，抑或是插入完某张图片以后深感心力憔悴，便把写了一半的文章束之高阁，欺骗自己将来有一天我会继续完成这篇文章。",[32,663],{},[19,665,666],{},[58,667,668,669,674],{},"总而言之，Typora对于我而言确实是非常有用的工具，而我将在接下来的半年到一年时间中过渡到其他的开源Markdown编辑器中。即使改变我的使用习惯将是一件非常痛苦的事情，但我不得不这么做。Typora内置的electron在Archlinux的滚动更新下不知道过多久会出现与系统不兼容的情况",[80,670,671],{},[62,672,89],{"href":84,"ariaDescribedBy":673,"dataFootnoteRef":87,"id":88},[86],"，所以这意味着继续使用老版本的Typora并不是长久之策，我需要在此之前尽快切换到其他的Markdown编辑器。而我不是个商业公司的Markdown工程师，单纯为了个人兴趣而花大价钱去买这一款生产力工具却无法得到经济回馈似乎并不是一个明智的选择。",[19,676,677],{},"反转了，仔细阅读Typora官网的Q&A后发现了这么一条:",[16,679,680,686],{},[19,681,682],{},[683,684,685],"strong",{},"Can I use Typora for free ?",[19,687,688],{},"You will have a 15 days free trial before the purchase. If you use  dev version or Linux version, you will have unlimited trial time if you  keep Typora updated. But we may show “trial button” or disable certain  features to encourage you to purchase our app, but basic and most  functions will be kept.",[19,690,691],{},"看起来 Dev 版和 Linux版本在最新版本可以无限试用下去，那我不考虑改变我的写作习惯了。",[16,693,694],{},[19,695,696,697],{},"注: Dev 版藏得有点深，在",[62,698,701],{"href":699,"rel":700},"https://typora.io/releases/dev",[66],"这里",[260,703,705,708],{"className":704,"dataFootnotes":87},[263],[35,706,268],{"className":707,"id":86},[267],[270,709,710],{},[273,711,712,713],{"id":275},"baidunetdisk-bin内置的electron已经无法在如今的Archlinux上跑起来了，目前唯一的解决方案是拆包、并使用系统级的electron去启动百度网盘，也就是AUR的baidunetdisk-electron。但是typora运用了一些混淆/加密的手段，使得只有他内置的electron才可以正确启动程序。 ",[62,714,287],{"href":283,"ariaLabel":284,"className":715,"dataFootnoteBackref":87},[286],{"title":87,"searchDepth":332,"depth":332,"links":717},[718],{"id":86,"depth":332,"text":268},{"title":720,"date":721,"path":722,"tags":723,"body":726},"我是来吹CloudflareMirrors的","2021-11-21 01:48:49","/2021/11/21/use-cloudflare-mirrors",[724,725],"Cloudflare","Mirror Site",{"type":13,"value":727,"toc":802},[728,737,740,747,750,755,784,791,796,799],[19,729,730,731,736],{},"Cloudflare也开始提供",[62,732,735],{"href":733,"rel":734},"https://cloudflaremirrors.com/",[66],"Linux开源镜像站","了。",[19,738,739],{},"虽然在中国大陆地区，Cloudflare速度日常抽风，不适合作为我们本机镜像源，但完全可以用于境外VPS。平常我们对国内的镜像站比较熟悉，也知道自己的网络环境使用哪个镜像站会稍微快一些，但一旦出了国，这些经验就没有用了。",[19,741,742,743,746],{},"作为一家老牌的CDN网站加速服务提供商，Cloudflare提供的网络服务在全球范围内都非常快（",[58,744,745],{},"嗯，对，全球范围不包含中国大陆","）",[19,748,749],{},"无论你的vps是在美国日本，还是香港新加坡，cloudflare都能提供非常稳定高速的服务，只需要记住cloudflare镜像站的域名，便可以抛弃挑选镜像站的烦恼。",[19,751,752],{},[50,753],{"alt":87,"src":754},"https://static.031130.xyz/uploads/2024/08/12/62f3c9a9448a4.webp",[19,756,757,758,761,762,766,767,772,773,766,778,783],{},"根据网页上所说，cloudflare会以「反代就近的镜像站」+「缓存」的形式来提供服务，",[58,759,760],{},"既然都要通过cloudflare网络，那中国大陆地区就可以彻底别想了","，能够给几乎所有地区提供不错的服务。目前说是只提供了「",[62,763,350],{"href":764,"rel":765},"https://cloudflaremirrors.com/archlinux/",[66],"」和「",[62,768,771],{"href":769,"rel":770},"https://cloudflaremirrors.com/debian/",[66],"Debian","」的服务，但是根据我考证下来，其实「",[62,774,777],{"href":775,"rel":776},"https://cloudflaremirrors.com/ubuntu/",[66],"Ubuntu",[62,779,782],{"href":780,"rel":781},"https://cloudflaremirrors.com/centos/",[66],"CentOS","」也有，只不过没写在页面上罢了。那么废话不多说，我们上境外的vps测一下下载速度如何。",[19,785,786,790],{},[62,787,789],{"href":733,"rel":788},[66],"cloudflaremirrors"," 在我这台位于美国达拉斯机房的1Gbps机器上可以跑到80MB/s+的速度，虽然没有跑满理论速率，但也算是相当喜人的成绩了。",[19,792,793],{},[50,794],{"alt":87,"src":795},"https://static.031130.xyz/uploads/2024/08/12/62f3ccc8d7c82.webp",[19,797,798],{},"小结:",[19,800,801],{},"CloudflareMirrors非常适合境外的vps使用，免去了用户自行给一个个镜像站测速的麻烦。",{"title":87,"searchDepth":332,"depth":332,"links":803},[],{"title":805,"date":806,"path":807,"tags":808,"body":811},"deepin-elf-verify究竟是何物？","2021-11-20","/2021/11/20/what-is-deepin-elf-verify",[809,810],"deepin","Linux",{"type":13,"value":812,"toc":1081},[813,816,830,833,854,888,891,896,903,906,914,917,926,929,935,940,958,986,989,994,1001,1007,1013,1016,1020,1026,1029,1058,1062,1067,1073,1078],[35,814,815],{"id":815},"起因",[19,817,818,819,822,823,826,827,829],{},"越来越多上架在 Deepin 应用商店中的 deb 包中开始依赖了一个叫做 ",[278,820,821],{},"deepin-elf-verify"," 的依赖，今天来讲讲这个",[58,824,825],{},"神奇","的 ",[278,828,821],{}," 到底为何物，为什么这么多程序都要依赖于他来工作。",[35,831,832],{"id":832},"下载拆包",[19,834,835,836,841,842,847,848,851,852,68],{},"打开 ",[62,837,840],{"href":838,"rel":839},"https://mirrors.bfsu.edu.cn/",[66],"Bfsu镜像站"," ，可以很轻松地找到 ",[62,843,846],{"href":844,"rel":845},"https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages",[66],"Packages"," —— 在 apt 源中记录了各个文件信息（包括他在仓库中的相对位置）的这么一个",[849,850,825],"em",{},"的文件，就是体积有点大，达到了68MB的样子。我们可以通过以下命令检索今天的主角——",[278,853,821],{},[426,855,857],{"className":428,"code":856,"language":430,"meta":87,"style":87},"curl -s https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages | grep deepin-elf-sign | grep pool\n",[278,858,859],{"__ignoreMap":87},[434,860,861,864,868,871,875,878,881,883,885],{"class":436,"line":3},[434,862,863],{"class":439},"curl",[434,865,867],{"class":866},"sAGMh"," -s",[434,869,870],{"class":443}," https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages",[434,872,874],{"class":873},"s5ixo"," | ",[434,876,877],{"class":439},"grep",[434,879,880],{"class":443}," deepin-elf-sign",[434,882,874],{"class":873},[434,884,877],{"class":439},[434,886,887],{"class":443}," pool\n",[19,889,890],{},"得到了输出:",[16,892,893],{},[19,894,895],{},"Filename: pool/main/d/deepin-elf-verify/deepin-elf-verify_0.2.0.6-1_amd64.deb",[19,897,898,899],{},"我们就可以把完整的下载链接拼出来: ",[62,900,901],{"href":901,"rel":902},"https://mirrors.bfsu.edu.cn/deepin/pool/main/d/deepin-elf-verify/deepin-elf-verify_0.2.0.6-1_amd64.deb",[66],[19,904,905],{},"下载解压，大概是这么一个目录结构:",[426,907,912],{"className":908,"code":910,"language":911},[909],"language-text","deepin-elf-verify_0.2.0.6-1_amd64\n├── control.tar.xz\n├── data.tar.xz\n└── debian-binary\n","text",[278,913,910],{"__ignoreMap":87},[19,915,916],{},"是个常规的deb包该有的结构了。",[918,919,920,923],"ul",{},[273,921,922],{},"control.tar.xz 中存放了deb包的相关信息",[273,924,925],{},"data.tar.xz 是整个包最终会被安装到系统中的文件",[19,927,928],{},"终于到了激动人心的时刻了，打开 data.tar.xz ！",[19,930,931],{},[50,932],{"alt":933,"src":934},"空的？","https://static.031130.xyz/uploads/2024/08/12/62f3ccc192986.webp",[19,936,937],{},[683,938,939],{},"搞错了，再来",[19,941,942,943,948,949,951,952,954,955,957],{},"打开UOS的",[62,944,947],{"href":945,"rel":946},"https://uos.deepin.cn/uos/",[66],"源链接","，使用",[278,950,863],{},"+",[278,953,877],{},"检索",[278,956,821],{},"在源中的相对位置",[426,959,961],{"className":428,"code":960,"language":430,"meta":87,"style":87},"curl -sL https://uos.deepin.cn/uos/dists/eagle/main/binary-amd64/Packages | grep deepin-elf-verify | grep pool\n",[278,962,963],{"__ignoreMap":87},[434,964,965,967,970,973,975,977,980,982,984],{"class":436,"line":3},[434,966,863],{"class":439},[434,968,969],{"class":866}," -sL",[434,971,972],{"class":443}," https://uos.deepin.cn/uos/dists/eagle/main/binary-amd64/Packages",[434,974,874],{"class":873},[434,976,877],{"class":439},[434,978,979],{"class":443}," deepin-elf-verify",[434,981,874],{"class":873},[434,983,877],{"class":439},[434,985,887],{"class":443},[19,987,988],{},"获得输出:",[16,990,991],{},[19,992,993],{},"Filename: pool/main/d/deepin-elf-verify/deepin-elf-verify_0.0.14.5-1_amd64.deb\nFilename: pool/main/d/deepin-elf-verify/deepin-elf-verify-dbgsym_0.0.14.5-1_amd64.deb",[19,995,996,997],{},"拼接为链接: ",[62,998,999],{"href":999,"rel":1000},"https://uos.deepin.cn/uos/pool/main/d/deepin-elf-verify/deepin-elf-verify_0.0.14.5-1_amd64.deb",[66],[19,1002,1003,1004],{},"下载后打开 ",[278,1005,1006],{},"data.tar.xz",[19,1008,1009],{},[50,1010],{"alt":1011,"src":1012},"看来还是有东西的","https://static.031130.xyz/uploads/2024/08/12/62f3ccc53d544.webp",[35,1014,1015],{"id":1015},"说说结论吧",[40,1017,1019],{"id":1018},"对于uos","对于UOS",[19,1021,1022,1023,1025],{},"在UOS下，",[278,1024,821],{},"用于检测用户运行的进程是否被deepin信任的证书签名过，虽然有些过于限制用户，对于一个将要广泛用于政府机关的发行版而言是可以理解的。",[40,1027,1028],{"id":1028},"对于deepin",[918,1030,1031,1036,1045],{},[273,1032,1033,1035],{},[278,1034,821],{}," 在 deepin 上就是个空包。",[273,1037,1038,1039,1041,1042,1044],{},"当我们使用 deepin 安装一个含有 ",[278,1040,821],{}," 的软件包时，apt 会自动从源内搜索并安装 ",[278,1043,821],{},"，由于是个空包，他对于系统不会有任何负担。",[273,1046,1047,1048,1050,1051,1054,1055,1057],{},"大多数依赖",[278,1049,821],{},"的程序都把依赖写成了",[278,1052,1053],{},"deepin-elf-verify (>= 0.0.16.7-1)","，而在deepin源中，",[278,1056,821],{},"版本号是 0.2.0.6，因此在未来的很长一段时间里应该都是满足要求的，说明统信那边并没有「想要让deepin装不上UOS的包」的这种想法，可见在这一点上，统信还没有明显的偏心。",[40,1059,1061],{"id":1060},"在别的deb发行版下","在别的Deb发行版下",[19,1063,1064,1066],{},[278,1065,821],{},"存在于、并且仅仅存在于 deepin 和 UOS 的源内。",[19,1068,1069,1070,1072],{},"而当我们使用别的 deb 发行版（如Debian、Ubuntu）时，apt 无法在他们自己的源内找到 ",[278,1071,821],{}," ，apt就会报错并且停止安装。",[19,1074,1075],{},[683,1076,1077],{},"小结: 至于其最终目的，是为了__________________________",[609,1079,1080],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":87,"searchDepth":332,"depth":332,"links":1082},[1083,1084,1085],{"id":815,"depth":332,"text":815},{"id":832,"depth":332,"text":832},{"id":1015,"depth":332,"text":1015,"children":1086},[1087,1088,1089],{"id":1018,"depth":337,"text":1019},{"id":1028,"depth":337,"text":1028},{"id":1060,"depth":337,"text":1061},{"title":1091,"date":1092,"path":1093,"tags":1094,"body":1096},"【翻译】请别再使用主题装饰我们的软件","2021-11-05 20:35:58","/2021/11/05/please-dont-theme-our-apps",[1095],"Translation",{"type":13,"value":1097,"toc":1562},[1098,1107,1109,1117,1120,1123,1129,1135,1141,1146,1149,1161,1164,1182,1188,1191,1194,1200,1207,1213,1216,1219,1222,1545,1550,1552],[19,1099,1100],{},[849,1101,1102,1103],{},"标题中的「我们」当然不是我自己，这是一封来自GNOME开发者针对广大GNOME社区开发者的一封公开信。看着挺有意思的，其中也透露出了GNOME的设计理念，我在这里尽力将其不掺杂个人情感地翻译完。原文可以查看这里: ",[62,1104,1105],{"href":1105,"rel":1106},"https://stopthemingmy.app/",[66],[32,1108],{},[16,1110,1111,1114],{},[19,1112,1113],{},"请从头到尾阅读这封信。",[19,1115,1116],{},"这份信针对的是那些在默认设置下使用第三方主题破坏软件体验的发行版，而不是那些试图使用第三方主题美化自己桌面的用户。（原文中出现的是tinkerers，意为修补匠）",[19,1118,1119],{},"我们是 GNOME 平台的应用开发者与设计者，我们为自己的成果感到自豪，并努力确保我们的应用能够为人们提供良好的体验。",[19,1121,1122],{},"然而不幸的是，在许多情况下，我们所有在软件的设计、开发、测试上所做出努力都因为第三方主题而变得徒劳无功。",[19,1124,1125],{},[50,1126],{"alt":1127,"src":1128},"\u003Cfont size=\"5\">\u003Cb>GTK样式\u003C/b>可以使得软件外观看上去不协调、甚至使得软件无法使用\u003C/font>","https://stopthemingmy.app/assets/stylesheets.png",[19,1130,1131],{},[50,1132],{"alt":1133,"src":1134},"\u003Cfont size=\"5\">\u003Cb>图表包\u003C/b>可以改变图标的含义，使得显示的图标无法准确的表达开发者的意思。\u003C/font>","https://stopthemingmy.app/assets/iconthemes.png",[19,1136,1137],{},[50,1138],{"alt":1139,"src":1140},"\u003Cfont size=\"5\">\u003Cb>应用图标\u003C/b>是一个软件身份的象征。改变一个软件的图标剥夺了开发者控制其品牌的可能性\u003C/font>","https://stopthemingmy.app/assets/appicons.png",[19,1142,1143],{},[849,1144,1145],{},"注: 这些例子纯粹只是用于说明问题，并不针对个别主题。所以，主题开发者们别多想。❤️",[19,1147,1148],{},"当然，还有些不那么直接的后果，包括:",[918,1150,1151,1158],{},[273,1152,1153,1154,1157],{},"在GNOME软件中心或Flathub 中使用的截图( ",[683,1155,1156],{},"Appstream Screenshots"," )中的UI会和你实际安装以后的UI看上去完全不同，这使得这些截图失去了原有的意义。",[273,1159,1160],{},"如果系统的UI元素和用户帮助文档中出现的元素不同，用户帮助文档将会极大地丢失原有意义。",[19,1162,1163],{},"这些博客文章更详细地解释了主题化的一些问题：",[918,1165,1166,1174],{},[273,1167,1168,1169],{},"GTK Stylesheets — ",[62,1170,1173],{"href":1171,"rel":1172},"https://blogs.gnome.org/tbernard/2018/10/15/restyling-apps-at-scale",[66],"Restyling apps at scale",[273,1175,1176,1177],{},"App Icons — ",[62,1178,1181],{"href":1179,"rel":1180},"https://samuelhewitt.com/blog/2017-11-26-linux-themes-third-party-icons",[66],"Linux Themes & Third-Party Icons",[19,1183,1184,1187],{},[683,1185,1186],{},"这就是为什么我们心平气和地要求我们的软件不要被主题化。"," 它们是被上游所使用的（即默认的） GNOME 样式表、图标和字体 所构建和测试的，因此它们在用户的系统上应该是原汁原味的。",[19,1189,1190],{},"虽然我们可以直接在我们的应用程序中禁用主题，但我们不想这么做。 我们认为技术性的解决方案可能不会有效，因为这不是技术问题。",[19,1192,1193],{},"在技术上，我们希望软件可以在没有人工干预的情况下被自动地重新设计，但这到目前为止仍然是个幻想。在这种技术现状被改善之前，这种（应用被主题搞炸）的情况几乎不可能被解决。因此，我们正试图通过这封信向大家告知这种情况，并尽自己的一份力量。",[19,1195,1196,1199],{},[683,1197,1198],{},"如果你想要美化你自己的系统，我们没有意见","。然而，如果你改变了诸如图标、样式表等东西，你应当意识到你的行为不会得到支持（应该是指不会得到社区的帮助）。您遇到的任何问题都应直接报告给主题开发者，而不是软件开发者。",[19,1201,1202,1203,1206],{},"作为一个平台，",[683,1204,1205],{},"我们坚信GTK应当停止强制默认在所有软件使用同一个样式表","（也就是说应该可以为不同的软件指定不同的GTK样式）。应用程序不必通过把样式表写死来避免这种情况，而是应该使用平台样式表（系统提供的样式表），除非他们魔改了样式表以加入其他内容。 我们意识到这是一个复杂的问题，但假设每个应用程序都适用于每个样式表同样也是一个糟糕的默认设置。",[19,1208,1209,1212],{},[683,1210,1211],{},"如果你是更改了系统样式表和图标的发行版的开发人员，希望你重新考虑此决定","。 在没有任何 QA 的情况下更改第三方应用程序是鲁莽的，并且在任何其他平台上都是不可接受的。 您的行为对我们这些应用程序开发人员造成了很大的伤害，并且正在损害除了您的发行版以外的整个软件生态。",[19,1214,1215],{},"我们理解发行版需要脱颖而出来吸引用户。但是，我们敦促您想办法在不剥夺我们代理权的情况下做到这一点。 我们厌倦了当人们告诉我们「这个主题魔改得还不错」时，我们必须为我们从未打算支持的设置做额外的工作。你绝对不会对 Blender、Atom、Telegram 或其他第三方应用程序做出这样的魔改。我们的应用程序使用 GTK 并不意味着我们可以接受别人对它们的魔改。",[19,1217,1218],{},"由于你要使用 GNOME 平台开发，我们预设「你希望这个软件生态是健康的」。如果现实确实如此，我们要求您停止使用主题装饰我们的软件的这一行为。",[19,1220,1221],{},"署名,",[918,1223,1224,1235,1245,1272,1293,1304,1317,1327,1348,1358,1374,1384,1398,1428,1438,1457,1467,1492,1502,1515,1525,1536],{},[273,1225,1226,1229,1230],{},[683,1227,1228],{},"Alexander Mikhaylenko","\nMaintainer of ",[62,1231,1234],{"href":1232,"rel":1233},"https://gitlab.gnome.org/GNOME/gnome-games",[66],"Games",[273,1236,1237,1229,1240],{},[683,1238,1239],{},"Avi Wadhwa",[62,1241,1244],{"href":1242,"rel":1243},"https://gitlab.gnome.org/aviwad/organizer",[66],"Organizer",[273,1246,1247,1229,1250,1255,1256,1255,1261,1266,1267],{},[683,1248,1249],{},"Bilal Elmoussaoui",[62,1251,1254],{"href":1252,"rel":1253},"https://gitlab.gnome.org/World/Authenticator",[66],"Authenticator",", ",[62,1257,1260],{"href":1258,"rel":1259},"https://gitlab.gnome.org/World/design/icon-library",[66],"Icon Library",[62,1262,1265],{"href":1263,"rel":1264},"https://gitlab.gnome.org/World/design/contrast",[66],"Contrast"," and ",[62,1268,1271],{"href":1269,"rel":1270},"https://gitlab.gnome.org/World/obfuscate",[66],"Obfuscate",[273,1273,1274,1229,1277,1255,1282,1287,1288],{},[683,1275,1276],{},"Cédric Bellegarde",[62,1278,1281],{"href":1279,"rel":1280},"https://gitlab.gnome.org/World/lollypop",[66],"Lollypop",[62,1283,1286],{"href":1284,"rel":1285},"https://gitlab.gnome.org/World/eolie",[66],"Eolie",", and ",[62,1289,1292],{"href":1290,"rel":1291},"https://gitlab.gnome.org/gnumdk/passbook",[66],"Passbook",[273,1294,1295,1298,1299],{},[683,1296,1297],{},"Christopher Davis","\nCore contributor to ",[62,1300,1303],{"href":1301,"rel":1302},"https://gitlab.gnome.org/GNOME/Fractal",[66],"Fractal",[273,1305,1306,1229,1309,1266,1312],{},[683,1307,1308],{},"Daniel García Moreno",[62,1310,1303],{"href":1301,"rel":1311},[66],[62,1313,1316],{"href":1314,"rel":1315},"https://gitlab.gnome.org/danigm/timetrack",[66],"Timetrack",[273,1318,1319,1229,1322],{},[683,1320,1321],{},"Falk Alexander Seidl",[62,1323,1326],{"href":1324,"rel":1325},"https://gitlab.gnome.org/World/PasswordSafe",[66],"Password Safe",[273,1328,1329,1332,1333,1255,1338,1287,1343],{},[683,1330,1331],{},"Felix Häcker",",\nMaintainer of ",[62,1334,1337],{"href":1335,"rel":1336},"https://gitlab.gnome.org/World/Shortwave",[66],"Gradio/Shortwave",[62,1339,1342],{"href":1340,"rel":1341},"https://gitlab.gnome.org/World/Fragments",[66],"Fragments",[62,1344,1347],{"href":1345,"rel":1346},"https://gitlab.gnome.org/World/Remotely",[66],"Remotely",[273,1349,1350,1229,1353],{},[683,1351,1352],{},"Forever XML",[62,1354,1357],{"href":1355,"rel":1356},"https://codeberg.org/foreverxml/random",[66],"Random",[273,1359,1360,1363,1364,1266,1369],{},[683,1361,1362],{},"Jan Lukas Gernert","\nAuthor of ",[62,1365,1368],{"href":1366,"rel":1367},"https://jangernert.github.io/FeedReader/",[66],"FeedReader",[62,1370,1373],{"href":1371,"rel":1372},"https://gitlab.com/news-flash",[66],"NewsFlash",[273,1375,1376,1229,1379],{},[683,1377,1378],{},"Jordan Petridis",[62,1380,1383],{"href":1381,"rel":1382},"https://gitlab.gnome.org/World/podcasts",[66],"Podcasts",[273,1385,1386,1298,1389,1392,1393],{},[683,1387,1388],{},"Julian Sparber",[62,1390,1303],{"href":1301,"rel":1391},[66],", maintainer of ",[62,1394,1397],{"href":1395,"rel":1396},"https://gitlab.gnome.org/jsparber/teleport",[66],"Teleport",[273,1399,1400,1229,1403,1255,1408,1255,1413,1255,1418,1287,1423],{},[683,1401,1402],{},"Lains",[62,1404,1407],{"href":1405,"rel":1406},"https://github.com/lainsce/notejot",[66],"Notejot",[62,1409,1412],{"href":1410,"rel":1411},"https://github.com/lainsce/khronos",[66],"Khronos",[62,1414,1417],{"href":1415,"rel":1416},"https://github.com/lainsce/dot-matrix",[66],"Dot Matrix",[62,1419,1422],{"href":1420,"rel":1421},"https://github.com/lainsce/quilter",[66],"Quilter",[62,1424,1427],{"href":1425,"rel":1426},"https://github.com/lainsce/emulsion",[66],"Emulsion",[273,1429,1430,1229,1433],{},[683,1431,1432],{},"Manuel Genovés",[62,1434,1437],{"href":1435,"rel":1436},"https://github.com/UberWriter/uberwriter",[66],"UberWriter",[273,1439,1440,1229,1443,1266,1448,1453,1454],{},[683,1441,1442],{},"Maximiliano Sandoval",[62,1444,1447],{"href":1445,"rel":1446},"https://gitlab.gnome.org/World/decoder",[66],"Decoder",[62,1449,1452],{"href":1450,"rel":1451},"https://gitlab.gnome.org/World/design/lorem",[66],"Lorem",", core contributor to ",[62,1455,1326],{"href":1324,"rel":1456},[66],[273,1458,1459,1229,1462],{},[683,1460,1461],{},"Michael Gratton",[62,1463,1466],{"href":1464,"rel":1465},"https://gitlab.gnome.org/GNOME/Geary",[66],"Geary",[273,1468,1469,1229,1472,1255,1477,1255,1482,1266,1487],{},[683,1470,1471],{},"Rafael Mardojai C.M.",[62,1473,1476],{"href":1474,"rel":1475},"https://github.com/rafaelmardojai/blanket",[66],"Blanket",[62,1478,1481],{"href":1479,"rel":1480},"https://github.com/dialect-app/dialect",[66],"Dialect",[62,1483,1486],{"href":1484,"rel":1485},"https://github.com/rafaelmardojai/share-preview",[66],"Share Preview",[62,1488,1491],{"href":1489,"rel":1490},"https://github.com/rafaelmardojai/webfont-kit-generator",[66],"Webfont Kit Generator",[273,1493,1494,1229,1497],{},[683,1495,1496],{},"Sophie Herold",[62,1498,1501],{"href":1499,"rel":1500},"https://apps.gnome.org/app/org.gnome.World.PikaBackup/",[66],"Pika Backup",[273,1503,1504,1507,1508,1266,1511,1514],{},[683,1505,1506],{},"Tobias Bernard","\nDesigner of ",[62,1509,1342],{"href":1340,"rel":1510},[66],[62,1512,1383],{"href":1381,"rel":1513},[66]," (among others)",[273,1516,1517,1229,1520],{},[683,1518,1519],{},"Zander Brown",[62,1521,1524],{"href":1522,"rel":1523},"https://gitlab.gnome.org/World/design/icon-preview",[66],"Icon Preview",[273,1526,1527],{},[683,1528,1529,1530,1535],{},"The ",[62,1531,1534],{"href":1532,"rel":1533},"https://usebottles.com",[66],"Bottles"," Developers",[273,1537,1538],{},[683,1539,1529,1540,1535],{},[62,1541,1544],{"href":1542,"rel":1543},"https://pitivi.org",[66],"Pitivi",[19,1546,1547],{},[849,1548,1549],{},"Note: Even though some of us are Foundation  members or work on GNOME, these are our personal views as individuals,  and not those of the GNOME Project, the GNOME Foundation, or our  employers.",[32,1551],{},[19,1553,1554],{},[683,1555,1556,1557],{},"推荐阅读:  ",[62,1558,1561],{"href":1559,"rel":1560},"https://whiteboard-ui8.pages.dev/translation/libadwaita-gtk4-TheEvilSkeleton/",[66],"《libadwaita：修复 Linux 桌面的可用性问题》",{"title":87,"searchDepth":332,"depth":332,"links":1563},[],{"title":1565,"date":1566,"path":1567,"tags":1568,"body":1572},"Waydroid on KDE 初体验","2021-10-31 15:57:57","/2021/10/31/waydroid-experience-on-kde",[350,1569,1570,1571],"Waydroid","KDE","Experience",{"type":13,"value":1573,"toc":1895},[1574,1591,1595,1598,1601,1607,1610,1625,1642,1645,1648,1667,1674,1688,1692,1707,1710,1721,1740,1743,1746,1764,1767,1783,1786,1789,1801,1812,1815,1833,1836,1845,1848,1872,1875,1880,1886,1892],[16,1575,1576],{},[19,1577,1578,1579,1584,1585,1590],{},"在",[62,1580,1583],{"href":1581,"rel":1582},"https://yanqiyu.info/",[66],"西木野羰基的博客","中看到了其在Fedora中使用waydroid跑明日方舟的",[62,1586,1589],{"href":1587,"rel":1588},"https://static.031130.xyz/uploads/2024/08/12/62f3cc0d6b9e8.webp",[66],"截图","，心里有有些痒痒了，决定在Archlinux上尝试使用waydroid。",[35,1592,1594],{"id":1593},"waydroid是什么","Waydroid是什么",[19,1596,1597],{},"Waydroid是一个基于lxc容器技术，用以启动完整安卓系统的方案。",[19,1599,1600],{},"默认使用了LineageOS-17.1，对应 Aosp10，相比起 anbox 显然是更加新了。",[19,1602,1603],{},[50,1604],{"alt":1605,"src":1606},"是长成这样","https://static.031130.xyz/uploads/2024/08/12/62f3cb238c027.webp",[35,1608,1609],{"id":1609},"内核支持",[19,1611,1612,1613,1616,1617,1620,1621,1624],{},"waydroid需要内核提供",[278,1614,1615],{},"Ashmem","和",[278,1618,1619],{},"binder","支持，西木野羰基是使用的自己编译的内核。而我在使用Archlinux，因此直接使用",[278,1622,1623],{},"linux-zen","即可。",[16,1626,1627],{},[19,1628,1629,1630,1633,1634,1637,1638,1641],{},"注: AUR上的",[278,1631,1632],{},"linux-xanmod","虽然也有这些模块支持，但是在编译时设置了",[278,1635,1636],{},"psi=0","以提升性能，而waydroid恰巧需要",[278,1639,1640],{},"psi=1","的支持，故不可使用。",[35,1643,1644],{"id":1644},"安装",[19,1646,1647],{},"Archlinux已经有人将其打包上传到了AUR，我们直接安装即可。我使用的 AUR Helper 是 yay，所以直接",[426,1649,1651],{"className":428,"code":1650,"language":430,"meta":87,"style":87},"yay -S waydroid --noconfirm\n",[278,1652,1653],{"__ignoreMap":87},[434,1654,1655,1658,1661,1664],{"class":436,"line":3},[434,1656,1657],{"class":439},"yay",[434,1659,1660],{"class":866}," -S",[434,1662,1663],{"class":443}," waydroid",[434,1665,1666],{"class":866}," --noconfirm\n",[19,1668,1669,1670,1673],{},"再装个",[278,1671,1672],{},"python-pyclip","解决剪切板同步的问题",[426,1675,1677],{"className":428,"code":1676,"language":430,"meta":87,"style":87},"yay -S python-pyclip\n",[278,1678,1679],{"__ignoreMap":87},[434,1680,1681,1683,1685],{"class":436,"line":3},[434,1682,1657],{"class":439},[434,1684,1660],{"class":866},[434,1686,1687],{"class":443}," python-pyclip\n",[35,1689,1691],{"id":1690},"下载waydroid镜像","下载Waydroid镜像",[426,1693,1695],{"className":428,"code":1694,"language":430,"meta":87,"style":87},"sudo waydroid init\n",[278,1696,1697],{"__ignoreMap":87},[434,1698,1699,1702,1704],{"class":436,"line":3},[434,1700,1701],{"class":439},"sudo",[434,1703,1663],{"class":443},[434,1705,1706],{"class":443}," init\n",[19,1708,1709],{},"这一步将会自动（从SourceForge）下载纯净的LineageOS镜像压缩包并解压，处于中国大陆网络环境的用户记得（          ）",[19,1711,1712,1713,1716,1717],{},"如果你需要Gapps，可以指定下载Gapps版本，但是这将需要你获取",[278,1714,1715],{},"Android ID","并向谷歌提交 Custom Rom 的 Gapps 申请。见",[62,1718,701],{"href":1719,"rel":1720},"https://www.google.com/android/uncertified/",[66],[426,1722,1724],{"className":428,"code":1723,"language":430,"meta":87,"style":87},"sudo waydroid init -s GAPPS\n",[278,1725,1726],{"__ignoreMap":87},[434,1727,1728,1730,1732,1735,1737],{"class":436,"line":3},[434,1729,1701],{"class":439},[434,1731,1663],{"class":443},[434,1733,1734],{"class":443}," init",[434,1736,867],{"class":866},[434,1738,1739],{"class":443}," GAPPS\n",[35,1741,1742],{"id":1742},"启用服务",[19,1744,1745],{},"这个没什么好说的，使用systemctl启动服务。",[426,1747,1749],{"className":428,"code":1748,"language":430,"meta":87,"style":87},"sudo systemctl start waydroid-container.service\n",[278,1750,1751],{"__ignoreMap":87},[434,1752,1753,1755,1758,1761],{"class":436,"line":3},[434,1754,1701],{"class":439},[434,1756,1757],{"class":443}," systemctl",[434,1759,1760],{"class":443}," start",[434,1762,1763],{"class":443}," waydroid-container.service\n",[35,1765,1766],{"id":1766},"开启waydroid",[426,1768,1770],{"className":428,"code":1769,"language":430,"meta":87,"style":87},"waydroid session start\n",[278,1771,1772],{"__ignoreMap":87},[434,1773,1774,1777,1780],{"class":436,"line":3},[434,1775,1776],{"class":439},"waydroid",[434,1778,1779],{"class":443}," session",[434,1781,1782],{"class":443}," start\n",[35,1784,1785],{"id":1785},"一些简单的使用技巧",[19,1787,1788],{},"如果你想直接展示整个系统界面，可以使用",[426,1790,1792],{"className":428,"code":1791,"language":430,"meta":87,"style":87},"waydroid show-full-ui\n",[278,1793,1794],{"__ignoreMap":87},[434,1795,1796,1798],{"class":436,"line":3},[434,1797,1776],{"class":439},[434,1799,1800],{"class":443}," show-full-ui\n",[19,1802,1803,1804,1807,1808,1811],{},"我们也可以用",[278,1805,1806],{},"waydroid app launch ${package_name}","的方式来启动单个应用（包名可以使用",[278,1809,1810],{},"waydroid app list","来获取",[19,1813,1814],{},"当然，可以直接在Linux环境里 安装 某个apk",[426,1816,1818],{"className":428,"code":1817,"language":430,"meta":87,"style":87},"waydroid app install path/to/apkfile.apk\n",[278,1819,1820],{"__ignoreMap":87},[434,1821,1822,1824,1827,1830],{"class":436,"line":3},[434,1823,1776],{"class":439},[434,1825,1826],{"class":443}," app",[434,1828,1829],{"class":443}," install",[434,1831,1832],{"class":443}," path/to/apkfile.apk\n",[19,1834,1835],{},"F11有助于解决应用分辨率问题，左Alt有助于解决键盘无法输入的问题。",[19,1837,1838,1839,1844],{},"Github上有个",[62,1840,1843],{"href":1841,"rel":1842},"https://github.com/casualsnek/waydroid_script",[66],"脚本","，可以帮助 安装OpenGapps/Magisk/arm转译库/获取Android ID。",[35,1846,1847],{"id":1847},"牢骚时间",[918,1849,1850,1853,1856,1859,1862,1865],{},[273,1851,1852],{},"对AMD和英伟达的显卡支持都不太行",[273,1854,1855],{},"不能直接输入中文，还是得借助安卓系统内的输入法。",[273,1857,1858],{},"不自带arm转译库，通过脚本安装的转译库似乎兼容性挺差（至少我是成功打开什么arm软件",[273,1860,1861],{},"系统运行的流畅度还可以",[273,1863,1864],{},"相关的资料似乎有点少，官方的文档也没有写得太详细",[273,1866,1867,1868,1871],{},"Waydroid会自动在",[278,1869,1870],{},"$HOME/.local/share/applications/","为wayland内的安装应用添加Desktop文件（这让我有些反感",[35,1873,1874],{"id":1874},"一些截图",[19,1876,1877],{},[50,1878],{"alt":87,"src":1879},"https://static.031130.xyz/uploads/2024/08/12/62f3cb26cba03.webp",[19,1881,1882],{},[50,1883],{"alt":1884,"src":1885},"原生安卓从未变过的应用抽屉","https://static.031130.xyz/uploads/2024/08/12/62f3cc722835c.webp",[19,1887,1888],{},[50,1889],{"alt":1890,"src":1891},"这充电速度太刺激啦！","https://static.031130.xyz/uploads/2024/08/12/62f3cc76b986c.webp",[609,1893,1894],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":87,"searchDepth":332,"depth":332,"links":1896},[1897,1898,1899,1900,1901,1902,1903,1904,1905],{"id":1593,"depth":332,"text":1594},{"id":1609,"depth":332,"text":1609},{"id":1644,"depth":332,"text":1644},{"id":1690,"depth":332,"text":1691},{"id":1742,"depth":332,"text":1742},{"id":1766,"depth":332,"text":1766},{"id":1785,"depth":332,"text":1785},{"id":1847,"depth":332,"text":1847},{"id":1874,"depth":332,"text":1874},{"title":1907,"date":1908,"path":1909,"tags":1910,"body":1912},"PicUploader使用系列（二）——为KDE的dolphin添加右键快捷菜单","2021-10-24 22:26:50","/2021/10/24/picuploader-with-kde-action",[350,644,1570,1911],"PHP",{"type":13,"value":1913,"toc":2290},[1914,1927,1933,1937,1966,1969,1975,1988,1991,1996,1999,2002,2008,2028,2031,2039,2046,2052,2073,2076,2203,2210,2228,2231,2240,2243,2263,2266,2271,2274,2281,2287],[19,1915,1916,1920,1921,1926],{},[62,1917,1919],{"href":1918},"/2021/10/21/picuploader-on-archlinux-with-caddy/","上一篇文章","我们在Archlinux中成功部署了PicUploader的web端，本文我们来讲讲如何为KDE的dolphin添加右键快捷键上传，效果类似这样。（gif图来自",[62,1922,1925],{"href":1923,"rel":1924},"https://www.xiebruce.top/17.html",[66],"PicUploader作者的博客",")",[1928,1929,1930],"center",{},[50,1931],{"src":1932,"width":87,"height":87},"https://img.xiebruce.top/2018/09/11/f4859eda8832f814486fc00df971e3cc.gif",[35,1934,1936],{"id":1935},"创建desktop文件","创建.desktop文件",[426,1938,1940],{"className":428,"code":1939,"language":430,"meta":87,"style":87},"mkdir -p $HOME/.local/share/kservices5/\ntouch $HOME/.local/share/kservices5/picuploader.desktop\n",[278,1941,1942,1956],{"__ignoreMap":87},[434,1943,1944,1947,1950,1953],{"class":436,"line":3},[434,1945,1946],{"class":439},"mkdir",[434,1948,1949],{"class":866}," -p",[434,1951,1952],{"class":495}," $HOME",[434,1954,1955],{"class":443},"/.local/share/kservices5/\n",[434,1957,1958,1961,1963],{"class":436,"line":332},[434,1959,1960],{"class":439},"touch",[434,1962,1952],{"class":495},[434,1964,1965],{"class":443},"/.local/share/kservices5/picuploader.desktop\n",[35,1967,1968],{"id":1968},"填上这段内容",[426,1970,1973],{"className":1971,"code":1972,"language":911},[909],"[Desktop Entry]\nActions=PicUploader;\nMimeType=image/jpeg;image/png;\nType=Service\nX-KDE-Priority=TopLevel\nX-KDE-ServiceTypes=KonqPopupMenu/Plugin\nIcon=/var/www/image/favicon.ico\n\n[Desktop Action PicUploader]\nName=Upload with PicUploader\nName[zh_CN]=使用PicUploader上传\nIcon=/var/www/image/favicon.ico\nExec=php /var/www/image/index.php %F | scopy\n",[278,1974,1972],{"__ignoreMap":87},[19,1976,1977],{},[683,1978,1979,1980,1984,1985,1624],{},"注: 这里的 scopy 是我在下面",[62,1981,1983],{"href":1982},"#%E5%A4%8D%E5%88%B6%E5%88%B0%E7%B2%98%E8%B4%B4%E6%9D%BF","自己创建的一段脚本","，用以同时满足x11和wayland下的使用，如果你仅使用x11的话直接改成",[278,1986,1987],{},"xclip -selection clipboard",[19,1989,1990],{},"MimeType指的是文件类型。在这份desktop中，我仅指定了png和jpg文件在右键时会弹出picuploader的上传菜单，如果你需要更多文件类型的MimeType，你可以参考下gwenview的desktop都写了哪些文件类型。",[16,1992,1993],{},[19,1994,1995],{},"MimeType=inode/directory;image/avif;image/gif;image/jpeg;image/png;image/bmp;image/x-eps;image/x-icns;image/x-ico;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-xbitmap;image/x-xpixmap;image/tiff;image/x-psd;image/x-webp;image/webp;image/x-tga;application/x-krita;image/x-kde-raw;image/x-canon-cr2;image/x-canon-crw;image/x-kodak-dcr;image/x-adobe-dng;image/x-kodak-k25;image/x-kodak-kdc;image/x-minolta-mrw;image/x-nikon-nef;image/x-olympus-orf;image/x-pentax-pef;image/x-fuji-raf;image/x-panasonic-rw;image/x-sony-sr2;image/x-sony-srf;image/x-sigma-x3f;image/x-sony-arw;image/x-panasonic-rw2;",[35,1997,1998],{"id":1998},"安装所需组件",[40,2000,2001],{"id":2001},"通知提示",[19,2003,2004,2005],{},"右下角弹出文字提示的功能依赖于",[278,2006,2007],{},"libnotify",[426,2009,2011],{"className":428,"code":2010,"language":430,"meta":87,"style":87},"sudo pacman -S libnotify --needed\n",[278,2012,2013],{"__ignoreMap":87},[434,2014,2015,2017,2020,2022,2025],{"class":436,"line":3},[434,2016,1701],{"class":439},[434,2018,2019],{"class":443}," pacman",[434,2021,1660],{"class":866},[434,2023,2024],{"class":443}," libnotify",[434,2026,2027],{"class":866}," --needed\n",[40,2029,2030],{"id":2030},"复制到粘贴板",[19,2032,2033],{},[58,2034,2035,2036],{},"复制到粘贴板的功能依赖于",[278,2037,2038],{},"xclip",[19,2040,2041],{},[58,2042,2043],{},[278,2044,2045],{},"sudo pacman -S xclip --needed",[19,2047,2048,2049,2051],{},"考虑到我可能在 x11 和 wayland 之间反复横跳，仅仅一个",[278,2050,2038],{},"看起来满足不了我的需求",[426,2053,2055],{"className":428,"code":2054,"language":430,"meta":87,"style":87},"sudo pacman -S xclip wl-clipboard --needed\n",[278,2056,2057],{"__ignoreMap":87},[434,2058,2059,2061,2063,2065,2068,2071],{"class":436,"line":3},[434,2060,1701],{"class":439},[434,2062,2019],{"class":443},[434,2064,1660],{"class":866},[434,2066,2067],{"class":443}," xclip",[434,2069,2070],{"class":443}," wl-clipboard",[434,2072,2027],{"class":866},[19,2074,2075],{},"手糊了一段脚本，用以判断对应的运行环境并调用相应的粘贴板工具",[426,2077,2079],{"className":428,"code":2078,"language":430,"meta":87,"style":87},"/usr/bin/scopy\n---\n#!/bin/bash\n\nif [ \"$XDG_SESSION_TYPE\" = \"wayland\" ]; then\n  wl-copy\nelif [ \"$XDG_SESSION_TYPE\" = \"x11\" ]; then\n  xclip -selection clipboard\nelse\n  echo \"ERROR! You are using $XDG_SESSION_TYPE\"\nfi\n",[278,2080,2081,2086,2091,2097,2104,2135,2141,2164,2176,2182,2197],{"__ignoreMap":87},[434,2082,2083],{"class":436,"line":3},[434,2084,2085],{"class":439},"/usr/bin/scopy\n",[434,2087,2088],{"class":436,"line":332},[434,2089,2090],{"class":439},"---\n",[434,2092,2093],{"class":436,"line":337},[434,2094,2096],{"class":2095},"sW2Sy","#!/bin/bash\n",[434,2098,2100],{"class":436,"line":2099},4,[434,2101,2103],{"emptyLinePlaceholder":2102},true,"\n",[434,2105,2107,2111,2114,2117,2120,2122,2126,2129,2132],{"class":436,"line":2106},5,[434,2108,2110],{"class":2109},"sLKXg","if",[434,2112,2113],{"class":873}," [ ",[434,2115,2116],{"class":443},"\"",[434,2118,2119],{"class":495},"$XDG_SESSION_TYPE",[434,2121,2116],{"class":443},[434,2123,2125],{"class":2124},"sknuh"," =",[434,2127,2128],{"class":443}," \"wayland\"",[434,2130,2131],{"class":873}," ]; ",[434,2133,2134],{"class":2109},"then\n",[434,2136,2138],{"class":436,"line":2137},6,[434,2139,2140],{"class":439},"  wl-copy\n",[434,2142,2144,2147,2149,2151,2153,2155,2157,2160,2162],{"class":436,"line":2143},7,[434,2145,2146],{"class":2109},"elif",[434,2148,2113],{"class":873},[434,2150,2116],{"class":443},[434,2152,2119],{"class":495},[434,2154,2116],{"class":443},[434,2156,2125],{"class":2124},[434,2158,2159],{"class":443}," \"x11\"",[434,2161,2131],{"class":873},[434,2163,2134],{"class":2109},[434,2165,2167,2170,2173],{"class":436,"line":2166},8,[434,2168,2169],{"class":439},"  xclip",[434,2171,2172],{"class":866}," -selection",[434,2174,2175],{"class":443}," clipboard\n",[434,2177,2179],{"class":436,"line":2178},9,[434,2180,2181],{"class":2109},"else\n",[434,2183,2185,2189,2192,2194],{"class":436,"line":2184},10,[434,2186,2188],{"class":2187},"s_Sar","  echo",[434,2190,2191],{"class":443}," \"ERROR! You are using ",[434,2193,2119],{"class":495},[434,2195,2196],{"class":443},"\"\n",[434,2198,2200],{"class":436,"line":2199},11,[434,2201,2202],{"class":2109},"fi\n",[19,2204,2205,2206,2209],{},"为",[278,2207,2208],{},"/usr/bin/scopy","授予运行权限",[426,2211,2213],{"className":428,"code":2212,"language":430,"meta":87,"style":87},"sudo chmod 755 /usr/bin/scopy\n",[278,2214,2215],{"__ignoreMap":87},[434,2216,2217,2219,2222,2225],{"class":436,"line":3},[434,2218,1701],{"class":439},[434,2220,2221],{"class":443}," chmod",[434,2223,2224],{"class":866}," 755",[434,2226,2227],{"class":443}," /usr/bin/scopy\n",[35,2229,2230],{"id":2230},"启用该动作菜单",[426,2232,2234],{"className":428,"code":2233,"language":430,"meta":87,"style":87},"kbuildsycoca5\n",[278,2235,2236],{"__ignoreMap":87},[434,2237,2238],{"class":436,"line":3},[434,2239,2233],{"class":439},[35,2241,2242],{"id":2242},"处理普通用户无权写入logs的问题",[426,2244,2246],{"className":428,"code":2245,"language":430,"meta":87,"style":87},"sudo chmod 777 -R /var/www/image/logs/\n",[278,2247,2248],{"__ignoreMap":87},[434,2249,2250,2252,2254,2257,2260],{"class":436,"line":3},[434,2251,1701],{"class":439},[434,2253,2221],{"class":443},[434,2255,2256],{"class":866}," 777",[434,2258,2259],{"class":866}," -R",[434,2261,2262],{"class":443}," /var/www/image/logs/\n",[35,2264,2265],{"id":2265},"最终结果",[1928,2267,2268],{},[50,2269],{"src":2270,"width":87,"height":87},"https://static.031130.xyz/uploads/2024/08/12/62f36f57f34aa.gif",[35,2272,2273],{"id":2273},"参考链接",[19,2275,2276],{},[62,2277,2280],{"href":2278,"rel":2279},"https://cnzhx.net/blog/kde-plasma-5-dolphin-add-action-menu-entry/",[66],"在 KDE Plasma 5 的 Dolphin 中添加一个右键动作菜单",[19,2282,2283],{},[62,2284,2286],{"href":1923,"rel":2285},[66],"PicUploader: 一个还不错的图床工具",[609,2288,2289],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sknuh, html code.shiki .sknuh{--shiki-default:#383A42;--shiki-dark:#56B6C2}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}",{"title":87,"searchDepth":332,"depth":332,"links":2291},[2292,2293,2294,2298,2299,2300,2301],{"id":1935,"depth":332,"text":1936},{"id":1968,"depth":332,"text":1968},{"id":1998,"depth":332,"text":1998,"children":2295},[2296,2297],{"id":2001,"depth":337,"text":2001},{"id":2030,"depth":337,"text":2030},{"id":2230,"depth":332,"text":2230},{"id":2242,"depth":332,"text":2242},{"id":2265,"depth":332,"text":2265},{"id":2273,"depth":332,"text":2273},{"title":2303,"date":2304,"path":2305,"tags":2306,"body":2308},"PicUploader使用系列（一）——在Archlinux上使用Caddy部署PicUploader","2021-10-21 22:15:33","/2021/10/21/picuploader-on-archlinux-with-caddy",[350,2307,644,1911],"Caddy",{"type":13,"value":2309,"toc":3276},[2310,2323,2333,2360,2366,2373,2396,2650,2657,2662,2677,2684,2840,2850,3035,3039,3042,3059,3062,3083,3086,3105,3109,3116,3119,3126,3132,3146,3150,3157,3181,3184,3190,3194,3197,3215,3218,3221,3229,3251,3254,3262,3265,3273],[16,2311,2312,2315],{},[19,2313,2314],{},"之前找对大陆网络友好的图床时，找到了cloudinary，但是全英文界面对操作增加了不少难度，其页面也不是很简洁，让我一下打消了使用网页版的念头。通过搜索，找到了 PicUploader 这一方案，使用php编写，支持cloudinary的api。",[19,2316,2317,2318,2322],{},"作者在其",[62,2319,2321],{"href":1923,"rel":2320},[66],"博客","中仅提供了nginx的部署方案，我参考其配置文件成功实现了在caddy下的部署，并且花费了数个小时排坑，故写下本文帮助后来者节省时间。",[35,2324,1644,2326,1616,2329,2332],{"id":2325},"安装caddy和php-fpm以及所需的拓展",[278,2327,2328],{},"caddy",[278,2330,2331],{},"php-fpm","以及所需的拓展",[426,2334,2336],{"className":428,"code":2335,"language":430,"meta":87,"style":87},"sudo pacman -S caddy php-fpm php-gd php-sqlite --needed\n",[278,2337,2338],{"__ignoreMap":87},[434,2339,2340,2342,2344,2346,2349,2352,2355,2358],{"class":436,"line":3},[434,2341,1701],{"class":439},[434,2343,2019],{"class":443},[434,2345,1660],{"class":866},[434,2347,2348],{"class":443}," caddy",[434,2350,2351],{"class":443}," php-fpm",[434,2353,2354],{"class":443}," php-gd",[434,2356,2357],{"class":443}," php-sqlite",[434,2359,2027],{"class":866},[35,2361,2363,2364],{"id":2362},"配置php-fpm","配置",[278,2365,2331],{},[40,2367,1578,2369,2372],{"id":2368},"在etcphpphpini启用picuploader所需拓展",[278,2370,2371],{},"/etc/php/php.ini","启用PicUploader所需拓展",[19,2374,2375,2376,2379,2380,2379,2383,2379,2385,2379,2388,2391,2392,2395],{},"PicUploaer依赖于",[278,2377,2378],{},"fileinfo","、",[278,2381,2382],{},"gd",[278,2384,863],{},[278,2386,2387],{},"exif",[278,2389,2390],{},"pdo_sqlite","拓展，可以使用",[278,2393,2394],{},"php -m","命令来查看目前加载成功了的插件。",[426,2397,2401],{"className":2398,"code":2399,"language":2400,"meta":87,"style":87},"language-diff shiki shiki-themes one-light one-dark-pro",";extension=bcmath\n;extension=bz2\n;extension=calendar\n- extension=curl\n+ extension=curl\n;extension=dba\n;extension=enchant\n- extension=exif\n+ extension=exif\n;extension=ffi\n;extension=ftp\n- extension=gd\n+ extension=gd\n;extension=gettext\n;extension=gmp\n;extension=iconv\n;extension=imap\n;extension=intl\n;extension=ldap\n;extension=mysqli\n;extension=odbc\n;zend_extension=opcache\n;extension=pdo_dblib\n;extension=pdo_mysql\n;extension=pdo_odbc\n;extension=pdo_pgsql\n- extension=pdo_sqlite\n+ extension=pdo_sqlite\n;extension=pgsql\n;extension=pspell\n;extension=shmop\n;extension=snmp\n;extension=soap\n;extension=sockets\n;extension=sodium\n;extension=sqlite3\n;extension=sysvmsg\n;extension=sysvsem\n;extension=sysvshm\n;extension=tidy\n;extension=xmlrpc\n;extension=xsl\nextension=zip\n","diff",[278,2402,2403,2408,2413,2418,2423,2428,2433,2438,2443,2448,2453,2458,2464,2470,2476,2482,2488,2494,2500,2506,2512,2518,2524,2530,2536,2542,2548,2554,2560,2566,2572,2578,2584,2590,2596,2602,2608,2614,2620,2626,2632,2638,2644],{"__ignoreMap":87},[434,2404,2405],{"class":436,"line":3},[434,2406,2407],{"class":873},";extension=bcmath\n",[434,2409,2410],{"class":436,"line":332},[434,2411,2412],{"class":873},";extension=bz2\n",[434,2414,2415],{"class":436,"line":337},[434,2416,2417],{"class":873},";extension=calendar\n",[434,2419,2420],{"class":436,"line":2099},[434,2421,2422],{"class":495},"- extension=curl\n",[434,2424,2425],{"class":436,"line":2106},[434,2426,2427],{"class":443},"+ extension=curl\n",[434,2429,2430],{"class":436,"line":2137},[434,2431,2432],{"class":873},";extension=dba\n",[434,2434,2435],{"class":436,"line":2143},[434,2436,2437],{"class":873},";extension=enchant\n",[434,2439,2440],{"class":436,"line":2166},[434,2441,2442],{"class":495},"- extension=exif\n",[434,2444,2445],{"class":436,"line":2178},[434,2446,2447],{"class":443},"+ extension=exif\n",[434,2449,2450],{"class":436,"line":2184},[434,2451,2452],{"class":873},";extension=ffi\n",[434,2454,2455],{"class":436,"line":2199},[434,2456,2457],{"class":873},";extension=ftp\n",[434,2459,2461],{"class":436,"line":2460},12,[434,2462,2463],{"class":495},"- extension=gd\n",[434,2465,2467],{"class":436,"line":2466},13,[434,2468,2469],{"class":443},"+ extension=gd\n",[434,2471,2473],{"class":436,"line":2472},14,[434,2474,2475],{"class":873},";extension=gettext\n",[434,2477,2479],{"class":436,"line":2478},15,[434,2480,2481],{"class":873},";extension=gmp\n",[434,2483,2485],{"class":436,"line":2484},16,[434,2486,2487],{"class":873},";extension=iconv\n",[434,2489,2491],{"class":436,"line":2490},17,[434,2492,2493],{"class":873},";extension=imap\n",[434,2495,2497],{"class":436,"line":2496},18,[434,2498,2499],{"class":873},";extension=intl\n",[434,2501,2503],{"class":436,"line":2502},19,[434,2504,2505],{"class":873},";extension=ldap\n",[434,2507,2509],{"class":436,"line":2508},20,[434,2510,2511],{"class":873},";extension=mysqli\n",[434,2513,2515],{"class":436,"line":2514},21,[434,2516,2517],{"class":873},";extension=odbc\n",[434,2519,2521],{"class":436,"line":2520},22,[434,2522,2523],{"class":873},";zend_extension=opcache\n",[434,2525,2527],{"class":436,"line":2526},23,[434,2528,2529],{"class":873},";extension=pdo_dblib\n",[434,2531,2533],{"class":436,"line":2532},24,[434,2534,2535],{"class":873},";extension=pdo_mysql\n",[434,2537,2539],{"class":436,"line":2538},25,[434,2540,2541],{"class":873},";extension=pdo_odbc\n",[434,2543,2545],{"class":436,"line":2544},26,[434,2546,2547],{"class":873},";extension=pdo_pgsql\n",[434,2549,2551],{"class":436,"line":2550},27,[434,2552,2553],{"class":495},"- extension=pdo_sqlite\n",[434,2555,2557],{"class":436,"line":2556},28,[434,2558,2559],{"class":443},"+ extension=pdo_sqlite\n",[434,2561,2563],{"class":436,"line":2562},29,[434,2564,2565],{"class":873},";extension=pgsql\n",[434,2567,2569],{"class":436,"line":2568},30,[434,2570,2571],{"class":873},";extension=pspell\n",[434,2573,2575],{"class":436,"line":2574},31,[434,2576,2577],{"class":873},";extension=shmop\n",[434,2579,2581],{"class":436,"line":2580},32,[434,2582,2583],{"class":873},";extension=snmp\n",[434,2585,2587],{"class":436,"line":2586},33,[434,2588,2589],{"class":873},";extension=soap\n",[434,2591,2593],{"class":436,"line":2592},34,[434,2594,2595],{"class":873},";extension=sockets\n",[434,2597,2599],{"class":436,"line":2598},35,[434,2600,2601],{"class":873},";extension=sodium\n",[434,2603,2605],{"class":436,"line":2604},36,[434,2606,2607],{"class":873},";extension=sqlite3\n",[434,2609,2611],{"class":436,"line":2610},37,[434,2612,2613],{"class":873},";extension=sysvmsg\n",[434,2615,2617],{"class":436,"line":2616},38,[434,2618,2619],{"class":873},";extension=sysvsem\n",[434,2621,2623],{"class":436,"line":2622},39,[434,2624,2625],{"class":873},";extension=sysvshm\n",[434,2627,2629],{"class":436,"line":2628},40,[434,2630,2631],{"class":873},";extension=tidy\n",[434,2633,2635],{"class":436,"line":2634},41,[434,2636,2637],{"class":873},";extension=xmlrpc\n",[434,2639,2641],{"class":436,"line":2640},42,[434,2642,2643],{"class":873},";extension=xsl\n",[434,2645,2647],{"class":436,"line":2646},43,[434,2648,2649],{"class":873},"extension=zip\n",[40,2651,2653,2654,2656],{"id":2652},"编辑etcphpphpini以增加单文件上传大小限制","编辑",[278,2655,2371],{},"以增加单文件上传大小限制",[19,2658,2659],{},[58,2660,2661],{},"查出这个问题浪费了我整整4小时时间。",[426,2663,2665],{"className":2398,"code":2664,"language":2400,"meta":87,"style":87},"- upload_max_filesize = 2M\n+ upload_max_filesize = 100M\n",[278,2666,2667,2672],{"__ignoreMap":87},[434,2668,2669],{"class":436,"line":3},[434,2670,2671],{"class":495},"- upload_max_filesize = 2M\n",[434,2673,2674],{"class":436,"line":332},[434,2675,2676],{"class":443},"+ upload_max_filesize = 100M\n",[40,2678,2653,2680,2683],{"id":2679},"编辑etcphpphp-fpmdwwwconf使其在运行时使用caddy用户",[278,2681,2682],{},"/etc/php/php-fpm.d/www.conf","使其在运行时使用caddy用户。",[426,2685,2687],{"className":2398,"code":2686,"language":2400,"meta":87,"style":87},"---\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n- user = http\n+ user = caddy\n- group = http\n+ group = caddy\n; The address on which to accept FastCGI requests.\n; Valid syntaxes are:\n;   'ip.add.re.ss:port'    - to listen on a TCP socket to a specific IPv4 address on\n;                            a specific port;\n;   '[ip:6:addr:ess]:port' - to listen on a TCP socket to a specific IPv6 address on\n---\n---\n; Note: This value is mandatory.\nlisten = /run/php-fpm/php-fpm.sock\n; and group can be specified either by name or by their numeric IDs.\n; Default Values: user and group are set as the running user\n;                 mode is set to 0660\n- listen.owner = http\n+ listen.owner = caddy\n- listen.group = http\n+ listen.group = caddy\n;listen.mode = 0660\n; When POSIX Access Control Lists are supported you can set them using\n; these options, value is a comma separated list of user/group names.\n; When set, listen.owner and listen.group are ignored\n;listen.acl_users =\n;listen.acl_groups =\n---\n",[278,2688,2689,2693,2698,2703,2708,2713,2718,2723,2728,2733,2738,2743,2748,2753,2757,2761,2766,2771,2776,2781,2786,2791,2796,2801,2806,2811,2816,2821,2826,2831,2836],{"__ignoreMap":87},[434,2690,2691],{"class":436,"line":3},[434,2692,2090],{"class":873},[434,2694,2695],{"class":436,"line":332},[434,2696,2697],{"class":873},"; Unix user/group of processes\n",[434,2699,2700],{"class":436,"line":337},[434,2701,2702],{"class":873},"; Note: The user is mandatory. If the group is not set, the default user's group\n",[434,2704,2705],{"class":436,"line":2099},[434,2706,2707],{"class":873},";       will be used.\n",[434,2709,2710],{"class":436,"line":2106},[434,2711,2712],{"class":495},"- user = http\n",[434,2714,2715],{"class":436,"line":2137},[434,2716,2717],{"class":443},"+ user = caddy\n",[434,2719,2720],{"class":436,"line":2143},[434,2721,2722],{"class":495},"- group = http\n",[434,2724,2725],{"class":436,"line":2166},[434,2726,2727],{"class":443},"+ group = caddy\n",[434,2729,2730],{"class":436,"line":2178},[434,2731,2732],{"class":873},"; The address on which to accept FastCGI requests.\n",[434,2734,2735],{"class":436,"line":2184},[434,2736,2737],{"class":873},"; Valid syntaxes are:\n",[434,2739,2740],{"class":436,"line":2199},[434,2741,2742],{"class":873},";   'ip.add.re.ss:port'    - to listen on a TCP socket to a specific IPv4 address on\n",[434,2744,2745],{"class":436,"line":2460},[434,2746,2747],{"class":873},";                            a specific port;\n",[434,2749,2750],{"class":436,"line":2466},[434,2751,2752],{"class":873},";   '[ip:6:addr:ess]:port' - to listen on a TCP socket to a specific IPv6 address on\n",[434,2754,2755],{"class":436,"line":2472},[434,2756,2090],{"class":873},[434,2758,2759],{"class":436,"line":2478},[434,2760,2090],{"class":873},[434,2762,2763],{"class":436,"line":2484},[434,2764,2765],{"class":873},"; Note: This value is mandatory.\n",[434,2767,2768],{"class":436,"line":2490},[434,2769,2770],{"class":873},"listen = /run/php-fpm/php-fpm.sock\n",[434,2772,2773],{"class":436,"line":2496},[434,2774,2775],{"class":873},"; and group can be specified either by name or by their numeric IDs.\n",[434,2777,2778],{"class":436,"line":2502},[434,2779,2780],{"class":873},"; Default Values: user and group are set as the running user\n",[434,2782,2783],{"class":436,"line":2508},[434,2784,2785],{"class":873},";                 mode is set to 0660\n",[434,2787,2788],{"class":436,"line":2514},[434,2789,2790],{"class":495},"- listen.owner = http\n",[434,2792,2793],{"class":436,"line":2520},[434,2794,2795],{"class":443},"+ listen.owner = caddy\n",[434,2797,2798],{"class":436,"line":2526},[434,2799,2800],{"class":495},"- listen.group = http\n",[434,2802,2803],{"class":436,"line":2532},[434,2804,2805],{"class":443},"+ listen.group = caddy\n",[434,2807,2808],{"class":436,"line":2538},[434,2809,2810],{"class":873},";listen.mode = 0660\n",[434,2812,2813],{"class":436,"line":2544},[434,2814,2815],{"class":873},"; When POSIX Access Control Lists are supported you can set them using\n",[434,2817,2818],{"class":436,"line":2550},[434,2819,2820],{"class":873},"; these options, value is a comma separated list of user/group names.\n",[434,2822,2823],{"class":436,"line":2556},[434,2824,2825],{"class":873},"; When set, listen.owner and listen.group are ignored\n",[434,2827,2828],{"class":436,"line":2562},[434,2829,2830],{"class":873},";listen.acl_users =\n",[434,2832,2833],{"class":436,"line":2568},[434,2834,2835],{"class":873},";listen.acl_groups =\n",[434,2837,2838],{"class":436,"line":2574},[434,2839,2090],{"class":873},[19,2841,2842,2845,2846,2849],{},[683,2843,2844],{},"2022年1月14日更新","：在 Fedora 尝试部署的时候遇到了新的坑，Fedora 的相应配置文件为 ",[278,2847,2848],{},"/etc/php-fpm.d/www.conf","，相应修改如下",[426,2851,2853],{"className":2398,"code":2852,"language":2400,"meta":87,"style":87},"; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n; RPM: apache user chosen to provide access to the same directories as httpd\n-user = apache\n+user = caddy\n; RPM: Keep a group allowed to write in log dir.\n-user = apache\n+group = caddy\n\n; The address on which to accept FastCGI requests.\n; Valid syntaxes are:\n;   'ip.add.re.ss:port'    - to listen on a TCP socket to a specific IPv4 address on\n;             a specific port;\n---\n---\n; Set permissions for unix socket, if one is used. In Linux, read/write\n; permissions must be set in order to allow connections from a web server.\n; Default Values: user and group are set as the running user\n;                 mode is set to 0660\n-;listen.owner = nobody\n+listen.owner = caddy\n-;listen.owner = nobody\n+listen.group = caddy\n;listen.mode = 0660\n\n; When POSIX Access Control Lists are supported you can set them using\n; these options, value is a comma separated list of user/group names.\n; When set, listen.owner and listen.group are ignored\n-listen.acl_users = apache,nginx\n+;listen.acl_users = apache,nginx\n;listen.acl_groups =\n\n; List of addresses (IPv4/IPv6) of FastCGI clients which are allowed to connect.\n; Equivalent to the FCGI_WEB_SERVER_ADDRS environment variable in the original\n; PHP FCGI (5.2.2+). Makes sense only with a tcp listening socket. Each address\n; must be separated by a comma. If this value is left blank, connections will be\n; accepted from any ip address.\n; Default Value: any\nlisten.allowed_clients = 127.0.0.1\n",[278,2854,2855,2859,2863,2867,2872,2877,2882,2887,2891,2896,2900,2904,2908,2912,2917,2921,2925,2930,2935,2939,2943,2948,2953,2957,2962,2966,2970,2974,2978,2982,2987,2992,2996,3000,3005,3010,3015,3020,3025,3030],{"__ignoreMap":87},[434,2856,2857],{"class":436,"line":3},[434,2858,2697],{"class":873},[434,2860,2861],{"class":436,"line":332},[434,2862,2702],{"class":873},[434,2864,2865],{"class":436,"line":337},[434,2866,2707],{"class":873},[434,2868,2869],{"class":436,"line":2099},[434,2870,2871],{"class":873},"; RPM: apache user chosen to provide access to the same directories as httpd\n",[434,2873,2874],{"class":436,"line":2106},[434,2875,2876],{"class":495},"-user = apache\n",[434,2878,2879],{"class":436,"line":2137},[434,2880,2881],{"class":443},"+user = caddy\n",[434,2883,2884],{"class":436,"line":2143},[434,2885,2886],{"class":873},"; RPM: Keep a group allowed to write in log dir.\n",[434,2888,2889],{"class":436,"line":2166},[434,2890,2876],{"class":495},[434,2892,2893],{"class":436,"line":2178},[434,2894,2895],{"class":443},"+group = caddy\n",[434,2897,2898],{"class":436,"line":2184},[434,2899,2103],{"emptyLinePlaceholder":2102},[434,2901,2902],{"class":436,"line":2199},[434,2903,2732],{"class":873},[434,2905,2906],{"class":436,"line":2460},[434,2907,2737],{"class":873},[434,2909,2910],{"class":436,"line":2466},[434,2911,2742],{"class":873},[434,2913,2914],{"class":436,"line":2472},[434,2915,2916],{"class":873},";             a specific port;\n",[434,2918,2919],{"class":436,"line":2478},[434,2920,2090],{"class":873},[434,2922,2923],{"class":436,"line":2484},[434,2924,2090],{"class":873},[434,2926,2927],{"class":436,"line":2490},[434,2928,2929],{"class":873},"; Set permissions for unix socket, if one is used. In Linux, read/write\n",[434,2931,2932],{"class":436,"line":2496},[434,2933,2934],{"class":873},"; permissions must be set in order to allow connections from a web server.\n",[434,2936,2937],{"class":436,"line":2502},[434,2938,2780],{"class":873},[434,2940,2941],{"class":436,"line":2508},[434,2942,2785],{"class":873},[434,2944,2945],{"class":436,"line":2514},[434,2946,2947],{"class":495},"-;listen.owner = nobody\n",[434,2949,2950],{"class":436,"line":2520},[434,2951,2952],{"class":443},"+listen.owner = caddy\n",[434,2954,2955],{"class":436,"line":2526},[434,2956,2947],{"class":495},[434,2958,2959],{"class":436,"line":2532},[434,2960,2961],{"class":443},"+listen.group = caddy\n",[434,2963,2964],{"class":436,"line":2538},[434,2965,2810],{"class":873},[434,2967,2968],{"class":436,"line":2544},[434,2969,2103],{"emptyLinePlaceholder":2102},[434,2971,2972],{"class":436,"line":2550},[434,2973,2815],{"class":873},[434,2975,2976],{"class":436,"line":2556},[434,2977,2820],{"class":873},[434,2979,2980],{"class":436,"line":2562},[434,2981,2825],{"class":873},[434,2983,2984],{"class":436,"line":2568},[434,2985,2986],{"class":495},"-listen.acl_users = apache,nginx\n",[434,2988,2989],{"class":436,"line":2574},[434,2990,2991],{"class":443},"+;listen.acl_users = apache,nginx\n",[434,2993,2994],{"class":436,"line":2580},[434,2995,2835],{"class":873},[434,2997,2998],{"class":436,"line":2586},[434,2999,2103],{"emptyLinePlaceholder":2102},[434,3001,3002],{"class":436,"line":2592},[434,3003,3004],{"class":873},"; List of addresses (IPv4/IPv6) of FastCGI clients which are allowed to connect.\n",[434,3006,3007],{"class":436,"line":2598},[434,3008,3009],{"class":873},"; Equivalent to the FCGI_WEB_SERVER_ADDRS environment variable in the original\n",[434,3011,3012],{"class":436,"line":2604},[434,3013,3014],{"class":873},"; PHP FCGI (5.2.2+). Makes sense only with a tcp listening socket. Each address\n",[434,3016,3017],{"class":436,"line":2610},[434,3018,3019],{"class":873},"; must be separated by a comma. If this value is left blank, connections will be\n",[434,3021,3022],{"class":436,"line":2616},[434,3023,3024],{"class":873},"; accepted from any ip address.\n",[434,3026,3027],{"class":436,"line":2622},[434,3028,3029],{"class":873},"; Default Value: any\n",[434,3031,3032],{"class":436,"line":2628},[434,3033,3034],{"class":873},"listen.allowed_clients = 127.0.0.1\n",[35,3036,3038],{"id":3037},"拉取-picuploader-最新代码","拉取 PicUploader 最新代码",[19,3040,3041],{},"首先创建一个用于存放代码的目录",[426,3043,3045],{"className":428,"code":3044,"language":430,"meta":87,"style":87},"sudo mkdir -p /var/www/\n",[278,3046,3047],{"__ignoreMap":87},[434,3048,3049,3051,3054,3056],{"class":436,"line":3},[434,3050,1701],{"class":439},[434,3052,3053],{"class":443}," mkdir",[434,3055,1949],{"class":866},[434,3057,3058],{"class":443}," /var/www/\n",[19,3060,3061],{},"clone 最新源码",[426,3063,3065],{"className":428,"code":3064,"language":430,"meta":87,"style":87},"sudo git clone https://github.com/xiebruce/PicUploader.git /var/www/picuploader\n",[278,3066,3067],{"__ignoreMap":87},[434,3068,3069,3071,3074,3077,3080],{"class":436,"line":3},[434,3070,1701],{"class":439},[434,3072,3073],{"class":443}," git",[434,3075,3076],{"class":443}," clone",[434,3078,3079],{"class":443}," https://github.com/xiebruce/PicUploader.git",[434,3081,3082],{"class":443}," /var/www/picuploader\n",[19,3084,3085],{},"将代码所有权转交给caddy用户",[426,3087,3089],{"className":428,"code":3088,"language":430,"meta":87,"style":87},"sudo chown -R caddy:caddy /var/www/picuploader\n",[278,3090,3091],{"__ignoreMap":87},[434,3092,3093,3095,3098,3100,3103],{"class":436,"line":3},[434,3094,1701],{"class":439},[434,3096,3097],{"class":443}," chown",[434,3099,2259],{"class":866},[434,3101,3102],{"class":443}," caddy:caddy",[434,3104,3082],{"class":443},[35,3106,3108],{"id":3107},"编辑caddyfile","编辑Caddyfile",[19,3110,3111,3112,3115],{},"caddy默认使用",[278,3113,3114],{},"/etc/caddy/Caddyfile","，因此如果你就部署这一个站点，直接修改这个就好了。",[19,3117,3118],{},"caddy的语法非常简洁易懂，因此我随手写了几行就能跑起来了。",[19,3120,3121,3122,3125],{},"下面是我用的Caddyfile，如果你在服务器上部署，请把",[278,3123,3124],{},"http://api.picuploader.com","更换为你服务器所需要绑定的域名(不带http协议头)，caddy将自动为你申请ssl证书。",[426,3127,3130],{"className":3128,"code":3129,"language":911},[909],"http://api.picuploader.com {\n        root * /var/www/picuploader\n\n        php_fastcgi * unix//run/php-fpm/php-fpm.sock {\n                index dashboard.php\n        }\n\n        file_server {\n                index index.php\n        }\n\n        handle_errors {\n        root * /etc/caddy/error\n                rewrite * /error.html\n                templates\n                file_server\n        }\n}\n\n# Import additional caddy config files in /etc/caddy/conf.d/\nimport /etc/caddy/conf.d/*\n",[278,3131,3129],{"__ignoreMap":87},[19,3133,3134,3135,3138,3139,3141,3142,3145],{},"php我选择了监听本地",[278,3136,3137],{},"unix//run/php-fpm/php-fpm.sock","的方案，这个路径在上文的",[278,3140,2682],{},"可以设置，如需查询，直接使用 ",[278,3143,3144],{},"grep listen\\ = /etc/php/php-fpm.d/www.conf","应该就能看见。",[40,3147,3149],{"id":3148},"设置访问密码可选","设置访问密码（可选）",[19,3151,3152,3153,3156],{},"caddy2开始不允许在caddyfile中直接指定明文密码，因此我们需要用",[278,3154,3155],{},"hash-password","获取加密后的密码密文",[426,3158,3160],{"className":428,"code":3159,"language":430,"meta":87,"style":87},"caddy hash-password  --plaintext \u003CYourPassword>\n",[278,3161,3162],{"__ignoreMap":87},[434,3163,3164,3166,3169,3172,3175,3178],{"class":436,"line":3},[434,3165,2328],{"class":439},[434,3167,3168],{"class":443}," hash-password",[434,3170,3171],{"class":866},"  --plaintext",[434,3173,3174],{"class":873}," \u003C",[434,3176,3177],{"class":443},"YourPasswor",[434,3179,3180],{"class":873},"d>\n",[19,3182,3183],{},"再在Caddyfile中，加上",[426,3185,3188],{"className":3186,"code":3187,"language":911},[909],"basicauth /* {\n        \u003Cusername> \u003Chashed_password>\n}\n",[278,3189,3187],{"__ignoreMap":87},[35,3191,3193],{"id":3192},"修改hosts设置dns解析","修改hosts/设置DNS解析",[19,3195,3196],{},"由于 api.picuploader.com 这个域名不在我手里，而我只是想在本地使用，并不打算部署到服务器，因此修改hosts将这个域名解析到本地是个不错的选择。",[426,3198,3200],{"className":428,"code":3199,"language":430,"meta":87,"style":87},"sudo sh -c \"echo '127.0.0.1     api.picuploader.com'  /etc/hosts\"\n",[278,3201,3202],{"__ignoreMap":87},[434,3203,3204,3206,3209,3212],{"class":436,"line":3},[434,3205,1701],{"class":439},[434,3207,3208],{"class":443}," sh",[434,3210,3211],{"class":866}," -c",[434,3213,3214],{"class":443}," \"echo '127.0.0.1     api.picuploader.com'  /etc/hosts\"\n",[19,3216,3217],{},"而你若是在服务器上部署，应当去设置DNS解析，这个应该不需要我多说。",[35,3219,3220],{"id":3220},"开启服务",[19,3222,3223,3224,1616,3226,3228],{},"在Archlinux下，我习惯直接用systemd运行",[278,3225,2328],{},[278,3227,2331],{},"以开机自启动。",[426,3230,3232],{"className":428,"code":3231,"language":430,"meta":87,"style":87},"sudo systemctl enable --now caddy php-fpm\n",[278,3233,3234],{"__ignoreMap":87},[434,3235,3236,3238,3240,3243,3246,3248],{"class":436,"line":3},[434,3237,1701],{"class":439},[434,3239,1757],{"class":443},[434,3241,3242],{"class":443}," enable",[434,3244,3245],{"class":866}," --now",[434,3247,2348],{"class":443},[434,3249,3250],{"class":443}," php-fpm\n",[35,3252,3253],{"id":3253},"最终测试",[19,3255,3256,3257,3261],{},"在浏览器内访问 ",[62,3258,3260],{"href":3124,"rel":3259},[66],"api.picuploader.com"," ，如果能看到页面，就算是成功啦。",[35,3263,3264],{"id":3264},"设置上传参数",[19,3266,3267,3268],{},"见作者博客：",[62,3269,3272],{"href":3270,"rel":3271},"https://www.xiebruce.top/117.html",[66],"PicUploader: 各图床获取上传图片参数的方法",[609,3274,3275],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":87,"searchDepth":332,"depth":332,"links":3277},[3278,3279,3287,3288,3291,3292,3293,3294],{"id":2325,"depth":332,"text":2325},{"id":2362,"depth":332,"text":2362,"children":3280},[3281,3283,3285],{"id":2368,"depth":337,"text":3282},"在/etc/php/php.ini启用PicUploader所需拓展",{"id":2652,"depth":337,"text":3284},"编辑/etc/php/php.ini以增加单文件上传大小限制",{"id":2679,"depth":337,"text":3286},"编辑/etc/php/php-fpm.d/www.conf使其在运行时使用caddy用户。",{"id":3037,"depth":332,"text":3038},{"id":3107,"depth":332,"text":3108,"children":3289},[3290],{"id":3148,"depth":337,"text":3149},{"id":3192,"depth":332,"text":3193},{"id":3220,"depth":332,"text":3220},{"id":3253,"depth":332,"text":3253},{"id":3264,"depth":332,"text":3264},{"title":3296,"date":3297,"path":3298,"tags":3299,"body":3300},"Archlinux坚果云踩坑实录","2021-10-02 00:21:34","/2021/10/02/nutstore-guide-on-archlinux-kde",[350],{"type":13,"value":3301,"toc":3608},[3302,3307,3309,3323,3326,3329,3332,3337,3344,3350,3356,3377,3380,3383,3389,3395,3401,3405,3411,3419,3448,3454,3458,3461,3467,3474,3504,3508,3511,3529,3535,3605],[16,3303,3304],{},[19,3305,3306],{},"在Archlinux上，坚果云似乎出现了一些问题。",[35,3308,1644],{"id":1644},[426,3310,3312],{"className":428,"code":3311,"language":430,"meta":87,"style":87},"yay -S nutstore\n",[278,3313,3314],{"__ignoreMap":87},[434,3315,3316,3318,3320],{"class":436,"line":3},[434,3317,1657],{"class":439},[434,3319,1660],{"class":866},[434,3321,3322],{"class":443}," nutstore\n",[19,3324,3325],{},"这个没什么可说的，AUR还是Archlinuxcn都无所谓，都是一模一样的。",[35,3327,3328],{"id":3328},"白屏",[19,3330,3331],{},"双击图标，咦？怎么白屏了？",[19,3333,3334],{},[50,3335],{"alt":3328,"src":3336},"https://static.031130.xyz/uploads/2024/08/12/62f3cc797bc09.webp",[19,3338,3339,3340,3343],{},"看看AUR评论区，有人说",[278,3341,3342],{},"nutstore-experimental","修了？",[19,3345,3346],{},[50,3347],{"alt":3348,"src":3349},"AUR评论区","https://static.031130.xyz/uploads/2024/08/12/62f3cc7df08ad.webp",[19,3351,3352,3353],{},"对比了一下，就是改了改",[278,3354,3355],{},"/opt/nutstore/conf/nutstore.properties",[426,3357,3359],{"className":428,"code":3358,"language":430,"meta":87,"style":87},"sudo sed -i 's|webui.enable=true|webui.enable=false|' /opt/nutstore/conf/nutstore.properties\n",[278,3360,3361],{"__ignoreMap":87},[434,3362,3363,3365,3368,3371,3374],{"class":436,"line":3},[434,3364,1701],{"class":439},[434,3366,3367],{"class":443}," sed",[434,3369,3370],{"class":866}," -i",[434,3372,3373],{"class":443}," 's|webui.enable=true|webui.enable=false|'",[434,3375,3376],{"class":443}," /opt/nutstore/conf/nutstore.properties\n",[19,3378,3379],{},"轻松解决",[35,3381,3382],{"id":3382},"窗口太小不能登陆",[19,3384,3385],{},[50,3386],{"alt":3387,"src":3388},"调出窗口规则设置界面","https://static.031130.xyz/uploads/2024/08/12/62f3cc822fbe9.webp",[19,3390,3391],{},[50,3392],{"alt":3393,"src":3394},"进行设置","https://static.031130.xyz/uploads/2024/08/12/62f3cc864a783.webp",[19,3396,3397],{},[50,3398],{"alt":3399,"src":3400},"完成","https://static.031130.xyz/uploads/2024/08/12/62f3cc89ca4eb.webp",[35,3402,3404],{"id":3403},"桌面使用了暗色主题导致部分字体不清晰","桌面使用了暗色主题导致部分字体不清晰？",[19,3406,3407],{},[50,3408],{"alt":3409,"src":3410},"这字体鬼看得见？","https://static.031130.xyz/uploads/2024/08/12/62f3cc8f193b1.webp",[19,3412,3413,3414,3418],{},"参考",[62,3415,3417],{"href":3416},"/2021/09/05/wrong-fonts-color-fix-under-kde-with-a-dark-theme/","使用fakehome方案暂时解决跑在KDE暗色主题下的程序使用亮色字体的问题","编写启动命令",[426,3420,3422],{"className":428,"code":3421,"language":430,"meta":87,"style":87},"bwrap --dev-bind / / --tmpfs $HOME/.config /usr/bin/nutstore\n",[278,3423,3424],{"__ignoreMap":87},[434,3425,3426,3429,3432,3435,3437,3440,3442,3445],{"class":436,"line":3},[434,3427,3428],{"class":439},"bwrap",[434,3430,3431],{"class":866}," --dev-bind",[434,3433,3434],{"class":443}," /",[434,3436,3434],{"class":443},[434,3438,3439],{"class":866}," --tmpfs",[434,3441,1952],{"class":495},[434,3443,3444],{"class":443},"/.config",[434,3446,3447],{"class":443}," /usr/bin/nutstore\n",[19,3449,3450],{},[50,3451],{"alt":3452,"src":3453},"测试通过","https://static.031130.xyz/uploads/2024/08/12/62f3cc9245d26.webp",[35,3455,3457],{"id":3456},"本地markdown文件的文件类型被识别成了坚果云-markdown","本地markdown文件的文件类型被识别成了「坚果云 Markdown」",[19,3459,3460],{},"这个是由于坚果云自作主张推广他自己并不好用的lightapp，写了几条 mime 的规则，如图",[19,3462,3463],{},[50,3464],{"alt":3465,"src":3466},"没错，整整5个xml","https://static.031130.xyz/uploads/2024/08/12/62f3cc95f0dd1.webp",[19,3468,3469,3470,3473],{},"看来在我们的启动命令中也需要防止坚果云接触到",[278,3471,3472],{},"$HOME/.local/share/","这个路径，所以现在的启动命令得写成这样。",[426,3475,3477],{"className":428,"code":3476,"language":430,"meta":87,"style":87},"bwrap --dev-bind / / --tmpfs $HOME/.config --tmpfs $HOME/.local/share/ /usr/bin/nutstore\n",[278,3478,3479],{"__ignoreMap":87},[434,3480,3481,3483,3485,3487,3489,3491,3493,3495,3497,3499,3502],{"class":436,"line":3},[434,3482,3428],{"class":439},[434,3484,3431],{"class":866},[434,3486,3434],{"class":443},[434,3488,3434],{"class":443},[434,3490,3439],{"class":866},[434,3492,1952],{"class":495},[434,3494,3444],{"class":443},[434,3496,3439],{"class":866},[434,3498,1952],{"class":495},[434,3500,3501],{"class":443},"/.local/share/",[434,3503,3447],{"class":443},[35,3505,3507],{"id":3506},"修改desktop文件使其使用我们自己攥写的启动命令","修改desktop文件，使其使用我们自己攥写的启动命令",[19,3509,3510],{},"首先，复制一份desktop文件到我们的 $HOME 目录下，好处是下次更新的时候我们所做的更改不会被包管理器覆盖。",[426,3512,3514],{"className":428,"code":3513,"language":430,"meta":87,"style":87},"cp /usr/share/applications/nutstore.desktop $HOME/.local/share/applications/\n",[278,3515,3516],{"__ignoreMap":87},[434,3517,3518,3521,3524,3526],{"class":436,"line":3},[434,3519,3520],{"class":439},"cp",[434,3522,3523],{"class":443}," /usr/share/applications/nutstore.desktop",[434,3525,1952],{"class":495},[434,3527,3528],{"class":443},"/.local/share/applications/\n",[19,3530,3531,3532],{},"再修改",[278,3533,3534],{},"$HOME/.local/share/applications/nutstore.desktop",[426,3536,3538],{"className":2398,"code":3537,"language":2400,"meta":87,"style":87},"[Desktop Entry]\nEncoding=UTF-8\nType=Application\nTerminal=false\nIcon=nutstore\n-Exec=/usr/bin/nutstore\n+Exec=bwrap --dev-bind / / --tmpfs $HOME/.config --tmpfs $HOME/.local/share/applications --tmpfs $HOME/.local/share/mime /usr/bin/nutstore\nStartupWMClass=Nutstore\nName=Nutstore\nName[zh_CN]=坚果云 \nComment=Data Sync, Sharing, Backup\nComment[zh_CN]=数据同步,共享和备份\nCategories=Network;Application;\n",[278,3539,3540,3545,3550,3555,3560,3565,3570,3575,3580,3585,3590,3595,3600],{"__ignoreMap":87},[434,3541,3542],{"class":436,"line":3},[434,3543,3544],{"class":873},"[Desktop Entry]\n",[434,3546,3547],{"class":436,"line":332},[434,3548,3549],{"class":873},"Encoding=UTF-8\n",[434,3551,3552],{"class":436,"line":337},[434,3553,3554],{"class":873},"Type=Application\n",[434,3556,3557],{"class":436,"line":2099},[434,3558,3559],{"class":873},"Terminal=false\n",[434,3561,3562],{"class":436,"line":2106},[434,3563,3564],{"class":873},"Icon=nutstore\n",[434,3566,3567],{"class":436,"line":2137},[434,3568,3569],{"class":495},"-Exec=/usr/bin/nutstore\n",[434,3571,3572],{"class":436,"line":2143},[434,3573,3574],{"class":443},"+Exec=bwrap --dev-bind / / --tmpfs $HOME/.config --tmpfs $HOME/.local/share/applications --tmpfs $HOME/.local/share/mime /usr/bin/nutstore\n",[434,3576,3577],{"class":436,"line":2166},[434,3578,3579],{"class":873},"StartupWMClass=Nutstore\n",[434,3581,3582],{"class":436,"line":2178},[434,3583,3584],{"class":873},"Name=Nutstore\n",[434,3586,3587],{"class":436,"line":2184},[434,3588,3589],{"class":873},"Name[zh_CN]=坚果云 \n",[434,3591,3592],{"class":436,"line":2199},[434,3593,3594],{"class":873},"Comment=Data Sync, Sharing, Backup\n",[434,3596,3597],{"class":436,"line":2460},[434,3598,3599],{"class":873},"Comment[zh_CN]=数据同步,共享和备份\n",[434,3601,3602],{"class":436,"line":2466},[434,3603,3604],{"class":873},"Categories=Network;Application;\n",[609,3606,3607],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}",{"title":87,"searchDepth":332,"depth":332,"links":3609},[3610,3611,3612,3613,3614,3615],{"id":1644,"depth":332,"text":1644},{"id":3328,"depth":332,"text":3328},{"id":3382,"depth":332,"text":3382},{"id":3403,"depth":332,"text":3404},{"id":3456,"depth":332,"text":3457},{"id":3506,"depth":332,"text":3507},132,1766526714662]