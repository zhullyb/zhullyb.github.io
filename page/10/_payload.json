[{"data":1,"prerenderedAt":3643},["ShallowReactive",2],{"randomIndex/page/10/":3,"language-switch-/page/10/-en":4,"index-page-10-zh":5,"posts-total-zh":3642},11,"/en/",[6,100,403,878,1221,1618,2611,2932,3105,3202],{"title":7,"date":8,"path":9,"tags":10,"body":13},"我是来吹CloudflareMirrors的","2021-11-21 01:48:49","/2021/11/21/use-cloudflare-mirrors",[11,12],"Cloudflare","Mirror Site",{"type":14,"value":15,"toc":97},"minimark",[16,28,31,39,42,49,79,86,91,94],[17,18,19,20,27],"p",{},"Cloudflare也开始提供",[21,22,26],"a",{"href":23,"rel":24},"https://cloudflaremirrors.com/",[25],"nofollow","Linux开源镜像站","了。",[17,29,30],{},"虽然在中国大陆地区，Cloudflare速度日常抽风，不适合作为我们本机镜像源，但完全可以用于境外VPS。平常我们对国内的镜像站比较熟悉，也知道自己的网络环境使用哪个镜像站会稍微快一些，但一旦出了国，这些经验就没有用了。",[17,32,33,34,38],{},"作为一家老牌的CDN网站加速服务提供商，Cloudflare提供的网络服务在全球范围内都非常快（",[35,36,37],"del",{},"嗯，对，全球范围不包含中国大陆","）",[17,40,41],{},"无论你的vps是在美国日本，还是香港新加坡，cloudflare都能提供非常稳定高速的服务，只需要记住cloudflare镜像站的域名，便可以抛弃挑选镜像站的烦恼。",[17,43,44],{},[45,46],"img",{"alt":47,"src":48},"","https://static.031130.xyz/uploads/2024/08/12/62f3c9a9448a4.webp",[17,50,51,52,55,56,61,62,67,68,61,73,78],{},"根据网页上所说，cloudflare会以「反代就近的镜像站」+「缓存」的形式来提供服务，",[35,53,54],{},"既然都要通过cloudflare网络，那中国大陆地区就可以彻底别想了","，能够给几乎所有地区提供不错的服务。目前说是只提供了「",[21,57,60],{"href":58,"rel":59},"https://cloudflaremirrors.com/archlinux/",[25],"Archlinux","」和「",[21,63,66],{"href":64,"rel":65},"https://cloudflaremirrors.com/debian/",[25],"Debian","」的服务，但是根据我考证下来，其实「",[21,69,72],{"href":70,"rel":71},"https://cloudflaremirrors.com/ubuntu/",[25],"Ubuntu",[21,74,77],{"href":75,"rel":76},"https://cloudflaremirrors.com/centos/",[25],"CentOS","」也有，只不过没写在页面上罢了。那么废话不多说，我们上境外的vps测一下下载速度如何。",[17,80,81,85],{},[21,82,84],{"href":23,"rel":83},[25],"cloudflaremirrors"," 在我这台位于美国达拉斯机房的1Gbps机器上可以跑到80MB/s+的速度，虽然没有跑满理论速率，但也算是相当喜人的成绩了。",[17,87,88],{},[45,89],{"alt":47,"src":90},"https://static.031130.xyz/uploads/2024/08/12/62f3ccc8d7c82.webp",[17,92,93],{},"小结:",[17,95,96],{},"CloudflareMirrors非常适合境外的vps使用，免去了用户自行给一个个镜像站测速的麻烦。",{"title":47,"searchDepth":98,"depth":98,"links":99},2,[],{"title":101,"date":102,"path":103,"tags":104,"body":107},"deepin-elf-verify究竟是何物？","2021-11-20","/2021/11/20/what-is-deepin-elf-verify",[105,106],"deepin","Linux",{"type":14,"value":108,"toc":393},[109,113,128,131,153,195,198,204,211,214,222,225,235,238,244,250,268,296,299,304,311,317,323,326,331,337,340,369,373,378,384,389],[110,111,112],"h2",{"id":112},"起因",[17,114,115,116,120,121,124,125,127],{},"越来越多上架在 Deepin 应用商店中的 deb 包中开始依赖了一个叫做 ",[117,118,119],"code",{},"deepin-elf-verify"," 的依赖，今天来讲讲这个",[35,122,123],{},"神奇","的 ",[117,126,119],{}," 到底为何物，为什么这么多程序都要依赖于他来工作。",[110,129,130],{"id":130},"下载拆包",[17,132,133,134,139,140,145,146,149,150,152],{},"打开 ",[21,135,138],{"href":136,"rel":137},"https://mirrors.bfsu.edu.cn/",[25],"Bfsu镜像站"," ，可以很轻松地找到 ",[21,141,144],{"href":142,"rel":143},"https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages",[25],"Packages"," —— 在 apt 源中记录了各个文件信息（包括他在仓库中的相对位置）的这么一个",[147,148,123],"em",{},"的文件，就是体积有点大，达到了68MB的样子。我们可以通过以下命令检索今天的主角——",[117,151,119],{},"。",[154,155,159],"pre",{"className":156,"code":157,"language":158,"meta":47,"style":47},"language-bash shiki shiki-themes one-light one-dark-pro","curl -s https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages | grep deepin-elf-sign | grep pool\n","bash",[117,160,161],{"__ignoreMap":47},[162,163,166,170,174,178,182,185,188,190,192],"span",{"class":164,"line":165},"line",1,[162,167,169],{"class":168},"sAdtL","curl",[162,171,173],{"class":172},"sAGMh"," -s",[162,175,177],{"class":176},"sDhpE"," https://mirrors.bfsu.edu.cn/deepin/dists/apricot/main/binary-amd64/Packages",[162,179,181],{"class":180},"s5ixo"," | ",[162,183,184],{"class":168},"grep",[162,186,187],{"class":176}," deepin-elf-sign",[162,189,181],{"class":180},[162,191,184],{"class":168},[162,193,194],{"class":176}," pool\n",[17,196,197],{},"得到了输出:",[199,200,201],"blockquote",{},[17,202,203],{},"Filename: pool/main/d/deepin-elf-verify/deepin-elf-verify_0.2.0.6-1_amd64.deb",[17,205,206,207],{},"我们就可以把完整的下载链接拼出来: ",[21,208,209],{"href":209,"rel":210},"https://mirrors.bfsu.edu.cn/deepin/pool/main/d/deepin-elf-verify/deepin-elf-verify_0.2.0.6-1_amd64.deb",[25],[17,212,213],{},"下载解压，大概是这么一个目录结构:",[154,215,220],{"className":216,"code":218,"language":219},[217],"language-text","deepin-elf-verify_0.2.0.6-1_amd64\n├── control.tar.xz\n├── data.tar.xz\n└── debian-binary\n","text",[117,221,218],{"__ignoreMap":47},[17,223,224],{},"是个常规的deb包该有的结构了。",[226,227,228,232],"ul",{},[229,230,231],"li",{},"control.tar.xz 中存放了deb包的相关信息",[229,233,234],{},"data.tar.xz 是整个包最终会被安装到系统中的文件",[17,236,237],{},"终于到了激动人心的时刻了，打开 data.tar.xz ！",[17,239,240],{},[45,241],{"alt":242,"src":243},"空的？","https://static.031130.xyz/uploads/2024/08/12/62f3ccc192986.webp",[17,245,246],{},[247,248,249],"strong",{},"搞错了，再来",[17,251,252,253,258,259,261,262,264,265,267],{},"打开UOS的",[21,254,257],{"href":255,"rel":256},"https://uos.deepin.cn/uos/",[25],"源链接","，使用",[117,260,169],{},"+",[117,263,184],{},"检索",[117,266,119],{},"在源中的相对位置",[154,269,271],{"className":156,"code":270,"language":158,"meta":47,"style":47},"curl -sL https://uos.deepin.cn/uos/dists/eagle/main/binary-amd64/Packages | grep deepin-elf-verify | grep pool\n",[117,272,273],{"__ignoreMap":47},[162,274,275,277,280,283,285,287,290,292,294],{"class":164,"line":165},[162,276,169],{"class":168},[162,278,279],{"class":172}," -sL",[162,281,282],{"class":176}," https://uos.deepin.cn/uos/dists/eagle/main/binary-amd64/Packages",[162,284,181],{"class":180},[162,286,184],{"class":168},[162,288,289],{"class":176}," deepin-elf-verify",[162,291,181],{"class":180},[162,293,184],{"class":168},[162,295,194],{"class":176},[17,297,298],{},"获得输出:",[199,300,301],{},[17,302,303],{},"Filename: pool/main/d/deepin-elf-verify/deepin-elf-verify_0.0.14.5-1_amd64.deb\nFilename: pool/main/d/deepin-elf-verify/deepin-elf-verify-dbgsym_0.0.14.5-1_amd64.deb",[17,305,306,307],{},"拼接为链接: ",[21,308,309],{"href":309,"rel":310},"https://uos.deepin.cn/uos/pool/main/d/deepin-elf-verify/deepin-elf-verify_0.0.14.5-1_amd64.deb",[25],[17,312,313,314],{},"下载后打开 ",[117,315,316],{},"data.tar.xz",[17,318,319],{},[45,320],{"alt":321,"src":322},"看来还是有东西的","https://static.031130.xyz/uploads/2024/08/12/62f3ccc53d544.webp",[110,324,325],{"id":325},"说说结论吧",[327,328,330],"h3",{"id":329},"对于uos","对于UOS",[17,332,333,334,336],{},"在UOS下，",[117,335,119],{},"用于检测用户运行的进程是否被deepin信任的证书签名过，虽然有些过于限制用户，对于一个将要广泛用于政府机关的发行版而言是可以理解的。",[327,338,339],{"id":339},"对于deepin",[226,341,342,347,356],{},[229,343,344,346],{},[117,345,119],{}," 在 deepin 上就是个空包。",[229,348,349,350,352,353,355],{},"当我们使用 deepin 安装一个含有 ",[117,351,119],{}," 的软件包时，apt 会自动从源内搜索并安装 ",[117,354,119],{},"，由于是个空包，他对于系统不会有任何负担。",[229,357,358,359,361,362,365,366,368],{},"大多数依赖",[117,360,119],{},"的程序都把依赖写成了",[117,363,364],{},"deepin-elf-verify (>= 0.0.16.7-1)","，而在deepin源中，",[117,367,119],{},"版本号是 0.2.0.6，因此在未来的很长一段时间里应该都是满足要求的，说明统信那边并没有「想要让deepin装不上UOS的包」的这种想法，可见在这一点上，统信还没有明显的偏心。",[327,370,372],{"id":371},"在别的deb发行版下","在别的Deb发行版下",[17,374,375,377],{},[117,376,119],{},"存在于、并且仅仅存在于 deepin 和 UOS 的源内。",[17,379,380,381,383],{},"而当我们使用别的 deb 发行版（如Debian、Ubuntu）时，apt 无法在他们自己的源内找到 ",[117,382,119],{}," ，apt就会报错并且停止安装。",[17,385,386],{},[247,387,388],{},"小结: 至于其最终目的，是为了__________________________",[390,391,392],"style",{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":47,"searchDepth":98,"depth":98,"links":394},[395,396,397],{"id":112,"depth":98,"text":112},{"id":130,"depth":98,"text":130},{"id":325,"depth":98,"text":325,"children":398},[399,401,402],{"id":329,"depth":400,"text":330},3,{"id":339,"depth":400,"text":339},{"id":371,"depth":400,"text":372},{"title":404,"date":405,"path":406,"tags":407,"body":409},"【翻译】请别再使用主题装饰我们的软件","2021-11-05 20:35:58","/2021/11/05/please-dont-theme-our-apps",[408],"Translation",{"type":14,"value":410,"toc":876},[411,420,423,431,434,437,443,449,455,460,463,475,478,496,502,505,508,514,521,527,530,533,536,859,864,866],[17,412,413],{},[147,414,415,416],{},"标题中的「我们」当然不是我自己，这是一封来自GNOME开发者针对广大GNOME社区开发者的一封公开信。看着挺有意思的，其中也透露出了GNOME的设计理念，我在这里尽力将其不掺杂个人情感地翻译完。原文可以查看这里: ",[21,417,418],{"href":418,"rel":419},"https://stopthemingmy.app/",[25],[421,422],"hr",{},[199,424,425,428],{},[17,426,427],{},"请从头到尾阅读这封信。",[17,429,430],{},"这份信针对的是那些在默认设置下使用第三方主题破坏软件体验的发行版，而不是那些试图使用第三方主题美化自己桌面的用户。（原文中出现的是tinkerers，意为修补匠）",[17,432,433],{},"我们是 GNOME 平台的应用开发者与设计者，我们为自己的成果感到自豪，并努力确保我们的应用能够为人们提供良好的体验。",[17,435,436],{},"然而不幸的是，在许多情况下，我们所有在软件的设计、开发、测试上所做出努力都因为第三方主题而变得徒劳无功。",[17,438,439],{},[45,440],{"alt":441,"src":442},"\u003Cfont size=\"5\">\u003Cb>GTK样式\u003C/b>可以使得软件外观看上去不协调、甚至使得软件无法使用\u003C/font>","https://stopthemingmy.app/assets/stylesheets.png",[17,444,445],{},[45,446],{"alt":447,"src":448},"\u003Cfont size=\"5\">\u003Cb>图表包\u003C/b>可以改变图标的含义，使得显示的图标无法准确的表达开发者的意思。\u003C/font>","https://stopthemingmy.app/assets/iconthemes.png",[17,450,451],{},[45,452],{"alt":453,"src":454},"\u003Cfont size=\"5\">\u003Cb>应用图标\u003C/b>是一个软件身份的象征。改变一个软件的图标剥夺了开发者控制其品牌的可能性\u003C/font>","https://stopthemingmy.app/assets/appicons.png",[17,456,457],{},[147,458,459],{},"注: 这些例子纯粹只是用于说明问题，并不针对个别主题。所以，主题开发者们别多想。❤️",[17,461,462],{},"当然，还有些不那么直接的后果，包括:",[226,464,465,472],{},[229,466,467,468,471],{},"在GNOME软件中心或Flathub 中使用的截图( ",[247,469,470],{},"Appstream Screenshots"," )中的UI会和你实际安装以后的UI看上去完全不同，这使得这些截图失去了原有的意义。",[229,473,474],{},"如果系统的UI元素和用户帮助文档中出现的元素不同，用户帮助文档将会极大地丢失原有意义。",[17,476,477],{},"这些博客文章更详细地解释了主题化的一些问题：",[226,479,480,488],{},[229,481,482,483],{},"GTK Stylesheets — ",[21,484,487],{"href":485,"rel":486},"https://blogs.gnome.org/tbernard/2018/10/15/restyling-apps-at-scale",[25],"Restyling apps at scale",[229,489,490,491],{},"App Icons — ",[21,492,495],{"href":493,"rel":494},"https://samuelhewitt.com/blog/2017-11-26-linux-themes-third-party-icons",[25],"Linux Themes & Third-Party Icons",[17,497,498,501],{},[247,499,500],{},"这就是为什么我们心平气和地要求我们的软件不要被主题化。"," 它们是被上游所使用的（即默认的） GNOME 样式表、图标和字体 所构建和测试的，因此它们在用户的系统上应该是原汁原味的。",[17,503,504],{},"虽然我们可以直接在我们的应用程序中禁用主题，但我们不想这么做。 我们认为技术性的解决方案可能不会有效，因为这不是技术问题。",[17,506,507],{},"在技术上，我们希望软件可以在没有人工干预的情况下被自动地重新设计，但这到目前为止仍然是个幻想。在这种技术现状被改善之前，这种（应用被主题搞炸）的情况几乎不可能被解决。因此，我们正试图通过这封信向大家告知这种情况，并尽自己的一份力量。",[17,509,510,513],{},[247,511,512],{},"如果你想要美化你自己的系统，我们没有意见","。然而，如果你改变了诸如图标、样式表等东西，你应当意识到你的行为不会得到支持（应该是指不会得到社区的帮助）。您遇到的任何问题都应直接报告给主题开发者，而不是软件开发者。",[17,515,516,517,520],{},"作为一个平台，",[247,518,519],{},"我们坚信GTK应当停止强制默认在所有软件使用同一个样式表","（也就是说应该可以为不同的软件指定不同的GTK样式）。应用程序不必通过把样式表写死来避免这种情况，而是应该使用平台样式表（系统提供的样式表），除非他们魔改了样式表以加入其他内容。 我们意识到这是一个复杂的问题，但假设每个应用程序都适用于每个样式表同样也是一个糟糕的默认设置。",[17,522,523,526],{},[247,524,525],{},"如果你是更改了系统样式表和图标的发行版的开发人员，希望你重新考虑此决定","。 在没有任何 QA 的情况下更改第三方应用程序是鲁莽的，并且在任何其他平台上都是不可接受的。 您的行为对我们这些应用程序开发人员造成了很大的伤害，并且正在损害除了您的发行版以外的整个软件生态。",[17,528,529],{},"我们理解发行版需要脱颖而出来吸引用户。但是，我们敦促您想办法在不剥夺我们代理权的情况下做到这一点。 我们厌倦了当人们告诉我们「这个主题魔改得还不错」时，我们必须为我们从未打算支持的设置做额外的工作。你绝对不会对 Blender、Atom、Telegram 或其他第三方应用程序做出这样的魔改。我们的应用程序使用 GTK 并不意味着我们可以接受别人对它们的魔改。",[17,531,532],{},"由于你要使用 GNOME 平台开发，我们预设「你希望这个软件生态是健康的」。如果现实确实如此，我们要求您停止使用主题装饰我们的软件的这一行为。",[17,534,535],{},"署名,",[226,537,538,549,559,586,607,618,631,641,662,672,688,698,712,742,752,771,781,806,816,829,839,850],{},[229,539,540,543,544],{},[247,541,542],{},"Alexander Mikhaylenko","\nMaintainer of ",[21,545,548],{"href":546,"rel":547},"https://gitlab.gnome.org/GNOME/gnome-games",[25],"Games",[229,550,551,543,554],{},[247,552,553],{},"Avi Wadhwa",[21,555,558],{"href":556,"rel":557},"https://gitlab.gnome.org/aviwad/organizer",[25],"Organizer",[229,560,561,543,564,569,570,569,575,580,581],{},[247,562,563],{},"Bilal Elmoussaoui",[21,565,568],{"href":566,"rel":567},"https://gitlab.gnome.org/World/Authenticator",[25],"Authenticator",", ",[21,571,574],{"href":572,"rel":573},"https://gitlab.gnome.org/World/design/icon-library",[25],"Icon Library",[21,576,579],{"href":577,"rel":578},"https://gitlab.gnome.org/World/design/contrast",[25],"Contrast"," and ",[21,582,585],{"href":583,"rel":584},"https://gitlab.gnome.org/World/obfuscate",[25],"Obfuscate",[229,587,588,543,591,569,596,601,602],{},[247,589,590],{},"Cédric Bellegarde",[21,592,595],{"href":593,"rel":594},"https://gitlab.gnome.org/World/lollypop",[25],"Lollypop",[21,597,600],{"href":598,"rel":599},"https://gitlab.gnome.org/World/eolie",[25],"Eolie",", and ",[21,603,606],{"href":604,"rel":605},"https://gitlab.gnome.org/gnumdk/passbook",[25],"Passbook",[229,608,609,612,613],{},[247,610,611],{},"Christopher Davis","\nCore contributor to ",[21,614,617],{"href":615,"rel":616},"https://gitlab.gnome.org/GNOME/Fractal",[25],"Fractal",[229,619,620,543,623,580,626],{},[247,621,622],{},"Daniel García Moreno",[21,624,617],{"href":615,"rel":625},[25],[21,627,630],{"href":628,"rel":629},"https://gitlab.gnome.org/danigm/timetrack",[25],"Timetrack",[229,632,633,543,636],{},[247,634,635],{},"Falk Alexander Seidl",[21,637,640],{"href":638,"rel":639},"https://gitlab.gnome.org/World/PasswordSafe",[25],"Password Safe",[229,642,643,646,647,569,652,601,657],{},[247,644,645],{},"Felix Häcker",",\nMaintainer of ",[21,648,651],{"href":649,"rel":650},"https://gitlab.gnome.org/World/Shortwave",[25],"Gradio/Shortwave",[21,653,656],{"href":654,"rel":655},"https://gitlab.gnome.org/World/Fragments",[25],"Fragments",[21,658,661],{"href":659,"rel":660},"https://gitlab.gnome.org/World/Remotely",[25],"Remotely",[229,663,664,543,667],{},[247,665,666],{},"Forever XML",[21,668,671],{"href":669,"rel":670},"https://codeberg.org/foreverxml/random",[25],"Random",[229,673,674,677,678,580,683],{},[247,675,676],{},"Jan Lukas Gernert","\nAuthor of ",[21,679,682],{"href":680,"rel":681},"https://jangernert.github.io/FeedReader/",[25],"FeedReader",[21,684,687],{"href":685,"rel":686},"https://gitlab.com/news-flash",[25],"NewsFlash",[229,689,690,543,693],{},[247,691,692],{},"Jordan Petridis",[21,694,697],{"href":695,"rel":696},"https://gitlab.gnome.org/World/podcasts",[25],"Podcasts",[229,699,700,612,703,706,707],{},[247,701,702],{},"Julian Sparber",[21,704,617],{"href":615,"rel":705},[25],", maintainer of ",[21,708,711],{"href":709,"rel":710},"https://gitlab.gnome.org/jsparber/teleport",[25],"Teleport",[229,713,714,543,717,569,722,569,727,569,732,601,737],{},[247,715,716],{},"Lains",[21,718,721],{"href":719,"rel":720},"https://github.com/lainsce/notejot",[25],"Notejot",[21,723,726],{"href":724,"rel":725},"https://github.com/lainsce/khronos",[25],"Khronos",[21,728,731],{"href":729,"rel":730},"https://github.com/lainsce/dot-matrix",[25],"Dot Matrix",[21,733,736],{"href":734,"rel":735},"https://github.com/lainsce/quilter",[25],"Quilter",[21,738,741],{"href":739,"rel":740},"https://github.com/lainsce/emulsion",[25],"Emulsion",[229,743,744,543,747],{},[247,745,746],{},"Manuel Genovés",[21,748,751],{"href":749,"rel":750},"https://github.com/UberWriter/uberwriter",[25],"UberWriter",[229,753,754,543,757,580,762,767,768],{},[247,755,756],{},"Maximiliano Sandoval",[21,758,761],{"href":759,"rel":760},"https://gitlab.gnome.org/World/decoder",[25],"Decoder",[21,763,766],{"href":764,"rel":765},"https://gitlab.gnome.org/World/design/lorem",[25],"Lorem",", core contributor to ",[21,769,640],{"href":638,"rel":770},[25],[229,772,773,543,776],{},[247,774,775],{},"Michael Gratton",[21,777,780],{"href":778,"rel":779},"https://gitlab.gnome.org/GNOME/Geary",[25],"Geary",[229,782,783,543,786,569,791,569,796,580,801],{},[247,784,785],{},"Rafael Mardojai C.M.",[21,787,790],{"href":788,"rel":789},"https://github.com/rafaelmardojai/blanket",[25],"Blanket",[21,792,795],{"href":793,"rel":794},"https://github.com/dialect-app/dialect",[25],"Dialect",[21,797,800],{"href":798,"rel":799},"https://github.com/rafaelmardojai/share-preview",[25],"Share Preview",[21,802,805],{"href":803,"rel":804},"https://github.com/rafaelmardojai/webfont-kit-generator",[25],"Webfont Kit Generator",[229,807,808,543,811],{},[247,809,810],{},"Sophie Herold",[21,812,815],{"href":813,"rel":814},"https://apps.gnome.org/app/org.gnome.World.PikaBackup/",[25],"Pika Backup",[229,817,818,821,822,580,825,828],{},[247,819,820],{},"Tobias Bernard","\nDesigner of ",[21,823,656],{"href":654,"rel":824},[25],[21,826,697],{"href":695,"rel":827},[25]," (among others)",[229,830,831,543,834],{},[247,832,833],{},"Zander Brown",[21,835,838],{"href":836,"rel":837},"https://gitlab.gnome.org/World/design/icon-preview",[25],"Icon Preview",[229,840,841],{},[247,842,843,844,849],{},"The ",[21,845,848],{"href":846,"rel":847},"https://usebottles.com",[25],"Bottles"," Developers",[229,851,852],{},[247,853,843,854,849],{},[21,855,858],{"href":856,"rel":857},"https://pitivi.org",[25],"Pitivi",[17,860,861],{},[147,862,863],{},"Note: Even though some of us are Foundation  members or work on GNOME, these are our personal views as individuals,  and not those of the GNOME Project, the GNOME Foundation, or our  employers.",[421,865],{},[17,867,868],{},[247,869,870,871],{},"推荐阅读:  ",[21,872,875],{"href":873,"rel":874},"https://whiteboard-ui8.pages.dev/translation/libadwaita-gtk4-TheEvilSkeleton/",[25],"《libadwaita：修复 Linux 桌面的可用性问题》",{"title":47,"searchDepth":98,"depth":98,"links":877},[],{"title":879,"date":880,"path":881,"tags":882,"body":886},"Waydroid on KDE 初体验","2021-10-31 15:57:57","/2021/10/31/waydroid-experience-on-kde",[60,883,884,885],"Waydroid","KDE","Experience",{"type":14,"value":887,"toc":1210},[888,905,909,912,915,921,924,939,956,959,962,981,988,1002,1006,1021,1024,1036,1055,1058,1061,1079,1082,1098,1101,1104,1116,1127,1130,1148,1151,1160,1163,1187,1190,1195,1201,1207],[199,889,890],{},[17,891,892,893,898,899,904],{},"在",[21,894,897],{"href":895,"rel":896},"https://yanqiyu.info/",[25],"西木野羰基的博客","中看到了其在Fedora中使用waydroid跑明日方舟的",[21,900,903],{"href":901,"rel":902},"https://static.031130.xyz/uploads/2024/08/12/62f3cc0d6b9e8.webp",[25],"截图","，心里有有些痒痒了，决定在Archlinux上尝试使用waydroid。",[110,906,908],{"id":907},"waydroid是什么","Waydroid是什么",[17,910,911],{},"Waydroid是一个基于lxc容器技术，用以启动完整安卓系统的方案。",[17,913,914],{},"默认使用了LineageOS-17.1，对应 Aosp10，相比起 anbox 显然是更加新了。",[17,916,917],{},[45,918],{"alt":919,"src":920},"是长成这样","https://static.031130.xyz/uploads/2024/08/12/62f3cb238c027.webp",[110,922,923],{"id":923},"内核支持",[17,925,926,927,930,931,934,935,938],{},"waydroid需要内核提供",[117,928,929],{},"Ashmem","和",[117,932,933],{},"binder","支持，西木野羰基是使用的自己编译的内核。而我在使用Archlinux，因此直接使用",[117,936,937],{},"linux-zen","即可。",[199,940,941],{},[17,942,943,944,947,948,951,952,955],{},"注: AUR上的",[117,945,946],{},"linux-xanmod","虽然也有这些模块支持，但是在编译时设置了",[117,949,950],{},"psi=0","以提升性能，而waydroid恰巧需要",[117,953,954],{},"psi=1","的支持，故不可使用。",[110,957,958],{"id":958},"安装",[17,960,961],{},"Archlinux已经有人将其打包上传到了AUR，我们直接安装即可。我使用的 AUR Helper 是 yay，所以直接",[154,963,965],{"className":156,"code":964,"language":158,"meta":47,"style":47},"yay -S waydroid --noconfirm\n",[117,966,967],{"__ignoreMap":47},[162,968,969,972,975,978],{"class":164,"line":165},[162,970,971],{"class":168},"yay",[162,973,974],{"class":172}," -S",[162,976,977],{"class":176}," waydroid",[162,979,980],{"class":172}," --noconfirm\n",[17,982,983,984,987],{},"再装个",[117,985,986],{},"python-pyclip","解决剪切板同步的问题",[154,989,991],{"className":156,"code":990,"language":158,"meta":47,"style":47},"yay -S python-pyclip\n",[117,992,993],{"__ignoreMap":47},[162,994,995,997,999],{"class":164,"line":165},[162,996,971],{"class":168},[162,998,974],{"class":172},[162,1000,1001],{"class":176}," python-pyclip\n",[110,1003,1005],{"id":1004},"下载waydroid镜像","下载Waydroid镜像",[154,1007,1009],{"className":156,"code":1008,"language":158,"meta":47,"style":47},"sudo waydroid init\n",[117,1010,1011],{"__ignoreMap":47},[162,1012,1013,1016,1018],{"class":164,"line":165},[162,1014,1015],{"class":168},"sudo",[162,1017,977],{"class":176},[162,1019,1020],{"class":176}," init\n",[17,1022,1023],{},"这一步将会自动（从SourceForge）下载纯净的LineageOS镜像压缩包并解压，处于中国大陆网络环境的用户记得（          ）",[17,1025,1026,1027,1030,1031],{},"如果你需要Gapps，可以指定下载Gapps版本，但是这将需要你获取",[117,1028,1029],{},"Android ID","并向谷歌提交 Custom Rom 的 Gapps 申请。见",[21,1032,1035],{"href":1033,"rel":1034},"https://www.google.com/android/uncertified/",[25],"这里",[154,1037,1039],{"className":156,"code":1038,"language":158,"meta":47,"style":47},"sudo waydroid init -s GAPPS\n",[117,1040,1041],{"__ignoreMap":47},[162,1042,1043,1045,1047,1050,1052],{"class":164,"line":165},[162,1044,1015],{"class":168},[162,1046,977],{"class":176},[162,1048,1049],{"class":176}," init",[162,1051,173],{"class":172},[162,1053,1054],{"class":176}," GAPPS\n",[110,1056,1057],{"id":1057},"启用服务",[17,1059,1060],{},"这个没什么好说的，使用systemctl启动服务。",[154,1062,1064],{"className":156,"code":1063,"language":158,"meta":47,"style":47},"sudo systemctl start waydroid-container.service\n",[117,1065,1066],{"__ignoreMap":47},[162,1067,1068,1070,1073,1076],{"class":164,"line":165},[162,1069,1015],{"class":168},[162,1071,1072],{"class":176}," systemctl",[162,1074,1075],{"class":176}," start",[162,1077,1078],{"class":176}," waydroid-container.service\n",[110,1080,1081],{"id":1081},"开启waydroid",[154,1083,1085],{"className":156,"code":1084,"language":158,"meta":47,"style":47},"waydroid session start\n",[117,1086,1087],{"__ignoreMap":47},[162,1088,1089,1092,1095],{"class":164,"line":165},[162,1090,1091],{"class":168},"waydroid",[162,1093,1094],{"class":176}," session",[162,1096,1097],{"class":176}," start\n",[110,1099,1100],{"id":1100},"一些简单的使用技巧",[17,1102,1103],{},"如果你想直接展示整个系统界面，可以使用",[154,1105,1107],{"className":156,"code":1106,"language":158,"meta":47,"style":47},"waydroid show-full-ui\n",[117,1108,1109],{"__ignoreMap":47},[162,1110,1111,1113],{"class":164,"line":165},[162,1112,1091],{"class":168},[162,1114,1115],{"class":176}," show-full-ui\n",[17,1117,1118,1119,1122,1123,1126],{},"我们也可以用",[117,1120,1121],{},"waydroid app launch ${package_name}","的方式来启动单个应用（包名可以使用",[117,1124,1125],{},"waydroid app list","来获取",[17,1128,1129],{},"当然，可以直接在Linux环境里 安装 某个apk",[154,1131,1133],{"className":156,"code":1132,"language":158,"meta":47,"style":47},"waydroid app install path/to/apkfile.apk\n",[117,1134,1135],{"__ignoreMap":47},[162,1136,1137,1139,1142,1145],{"class":164,"line":165},[162,1138,1091],{"class":168},[162,1140,1141],{"class":176}," app",[162,1143,1144],{"class":176}," install",[162,1146,1147],{"class":176}," path/to/apkfile.apk\n",[17,1149,1150],{},"F11有助于解决应用分辨率问题，左Alt有助于解决键盘无法输入的问题。",[17,1152,1153,1154,1159],{},"Github上有个",[21,1155,1158],{"href":1156,"rel":1157},"https://github.com/casualsnek/waydroid_script",[25],"脚本","，可以帮助 安装OpenGapps/Magisk/arm转译库/获取Android ID。",[110,1161,1162],{"id":1162},"牢骚时间",[226,1164,1165,1168,1171,1174,1177,1180],{},[229,1166,1167],{},"对AMD和英伟达的显卡支持都不太行",[229,1169,1170],{},"不能直接输入中文，还是得借助安卓系统内的输入法。",[229,1172,1173],{},"不自带arm转译库，通过脚本安装的转译库似乎兼容性挺差（至少我是成功打开什么arm软件",[229,1175,1176],{},"系统运行的流畅度还可以",[229,1178,1179],{},"相关的资料似乎有点少，官方的文档也没有写得太详细",[229,1181,1182,1183,1186],{},"Waydroid会自动在",[117,1184,1185],{},"$HOME/.local/share/applications/","为wayland内的安装应用添加Desktop文件（这让我有些反感",[110,1188,1189],{"id":1189},"一些截图",[17,1191,1192],{},[45,1193],{"alt":47,"src":1194},"https://static.031130.xyz/uploads/2024/08/12/62f3cb26cba03.webp",[17,1196,1197],{},[45,1198],{"alt":1199,"src":1200},"原生安卓从未变过的应用抽屉","https://static.031130.xyz/uploads/2024/08/12/62f3cc722835c.webp",[17,1202,1203],{},[45,1204],{"alt":1205,"src":1206},"这充电速度太刺激啦！","https://static.031130.xyz/uploads/2024/08/12/62f3cc76b986c.webp",[390,1208,1209],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":47,"searchDepth":98,"depth":98,"links":1211},[1212,1213,1214,1215,1216,1217,1218,1219,1220],{"id":907,"depth":98,"text":908},{"id":923,"depth":98,"text":923},{"id":958,"depth":98,"text":958},{"id":1004,"depth":98,"text":1005},{"id":1057,"depth":98,"text":1057},{"id":1081,"depth":98,"text":1081},{"id":1100,"depth":98,"text":1100},{"id":1162,"depth":98,"text":1162},{"id":1189,"depth":98,"text":1189},{"title":1222,"date":1223,"path":1224,"tags":1225,"body":1228},"PicUploader使用系列（二）——为KDE的dolphin添加右键快捷菜单","2021-10-24 22:26:50","/2021/10/24/picuploader-with-kde-action",[60,1226,884,1227],"PicUploader","PHP",{"type":14,"value":1229,"toc":1606},[1230,1243,1249,1253,1283,1286,1292,1305,1308,1313,1316,1319,1325,1345,1348,1356,1363,1369,1390,1393,1519,1526,1544,1547,1556,1559,1579,1582,1587,1590,1597,1603],[17,1231,1232,1236,1237,1242],{},[21,1233,1235],{"href":1234},"/2021/10/21/picuploader-on-archlinux-with-caddy/","上一篇文章","我们在Archlinux中成功部署了PicUploader的web端，本文我们来讲讲如何为KDE的dolphin添加右键快捷键上传，效果类似这样。（gif图来自",[21,1238,1241],{"href":1239,"rel":1240},"https://www.xiebruce.top/17.html",[25],"PicUploader作者的博客",")",[1244,1245,1246],"center",{},[45,1247],{"src":1248,"width":47,"height":47},"https://img.xiebruce.top/2018/09/11/f4859eda8832f814486fc00df971e3cc.gif",[110,1250,1252],{"id":1251},"创建desktop文件","创建.desktop文件",[154,1254,1256],{"className":156,"code":1255,"language":158,"meta":47,"style":47},"mkdir -p $HOME/.local/share/kservices5/\ntouch $HOME/.local/share/kservices5/picuploader.desktop\n",[117,1257,1258,1273],{"__ignoreMap":47},[162,1259,1260,1263,1266,1270],{"class":164,"line":165},[162,1261,1262],{"class":168},"mkdir",[162,1264,1265],{"class":172}," -p",[162,1267,1269],{"class":1268},"sJa8x"," $HOME",[162,1271,1272],{"class":176},"/.local/share/kservices5/\n",[162,1274,1275,1278,1280],{"class":164,"line":98},[162,1276,1277],{"class":168},"touch",[162,1279,1269],{"class":1268},[162,1281,1282],{"class":176},"/.local/share/kservices5/picuploader.desktop\n",[110,1284,1285],{"id":1285},"填上这段内容",[154,1287,1290],{"className":1288,"code":1289,"language":219},[217],"[Desktop Entry]\nActions=PicUploader;\nMimeType=image/jpeg;image/png;\nType=Service\nX-KDE-Priority=TopLevel\nX-KDE-ServiceTypes=KonqPopupMenu/Plugin\nIcon=/var/www/image/favicon.ico\n\n[Desktop Action PicUploader]\nName=Upload with PicUploader\nName[zh_CN]=使用PicUploader上传\nIcon=/var/www/image/favicon.ico\nExec=php /var/www/image/index.php %F | scopy\n",[117,1291,1289],{"__ignoreMap":47},[17,1293,1294],{},[247,1295,1296,1297,1301,1302,938],{},"注: 这里的 scopy 是我在下面",[21,1298,1300],{"href":1299},"#%E5%A4%8D%E5%88%B6%E5%88%B0%E7%B2%98%E8%B4%B4%E6%9D%BF","自己创建的一段脚本","，用以同时满足x11和wayland下的使用，如果你仅使用x11的话直接改成",[117,1303,1304],{},"xclip -selection clipboard",[17,1306,1307],{},"MimeType指的是文件类型。在这份desktop中，我仅指定了png和jpg文件在右键时会弹出picuploader的上传菜单，如果你需要更多文件类型的MimeType，你可以参考下gwenview的desktop都写了哪些文件类型。",[199,1309,1310],{},[17,1311,1312],{},"MimeType=inode/directory;image/avif;image/gif;image/jpeg;image/png;image/bmp;image/x-eps;image/x-icns;image/x-ico;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-xbitmap;image/x-xpixmap;image/tiff;image/x-psd;image/x-webp;image/webp;image/x-tga;application/x-krita;image/x-kde-raw;image/x-canon-cr2;image/x-canon-crw;image/x-kodak-dcr;image/x-adobe-dng;image/x-kodak-k25;image/x-kodak-kdc;image/x-minolta-mrw;image/x-nikon-nef;image/x-olympus-orf;image/x-pentax-pef;image/x-fuji-raf;image/x-panasonic-rw;image/x-sony-sr2;image/x-sony-srf;image/x-sigma-x3f;image/x-sony-arw;image/x-panasonic-rw2;",[110,1314,1315],{"id":1315},"安装所需组件",[327,1317,1318],{"id":1318},"通知提示",[17,1320,1321,1322],{},"右下角弹出文字提示的功能依赖于",[117,1323,1324],{},"libnotify",[154,1326,1328],{"className":156,"code":1327,"language":158,"meta":47,"style":47},"sudo pacman -S libnotify --needed\n",[117,1329,1330],{"__ignoreMap":47},[162,1331,1332,1334,1337,1339,1342],{"class":164,"line":165},[162,1333,1015],{"class":168},[162,1335,1336],{"class":176}," pacman",[162,1338,974],{"class":172},[162,1340,1341],{"class":176}," libnotify",[162,1343,1344],{"class":172}," --needed\n",[327,1346,1347],{"id":1347},"复制到粘贴板",[17,1349,1350],{},[35,1351,1352,1353],{},"复制到粘贴板的功能依赖于",[117,1354,1355],{},"xclip",[17,1357,1358],{},[35,1359,1360],{},[117,1361,1362],{},"sudo pacman -S xclip --needed",[17,1364,1365,1366,1368],{},"考虑到我可能在 x11 和 wayland 之间反复横跳，仅仅一个",[117,1367,1355],{},"看起来满足不了我的需求",[154,1370,1372],{"className":156,"code":1371,"language":158,"meta":47,"style":47},"sudo pacman -S xclip wl-clipboard --needed\n",[117,1373,1374],{"__ignoreMap":47},[162,1375,1376,1378,1380,1382,1385,1388],{"class":164,"line":165},[162,1377,1015],{"class":168},[162,1379,1336],{"class":176},[162,1381,974],{"class":172},[162,1383,1384],{"class":176}," xclip",[162,1386,1387],{"class":176}," wl-clipboard",[162,1389,1344],{"class":172},[17,1391,1392],{},"手糊了一段脚本，用以判断对应的运行环境并调用相应的粘贴板工具",[154,1394,1396],{"className":156,"code":1395,"language":158,"meta":47,"style":47},"/usr/bin/scopy\n---\n#!/bin/bash\n\nif [ \"$XDG_SESSION_TYPE\" = \"wayland\" ]; then\n  wl-copy\nelif [ \"$XDG_SESSION_TYPE\" = \"x11\" ]; then\n  xclip -selection clipboard\nelse\n  echo \"ERROR! You are using $XDG_SESSION_TYPE\"\nfi\n",[117,1397,1398,1403,1408,1414,1421,1452,1458,1481,1493,1499,1514],{"__ignoreMap":47},[162,1399,1400],{"class":164,"line":165},[162,1401,1402],{"class":168},"/usr/bin/scopy\n",[162,1404,1405],{"class":164,"line":98},[162,1406,1407],{"class":168},"---\n",[162,1409,1410],{"class":164,"line":400},[162,1411,1413],{"class":1412},"sW2Sy","#!/bin/bash\n",[162,1415,1417],{"class":164,"line":1416},4,[162,1418,1420],{"emptyLinePlaceholder":1419},true,"\n",[162,1422,1424,1428,1431,1434,1437,1439,1443,1446,1449],{"class":164,"line":1423},5,[162,1425,1427],{"class":1426},"sLKXg","if",[162,1429,1430],{"class":180}," [ ",[162,1432,1433],{"class":176},"\"",[162,1435,1436],{"class":1268},"$XDG_SESSION_TYPE",[162,1438,1433],{"class":176},[162,1440,1442],{"class":1441},"sknuh"," =",[162,1444,1445],{"class":176}," \"wayland\"",[162,1447,1448],{"class":180}," ]; ",[162,1450,1451],{"class":1426},"then\n",[162,1453,1455],{"class":164,"line":1454},6,[162,1456,1457],{"class":168},"  wl-copy\n",[162,1459,1461,1464,1466,1468,1470,1472,1474,1477,1479],{"class":164,"line":1460},7,[162,1462,1463],{"class":1426},"elif",[162,1465,1430],{"class":180},[162,1467,1433],{"class":176},[162,1469,1436],{"class":1268},[162,1471,1433],{"class":176},[162,1473,1442],{"class":1441},[162,1475,1476],{"class":176}," \"x11\"",[162,1478,1448],{"class":180},[162,1480,1451],{"class":1426},[162,1482,1484,1487,1490],{"class":164,"line":1483},8,[162,1485,1486],{"class":168},"  xclip",[162,1488,1489],{"class":172}," -selection",[162,1491,1492],{"class":176}," clipboard\n",[162,1494,1496],{"class":164,"line":1495},9,[162,1497,1498],{"class":1426},"else\n",[162,1500,1502,1506,1509,1511],{"class":164,"line":1501},10,[162,1503,1505],{"class":1504},"s_Sar","  echo",[162,1507,1508],{"class":176}," \"ERROR! You are using ",[162,1510,1436],{"class":1268},[162,1512,1513],{"class":176},"\"\n",[162,1515,1516],{"class":164,"line":3},[162,1517,1518],{"class":1426},"fi\n",[17,1520,1521,1522,1525],{},"为",[117,1523,1524],{},"/usr/bin/scopy","授予运行权限",[154,1527,1529],{"className":156,"code":1528,"language":158,"meta":47,"style":47},"sudo chmod 755 /usr/bin/scopy\n",[117,1530,1531],{"__ignoreMap":47},[162,1532,1533,1535,1538,1541],{"class":164,"line":165},[162,1534,1015],{"class":168},[162,1536,1537],{"class":176}," chmod",[162,1539,1540],{"class":172}," 755",[162,1542,1543],{"class":176}," /usr/bin/scopy\n",[110,1545,1546],{"id":1546},"启用该动作菜单",[154,1548,1550],{"className":156,"code":1549,"language":158,"meta":47,"style":47},"kbuildsycoca5\n",[117,1551,1552],{"__ignoreMap":47},[162,1553,1554],{"class":164,"line":165},[162,1555,1549],{"class":168},[110,1557,1558],{"id":1558},"处理普通用户无权写入logs的问题",[154,1560,1562],{"className":156,"code":1561,"language":158,"meta":47,"style":47},"sudo chmod 777 -R /var/www/image/logs/\n",[117,1563,1564],{"__ignoreMap":47},[162,1565,1566,1568,1570,1573,1576],{"class":164,"line":165},[162,1567,1015],{"class":168},[162,1569,1537],{"class":176},[162,1571,1572],{"class":172}," 777",[162,1574,1575],{"class":172}," -R",[162,1577,1578],{"class":176}," /var/www/image/logs/\n",[110,1580,1581],{"id":1581},"最终结果",[1244,1583,1584],{},[45,1585],{"src":1586,"width":47,"height":47},"https://static.031130.xyz/uploads/2024/08/12/62f36f57f34aa.gif",[110,1588,1589],{"id":1589},"参考链接",[17,1591,1592],{},[21,1593,1596],{"href":1594,"rel":1595},"https://cnzhx.net/blog/kde-plasma-5-dolphin-add-action-menu-entry/",[25],"在 KDE Plasma 5 的 Dolphin 中添加一个右键动作菜单",[17,1598,1599],{},[21,1600,1602],{"href":1239,"rel":1601},[25],"PicUploader: 一个还不错的图床工具",[390,1604,1605],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sW2Sy, html code.shiki .sW2Sy{--shiki-default:#A0A1A7;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic}html pre.shiki code .sLKXg, html code.shiki .sLKXg{--shiki-default:#A626A4;--shiki-dark:#C678DD}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sknuh, html code.shiki .sknuh{--shiki-default:#383A42;--shiki-dark:#56B6C2}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}",{"title":47,"searchDepth":98,"depth":98,"links":1607},[1608,1609,1610,1614,1615,1616,1617],{"id":1251,"depth":98,"text":1252},{"id":1285,"depth":98,"text":1285},{"id":1315,"depth":98,"text":1315,"children":1611},[1612,1613],{"id":1318,"depth":400,"text":1318},{"id":1347,"depth":400,"text":1347},{"id":1546,"depth":98,"text":1546},{"id":1558,"depth":98,"text":1558},{"id":1581,"depth":98,"text":1581},{"id":1589,"depth":98,"text":1589},{"title":1619,"date":1620,"path":1621,"tags":1622,"body":1624},"PicUploader使用系列（一）——在Archlinux上使用Caddy部署PicUploader","2021-10-21 22:15:33","/2021/10/21/picuploader-on-archlinux-with-caddy",[60,1623,1226,1227],"Caddy",{"type":14,"value":1625,"toc":2592},[1626,1639,1649,1676,1682,1689,1712,1966,1973,1978,1993,2000,2156,2166,2351,2355,2358,2375,2378,2399,2402,2421,2425,2432,2435,2442,2448,2462,2466,2473,2497,2500,2506,2510,2513,2531,2534,2537,2545,2567,2570,2578,2581,2589],[199,1627,1628,1631],{},[17,1629,1630],{},"之前找对大陆网络友好的图床时，找到了cloudinary，但是全英文界面对操作增加了不少难度，其页面也不是很简洁，让我一下打消了使用网页版的念头。通过搜索，找到了 PicUploader 这一方案，使用php编写，支持cloudinary的api。",[17,1632,1633,1634,1638],{},"作者在其",[21,1635,1637],{"href":1239,"rel":1636},[25],"博客","中仅提供了nginx的部署方案，我参考其配置文件成功实现了在caddy下的部署，并且花费了数个小时排坑，故写下本文帮助后来者节省时间。",[110,1640,958,1642,930,1645,1648],{"id":1641},"安装caddy和php-fpm以及所需的拓展",[117,1643,1644],{},"caddy",[117,1646,1647],{},"php-fpm","以及所需的拓展",[154,1650,1652],{"className":156,"code":1651,"language":158,"meta":47,"style":47},"sudo pacman -S caddy php-fpm php-gd php-sqlite --needed\n",[117,1653,1654],{"__ignoreMap":47},[162,1655,1656,1658,1660,1662,1665,1668,1671,1674],{"class":164,"line":165},[162,1657,1015],{"class":168},[162,1659,1336],{"class":176},[162,1661,974],{"class":172},[162,1663,1664],{"class":176}," caddy",[162,1666,1667],{"class":176}," php-fpm",[162,1669,1670],{"class":176}," php-gd",[162,1672,1673],{"class":176}," php-sqlite",[162,1675,1344],{"class":172},[110,1677,1679,1680],{"id":1678},"配置php-fpm","配置",[117,1681,1647],{},[327,1683,892,1685,1688],{"id":1684},"在etcphpphpini启用picuploader所需拓展",[117,1686,1687],{},"/etc/php/php.ini","启用PicUploader所需拓展",[17,1690,1691,1692,1695,1696,1695,1699,1695,1701,1695,1704,1707,1708,1711],{},"PicUploaer依赖于",[117,1693,1694],{},"fileinfo","、",[117,1697,1698],{},"gd",[117,1700,169],{},[117,1702,1703],{},"exif",[117,1705,1706],{},"pdo_sqlite","拓展，可以使用",[117,1709,1710],{},"php -m","命令来查看目前加载成功了的插件。",[154,1713,1717],{"className":1714,"code":1715,"language":1716,"meta":47,"style":47},"language-diff shiki shiki-themes one-light one-dark-pro",";extension=bcmath\n;extension=bz2\n;extension=calendar\n- extension=curl\n+ extension=curl\n;extension=dba\n;extension=enchant\n- extension=exif\n+ extension=exif\n;extension=ffi\n;extension=ftp\n- extension=gd\n+ extension=gd\n;extension=gettext\n;extension=gmp\n;extension=iconv\n;extension=imap\n;extension=intl\n;extension=ldap\n;extension=mysqli\n;extension=odbc\n;zend_extension=opcache\n;extension=pdo_dblib\n;extension=pdo_mysql\n;extension=pdo_odbc\n;extension=pdo_pgsql\n- extension=pdo_sqlite\n+ extension=pdo_sqlite\n;extension=pgsql\n;extension=pspell\n;extension=shmop\n;extension=snmp\n;extension=soap\n;extension=sockets\n;extension=sodium\n;extension=sqlite3\n;extension=sysvmsg\n;extension=sysvsem\n;extension=sysvshm\n;extension=tidy\n;extension=xmlrpc\n;extension=xsl\nextension=zip\n","diff",[117,1718,1719,1724,1729,1734,1739,1744,1749,1754,1759,1764,1769,1774,1780,1786,1792,1798,1804,1810,1816,1822,1828,1834,1840,1846,1852,1858,1864,1870,1876,1882,1888,1894,1900,1906,1912,1918,1924,1930,1936,1942,1948,1954,1960],{"__ignoreMap":47},[162,1720,1721],{"class":164,"line":165},[162,1722,1723],{"class":180},";extension=bcmath\n",[162,1725,1726],{"class":164,"line":98},[162,1727,1728],{"class":180},";extension=bz2\n",[162,1730,1731],{"class":164,"line":400},[162,1732,1733],{"class":180},";extension=calendar\n",[162,1735,1736],{"class":164,"line":1416},[162,1737,1738],{"class":1268},"- extension=curl\n",[162,1740,1741],{"class":164,"line":1423},[162,1742,1743],{"class":176},"+ extension=curl\n",[162,1745,1746],{"class":164,"line":1454},[162,1747,1748],{"class":180},";extension=dba\n",[162,1750,1751],{"class":164,"line":1460},[162,1752,1753],{"class":180},";extension=enchant\n",[162,1755,1756],{"class":164,"line":1483},[162,1757,1758],{"class":1268},"- extension=exif\n",[162,1760,1761],{"class":164,"line":1495},[162,1762,1763],{"class":176},"+ extension=exif\n",[162,1765,1766],{"class":164,"line":1501},[162,1767,1768],{"class":180},";extension=ffi\n",[162,1770,1771],{"class":164,"line":3},[162,1772,1773],{"class":180},";extension=ftp\n",[162,1775,1777],{"class":164,"line":1776},12,[162,1778,1779],{"class":1268},"- extension=gd\n",[162,1781,1783],{"class":164,"line":1782},13,[162,1784,1785],{"class":176},"+ extension=gd\n",[162,1787,1789],{"class":164,"line":1788},14,[162,1790,1791],{"class":180},";extension=gettext\n",[162,1793,1795],{"class":164,"line":1794},15,[162,1796,1797],{"class":180},";extension=gmp\n",[162,1799,1801],{"class":164,"line":1800},16,[162,1802,1803],{"class":180},";extension=iconv\n",[162,1805,1807],{"class":164,"line":1806},17,[162,1808,1809],{"class":180},";extension=imap\n",[162,1811,1813],{"class":164,"line":1812},18,[162,1814,1815],{"class":180},";extension=intl\n",[162,1817,1819],{"class":164,"line":1818},19,[162,1820,1821],{"class":180},";extension=ldap\n",[162,1823,1825],{"class":164,"line":1824},20,[162,1826,1827],{"class":180},";extension=mysqli\n",[162,1829,1831],{"class":164,"line":1830},21,[162,1832,1833],{"class":180},";extension=odbc\n",[162,1835,1837],{"class":164,"line":1836},22,[162,1838,1839],{"class":180},";zend_extension=opcache\n",[162,1841,1843],{"class":164,"line":1842},23,[162,1844,1845],{"class":180},";extension=pdo_dblib\n",[162,1847,1849],{"class":164,"line":1848},24,[162,1850,1851],{"class":180},";extension=pdo_mysql\n",[162,1853,1855],{"class":164,"line":1854},25,[162,1856,1857],{"class":180},";extension=pdo_odbc\n",[162,1859,1861],{"class":164,"line":1860},26,[162,1862,1863],{"class":180},";extension=pdo_pgsql\n",[162,1865,1867],{"class":164,"line":1866},27,[162,1868,1869],{"class":1268},"- extension=pdo_sqlite\n",[162,1871,1873],{"class":164,"line":1872},28,[162,1874,1875],{"class":176},"+ extension=pdo_sqlite\n",[162,1877,1879],{"class":164,"line":1878},29,[162,1880,1881],{"class":180},";extension=pgsql\n",[162,1883,1885],{"class":164,"line":1884},30,[162,1886,1887],{"class":180},";extension=pspell\n",[162,1889,1891],{"class":164,"line":1890},31,[162,1892,1893],{"class":180},";extension=shmop\n",[162,1895,1897],{"class":164,"line":1896},32,[162,1898,1899],{"class":180},";extension=snmp\n",[162,1901,1903],{"class":164,"line":1902},33,[162,1904,1905],{"class":180},";extension=soap\n",[162,1907,1909],{"class":164,"line":1908},34,[162,1910,1911],{"class":180},";extension=sockets\n",[162,1913,1915],{"class":164,"line":1914},35,[162,1916,1917],{"class":180},";extension=sodium\n",[162,1919,1921],{"class":164,"line":1920},36,[162,1922,1923],{"class":180},";extension=sqlite3\n",[162,1925,1927],{"class":164,"line":1926},37,[162,1928,1929],{"class":180},";extension=sysvmsg\n",[162,1931,1933],{"class":164,"line":1932},38,[162,1934,1935],{"class":180},";extension=sysvsem\n",[162,1937,1939],{"class":164,"line":1938},39,[162,1940,1941],{"class":180},";extension=sysvshm\n",[162,1943,1945],{"class":164,"line":1944},40,[162,1946,1947],{"class":180},";extension=tidy\n",[162,1949,1951],{"class":164,"line":1950},41,[162,1952,1953],{"class":180},";extension=xmlrpc\n",[162,1955,1957],{"class":164,"line":1956},42,[162,1958,1959],{"class":180},";extension=xsl\n",[162,1961,1963],{"class":164,"line":1962},43,[162,1964,1965],{"class":180},"extension=zip\n",[327,1967,1969,1970,1972],{"id":1968},"编辑etcphpphpini以增加单文件上传大小限制","编辑",[117,1971,1687],{},"以增加单文件上传大小限制",[17,1974,1975],{},[35,1976,1977],{},"查出这个问题浪费了我整整4小时时间。",[154,1979,1981],{"className":1714,"code":1980,"language":1716,"meta":47,"style":47},"- upload_max_filesize = 2M\n+ upload_max_filesize = 100M\n",[117,1982,1983,1988],{"__ignoreMap":47},[162,1984,1985],{"class":164,"line":165},[162,1986,1987],{"class":1268},"- upload_max_filesize = 2M\n",[162,1989,1990],{"class":164,"line":98},[162,1991,1992],{"class":176},"+ upload_max_filesize = 100M\n",[327,1994,1969,1996,1999],{"id":1995},"编辑etcphpphp-fpmdwwwconf使其在运行时使用caddy用户",[117,1997,1998],{},"/etc/php/php-fpm.d/www.conf","使其在运行时使用caddy用户。",[154,2001,2003],{"className":1714,"code":2002,"language":1716,"meta":47,"style":47},"---\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n- user = http\n+ user = caddy\n- group = http\n+ group = caddy\n; The address on which to accept FastCGI requests.\n; Valid syntaxes are:\n;   'ip.add.re.ss:port'    - to listen on a TCP socket to a specific IPv4 address on\n;                            a specific port;\n;   '[ip:6:addr:ess]:port' - to listen on a TCP socket to a specific IPv6 address on\n---\n---\n; Note: This value is mandatory.\nlisten = /run/php-fpm/php-fpm.sock\n; and group can be specified either by name or by their numeric IDs.\n; Default Values: user and group are set as the running user\n;                 mode is set to 0660\n- listen.owner = http\n+ listen.owner = caddy\n- listen.group = http\n+ listen.group = caddy\n;listen.mode = 0660\n; When POSIX Access Control Lists are supported you can set them using\n; these options, value is a comma separated list of user/group names.\n; When set, listen.owner and listen.group are ignored\n;listen.acl_users =\n;listen.acl_groups =\n---\n",[117,2004,2005,2009,2014,2019,2024,2029,2034,2039,2044,2049,2054,2059,2064,2069,2073,2077,2082,2087,2092,2097,2102,2107,2112,2117,2122,2127,2132,2137,2142,2147,2152],{"__ignoreMap":47},[162,2006,2007],{"class":164,"line":165},[162,2008,1407],{"class":180},[162,2010,2011],{"class":164,"line":98},[162,2012,2013],{"class":180},"; Unix user/group of processes\n",[162,2015,2016],{"class":164,"line":400},[162,2017,2018],{"class":180},"; Note: The user is mandatory. If the group is not set, the default user's group\n",[162,2020,2021],{"class":164,"line":1416},[162,2022,2023],{"class":180},";       will be used.\n",[162,2025,2026],{"class":164,"line":1423},[162,2027,2028],{"class":1268},"- user = http\n",[162,2030,2031],{"class":164,"line":1454},[162,2032,2033],{"class":176},"+ user = caddy\n",[162,2035,2036],{"class":164,"line":1460},[162,2037,2038],{"class":1268},"- group = http\n",[162,2040,2041],{"class":164,"line":1483},[162,2042,2043],{"class":176},"+ group = caddy\n",[162,2045,2046],{"class":164,"line":1495},[162,2047,2048],{"class":180},"; The address on which to accept FastCGI requests.\n",[162,2050,2051],{"class":164,"line":1501},[162,2052,2053],{"class":180},"; Valid syntaxes are:\n",[162,2055,2056],{"class":164,"line":3},[162,2057,2058],{"class":180},";   'ip.add.re.ss:port'    - to listen on a TCP socket to a specific IPv4 address on\n",[162,2060,2061],{"class":164,"line":1776},[162,2062,2063],{"class":180},";                            a specific port;\n",[162,2065,2066],{"class":164,"line":1782},[162,2067,2068],{"class":180},";   '[ip:6:addr:ess]:port' - to listen on a TCP socket to a specific IPv6 address on\n",[162,2070,2071],{"class":164,"line":1788},[162,2072,1407],{"class":180},[162,2074,2075],{"class":164,"line":1794},[162,2076,1407],{"class":180},[162,2078,2079],{"class":164,"line":1800},[162,2080,2081],{"class":180},"; Note: This value is mandatory.\n",[162,2083,2084],{"class":164,"line":1806},[162,2085,2086],{"class":180},"listen = /run/php-fpm/php-fpm.sock\n",[162,2088,2089],{"class":164,"line":1812},[162,2090,2091],{"class":180},"; and group can be specified either by name or by their numeric IDs.\n",[162,2093,2094],{"class":164,"line":1818},[162,2095,2096],{"class":180},"; Default Values: user and group are set as the running user\n",[162,2098,2099],{"class":164,"line":1824},[162,2100,2101],{"class":180},";                 mode is set to 0660\n",[162,2103,2104],{"class":164,"line":1830},[162,2105,2106],{"class":1268},"- listen.owner = http\n",[162,2108,2109],{"class":164,"line":1836},[162,2110,2111],{"class":176},"+ listen.owner = caddy\n",[162,2113,2114],{"class":164,"line":1842},[162,2115,2116],{"class":1268},"- listen.group = http\n",[162,2118,2119],{"class":164,"line":1848},[162,2120,2121],{"class":176},"+ listen.group = caddy\n",[162,2123,2124],{"class":164,"line":1854},[162,2125,2126],{"class":180},";listen.mode = 0660\n",[162,2128,2129],{"class":164,"line":1860},[162,2130,2131],{"class":180},"; When POSIX Access Control Lists are supported you can set them using\n",[162,2133,2134],{"class":164,"line":1866},[162,2135,2136],{"class":180},"; these options, value is a comma separated list of user/group names.\n",[162,2138,2139],{"class":164,"line":1872},[162,2140,2141],{"class":180},"; When set, listen.owner and listen.group are ignored\n",[162,2143,2144],{"class":164,"line":1878},[162,2145,2146],{"class":180},";listen.acl_users =\n",[162,2148,2149],{"class":164,"line":1884},[162,2150,2151],{"class":180},";listen.acl_groups =\n",[162,2153,2154],{"class":164,"line":1890},[162,2155,1407],{"class":180},[17,2157,2158,2161,2162,2165],{},[247,2159,2160],{},"2022年1月14日更新","：在 Fedora 尝试部署的时候遇到了新的坑，Fedora 的相应配置文件为 ",[117,2163,2164],{},"/etc/php-fpm.d/www.conf","，相应修改如下",[154,2167,2169],{"className":1714,"code":2168,"language":1716,"meta":47,"style":47},"; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n; RPM: apache user chosen to provide access to the same directories as httpd\n-user = apache\n+user = caddy\n; RPM: Keep a group allowed to write in log dir.\n-user = apache\n+group = caddy\n\n; The address on which to accept FastCGI requests.\n; Valid syntaxes are:\n;   'ip.add.re.ss:port'    - to listen on a TCP socket to a specific IPv4 address on\n;             a specific port;\n---\n---\n; Set permissions for unix socket, if one is used. In Linux, read/write\n; permissions must be set in order to allow connections from a web server.\n; Default Values: user and group are set as the running user\n;                 mode is set to 0660\n-;listen.owner = nobody\n+listen.owner = caddy\n-;listen.owner = nobody\n+listen.group = caddy\n;listen.mode = 0660\n\n; When POSIX Access Control Lists are supported you can set them using\n; these options, value is a comma separated list of user/group names.\n; When set, listen.owner and listen.group are ignored\n-listen.acl_users = apache,nginx\n+;listen.acl_users = apache,nginx\n;listen.acl_groups =\n\n; List of addresses (IPv4/IPv6) of FastCGI clients which are allowed to connect.\n; Equivalent to the FCGI_WEB_SERVER_ADDRS environment variable in the original\n; PHP FCGI (5.2.2+). Makes sense only with a tcp listening socket. Each address\n; must be separated by a comma. If this value is left blank, connections will be\n; accepted from any ip address.\n; Default Value: any\nlisten.allowed_clients = 127.0.0.1\n",[117,2170,2171,2175,2179,2183,2188,2193,2198,2203,2207,2212,2216,2220,2224,2228,2233,2237,2241,2246,2251,2255,2259,2264,2269,2273,2278,2282,2286,2290,2294,2298,2303,2308,2312,2316,2321,2326,2331,2336,2341,2346],{"__ignoreMap":47},[162,2172,2173],{"class":164,"line":165},[162,2174,2013],{"class":180},[162,2176,2177],{"class":164,"line":98},[162,2178,2018],{"class":180},[162,2180,2181],{"class":164,"line":400},[162,2182,2023],{"class":180},[162,2184,2185],{"class":164,"line":1416},[162,2186,2187],{"class":180},"; RPM: apache user chosen to provide access to the same directories as httpd\n",[162,2189,2190],{"class":164,"line":1423},[162,2191,2192],{"class":1268},"-user = apache\n",[162,2194,2195],{"class":164,"line":1454},[162,2196,2197],{"class":176},"+user = caddy\n",[162,2199,2200],{"class":164,"line":1460},[162,2201,2202],{"class":180},"; RPM: Keep a group allowed to write in log dir.\n",[162,2204,2205],{"class":164,"line":1483},[162,2206,2192],{"class":1268},[162,2208,2209],{"class":164,"line":1495},[162,2210,2211],{"class":176},"+group = caddy\n",[162,2213,2214],{"class":164,"line":1501},[162,2215,1420],{"emptyLinePlaceholder":1419},[162,2217,2218],{"class":164,"line":3},[162,2219,2048],{"class":180},[162,2221,2222],{"class":164,"line":1776},[162,2223,2053],{"class":180},[162,2225,2226],{"class":164,"line":1782},[162,2227,2058],{"class":180},[162,2229,2230],{"class":164,"line":1788},[162,2231,2232],{"class":180},";             a specific port;\n",[162,2234,2235],{"class":164,"line":1794},[162,2236,1407],{"class":180},[162,2238,2239],{"class":164,"line":1800},[162,2240,1407],{"class":180},[162,2242,2243],{"class":164,"line":1806},[162,2244,2245],{"class":180},"; Set permissions for unix socket, if one is used. In Linux, read/write\n",[162,2247,2248],{"class":164,"line":1812},[162,2249,2250],{"class":180},"; permissions must be set in order to allow connections from a web server.\n",[162,2252,2253],{"class":164,"line":1818},[162,2254,2096],{"class":180},[162,2256,2257],{"class":164,"line":1824},[162,2258,2101],{"class":180},[162,2260,2261],{"class":164,"line":1830},[162,2262,2263],{"class":1268},"-;listen.owner = nobody\n",[162,2265,2266],{"class":164,"line":1836},[162,2267,2268],{"class":176},"+listen.owner = caddy\n",[162,2270,2271],{"class":164,"line":1842},[162,2272,2263],{"class":1268},[162,2274,2275],{"class":164,"line":1848},[162,2276,2277],{"class":176},"+listen.group = caddy\n",[162,2279,2280],{"class":164,"line":1854},[162,2281,2126],{"class":180},[162,2283,2284],{"class":164,"line":1860},[162,2285,1420],{"emptyLinePlaceholder":1419},[162,2287,2288],{"class":164,"line":1866},[162,2289,2131],{"class":180},[162,2291,2292],{"class":164,"line":1872},[162,2293,2136],{"class":180},[162,2295,2296],{"class":164,"line":1878},[162,2297,2141],{"class":180},[162,2299,2300],{"class":164,"line":1884},[162,2301,2302],{"class":1268},"-listen.acl_users = apache,nginx\n",[162,2304,2305],{"class":164,"line":1890},[162,2306,2307],{"class":176},"+;listen.acl_users = apache,nginx\n",[162,2309,2310],{"class":164,"line":1896},[162,2311,2151],{"class":180},[162,2313,2314],{"class":164,"line":1902},[162,2315,1420],{"emptyLinePlaceholder":1419},[162,2317,2318],{"class":164,"line":1908},[162,2319,2320],{"class":180},"; List of addresses (IPv4/IPv6) of FastCGI clients which are allowed to connect.\n",[162,2322,2323],{"class":164,"line":1914},[162,2324,2325],{"class":180},"; Equivalent to the FCGI_WEB_SERVER_ADDRS environment variable in the original\n",[162,2327,2328],{"class":164,"line":1920},[162,2329,2330],{"class":180},"; PHP FCGI (5.2.2+). Makes sense only with a tcp listening socket. Each address\n",[162,2332,2333],{"class":164,"line":1926},[162,2334,2335],{"class":180},"; must be separated by a comma. If this value is left blank, connections will be\n",[162,2337,2338],{"class":164,"line":1932},[162,2339,2340],{"class":180},"; accepted from any ip address.\n",[162,2342,2343],{"class":164,"line":1938},[162,2344,2345],{"class":180},"; Default Value: any\n",[162,2347,2348],{"class":164,"line":1944},[162,2349,2350],{"class":180},"listen.allowed_clients = 127.0.0.1\n",[110,2352,2354],{"id":2353},"拉取-picuploader-最新代码","拉取 PicUploader 最新代码",[17,2356,2357],{},"首先创建一个用于存放代码的目录",[154,2359,2361],{"className":156,"code":2360,"language":158,"meta":47,"style":47},"sudo mkdir -p /var/www/\n",[117,2362,2363],{"__ignoreMap":47},[162,2364,2365,2367,2370,2372],{"class":164,"line":165},[162,2366,1015],{"class":168},[162,2368,2369],{"class":176}," mkdir",[162,2371,1265],{"class":172},[162,2373,2374],{"class":176}," /var/www/\n",[17,2376,2377],{},"clone 最新源码",[154,2379,2381],{"className":156,"code":2380,"language":158,"meta":47,"style":47},"sudo git clone https://github.com/xiebruce/PicUploader.git /var/www/picuploader\n",[117,2382,2383],{"__ignoreMap":47},[162,2384,2385,2387,2390,2393,2396],{"class":164,"line":165},[162,2386,1015],{"class":168},[162,2388,2389],{"class":176}," git",[162,2391,2392],{"class":176}," clone",[162,2394,2395],{"class":176}," https://github.com/xiebruce/PicUploader.git",[162,2397,2398],{"class":176}," /var/www/picuploader\n",[17,2400,2401],{},"将代码所有权转交给caddy用户",[154,2403,2405],{"className":156,"code":2404,"language":158,"meta":47,"style":47},"sudo chown -R caddy:caddy /var/www/picuploader\n",[117,2406,2407],{"__ignoreMap":47},[162,2408,2409,2411,2414,2416,2419],{"class":164,"line":165},[162,2410,1015],{"class":168},[162,2412,2413],{"class":176}," chown",[162,2415,1575],{"class":172},[162,2417,2418],{"class":176}," caddy:caddy",[162,2420,2398],{"class":176},[110,2422,2424],{"id":2423},"编辑caddyfile","编辑Caddyfile",[17,2426,2427,2428,2431],{},"caddy默认使用",[117,2429,2430],{},"/etc/caddy/Caddyfile","，因此如果你就部署这一个站点，直接修改这个就好了。",[17,2433,2434],{},"caddy的语法非常简洁易懂，因此我随手写了几行就能跑起来了。",[17,2436,2437,2438,2441],{},"下面是我用的Caddyfile，如果你在服务器上部署，请把",[117,2439,2440],{},"http://api.picuploader.com","更换为你服务器所需要绑定的域名(不带http协议头)，caddy将自动为你申请ssl证书。",[154,2443,2446],{"className":2444,"code":2445,"language":219},[217],"http://api.picuploader.com {\n        root * /var/www/picuploader\n\n        php_fastcgi * unix//run/php-fpm/php-fpm.sock {\n                index dashboard.php\n        }\n\n        file_server {\n                index index.php\n        }\n\n        handle_errors {\n        root * /etc/caddy/error\n                rewrite * /error.html\n                templates\n                file_server\n        }\n}\n\n# Import additional caddy config files in /etc/caddy/conf.d/\nimport /etc/caddy/conf.d/*\n",[117,2447,2445],{"__ignoreMap":47},[17,2449,2450,2451,2454,2455,2457,2458,2461],{},"php我选择了监听本地",[117,2452,2453],{},"unix//run/php-fpm/php-fpm.sock","的方案，这个路径在上文的",[117,2456,1998],{},"可以设置，如需查询，直接使用 ",[117,2459,2460],{},"grep listen\\ = /etc/php/php-fpm.d/www.conf","应该就能看见。",[327,2463,2465],{"id":2464},"设置访问密码可选","设置访问密码（可选）",[17,2467,2468,2469,2472],{},"caddy2开始不允许在caddyfile中直接指定明文密码，因此我们需要用",[117,2470,2471],{},"hash-password","获取加密后的密码密文",[154,2474,2476],{"className":156,"code":2475,"language":158,"meta":47,"style":47},"caddy hash-password  --plaintext \u003CYourPassword>\n",[117,2477,2478],{"__ignoreMap":47},[162,2479,2480,2482,2485,2488,2491,2494],{"class":164,"line":165},[162,2481,1644],{"class":168},[162,2483,2484],{"class":176}," hash-password",[162,2486,2487],{"class":172},"  --plaintext",[162,2489,2490],{"class":180}," \u003C",[162,2492,2493],{"class":176},"YourPasswor",[162,2495,2496],{"class":180},"d>\n",[17,2498,2499],{},"再在Caddyfile中，加上",[154,2501,2504],{"className":2502,"code":2503,"language":219},[217],"basicauth /* {\n        \u003Cusername> \u003Chashed_password>\n}\n",[117,2505,2503],{"__ignoreMap":47},[110,2507,2509],{"id":2508},"修改hosts设置dns解析","修改hosts/设置DNS解析",[17,2511,2512],{},"由于 api.picuploader.com 这个域名不在我手里，而我只是想在本地使用，并不打算部署到服务器，因此修改hosts将这个域名解析到本地是个不错的选择。",[154,2514,2516],{"className":156,"code":2515,"language":158,"meta":47,"style":47},"sudo sh -c \"echo '127.0.0.1     api.picuploader.com'  /etc/hosts\"\n",[117,2517,2518],{"__ignoreMap":47},[162,2519,2520,2522,2525,2528],{"class":164,"line":165},[162,2521,1015],{"class":168},[162,2523,2524],{"class":176}," sh",[162,2526,2527],{"class":172}," -c",[162,2529,2530],{"class":176}," \"echo '127.0.0.1     api.picuploader.com'  /etc/hosts\"\n",[17,2532,2533],{},"而你若是在服务器上部署，应当去设置DNS解析，这个应该不需要我多说。",[110,2535,2536],{"id":2536},"开启服务",[17,2538,2539,2540,930,2542,2544],{},"在Archlinux下，我习惯直接用systemd运行",[117,2541,1644],{},[117,2543,1647],{},"以开机自启动。",[154,2546,2548],{"className":156,"code":2547,"language":158,"meta":47,"style":47},"sudo systemctl enable --now caddy php-fpm\n",[117,2549,2550],{"__ignoreMap":47},[162,2551,2552,2554,2556,2559,2562,2564],{"class":164,"line":165},[162,2553,1015],{"class":168},[162,2555,1072],{"class":176},[162,2557,2558],{"class":176}," enable",[162,2560,2561],{"class":172}," --now",[162,2563,1664],{"class":176},[162,2565,2566],{"class":176}," php-fpm\n",[110,2568,2569],{"id":2569},"最终测试",[17,2571,2572,2573,2577],{},"在浏览器内访问 ",[21,2574,2576],{"href":2440,"rel":2575},[25],"api.picuploader.com"," ，如果能看到页面，就算是成功啦。",[110,2579,2580],{"id":2580},"设置上传参数",[17,2582,2583,2584],{},"见作者博客：",[21,2585,2588],{"href":2586,"rel":2587},"https://www.xiebruce.top/117.html",[25],"PicUploader: 各图床获取上传图片参数的方法",[390,2590,2591],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}",{"title":47,"searchDepth":98,"depth":98,"links":2593},[2594,2595,2603,2604,2607,2608,2609,2610],{"id":1641,"depth":98,"text":1641},{"id":1678,"depth":98,"text":1678,"children":2596},[2597,2599,2601],{"id":1684,"depth":400,"text":2598},"在/etc/php/php.ini启用PicUploader所需拓展",{"id":1968,"depth":400,"text":2600},"编辑/etc/php/php.ini以增加单文件上传大小限制",{"id":1995,"depth":400,"text":2602},"编辑/etc/php/php-fpm.d/www.conf使其在运行时使用caddy用户。",{"id":2353,"depth":98,"text":2354},{"id":2423,"depth":98,"text":2424,"children":2605},[2606],{"id":2464,"depth":400,"text":2465},{"id":2508,"depth":98,"text":2509},{"id":2536,"depth":98,"text":2536},{"id":2569,"depth":98,"text":2569},{"id":2580,"depth":98,"text":2580},{"title":2612,"date":2613,"path":2614,"tags":2615,"body":2616},"Archlinux坚果云踩坑实录","2021-10-02 00:21:34","/2021/10/02/nutstore-guide-on-archlinux-kde",[60],{"type":14,"value":2617,"toc":2924},[2618,2623,2625,2639,2642,2645,2648,2653,2660,2666,2672,2693,2696,2699,2705,2711,2717,2721,2727,2735,2764,2770,2774,2777,2783,2790,2820,2824,2827,2845,2851,2921],[199,2619,2620],{},[17,2621,2622],{},"在Archlinux上，坚果云似乎出现了一些问题。",[110,2624,958],{"id":958},[154,2626,2628],{"className":156,"code":2627,"language":158,"meta":47,"style":47},"yay -S nutstore\n",[117,2629,2630],{"__ignoreMap":47},[162,2631,2632,2634,2636],{"class":164,"line":165},[162,2633,971],{"class":168},[162,2635,974],{"class":172},[162,2637,2638],{"class":176}," nutstore\n",[17,2640,2641],{},"这个没什么可说的，AUR还是Archlinuxcn都无所谓，都是一模一样的。",[110,2643,2644],{"id":2644},"白屏",[17,2646,2647],{},"双击图标，咦？怎么白屏了？",[17,2649,2650],{},[45,2651],{"alt":2644,"src":2652},"https://static.031130.xyz/uploads/2024/08/12/62f3cc797bc09.webp",[17,2654,2655,2656,2659],{},"看看AUR评论区，有人说",[117,2657,2658],{},"nutstore-experimental","修了？",[17,2661,2662],{},[45,2663],{"alt":2664,"src":2665},"AUR评论区","https://static.031130.xyz/uploads/2024/08/12/62f3cc7df08ad.webp",[17,2667,2668,2669],{},"对比了一下，就是改了改",[117,2670,2671],{},"/opt/nutstore/conf/nutstore.properties",[154,2673,2675],{"className":156,"code":2674,"language":158,"meta":47,"style":47},"sudo sed -i 's|webui.enable=true|webui.enable=false|' /opt/nutstore/conf/nutstore.properties\n",[117,2676,2677],{"__ignoreMap":47},[162,2678,2679,2681,2684,2687,2690],{"class":164,"line":165},[162,2680,1015],{"class":168},[162,2682,2683],{"class":176}," sed",[162,2685,2686],{"class":172}," -i",[162,2688,2689],{"class":176}," 's|webui.enable=true|webui.enable=false|'",[162,2691,2692],{"class":176}," /opt/nutstore/conf/nutstore.properties\n",[17,2694,2695],{},"轻松解决",[110,2697,2698],{"id":2698},"窗口太小不能登陆",[17,2700,2701],{},[45,2702],{"alt":2703,"src":2704},"调出窗口规则设置界面","https://static.031130.xyz/uploads/2024/08/12/62f3cc822fbe9.webp",[17,2706,2707],{},[45,2708],{"alt":2709,"src":2710},"进行设置","https://static.031130.xyz/uploads/2024/08/12/62f3cc864a783.webp",[17,2712,2713],{},[45,2714],{"alt":2715,"src":2716},"完成","https://static.031130.xyz/uploads/2024/08/12/62f3cc89ca4eb.webp",[110,2718,2720],{"id":2719},"桌面使用了暗色主题导致部分字体不清晰","桌面使用了暗色主题导致部分字体不清晰？",[17,2722,2723],{},[45,2724],{"alt":2725,"src":2726},"这字体鬼看得见？","https://static.031130.xyz/uploads/2024/08/12/62f3cc8f193b1.webp",[17,2728,2729,2730,2734],{},"参考",[21,2731,2733],{"href":2732},"/2021/09/05/wrong-fonts-color-fix-under-kde-with-a-dark-theme/","使用fakehome方案暂时解决跑在KDE暗色主题下的程序使用亮色字体的问题","编写启动命令",[154,2736,2738],{"className":156,"code":2737,"language":158,"meta":47,"style":47},"bwrap --dev-bind / / --tmpfs $HOME/.config /usr/bin/nutstore\n",[117,2739,2740],{"__ignoreMap":47},[162,2741,2742,2745,2748,2751,2753,2756,2758,2761],{"class":164,"line":165},[162,2743,2744],{"class":168},"bwrap",[162,2746,2747],{"class":172}," --dev-bind",[162,2749,2750],{"class":176}," /",[162,2752,2750],{"class":176},[162,2754,2755],{"class":172}," --tmpfs",[162,2757,1269],{"class":1268},[162,2759,2760],{"class":176},"/.config",[162,2762,2763],{"class":176}," /usr/bin/nutstore\n",[17,2765,2766],{},[45,2767],{"alt":2768,"src":2769},"测试通过","https://static.031130.xyz/uploads/2024/08/12/62f3cc9245d26.webp",[110,2771,2773],{"id":2772},"本地markdown文件的文件类型被识别成了坚果云-markdown","本地markdown文件的文件类型被识别成了「坚果云 Markdown」",[17,2775,2776],{},"这个是由于坚果云自作主张推广他自己并不好用的lightapp，写了几条 mime 的规则，如图",[17,2778,2779],{},[45,2780],{"alt":2781,"src":2782},"没错，整整5个xml","https://static.031130.xyz/uploads/2024/08/12/62f3cc95f0dd1.webp",[17,2784,2785,2786,2789],{},"看来在我们的启动命令中也需要防止坚果云接触到",[117,2787,2788],{},"$HOME/.local/share/","这个路径，所以现在的启动命令得写成这样。",[154,2791,2793],{"className":156,"code":2792,"language":158,"meta":47,"style":47},"bwrap --dev-bind / / --tmpfs $HOME/.config --tmpfs $HOME/.local/share/ /usr/bin/nutstore\n",[117,2794,2795],{"__ignoreMap":47},[162,2796,2797,2799,2801,2803,2805,2807,2809,2811,2813,2815,2818],{"class":164,"line":165},[162,2798,2744],{"class":168},[162,2800,2747],{"class":172},[162,2802,2750],{"class":176},[162,2804,2750],{"class":176},[162,2806,2755],{"class":172},[162,2808,1269],{"class":1268},[162,2810,2760],{"class":176},[162,2812,2755],{"class":172},[162,2814,1269],{"class":1268},[162,2816,2817],{"class":176},"/.local/share/",[162,2819,2763],{"class":176},[110,2821,2823],{"id":2822},"修改desktop文件使其使用我们自己攥写的启动命令","修改desktop文件，使其使用我们自己攥写的启动命令",[17,2825,2826],{},"首先，复制一份desktop文件到我们的 $HOME 目录下，好处是下次更新的时候我们所做的更改不会被包管理器覆盖。",[154,2828,2830],{"className":156,"code":2829,"language":158,"meta":47,"style":47},"cp /usr/share/applications/nutstore.desktop $HOME/.local/share/applications/\n",[117,2831,2832],{"__ignoreMap":47},[162,2833,2834,2837,2840,2842],{"class":164,"line":165},[162,2835,2836],{"class":168},"cp",[162,2838,2839],{"class":176}," /usr/share/applications/nutstore.desktop",[162,2841,1269],{"class":1268},[162,2843,2844],{"class":176},"/.local/share/applications/\n",[17,2846,2847,2848],{},"再修改",[117,2849,2850],{},"$HOME/.local/share/applications/nutstore.desktop",[154,2852,2854],{"className":1714,"code":2853,"language":1716,"meta":47,"style":47},"[Desktop Entry]\nEncoding=UTF-8\nType=Application\nTerminal=false\nIcon=nutstore\n-Exec=/usr/bin/nutstore\n+Exec=bwrap --dev-bind / / --tmpfs $HOME/.config --tmpfs $HOME/.local/share/applications --tmpfs $HOME/.local/share/mime /usr/bin/nutstore\nStartupWMClass=Nutstore\nName=Nutstore\nName[zh_CN]=坚果云 \nComment=Data Sync, Sharing, Backup\nComment[zh_CN]=数据同步,共享和备份\nCategories=Network;Application;\n",[117,2855,2856,2861,2866,2871,2876,2881,2886,2891,2896,2901,2906,2911,2916],{"__ignoreMap":47},[162,2857,2858],{"class":164,"line":165},[162,2859,2860],{"class":180},"[Desktop Entry]\n",[162,2862,2863],{"class":164,"line":98},[162,2864,2865],{"class":180},"Encoding=UTF-8\n",[162,2867,2868],{"class":164,"line":400},[162,2869,2870],{"class":180},"Type=Application\n",[162,2872,2873],{"class":164,"line":1416},[162,2874,2875],{"class":180},"Terminal=false\n",[162,2877,2878],{"class":164,"line":1423},[162,2879,2880],{"class":180},"Icon=nutstore\n",[162,2882,2883],{"class":164,"line":1454},[162,2884,2885],{"class":1268},"-Exec=/usr/bin/nutstore\n",[162,2887,2888],{"class":164,"line":1460},[162,2889,2890],{"class":176},"+Exec=bwrap --dev-bind / / --tmpfs $HOME/.config --tmpfs $HOME/.local/share/applications --tmpfs $HOME/.local/share/mime /usr/bin/nutstore\n",[162,2892,2893],{"class":164,"line":1483},[162,2894,2895],{"class":180},"StartupWMClass=Nutstore\n",[162,2897,2898],{"class":164,"line":1495},[162,2899,2900],{"class":180},"Name=Nutstore\n",[162,2902,2903],{"class":164,"line":1501},[162,2904,2905],{"class":180},"Name[zh_CN]=坚果云 \n",[162,2907,2908],{"class":164,"line":3},[162,2909,2910],{"class":180},"Comment=Data Sync, Sharing, Backup\n",[162,2912,2913],{"class":164,"line":1776},[162,2914,2915],{"class":180},"Comment[zh_CN]=数据同步,共享和备份\n",[162,2917,2918],{"class":164,"line":1782},[162,2919,2920],{"class":180},"Categories=Network;Application;\n",[390,2922,2923],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .s5ixo, html code.shiki .s5ixo{--shiki-default:#383A42;--shiki-dark:#ABB2BF}",{"title":47,"searchDepth":98,"depth":98,"links":2925},[2926,2927,2928,2929,2930,2931],{"id":958,"depth":98,"text":958},{"id":2644,"depth":98,"text":2644},{"id":2698,"depth":98,"text":2698},{"id":2719,"depth":98,"text":2720},{"id":2772,"depth":98,"text":2773},{"id":2822,"depth":98,"text":2823},{"title":2933,"date":2934,"path":2935,"tags":2936,"body":2939},"把老版的火狐顶栏UI带回来","2021-10-01 19:20:23","/2021/10/01/bring-firefox-old-topbar-back",[2937,106,2938],"Firefox","Bwrap",{"type":14,"value":2940,"toc":3100},[2941,2947,2953,2964,2967,2973,3001,3008,3015,3020,3031,3037,3040,3046,3049,3058,3064,3067,3085,3091,3097],[17,2942,2943],{},[45,2944],{"alt":2945,"src":2946},"这是最新版火狐的顶栏","https://static.031130.xyz/uploads/2024/08/12/62f3cca6bb523.webp",[17,2948,2949],{},[45,2950],{"alt":2951,"src":2952},"这是去掉标题栏后的样子","https://static.031130.xyz/uploads/2024/08/12/62f3ccaa2b91c.webp",[199,2954,2955],{},[17,2956,2957,2958,2963],{},"在Firefox更新UI以后，我就一直感觉不太适应。顶栏的一个个标签页占用的体积达到了原来的1.5~2倍。Thanks to ",[21,2959,2962],{"href":2960,"rel":2961},"https://github.com/black7375/Firefox-UI-Fix",[25],"black7375/Firefox-UI-Fix"," ，我们得以把以前的顶栏找回来。",[327,2965,2966],{"id":2966},"加载新的css",[17,2968,2969,2970],{},"clone该github项目并进入对应路径后，执行",[117,2971,2972],{},"install.sh",[154,2974,2976],{"className":156,"code":2975,"language":158,"meta":47,"style":47},"git clone https://github.com/black7375/Firefox-UI-Fix.git\ncd Firefox-UI-Fix.git\n./install.sh\n",[117,2977,2978,2988,2996],{"__ignoreMap":47},[162,2979,2980,2983,2985],{"class":164,"line":165},[162,2981,2982],{"class":168},"git",[162,2984,2392],{"class":176},[162,2986,2987],{"class":176}," https://github.com/black7375/Firefox-UI-Fix.git\n",[162,2989,2990,2993],{"class":164,"line":98},[162,2991,2992],{"class":1504},"cd",[162,2994,2995],{"class":176}," Firefox-UI-Fix.git\n",[162,2997,2998],{"class":164,"line":400},[162,2999,3000],{"class":168},"./install.sh\n",[17,3002,3003,3004,3007],{},"在接下来的对话中，我们选择",[117,3005,3006],{},"Photon-Style","，这是最接近老版UI的。",[17,3009,3010,3011,3014],{},"紧接着脚本会要求我们选择我们的Firefox数据文件夹，我们可以打开Firefox，在浏览器地址栏输入",[117,3012,3013],{},"about:support","查看到我们所使用的数据文件夹路径。",[17,3016,3017],{},[45,3018],{"alt":3013,"src":3019},"https://static.031130.xyz/uploads/2024/08/12/62f3ccadd6ce8.webp",[17,3021,3022,3023,3026,3027,3030],{},"使用空格键选择我们的数据文件夹后，在终端上该路径开头处的",[117,3024,3025],{},"[ ]","中会被打上",[117,3028,3029],{},"X","，确认无误后，敲回车。",[17,3032,3033],{},[45,3034],{"alt":3035,"src":3036},"终端显示","https://static.031130.xyz/uploads/2024/08/12/62f3ccb1b0ebf.webp",[17,3038,3039],{},"重启浏览器，顶栏就长成了这样。",[17,3041,3042],{},[45,3043],{"alt":3044,"src":3045},"Fix后的顶栏效果","https://static.031130.xyz/uploads/2024/08/12/62f3ccb49ff10.webp",[327,3047,3048],{"id":3048},"添加主题",[17,3050,3051,3052,3057],{},"为了进一步模仿Firefox经典的配色，我们可以安装上",[21,3053,3056],{"href":3054,"rel":3055},"https://addons.mozilla.org/zh-CN/firefox/addon/photon-colors/",[25],"这个主题","，变成这样",[17,3059,3060],{},[45,3061],{"alt":3062,"src":3063},"应用主题后的样子","https://static.031130.xyz/uploads/2024/08/12/62f3ccb7bc14f.webp",[327,3065,3066],{"id":3066},"禁用暗色模式",[17,3068,3069,3070,3075,3076,3084],{},"如果你的系统主题使用的是深色，导致了诸如",[21,3071,3074],{"href":3072,"rel":3073},"https://mirrors.tuna.tsinghua.edu.cn",[25],"TUNA镜像站","自动为你启用了暗色模式，而你想禁用的话，",[21,3077,3079,3080,3083],{"href":3078},"/2021/04/23/disable-firefox-nightmode-when-your-system-is-using-that/","之前通过修改",[117,3081,3082],{},"about:config","方案","依然适用。",[17,3086,3087],{},[45,3088],{"alt":3089,"src":3090},"修改前","https://static.031130.xyz/uploads/2024/08/12/62f3ccbb36c5e.webp",[17,3092,3093],{},[45,3094],{"alt":3095,"src":3096},"修改后","https://static.031130.xyz/uploads/2024/08/12/62f3ccbe6f31a.webp",[390,3098,3099],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .s_Sar, html code.shiki .s_Sar{--shiki-default:#0184BC;--shiki-dark:#56B6C2}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":47,"searchDepth":98,"depth":98,"links":3101},[3102,3103,3104],{"id":2966,"depth":400,"text":2966},{"id":3048,"depth":400,"text":3048},{"id":3066,"depth":400,"text":3066},{"title":3106,"date":3107,"path":3108,"tags":3109,"body":3111},"记录一次原创文章被抄袭","2021-09-21","/2021/09/21/csdn-copied-my-article",[3110],"Blog",{"type":14,"value":3112,"toc":3200},[3113,3121,3124,3130,3133,3136,3142,3148,3154,3160,3166,3169,3191,3197],[17,3114,3115,3116,152],{},"今天在网站自搜的时候偶然间发现了一个叫「程序员宝宝」的站点转载了我去年在知乎专栏上发的一篇文章",[21,3117,3120],{"href":3118,"rel":3119},"https://zhuanlan.zhihu.com/p/141107518",[25],"《Ubuntu下对deepin-wine的使用详解》",[17,3122,3123],{},"转载的质量并不高，超链接都没有转载上去，只有干巴巴的图片和文字。翻到结尾处，我一口老血喷出。",[17,3125,3126],{},[45,3127],{"alt":3128,"src":3129},"都不知道哪里来的版权申明","https://static.031130.xyz/uploads/2024/08/12/62f3cacc1ff3f.webp",[17,3131,3132],{},"我就纳闷了，我作为原创博主，自己都没有给这篇文章挂上CC的版权协议，怎么就有人自称是原创给我挂上了CC协议，要知道我知乎还明确勾选了「转载需要申请」呢。",[17,3134,3135],{},"抱着吃瓜的心态在谷歌上搜索，我发现了五篇抄袭我的文章。CSDN三篇，还有「程序员宝宝」和「程序员宅基地」使用相同UI的、被我怀疑是机器人搬运的站点。",[17,3137,3138],{},[45,3139],{"alt":3140,"src":3141},"谷歌搜索结果","https://static.031130.xyz/uploads/2024/08/12/62f3cad01576d.webp",[17,3143,3144,3145],{},"CSDN那边，我在页面页脚处找到了「在线客服」，注册帐号后联系了客服，客服反应非常迅速，",[247,3146,3147],{},"5分钟内就对抄袭文章进行了下架处理，这点值得表扬。",[17,3149,3150],{},[45,3151],{"alt":3152,"src":3153},"CSDN客服聊天记录1","https://static.031130.xyz/uploads/2024/08/12/62f3cad3ceaa6.webp",[17,3155,3156],{},[45,3157],{"alt":3158,"src":3159},"CSDN客服聊天记录2","https://static.031130.xyz/uploads/2024/08/12/62f3cad833827.webp",[17,3161,3162],{},[45,3163],{"alt":3164,"src":3165},"CSDN客服聊天记录3","https://static.031130.xyz/uploads/2024/08/12/62f3cadacac4d.webp",[17,3167,3168],{},"至于「程序员宝宝」和「程序员宅基地」这两个站点，在他们的版权申明中写得很清楚。",[199,3170,3171,3176,3179,3188],{},[17,3172,3173],{},[247,3174,3175],{},"如果你是文章作者：",[17,3177,3178],{},"请通过邮件联系我们，邮件内容包括：",[3180,3181,3182,3185],"ol",{},[229,3183,3184],{},"待删除的文章链接",[229,3186,3187],{},"发件人是待删除文章作者的证明（如果发件人邮箱地址能证明你是文章作者，此项内容可以为空）",[17,3189,3190],{},"我们会在收到邮件后7个工作日内进行处理。",[17,3192,3193,3194],{},"但我找遍了整个网站，",[247,3195,3196],{},"根本没有发现站点方的邮箱。",[17,3198,3199],{},"不知诸位有何解决方案？",{"title":47,"searchDepth":98,"depth":98,"links":3201},[],{"title":3203,"date":3204,"path":3205,"tags":3206,"body":3207},"使用AUR(Helper)安装软件时究竟发生了什么？对于常见的构建错误如何解决？","2021-09-11 19:22:29","/2021/09/11/detailed-explanation-for-aur",[106,60],{"type":14,"value":3208,"toc":3628},[3209,3214,3218,3225,3232,3238,3271,3273,3276,3301,3304,3324,3330,3334,3341,3347,3351,3354,3358,3365,3371,3374,3395,3397,3400,3406,3412,3416,3541,3545,3548,3555,3562,3575,3579,3582,3584,3587,3593,3596,3614,3617,3625],[199,3210,3211],{},[17,3212,3213],{},"虽然对于没有能力手动修改/编写PKGBUILD的Arch用户其实是不应该使用AUR中的包的，这些软件的PKGBUILD可以由个人随意发布，并不能保证安全性，但是作为Archlinux的特色，但随着AUR Helper的趋于便利，还是吸引了不少小白使用AUR。本文将主要讲一讲 AUR Helper 帮助我们安装软件时到底做了些什么事情，并提供一些使用AUR Helper构建时常见错误的解决方案。",[110,3215,3217],{"id":3216},"partⅰ基本原理","PartⅠ基本原理",[327,3219,3221,3224],{"id":3220},"makepkg是如何工作的",[117,3222,3223],{},"makepkg","是如何工作的？",[17,3226,3227,3228,3231],{},"以钉钉举例，我们可以从AUR上使用 ",[117,3229,3230],{},"git clone https://aur.archlinux.org/dingtalk-bin.git"," 获取到由这个包的维护者为我们提前写好的构建脚本。他的目录大概是长成下面这个样子:",[154,3233,3236],{"className":3234,"code":3235,"language":219},[217],"dingtalk-bin\n├── com.alibabainc.dingtalk.desktop\n├── dingtalk.sh\n├── .git\n├── .gitignore\n├── PKGBUILD\n├── service-terms-zh\n└── .SRCINFO\n",[117,3237,3235],{"__ignoreMap":47},[226,3239,3240,3247,3253,3259],{},[229,3241,3242,3243,3246],{},"其中，",[117,3244,3245],{},".git","是git的工作目录，可以忽视。",[229,3248,3249,3252],{},[117,3250,3251],{},".gitignore","属于git的配置文件之一，我们也不用管。",[229,3254,3255,3258],{},[117,3256,3257],{},"PKGBUILD","是这个目录下最重要的东西，是一个用于提供参数的脚本。makepkg通过执行PKGBUILD脚本来获取到参数，自动进行下载和构建过程。",[229,3260,3261,569,3264,569,3267,3270],{},[117,3262,3263],{},"service-terms-zh",[117,3265,3266],{},"com.alibabainc.dingtalk.desktop",[117,3268,3269],{},"dingtalk.sh","是包里所需要用到的东西。",[421,3272],{},[17,3274,3275],{},"当我们cd到这个目录下执行makepkg时，",[17,3277,3278,3279,3281,3282,3284,3285,3288,3289,3292,3293,3296,3297,3300],{},"makepkg会调用",[117,3280,169],{}," / ",[117,3283,2982],{},"下载PKGBUILD中",[117,3286,3287],{},"source=()","部分中以",[117,3290,3291],{},"http(s)","协议头或者",[117,3294,3295],{},"git+","开头的链接，这些东西将会被下载到这个目录的",[117,3298,3299],{},"src","文件夹下。",[17,3302,3303],{},"对于curl下载的东西，makepkg会使用校验码核对下载到的文件是否完整、是否是当初这个包的维护者下载到的这一个。",[17,3305,3306,3307,1695,3310,1695,3313,3316,3317,3320,3321,3300],{},"校验通过后，makepkg会依次执行",[117,3308,3309],{},"prepare(){}",[117,3311,3312],{},"build(){}",[117,3314,3315],{},"package(){}","函数中的命令陆续完成",[147,3318,3319],{},"准备、编译","过程，并将最终要打进包里的文件放置到",[117,3322,3323],{},"pkg",[17,3325,3326,3327,3329],{},"最后，makepkg将会将",[117,3328,3323],{},"文件夹的内容压缩成包。",[327,3331,3333],{"id":3332},"aur-helper-干了些什么","AUR Helper 干了些什么",[17,3335,3336,3337,3340],{},"我们还是以钉钉为例，看看我们执行",[117,3338,3339],{},"yay dingtalk-bin","时到底发生了什么。",[17,3342,3343],{},[45,3344],{"alt":3345,"src":3346},"当你使用yay安装软件到底发生了什么","https://static.031130.xyz/uploads/2024/08/12/62f3cdb03ec8c.webp",[110,3348,3350],{"id":3349},"partⅱ常见错误解决方案","PartⅡ常见错误解决方案",[17,3352,3353],{},"如果有其他情况觉得可以完善的，欢迎在评论区留言。",[327,3355,3357],{"id":3356},"_1-base-devel-没有安装","1. base-devel 没有安装",[17,3359,3360,3361,3364],{},"正如上面所说的，没有安装",[117,3362,3363],{},"base-devel","组，赶紧补上!",[17,3366,3367,3368,3370],{},"由于",[117,3369,3363],{},"并不是一个具体的包，而是由多个包构成的包组，其实并没有很好的方法来检测你是否已经安装。",[17,3372,3373],{},"所以如果你不确定，你也可以执行下面的命令来确保自己已经安装。",[154,3375,3377],{"className":156,"code":3376,"language":158,"meta":47,"style":47},"sudo pacman -S base-devel --noconfirm --needed\n",[117,3378,3379],{"__ignoreMap":47},[162,3380,3381,3383,3385,3387,3390,3393],{"class":164,"line":165},[162,3382,1015],{"class":168},[162,3384,1336],{"class":176},[162,3386,974],{"class":172},[162,3388,3389],{"class":176}," base-devel",[162,3391,3392],{"class":172}," --noconfirm",[162,3394,1344],{"class":172},[421,3396],{},[17,3398,3399],{},"常见表现:",[154,3401,3404],{"className":3402,"code":3403,"language":219},[217],"ERROR: Cannot find the strip binary required for object file stripping.\n",[117,3405,3403],{"__ignoreMap":47},[154,3407,3410],{"className":3408,"code":3409,"language":219},[217],"PKGBUILD: line XXX XXX: command not found\n",[117,3411,3409],{"__ignoreMap":47},[327,3413,3415],{"id":3414},"_2-source源文件下载失败","2. source源文件下载失败",[3180,3417,3418,3526,3532],{},[229,3419,3420,3424,3425,3428,3432,3434,3435,152,3438,3456,3458,3469,3477,3479,3480,3483,3484,3487,3488,3490,3493,3495,3496,3523,3525],{},[3421,3422,3423],"h4",{"id":3423},"网络问题","国内的网络问题不用多说了，大多数情况下都是Github连接不上。",[3426,3427],"br",{},[45,3429],{"alt":3430,"src":3431},"yay下载失败","https://static.031130.xyz/uploads/2024/08/12/62f3cc9c9dda8.webp",[3426,3433],{},"最简单的解决方案就是把source里下载失败的东西通过特殊手段（比如你浏览器设置下代理，或者找找fastgit这种反代）下载下来以后直接扔到PKGBUILD所在的路径，然后手动执行",[117,3436,3437],{},"makepkg -si",[199,3439,3440,3443],{},[17,3441,3442],{},"-s代表自动下载makedepend，-i表示构建成功以后自动安装",[17,3444,3445,3446,3449,3450,3455],{},"yay存放PKGBUILD的默认路径是在",[117,3447,3448],{},"$HOME/.cache/yay/$pkgname","下面，具体可以参考我的另一篇关于",[21,3451,3454],{"href":3452,"rel":3453},"https://blog.zhullyb.top/2021/04/04/yay-more/#builddir-lt-dir-gt",[25],"yay的用法详解","的博客。",[3426,3457],{},[247,3459,3460,3461,3468],{},"我在这里再讲一种使用 ",[21,3462,3465],{"href":3463,"rel":3464},"http://fastgit.org/",[25],[147,3466,3467],{},"fastgit"," 作为反代加速github下载的方法。",[35,3470,3471,3472,152],{},"如果觉得fastgit帮助到了你，你可以考虑",[21,3473,3476],{"href":3474,"rel":3475},"http://fastgit.org/donate.html",[25],"给fastgit项目打钱",[3426,3478],{},"当你的yay出现这个询问菜单时，（也就是出现",[117,3481,3482],{},"Diffs to show","/",[117,3485,3486],{},"显示哪些差异？","字样时）",[3426,3489],{},[45,3491],{"alt":47,"src":3492},"https://static.031130.xyz/uploads/2024/08/12/62f3cca0c7aba.webp",[3426,3494],{},"我们再开一个终端，输入",[154,3497,3499],{"className":156,"code":3498,"language":158,"meta":47,"style":47},"sed -i \"s|github.com|hub.fastgit.org|g\" $HOME/.cache/yay/*/PKGBUILD\n",[117,3500,3501],{"__ignoreMap":47},[162,3502,3503,3506,3508,3511,3513,3516,3520],{"class":164,"line":165},[162,3504,3505],{"class":168},"sed",[162,3507,2686],{"class":172},[162,3509,3510],{"class":176}," \"s|github.com|hub.fastgit.org|g\"",[162,3512,1269],{"class":1268},[162,3514,3515],{"class":176},"/.cache/yay/",[162,3517,3519],{"class":3518},"s2QsP","*",[162,3521,3522],{"class":176},"/PKGBUILD\n",[3426,3524],{},"接着就下一步安装即可。",[229,3527,3528,3531],{},[3421,3529,3530],{"id":3530},"链接失效","这种情况多见于维护者维护不到位，上游放出了新版本包并删除老版本包以后维护者没有及时跟进的。你可以去逛一逛AUR的评论区查看解决方案，或者去查找上游的最新版本是多少，尝试更改PKGBUILD中的pkgver参数和checksum以后尝试makepkg。",[229,3533,3534,3537,3538],{},[3421,3535,3536],{"id":3536},"需要手动下载","一般情况下是上游没有提供直链，makepkg无法自行下载，需要人工介入。解决方法同上面的",[21,3539,3423],{"href":3540},"#%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98",[327,3542,3544],{"id":3543},"_3-checksum-错误","3. checksum 错误",[17,3546,3547],{},"上文已经提到过，checksum用于判断你所下载到的软件和维护者当初下载到的是否一致。但是有些情况下，确实是维护者忘了更新checksum值了，因此我们需要做一个判断。",[17,3549,3550,3551,3554],{},"打开",[117,3552,3553],{},".SCRINFO","，找到checksum报错的那个文件的链接。",[17,3556,3557,3558,3561],{},"使用wget/curl等工具将他下载下来，可以通过",[117,3559,3560],{},"md5sum+文件名","的方式获取他们的md5值。连续下载两次，核对两次的检验值是否一致。",[17,3563,3564,3565,3568,3569,3572,3573,152],{},"如果结果一致，那么说明并不是网络波动导致的检验值不符，而是维护者没有及时跟进导致的，你可以使用",[117,3566,3567],{},"yay -S $pkgname --skipchecksums","的方式跳过验证校验值的过程，或者你可以修改PKGBUILD中的校验值为",[117,3570,3571],{},"\"SKIP\"","来跳过某一文件的校验后手动",[117,3574,3223],{},[327,3576,3578],{"id":3577},"_4-tuna反代受限","4. tuna反代受限",[17,3580,3581],{},"tuna的服务器只有一个ip，但当使用他提供的AUR的反代服务时，全国的使用者都会被AUR认为是tuna这一个ip，过大的请求数量可能导致tuna的服务器超出AUR每天给每个ip限制的请求次数。",[421,3583],{},[17,3585,3586],{},"具体表现:",[154,3588,3591],{"className":3589,"code":3590,"language":219},[217],"Rate limit reached\n",[117,3592,3590],{"__ignoreMap":47},[17,3594,3595],{},"解决方案，改回AUR的服务器，使用自己的ip进行请求",[154,3597,3599],{"className":156,"code":3598,"language":158,"meta":47,"style":47},"yay --aururl \"https://aur.archlinux.org\" --save\n",[117,3600,3601],{"__ignoreMap":47},[162,3602,3603,3605,3608,3611],{"class":164,"line":165},[162,3604,971],{"class":168},[162,3606,3607],{"class":172}," --aururl",[162,3609,3610],{"class":176}," \"https://aur.archlinux.org\"",[162,3612,3613],{"class":172}," --save\n",[110,3615,3616],{"id":3616},"写在最后",[17,3618,3619,3620],{},"关于AUR使用的更多细节可以阅读 ",[21,3621,3624],{"href":3622,"rel":3623},"https://blog.zhullyb.top/2021/04/04/yay-more/",[25],"《yay进阶》",[390,3626,3627],{},"html pre.shiki code .sAdtL, html code.shiki .sAdtL{--shiki-default:#4078F2;--shiki-dark:#61AFEF}html pre.shiki code .sDhpE, html code.shiki .sDhpE{--shiki-default:#50A14F;--shiki-dark:#98C379}html pre.shiki code .sAGMh, html code.shiki .sAGMh{--shiki-default:#986801;--shiki-dark:#D19A66}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sJa8x, html code.shiki .sJa8x{--shiki-default:#E45649;--shiki-dark:#E06C75}html pre.shiki code .s2QsP, html code.shiki .s2QsP{--shiki-default:#E45649;--shiki-dark:#E5C07B}",{"title":47,"searchDepth":98,"depth":98,"links":3629},[3630,3635,3641],{"id":3216,"depth":98,"text":3217,"children":3631},[3632,3634],{"id":3220,"depth":400,"text":3633},"makepkg是如何工作的？",{"id":3332,"depth":400,"text":3333},{"id":3349,"depth":98,"text":3350,"children":3636},[3637,3638,3639,3640],{"id":3356,"depth":400,"text":3357},{"id":3414,"depth":400,"text":3415},{"id":3543,"depth":400,"text":3544},{"id":3577,"depth":400,"text":3578},{"id":3616,"depth":98,"text":3616},129,1763653590967]